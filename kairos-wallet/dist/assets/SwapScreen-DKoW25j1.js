import{d as c,j as e,e as Xe,Z as ue,O as Ce,ah as Qe,u as Se,ai as pe,ag as ne,A as V,m as M,T as q,b as Ke,X as oe,a1 as $e,aj as Fe,P as Je,ak as Ve,w as qe}from"./ui-Bym_0wSS.js";import{C as X,E as G,F as Ge,u as Ye,G as Ze,H as he,T as ie,I as le,p as et,J as tt}from"./index-Cv82Q9rX.js";import{parseUnits as H,formatUnits as Q,Contract as Y,Wallet as De}from"./crypto-1JBTrmrY.js";import"./vendor-CCYniLZC.js";const Te=["function getAmountsOut(uint amountIn, address[] calldata path) external view returns (uint[] memory amounts)","function getAmountsIn(uint amountOut, address[] calldata path) external view returns (uint[] memory amounts)","function swapExactETHForTokens(uint amountOutMin, address[] calldata path, address to, uint deadline) external payable returns (uint[] memory amounts)","function swapExactTokensForETH(uint amountIn, uint amountOutMin, address[] calldata path, address to, uint deadline) external returns (uint[] memory amounts)","function swapExactTokensForTokens(uint amountIn, uint amountOutMin, address[] calldata path, address to, uint deadline) external returns (uint[] memory amounts)","function swapExactETHForTokensSupportingFeeOnTransferTokens(uint amountOutMin, address[] calldata path, address to, uint deadline) external payable","function swapExactTokensForETHSupportingFeeOnTransferTokens(uint amountIn, uint amountOutMin, address[] calldata path, address to, uint deadline) external","function swapExactTokensForTokensSupportingFeeOnTransferTokens(uint amountIn, uint amountOutMin, address[] calldata path, address to, uint deadline) external","function factory() external view returns (address)","function WETH() external view returns (address)"],fe={56:"PancakeSwap",1:"Uniswap",137:"QuickSwap",42161:"SushiSwap",43114:"Trader Joe",8453:"BaseSwap"};function st(d){const r=X[d];if(!r?.dexRouter)throw new Error("No DEX disponible en esta red");const u=G(d);return new Y(r.dexRouter,Te,u)}async function at(d,r,u,f,g,p){const y=X[d],k=st(d),x=y.wrappedNative,a=r==="native",F=u==="native",s=a?x:r,v=F?x:u;if(s.toLowerCase()===v.toLowerCase())throw new Error("No puedes intercambiar el mismo token");const i=H(f.toString(),g),C=[[s,v],...s.toLowerCase()!==x.toLowerCase()&&v.toLowerCase()!==x.toLowerCase()?[[s,x,v]]:[]];let n=0n,N=null;for(const A of C)try{const j=await k.getAmountsOut(i,A),D=j[j.length-1];D>n&&(n=D,N=A)}catch{}if(!N||n===0n)throw new Error("No hay liquidez para este par. Prueba otro token o cantidad.");const w=Q(n,p),m=parseFloat(f),E=parseFloat(w)/m;let S=0;try{const A=H("1",g),j=await k.getAmountsOut(A,N);S=parseFloat(Q(j[j.length-1],p))}catch{}const b=S>0?Math.abs((E-S)/S)*100:0,R=N.map(A=>A.toLowerCase()===x.toLowerCase()?y.nativeCurrency.symbol:A);return{amountOut:w,amountOutRaw:n.toString(),path:N,priceImpact:b.toFixed(2),effectivePrice:E,route:R,dex:fe[d]||"DEX"}}async function Ee(d,r,u,f,g,p){const y=G(d),k=new De(r,y),x=new Y(u,Ge,k),a=H(g.toString(),p);if(await x.allowance(k.address,f)>=a)return null;const s=await x.approve(f,a);return await s.wait(),{hash:s.hash,type:"approve"}}async function rt({chainId:d,privateKey:r,tokenIn:u,tokenOut:f,amountIn:g,amountOutMin:p,decimalsIn:y,decimalsOut:k,path:x,slippage:a=.5,useFeeOnTransfer:F=!1}){const s=X[d],v=G(d),i=new De(r,v),C=new Y(s.dexRouter,Te,i),n=H(g.toString(),y),N=H(p.toString(),k),w=BigInt(Math.floor((100-a)*100)),m=N*w/10000n,h=Math.floor(Date.now()/1e3)+1200,E=u==="native",S=f==="native";let b;return E?F?b=await C.swapExactETHForTokensSupportingFeeOnTransferTokens(m,x,i.address,h,{value:n}):b=await C.swapExactETHForTokens(m,x,i.address,h,{value:n}):S?(await Ee(d,r,u,s.dexRouter,g,y),F?b=await C.swapExactTokensForETHSupportingFeeOnTransferTokens(n,m,x,i.address,h):b=await C.swapExactTokensForETH(n,m,x,i.address,h)):(await Ee(d,r,u,s.dexRouter,g,y),F?b=await C.swapExactTokensForTokensSupportingFeeOnTransferTokens(n,m,x,i.address,h):b=await C.swapExactTokensForTokens(n,m,x,i.address,h)),{hash:b.hash,from:i.address,type:"swap",tokenIn:u,tokenOut:f,amountIn:g,amountOutMin:Q(m,k),dex:fe[d],chainId:d,timestamp:Date.now(),status:"pending"}}const nt={56:[{symbol:"USDT",name:"Tether USD",address:"0x55d398326f99059fF775485246999027B3197955",decimals:18,icon:"ðŸ’µ"},{symbol:"USDC",name:"USD Coin",address:"0x8AC76a51cc950d9822D68b83fE1Ad97B32Cd580d",decimals:18,icon:"ðŸ’²"},{symbol:"BUSD",name:"Binance USD",address:"0xe9e7CEA3DedcA5984780Bafc599bD69ADd087D56",decimals:18,icon:"ðŸŸ¡"},{symbol:"ETH",name:"Ethereum",address:"0x2170Ed0880ac9A755fd29B2688956BD959F933F8",decimals:18,icon:"âŸ "},{symbol:"BTCB",name:"Bitcoin BEP20",address:"0x7130d2A12B9BCbFAe4f2634d864A1Ee1Ce3Ead9c",decimals:18,icon:"â‚¿"},{symbol:"CAKE",name:"PancakeSwap",address:"0x0E09FaBB73Bd3Ade0a17ECC321fD13a19e81cE82",decimals:18,icon:"ðŸ¥ž"},{symbol:"XRP",name:"XRP",address:"0x1D2F0da169ceB9fC7B3144628dB156f3F6c60dBE",decimals:18,icon:"âœ•"},{symbol:"DOGE",name:"Dogecoin",address:"0xbA2aE424d960c26247Dd6c32edC70B295c744C43",decimals:8,icon:"ðŸ•"},{symbol:"KAIROS",name:"KairosCoin",address:"0x14D41707269c7D8b8DFa5095b38824a46dA05da3",decimals:18,icon:"â³"}],1:[{symbol:"USDT",name:"Tether USD",address:"0xdAC17F958D2ee523a2206206994597C13D831ec7",decimals:6,icon:"ðŸ’µ"},{symbol:"USDC",name:"USD Coin",address:"0xA0b86991c6218b36c1d19D4a2e9Eb0cE3606eB48",decimals:6,icon:"ðŸ’²"},{symbol:"DAI",name:"Dai Stablecoin",address:"0x6B175474E89094C44Da98b954EedeAC495271d0F",decimals:18,icon:"â—ˆ"},{symbol:"WBTC",name:"Wrapped Bitcoin",address:"0x2260FAC5E5542a773Aa44fBCfeDf7C193bc2C599",decimals:8,icon:"â‚¿"},{symbol:"UNI",name:"Uniswap",address:"0x1f9840a85d5aF5bf1D1762F925BDADdC4201F984",decimals:18,icon:"ðŸ¦„"},{symbol:"LINK",name:"Chainlink",address:"0x514910771AF9Ca656af840dff83E8264EcF986CA",decimals:18,icon:"â¬¡"},{symbol:"SHIB",name:"Shiba Inu",address:"0x95aD61b0a150d79219dCF64E1E6Cc01f0B64C4cE",decimals:18,icon:"ðŸ•"},{symbol:"PEPE",name:"Pepe",address:"0x6982508145454Ce325dDbE47a25d4ec3d2311933",decimals:18,icon:"ðŸ¸"}],137:[{symbol:"USDT",name:"Tether USD",address:"0xc2132D05D31c914a87C6611C10748AEb04B58e8F",decimals:6,icon:"ðŸ’µ"},{symbol:"USDC",name:"USD Coin",address:"0x3c499c542cEF5E3811e1192ce70d8cC03d5c3359",decimals:6,icon:"ðŸ’²"},{symbol:"WBTC",name:"Wrapped Bitcoin",address:"0x1BFD67037B42Cf73acF2047067bd4F2C47D9BfD6",decimals:8,icon:"â‚¿"},{symbol:"WETH",name:"Wrapped Ether",address:"0x7ceB23fD6bC0adD59E62ac25578270cFf1b9f619",decimals:18,icon:"âŸ "},{symbol:"AAVE",name:"Aave",address:"0xD6DF932A45C0f255f85145f286eA0b292B21C90B",decimals:18,icon:"ðŸ‘»"},{symbol:"KAIROS",name:"KairosCoin",address:"0x9151B8C90B2F8a8DF82426E7E65d00563A75a6C9",decimals:18,icon:"â³"}],42161:[{symbol:"USDT",name:"Tether USD",address:"0xFd086bC7CD5C481DCC9C85ebE478A1C0b69FCbb9",decimals:6,icon:"ðŸ’µ"},{symbol:"USDC",name:"USD Coin",address:"0xaf88d065e77c8cC2239327C5EDb3A432268e5831",decimals:6,icon:"ðŸ’²"},{symbol:"WBTC",name:"Wrapped Bitcoin",address:"0x2f2a2543B76A4166549F7aaB2e75Bef0aefC5B0f",decimals:8,icon:"â‚¿"},{symbol:"ARB",name:"Arbitrum",address:"0x912CE59144191C1204E64559FE8253a0e49E6548",decimals:18,icon:"ðŸ”µ"},{symbol:"GMX",name:"GMX",address:"0xfc5A1A6EB076a2C7aD06eD22C90d7E710E35ad0a",decimals:18,icon:"ðŸ’Ž"},{symbol:"KAIROS",name:"KairosCoin",address:"0x14D41707269c7D8b8DFa5095b38824a46dA05da3",decimals:18,icon:"â³"}],8453:[{symbol:"USDC",name:"USD Coin",address:"0x833589fCD6eDb6E08f4c7C32D4f71b54bdA02913",decimals:6,icon:"ðŸ’²"},{symbol:"DAI",name:"Dai Stablecoin",address:"0x50c5725949A6F0c72E6C4a641F24049A917DB0Cb",decimals:18,icon:"â—ˆ"},{symbol:"KAIROS",name:"KairosCoin",address:"0x14D41707269c7D8b8DFa5095b38824a46dA05da3",decimals:18,icon:"â³"}],43114:[{symbol:"USDT",name:"Tether USD",address:"0x9702230A8Ea53601f5cD2dc00fDBc13d4dF4A8c7",decimals:6,icon:"ðŸ’µ"},{symbol:"USDC",name:"USD Coin",address:"0xB97EF9Ef8734C71904D8002F8b6Bc66Dd9c48a6E",decimals:6,icon:"ðŸ’²"},{symbol:"WBTC",name:"Wrapped Bitcoin",address:"0x50b7545627a5162F82A992c33b87aDc75187B218",decimals:8,icon:"â‚¿"},{symbol:"JOE",name:"Trader Joe",address:"0x6e84a6216eA6dACC71eE8E6b0a5B7322EEbC0fDd",decimals:18,icon:"ðŸŽ©"}]};function ot(d,r){const u=[],f=new Set;if(r?.native&&(u.push({...r.native,id:"native",isNative:!0}),f.add("native")),r?.tokens)for(const p of r.tokens)u.push({...p,id:p.address,hasBalance:!0}),f.add(p.address.toLowerCase());const g=nt[d]||[];for(const p of g)f.has(p.address.toLowerCase())||(u.push({...p,id:p.address,balance:"0",hasBalance:!1}),f.add(p.address.toLowerCase()));return u}async function it(d,r){const u=G(d),f=new Y(r,["function name() view returns (string)","function symbol() view returns (string)","function decimals() view returns (uint8)","function totalSupply() view returns (uint256)"],u),[g,p,y,k]=await Promise.all([f.name().catch(()=>"Unknown"),f.symbol().catch(()=>"???"),f.decimals().catch(()=>18),f.totalSupply().catch(()=>0n)]);return{address:r,name:g,symbol:p,decimals:Number(y),totalSupply:Q(k,y),id:r,balance:"0",hasBalance:!1}}const Be="kairos_swap_history",Ae=50;function Oe(){try{return JSON.parse(localStorage.getItem(Be)||"[]")}catch{return[]}}function lt(d){const r=Oe();r.unshift({...d,id:Date.now().toString(36),timestamp:Date.now()}),r.length>Ae&&(r.length=Ae),localStorage.setItem(Be,JSON.stringify(r))}const ct="kairos_swap_favorites";function dt(){try{return JSON.parse(localStorage.getItem(ct)||"[]")}catch{return[]}}const xt=["function getAmountsOut(uint amountIn, address[] calldata path) external view returns (uint[] memory amounts)","function factory() external view returns (address)","function WETH() external view returns (address)"],mt={56:[{name:"PancakeSwap V2",router:"0x10ED43C718714eb63d5aA57B78B54704E256024E",color:"#1FC7D4"},{name:"BiSwap",router:"0x3a6d8cA21D1CF76F653A67577FA0D27453350dD8",color:"#FF6B35"},{name:"ApeSwap",router:"0xcF0feBd3f17CEf5b47b0cD257aCf6025c5BFf3b7",color:"#A16552"},{name:"MDEX",router:"0x7DAe51BD3E3376B8c7c4900E9107f12Be3AF1bA8",color:"#4A90E2"}],1:[{name:"Uniswap V2",router:"0x7a250d5630B4cF539739dF2C5dAcb4c659F2488D",color:"#FF007A"},{name:"SushiSwap",router:"0xd9e1cE17f2641f24aE83637ab66a2cca9C378B9F",color:"#FA52A0"}],137:[{name:"QuickSwap",router:"0xa5E0829CaCEd8fFDD4De3c43696c57F7D7A678ff",color:"#418ACA"},{name:"SushiSwap",router:"0x1b02dA8Cb0d097eB8D57A175b88c7D8b47997506",color:"#FA52A0"}],42161:[{name:"SushiSwap",router:"0x1b02dA8Cb0d097eB8D57A175b88c7D8b47997506",color:"#FA52A0"},{name:"Camelot",router:"0xc873fEcbd354f5A56E00E710B90EF4201db2448d",color:"#FFAF1D"}],43114:[{name:"Trader Joe",router:"0x60aE616a2155Ee3d9A68541Ba4544862310933d4",color:"#E84142"},{name:"Pangolin",router:"0xE54Ca86531e17Ef3616d22Ca28b0D458b6C89106",color:"#FC4C00"}],8453:[{name:"BaseSwap",router:"0x327Df1E6de05895d2ab08513aaDD9313Fe505d86",color:"#0052FF"},{name:"Aerodrome",router:"0xcF77a3Ba9A5CA399B7c97c74d54e5b1Beb874E43",color:"#0000FF"}]};async function ut(d,r,u,f,g,p){const y=X[d],k=mt[d]||[];if(k.length===0)throw new Error("No DEXs configurados para esta red");const x=y.wrappedNative,a=r==="native",F=u==="native",s=a?x:r,v=F?x:u;if(s.toLowerCase()===v.toLowerCase())throw new Error("No puedes intercambiar el mismo token");const i=H(f.toString(),g),C=G(d),n=k.map(async m=>{try{const h=new Y(m.router,xt,C),E=[[s,v],...s.toLowerCase()!==x.toLowerCase()&&v.toLowerCase()!==x.toLowerCase()?[[s,x,v]]:[]];let S=0n,b=null;for(const j of E)try{const D=await h.getAmountsOut(i,j),B=D[D.length-1];B>S&&(S=B,b=j)}catch{}if(!b||S===0n)return null;const R=Q(S,p);let A=0;try{const j=H("1",g),D=await h.getAmountsOut(j,b),B=parseFloat(Q(D[D.length-1],p)),L=parseFloat(R)/parseFloat(f);A=B>0?Math.abs((L-B)/B)*100:0}catch{}return{dex:m.name,dexColor:m.color,router:m.router,amountOut:R,amountOutRaw:S.toString(),path:b,priceImpact:A.toFixed(2),route:b.map(j=>j.toLowerCase()===x.toLowerCase()?y.nativeCurrency.symbol:j)}}catch{return null}}),w=(await Promise.allSettled(n)).filter(m=>m.status==="fulfilled"&&m.value).map(m=>m.value).sort((m,h)=>parseFloat(h.amountOut)-parseFloat(m.amountOut));if(w.length===0)throw new Error("No hay liquidez en ningÃºn DEX para este par.");if(w.length>1){const m=parseFloat(w[0].amountOut),h=parseFloat(w[w.length-1].amountOut);w[0].isBest=!0,w[0].savingsPercent=h>0?((m-h)/h*100).toFixed(2):"0"}else w[0].isBest=!0,w[0].savingsPercent="0";return w}function jt(){const{activeAddress:d,activeChainId:r,balances:u,navigate:f,goBack:g,showToast:p,setBalances:y}=Ye(),k=X[r],x=fe[r]||"DEX",[a,F]=c.useState(null),[s,v]=c.useState(null),[i,C]=c.useState(""),[n,N]=c.useState(null),[w,m]=c.useState(!1),[h,E]=c.useState(""),S=c.useRef(null),[b,R]=c.useState(.5),[A,j]=c.useState(!1),[D,B]=c.useState(""),[L,Z]=c.useState(null),[O,I]=c.useState("idle"),[K,_]=c.useState(""),[be,ee]=c.useState(""),[we,Ie]=c.useState(""),[ze,te]=c.useState(""),[$,ge]=c.useState([]),[se,je]=c.useState(0),Ne=c.useRef(null),[ce,W]=c.useState(""),[de,ye]=c.useState(!1),[Pe,Ue]=c.useState(()=>{try{return JSON.parse(localStorage.getItem("kairos_custom_tokens")||"[]")}catch{return[]}}),[Re,ke]=c.useState(!1),[pt,ht]=c.useState(dt()),[ae,Le]=c.useState(0),U=ot(r,u);c.useEffect(()=>{Ze(r).then(t=>Le(t||0)).catch(()=>{})},[r]),c.useEffect(()=>{U.length>0&&!a&&(F(U[0]),U.length>1&&v(U[1]))},[U.length]);const xe=c.useCallback(async()=>{if(!a||!s||!i||parseFloat(i)<=0){N(null),E("");return}const t=parseFloat(a.balance||"0");if(parseFloat(i)>t){E("Saldo insuficiente"),N(null);return}m(!0),E("");try{const l=a.isNative?"native":a.address,z=s.isNative?"native":s.address,P=await at(r,l,z,i,a.decimals||18,s.decimals||18);N(P),E(""),je(0),clearInterval(Ne.current),Ne.current=setInterval(()=>{je(o=>o+1)},1e3);try{const o=a.isNative?"native":a.address,T=s.isNative?"native":s.address,J=await ut(r,o,T,i,a.decimals||18,s.decimals||18);ge(J)}catch{ge([])}}catch(l){N(null),E(l.message||"Error obteniendo cotizaciÃ³n")}finally{m(!1)}},[a,s,i,r]);c.useEffect(()=>(clearTimeout(S.current),i&&parseFloat(i)>0&&a&&s?S.current=setTimeout(xe,600):(N(null),E("")),()=>clearTimeout(S.current)),[i,a?.id,s?.id,xe]);const Me=()=>{const t=a;F(s),v(t),C(""),N(null)},He=()=>{if(!a)return;let t=parseFloat(a.balance||"0");a.isNative&&(t=Math.max(0,t-.005)),C(t>0?t.toString():"")},re=t=>{L==="from"?(s&&t.id===s.id&&v(a),F(t)):(a&&t.id===a.id&&F(s),v(t)),Z(null),N(null),C("")},_e=()=>{!n||h||(I("password"),_(""),ee(""))},ve=async()=>{ee("");try{const t=await et(K),z=[...t.accounts||[],...t.importedAccounts||[]].find(J=>J.address.toLowerCase()===d.toLowerCase());if(!z)throw new Error("Cuenta no encontrada");I("swapping");const P=a.isNative?"native":a.address,o=s.isNative?"native":s.address,T=await rt({chainId:r,privateKey:z.privateKey,tokenIn:P,tokenOut:o,amountIn:i,amountOutMin:n.amountOut,decimalsIn:a.decimals||18,decimalsOut:s.decimals||18,path:n.path,slippage:b,useFeeOnTransfer:!1});Ie(T.hash),I("success"),_(""),lt({hash:T.hash,fromSymbol:a.symbol,toSymbol:s.symbol,amountIn:i,amountOut:n?.amountOut,chainId:r,dex:n?.dex||x});try{const J=await tt(r,d);y(J)}catch{}}catch(t){t.message==="ContraseÃ±a incorrecta"?(ee("ContraseÃ±a incorrecta"),I("password")):(te(t.message||"Error ejecutando swap"),I("error"),_(""))}},We=t=>{const l=parseFloat(t);return l<1?"text-green-400":l<3?"text-yellow-400":l<5?"text-orange-400":"text-red-400"},me=n&&!h&&!w&&parseFloat(i)>0;return e.jsxs("div",{className:"screen-container",children:[e.jsxs("div",{className:"flex items-center justify-between px-5 py-4",children:[e.jsx("button",{onClick:g,className:"p-2 -ml-2 rounded-xl hover:bg-white/5",children:e.jsx(Xe,{size:20,className:"text-dark-300"})}),e.jsxs("div",{className:"text-center",children:[e.jsx("h1",{className:"font-bold text-white",children:"Swap"}),e.jsxs("p",{className:"text-[10px] text-dark-400 flex items-center gap-1 justify-center",children:[e.jsx(ue,{size:10,className:"text-kairos-400"}),x," en ",k.shortName]})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("button",{onClick:()=>ke(!0),className:"p-2 rounded-xl hover:bg-white/5",children:e.jsx(Ce,{size:18,className:"text-dark-300"})}),e.jsx("button",{onClick:()=>j(!0),className:"p-2 -mr-2 rounded-xl hover:bg-white/5",children:e.jsx(Qe,{size:20,className:"text-dark-300"})})]})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto px-5",children:[e.jsxs("div",{className:"bg-white/[0.03] rounded-2xl p-4 border border-white/5",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-xs text-dark-400",children:"Vendes"}),a&&e.jsxs("button",{onClick:He,className:"text-[10px] text-kairos-400 font-medium",children:["Saldo: ",he(a.balance||"0")," â€” MAX"]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("input",{type:"number",value:i,onChange:t=>C(t.target.value),placeholder:"0.0",className:"flex-1 bg-transparent text-2xl font-bold text-white placeholder-dark-600 outline-none min-w-0",inputMode:"decimal"}),e.jsxs("button",{onClick:()=>Z("from"),className:"flex items-center gap-2 bg-white/[0.06] hover:bg-white/[0.1] rounded-xl px-3 py-2 transition-colors shrink-0",children:[a?e.jsxs(e.Fragment,{children:[e.jsx(ie,{token:a,chainId:r,size:24}),e.jsx("span",{className:"font-semibold text-sm",children:a.symbol})]}):e.jsx("span",{className:"text-sm text-dark-300",children:"Elegir"}),e.jsx(Se,{size:14,className:"text-dark-400"})]})]}),i&&parseFloat(i)>0&&a?.isNative&&ae>0&&e.jsxs("p",{className:"text-[10px] text-dark-500 mt-1 text-right",children:["â‰ˆ ",le(parseFloat(i)*ae)]}),i&&parseFloat(i)>0&&a&&!a.isNative&&a.symbol?.includes("USD")&&e.jsxs("p",{className:"text-[10px] text-dark-500 mt-1 text-right",children:["â‰ˆ ",le(parseFloat(i))]})]}),e.jsx("div",{className:"flex justify-center -my-3 relative z-10",children:e.jsx("button",{onClick:Me,className:"w-10 h-10 rounded-xl bg-dark-800 border border-white/10 flex items-center justify-center hover:bg-dark-700 active:scale-90 transition-all",children:e.jsx(pe,{size:16,className:"text-kairos-400"})})}),e.jsxs("div",{className:"bg-white/[0.03] rounded-2xl p-4 border border-white/5",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-xs text-dark-400",children:"Recibes"}),s&&e.jsxs("span",{className:"text-[10px] text-dark-500",children:["Saldo: ",he(s.balance||"0")]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"flex-1 min-w-0",children:w?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ne,{size:20,className:"text-kairos-400 animate-spin"}),e.jsx("span",{className:"text-dark-400 text-sm",children:"Cotizando..."})]}):n?e.jsx("span",{className:"text-2xl font-bold text-white",children:parseFloat(n.amountOut).toFixed(6)}):e.jsx("span",{className:"text-2xl font-bold text-dark-600",children:"0.0"})}),e.jsxs("button",{onClick:()=>Z("to"),className:"flex items-center gap-2 bg-white/[0.06] hover:bg-white/[0.1] rounded-xl px-3 py-2 transition-colors shrink-0",children:[s?e.jsxs(e.Fragment,{children:[e.jsx(ie,{token:s,chainId:r,size:24}),e.jsx("span",{className:"font-semibold text-sm",children:s.symbol})]}):e.jsx("span",{className:"text-sm text-dark-300",children:"Elegir"}),e.jsx(Se,{size:14,className:"text-dark-400"})]})]}),n&&s?.isNative&&ae>0&&e.jsxs("p",{className:"text-[10px] text-dark-500 mt-1 text-right",children:["â‰ˆ ",le(parseFloat(n.amountOut)*ae)]}),n&&s&&!s.isNative&&s.symbol?.includes("USD")&&e.jsxs("p",{className:"text-[10px] text-dark-500 mt-1 text-right",children:["â‰ˆ ",le(parseFloat(n.amountOut))]})]}),e.jsx(V,{children:n&&e.jsxs(M.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},className:"overflow-hidden",children:[e.jsxs("div",{className:"mt-4 bg-white/[0.02] rounded-xl p-3 space-y-2 border border-white/5",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-xs text-dark-400",children:"Tasa"}),e.jsxs("span",{className:"text-xs text-dark-200",children:["1 ",a?.symbol," â‰ˆ ",n.effectivePrice.toFixed(6)," ",s?.symbol]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"text-xs text-dark-400 flex items-center gap-1",children:["Impacto",parseFloat(n.priceImpact)>3&&e.jsx(q,{size:10,className:"text-orange-400"})]}),e.jsxs("span",{className:`text-xs font-medium ${We(n.priceImpact)}`,children:[n.priceImpact,"%"]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-xs text-dark-400",children:"MÃ­nimo recibido"}),e.jsxs("span",{className:"text-xs text-dark-200",children:[(parseFloat(n.amountOut)*(1-b/100)).toFixed(6)," ",s?.symbol]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-xs text-dark-400",children:"Slippage"}),e.jsxs("button",{onClick:()=>j(!0),className:"text-xs text-kairos-400",children:[b,"%"]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-xs text-dark-400",children:"Ruta"}),e.jsx("span",{className:"text-xs text-dark-300",children:n.route.map((t,l)=>e.jsxs("span",{children:[t.length>10?t.slice(0,6)+"...":t,l<n.route.length-1?" â†’ ":""]},l))})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-xs text-dark-400",children:"DEX"}),e.jsxs("span",{className:"text-xs text-dark-200 flex items-center gap-1",children:[e.jsx(ue,{size:10,className:"text-kairos-400"}),n.dex]})]})]}),$.length>1&&e.jsxs("div",{className:"mt-3 bg-white/[0.02] rounded-xl p-3 border border-white/5",children:[e.jsxs("div",{className:"flex items-center gap-1 mb-2",children:[e.jsx(ue,{size:10,className:"text-kairos-400"}),e.jsx("span",{className:"text-[10px] text-kairos-400 font-bold",children:"COMPARACIÃ“N MULTI-DEX"}),$[0]?.savingsPercent&&parseFloat($[0].savingsPercent)>0&&e.jsxs("span",{className:"ml-auto text-[10px] text-green-400 font-bold",children:["Ahorro: +",$[0].savingsPercent,"%"]})]}),e.jsx("div",{className:"space-y-1.5",children:$.slice(0,4).map((t,l)=>e.jsxs("div",{className:`flex items-center justify-between py-1.5 px-2 rounded-lg text-xs ${t.isBest?"bg-green-500/10 border border-green-500/20":"bg-dark-800/30"}`,children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"w-2 h-2 rounded-full",style:{backgroundColor:t.dexColor||"#666"}}),e.jsx("span",{className:t.isBest?"text-green-400 font-semibold":"text-dark-300",children:t.dex}),t.isBest&&e.jsx("span",{className:"text-[9px] bg-green-500/20 text-green-400 px-1 rounded",children:"MEJOR"})]}),e.jsx("span",{className:t.isBest?"text-green-400 font-bold":"text-dark-400",children:parseFloat(t.amountOut).toFixed(6)})]},l))})]})]})}),h&&e.jsxs("div",{className:"mt-3 flex items-center gap-2 px-3 py-2 rounded-xl bg-red-500/10 border border-red-500/20",children:[e.jsx(q,{size:14,className:"text-red-400 shrink-0"}),e.jsx("span",{className:"text-xs text-red-300",children:h})]}),n&&se>0&&e.jsxs("div",{className:"mt-2 flex items-center justify-between px-1",children:[e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx("div",{className:`w-1.5 h-1.5 rounded-full ${se<10?"bg-green-400":se<20?"bg-yellow-400":"bg-red-400"}`}),e.jsxs("span",{className:"text-[10px] text-dark-500",children:["CotizaciÃ³n: ",se,"s"]})]}),e.jsxs("button",{onClick:xe,className:"flex items-center gap-1 text-[10px] text-kairos-400 hover:text-kairos-300",children:[e.jsx(Ke,{size:10})," Actualizar"]})]}),n&&parseFloat(n.priceImpact)>5&&e.jsxs("div",{className:"mt-3 flex items-center gap-2 px-3 py-2 rounded-xl bg-orange-500/10 border border-orange-500/20",children:[e.jsx(q,{size:14,className:"text-orange-400 shrink-0"}),e.jsxs("span",{className:"text-xs text-orange-300",children:["Alto impacto de precio (",n.priceImpact,"%). PodrÃ­as perder valor significativo."]})]})]}),e.jsx("div",{className:"px-5 pb-6 pt-3",children:e.jsx("button",{onClick:_e,disabled:!me,className:`w-full py-4 rounded-2xl font-bold text-sm flex items-center justify-center gap-2 transition-all active:scale-[0.98] ${me?"bg-gradient-to-r from-kairos-500 to-kairos-400 text-dark-950 shadow-lg shadow-kairos-500/20":"bg-white/[0.06] text-dark-500 cursor-not-allowed"}`,children:w?e.jsxs(e.Fragment,{children:[e.jsx(ne,{size:16,className:"animate-spin"}),"Cotizando..."]}):!a||!s?"Selecciona los tokens":!i||parseFloat(i)<=0?"Ingresa un monto":h||(me?e.jsxs(e.Fragment,{children:[e.jsx(pe,{size:16}),"Swap ",a.symbol," â†’ ",s.symbol]}):"Swap")})}),e.jsx(V,{children:L&&e.jsxs(M.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"absolute inset-0 z-50 bg-dark-950/95 backdrop-blur-xl",children:[e.jsxs("div",{className:"flex items-center justify-between px-5 py-4",children:[e.jsx("h2",{className:"font-bold text-white",children:L==="from"?"Token a vender":"Token a recibir"}),e.jsx("button",{onClick:()=>{Z(null),W("")},className:"p-2 rounded-xl hover:bg-white/5",children:e.jsx(oe,{size:20,className:"text-dark-300"})})]}),e.jsx("div",{className:"px-5 mb-3",children:e.jsxs("div",{className:"relative",children:[e.jsx($e,{size:16,className:"absolute left-3 top-1/2 -translate-y-1/2 text-dark-500 pointer-events-none"}),e.jsx("input",{type:"text",value:ce,onChange:t=>W(t.target.value),placeholder:"Buscar por nombre, sÃ­mbolo o direcciÃ³n",className:"w-full bg-white/[0.04] rounded-xl pl-10 pr-4 py-3 text-sm text-white placeholder-dark-500 outline-none border border-white/5 focus:border-kairos-500/50",style:{color:"#ffffff",WebkitTextFillColor:"#ffffff"},autoFocus:!0})]})}),e.jsxs("div",{className:"px-5 overflow-y-auto",style:{maxHeight:"calc(100vh - 160px)"},children:[!ce&&e.jsx("div",{className:"flex flex-wrap gap-1.5 mb-3",children:U.filter(t=>t.isNative||t.hasBalance).slice(0,6).map(t=>e.jsxs("button",{onClick:()=>{re(t),W("")},className:"flex items-center gap-1.5 px-3 py-1.5 rounded-full bg-white/[0.04] border border-white/5 hover:bg-white/[0.08] transition-all",children:[e.jsx(ie,{token:t,chainId:r,size:18}),e.jsx("span",{className:"text-xs font-medium text-white",children:t.symbol})]},t.id))}),(()=>{const t=ce.toLowerCase().trim(),l=t?U.filter(o=>o.symbol?.toLowerCase().includes(t)||o.name?.toLowerCase().includes(t)||o.address?.toLowerCase().includes(t)):U,z=t.startsWith("0x")&&t.length===42,P=l.length>0;return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-0.5",children:[l.filter(o=>o.isNative||parseFloat(o.balance||0)>0).length>0&&e.jsx("p",{className:"text-[10px] text-dark-500 uppercase tracking-wider px-1 py-1 mt-1",children:"Con saldo"}),l.filter(o=>o.isNative||parseFloat(o.balance||0)>0).map(o=>{const T=L==="from"&&a?.id===o.id||L==="to"&&s?.id===o.id;return e.jsxs("button",{onClick:()=>{re(o),W("")},className:`w-full flex items-center gap-3 p-3 rounded-xl transition-colors ${T?"bg-kairos-500/10 border border-kairos-500/30":"hover:bg-white/[0.04] border border-transparent"}`,children:[e.jsx(ie,{token:o,chainId:r,size:36}),e.jsxs("div",{className:"flex-1 text-left",children:[e.jsx("div",{className:"font-semibold text-sm text-white",children:o.symbol}),e.jsx("div",{className:"text-xs text-dark-400",children:o.name})]}),e.jsx("div",{className:"text-right",children:e.jsx("div",{className:"text-sm font-medium text-dark-200",children:he(o.balance||"0")})}),T&&e.jsx(Fe,{size:16,className:"text-kairos-400 shrink-0"})]},o.id)}),l.filter(o=>!o.isNative&&parseFloat(o.balance||0)<=0).length>0&&e.jsx("p",{className:"text-[10px] text-dark-500 uppercase tracking-wider px-1 py-1 mt-3",children:"Populares"}),l.filter(o=>!o.isNative&&parseFloat(o.balance||0)<=0).map(o=>e.jsxs("button",{onClick:()=>{re(o),W("")},className:"w-full flex items-center gap-3 p-3 rounded-xl hover:bg-white/[0.04] border border-transparent transition-colors",children:[e.jsx("div",{className:"w-9 h-9 rounded-full bg-white/5 flex items-center justify-center text-lg",children:o.icon||"ðŸª™"}),e.jsxs("div",{className:"flex-1 text-left",children:[e.jsx("div",{className:"font-semibold text-sm text-dark-300",children:o.symbol}),e.jsx("div",{className:"text-xs text-dark-500",children:o.name})]})]},o.id))]}),z&&!P&&e.jsxs("button",{onClick:async()=>{ye(!0);try{const o=await it(r,t),T=[...Pe,o];Ue(T),localStorage.setItem("kairos_custom_tokens",JSON.stringify(T)),re(o),W(""),p(`${o.symbol} importado`,"success")}catch(o){p("Token no encontrado: "+o.message,"error")}ye(!1)},disabled:de,className:"w-full flex items-center gap-3 p-4 rounded-xl bg-kairos-500/10 border border-kairos-500/30 mt-3",children:[de?e.jsx(ne,{size:20,className:"text-kairos-400 animate-spin"}):e.jsx(Je,{size:20,className:"text-kairos-400"}),e.jsxs("div",{className:"flex-1 text-left",children:[e.jsx("p",{className:"text-sm font-medium text-kairos-400",children:de?"Importando...":"Importar Token"}),e.jsx("p",{className:"text-[10px] text-dark-400 truncate",children:t})]})]}),!z&&!P&&t&&e.jsxs("div",{className:"text-center py-8 text-dark-500 text-sm",children:['No se encontraron tokens para "',t,'"']})]})})()]})]})}),e.jsx(V,{children:A&&e.jsxs(M.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"absolute inset-0 z-50 bg-dark-950/95 backdrop-blur-xl flex flex-col",children:[e.jsxs("div",{className:"flex items-center justify-between px-5 py-4",children:[e.jsx("h2",{className:"font-bold text-white",children:"ConfiguraciÃ³n de Slippage"}),e.jsx("button",{onClick:()=>j(!1),className:"p-2 rounded-xl hover:bg-white/5",children:e.jsx(oe,{size:20,className:"text-dark-300"})})]}),e.jsxs("div",{className:"px-5",children:[e.jsx("p",{className:"text-xs text-dark-400 mb-4",children:"El slippage es la diferencia mÃ¡xima aceptable entre el precio esperado y el precio real de ejecuciÃ³n."}),e.jsx("div",{className:"grid grid-cols-3 gap-2 mb-4",children:[.1,.5,1].map(t=>e.jsxs("button",{onClick:()=>{R(t),B("")},className:`py-3 rounded-xl text-sm font-medium transition-all ${b===t&&!D?"bg-kairos-500/20 text-kairos-400 border border-kairos-500/30":"bg-white/[0.04] text-dark-300 border border-transparent hover:bg-white/[0.08]"}`,children:[t,"%"]},t))}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"number",value:D,onChange:t=>{B(t.target.value);const l=parseFloat(t.target.value);l>0&&l<=50&&R(l)},placeholder:"Personalizado",className:"w-full bg-white/[0.04] rounded-xl px-4 py-3 text-sm text-white placeholder-dark-500 outline-none border border-white/5 focus:border-kairos-500/50",inputMode:"decimal"}),e.jsx("span",{className:"absolute right-4 top-1/2 -translate-y-1/2 text-dark-400 text-sm",children:"%"})]}),b>5&&e.jsxs("div",{className:"mt-3 flex items-center gap-2 px-3 py-2 rounded-xl bg-orange-500/10 border border-orange-500/20",children:[e.jsx(q,{size:14,className:"text-orange-400 shrink-0"}),e.jsx("span",{className:"text-xs text-orange-300",children:"Slippage alto. Tu transacciÃ³n podrÃ­a ser frontrunned."})]}),e.jsx("button",{onClick:()=>j(!1),className:"w-full mt-6 py-3 rounded-xl bg-kairos-500 text-dark-950 font-bold text-sm",children:"Guardar"})]})]})}),e.jsx(V,{children:O!=="idle"&&e.jsx(M.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"absolute inset-0 z-50 bg-dark-950/95 backdrop-blur-xl flex items-center justify-center px-5",children:e.jsxs(M.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},className:"w-full max-w-sm bg-dark-800 rounded-2xl p-6 border border-white/10",children:[["password","error","success"].includes(O)&&e.jsx("div",{className:"flex justify-end mb-2",children:e.jsx("button",{onClick:()=>{I("idle"),_(""),te("")},className:"p-1 rounded-lg hover:bg-white/5",children:e.jsx(oe,{size:16,className:"text-dark-400"})})}),O==="password"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"text-center mb-5",children:[e.jsx("div",{className:"w-14 h-14 rounded-2xl bg-kairos-500/10 flex items-center justify-center mx-auto mb-3",children:e.jsx(pe,{size:24,className:"text-kairos-400"})}),e.jsx("h3",{className:"font-bold text-white text-lg",children:"Confirmar Swap"}),e.jsxs("p",{className:"text-xs text-dark-400 mt-1",children:[parseFloat(i).toFixed(6)," ",a?.symbol," â†’ ",parseFloat(n?.amountOut||0).toFixed(6)," ",s?.symbol]})]}),e.jsx("input",{type:"password",value:K,onChange:t=>{_(t.target.value),ee("")},onKeyDown:t=>t.key==="Enter"&&K&&ve(),placeholder:"ContraseÃ±a de la wallet",className:"w-full bg-white/[0.04] rounded-xl px-4 py-3 text-sm text-white placeholder-dark-500 outline-none border border-white/5 focus:border-kairos-500/50 mb-2",autoFocus:!0}),be&&e.jsx("p",{className:"text-red-400 text-xs mb-2",children:be}),e.jsx("button",{onClick:ve,disabled:!K,className:`w-full py-3 rounded-xl font-bold text-sm mt-2 transition-all ${K?"bg-gradient-to-r from-kairos-500 to-kairos-400 text-dark-950":"bg-white/[0.06] text-dark-500 cursor-not-allowed"}`,children:"Confirmar Swap"})]}),(O==="approving"||O==="swapping")&&e.jsxs("div",{className:"text-center py-4",children:[e.jsx(M.div,{animate:{rotate:360},transition:{duration:2,repeat:1/0,ease:"linear"},className:"w-16 h-16 rounded-full bg-kairos-500/10 flex items-center justify-center mx-auto mb-4",children:e.jsx(ne,{size:28,className:"text-kairos-400"})}),e.jsx("h3",{className:"font-bold text-white text-lg",children:O==="approving"?"Aprobando token...":"Ejecutando swap..."}),e.jsx("p",{className:"text-xs text-dark-400 mt-2",children:O==="approving"?"Autorizando al router para usar tus tokens":`Intercambiando en ${x}`}),e.jsx("p",{className:"text-[10px] text-dark-500 mt-4",children:"No cierres esta ventana"})]}),O==="success"&&e.jsxs("div",{className:"text-center py-2",children:[e.jsx("div",{className:"w-16 h-16 rounded-full bg-green-500/10 flex items-center justify-center mx-auto mb-4",children:e.jsx(Fe,{size:28,className:"text-green-400"})}),e.jsx("h3",{className:"font-bold text-white text-lg",children:"Â¡Swap exitoso!"}),e.jsxs("p",{className:"text-xs text-dark-400 mt-2 mb-4",children:[parseFloat(i).toFixed(6)," ",a?.symbol," â†’ ",parseFloat(n?.amountOut||0).toFixed(6)," ",s?.symbol]}),we&&e.jsx("a",{href:`${k.blockExplorerUrl}/tx/${we}`,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-1 text-xs text-kairos-400 mb-4",children:"Ver en explorador â†—"}),e.jsx("button",{onClick:()=>{I("idle"),C(""),N(null)},className:"w-full py-3 rounded-xl bg-kairos-500 text-dark-950 font-bold text-sm",children:"Listo"})]}),O==="error"&&e.jsxs("div",{className:"text-center py-2",children:[e.jsx("div",{className:"w-16 h-16 rounded-full bg-red-500/10 flex items-center justify-center mx-auto mb-4",children:e.jsx(q,{size:28,className:"text-red-400"})}),e.jsx("h3",{className:"font-bold text-white text-lg",children:"Error en el swap"}),e.jsx("p",{className:"text-xs text-red-300 mt-2 mb-4 break-words max-h-24 overflow-y-auto",children:ze}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>{I("idle"),te("")},className:"flex-1 py-3 rounded-xl bg-white/[0.06] text-dark-300 font-medium text-sm",children:"Cancelar"}),e.jsx("button",{onClick:()=>{I("password"),te(""),_("")},className:"flex-1 py-3 rounded-xl bg-kairos-500 text-dark-950 font-bold text-sm",children:"Reintentar"})]})]})]})})}),e.jsx(V,{children:Re&&e.jsxs(M.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"absolute inset-0 z-50 bg-dark-950/95 backdrop-blur-xl",children:[e.jsxs("div",{className:"flex items-center justify-between px-5 py-4",children:[e.jsx("h2",{className:"font-bold text-white",children:"Historial de Swaps"}),e.jsx("button",{onClick:()=>ke(!1),className:"p-2 rounded-xl hover:bg-white/5",children:e.jsx(oe,{size:20,className:"text-dark-300"})})]}),e.jsx("div",{className:"px-5 overflow-y-auto",style:{maxHeight:"calc(100vh - 80px)"},children:(()=>{const t=Oe();return t.length===0?e.jsxs("div",{className:"text-center py-16",children:[e.jsx(Ce,{size:32,className:"text-dark-600 mx-auto mb-3"}),e.jsx("p",{className:"text-dark-400 text-sm",children:"Sin swaps recientes"}),e.jsx("p",{className:"text-dark-500 text-xs mt-1",children:"Tu historial aparecerÃ¡ aquÃ­"})]}):e.jsx("div",{className:"space-y-2",children:t.map((l,z)=>{const P=X[l.chainId];return e.jsxs("div",{className:"bg-white/[0.03] rounded-xl p-3 border border-white/5",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ve,{size:14,className:"text-kairos-400"}),e.jsxs("span",{className:"text-sm font-semibold text-white",children:[l.fromSymbol," â†’ ",l.toSymbol]})]}),e.jsx("span",{className:"text-[10px] text-dark-500",children:new Date(l.timestamp).toLocaleDateString("es",{day:"2-digit",month:"short",hour:"2-digit",minute:"2-digit"})})]}),e.jsxs("div",{className:"flex items-center justify-between mt-1.5",children:[e.jsxs("span",{className:"text-xs text-dark-400",children:[parseFloat(l.amountIn).toFixed(4)," ",l.fromSymbol," â†’ ",parseFloat(l.amountOut).toFixed(4)," ",l.toSymbol]}),e.jsx("span",{className:"text-[10px] text-dark-500",children:l.dex})]}),l.hash&&P&&e.jsxs("a",{href:`${P.blockExplorerUrl}/tx/${l.hash}`,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-1 text-[10px] text-kairos-400 mt-1.5",children:[e.jsx(qe,{size:10})," Ver transacciÃ³n"]})]},z)})})})()})]})})]})}export{jt as default};
