import{d as u,j as e,e as C,aH as k,b as w,m as j,aj as R,T as P,aI as A}from"./ui-Bym_0wSS.js";import{u as z,U as p,C as N}from"./index-cz92uTWo.js";import{JsonRpcProvider as S}from"./crypto-1JBTrmrY.js";import"./vendor-CCYniLZC.js";async function H(d,c){const x=performance.now();try{const l=new S(d,c,{staticNetwork:!0,batchMaxCount:1}),o=await Promise.race([l.getBlockNumber(),new Promise((g,m)=>setTimeout(()=>m("timeout"),5e3))]),f=Math.round(performance.now()-x);return{url:d,status:"ok",latency:f,blockNumber:o,error:null}}catch(l){const o=Math.round(performance.now()-x);return{url:d,status:"error",latency:o,blockNumber:0,error:l.message||"Timeout"}}}function T(){const{goBack:d}=z(),[c,x]=u.useState({}),[l,o]=u.useState(!1),[f,g]=u.useState(null),m=async()=>{o(!0);const s={};for(const t of p){const a=N[t],n=a.rpcUrls||[a.rpcUrl],i=await Promise.all(n.map(h=>H(h,t)));s[t]=i}x(s),o(!1)};u.useEffect(()=>{m()},[]);const b=s=>{const t=c[s];if(!t)return"unknown";const a=t.filter(n=>n.status==="ok");return a.length===t.length?"healthy":a.length>0?"degraded":"down"},v=s=>{const t=c[s]?.filter(a=>a.status==="ok");return t?.length?Math.round(t.reduce((a,n)=>a+n.latency,0)/t.length):0};return e.jsxs("div",{className:"screen-container",children:[e.jsxs("div",{className:"flex items-center gap-3 p-4 border-b border-dark-800",children:[e.jsx("button",{onClick:d,className:"text-dark-300 hover:text-white",children:e.jsx(C,{size:20})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(k,{className:"text-kairos-400",size:20}),e.jsx("h1",{className:"text-lg font-bold text-white",children:"RPC Health"})]}),e.jsx("button",{onClick:m,disabled:l,className:"ml-auto text-dark-400 hover:text-white",children:e.jsx(w,{size:16,className:l?"animate-spin":""})})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-3",children:[l&&Object.keys(c).length===0&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx(j.div,{animate:{rotate:360},transition:{repeat:1/0,duration:1.5,ease:"linear"},children:e.jsx(k,{className:"mx-auto text-kairos-400",size:32})}),e.jsx("p",{className:"text-dark-400 text-sm mt-3",children:"Verificando RPCs..."})]}),p.map(s=>{const t=N[s],a=b(s),n=v(s),i=c[s]||[],h=f===s;return e.jsxs(j.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},children:[e.jsx("button",{onClick:()=>g(h?null:s),className:"w-full bg-dark-800/50 rounded-xl p-3 border border-dark-700/50 text-left",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg flex items-center justify-center text-lg",style:{backgroundColor:t.color+"15"},children:t.icon}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("p",{className:"text-white text-sm font-semibold",children:t.shortName}),a==="healthy"&&e.jsx(R,{size:12,className:"text-green-400"}),a==="degraded"&&e.jsx(P,{size:12,className:"text-amber-400"}),a==="down"&&e.jsx(A,{size:12,className:"text-red-400"})]}),e.jsxs("p",{className:"text-dark-500 text-xs",children:[i.length," RPCs Â· ",i.filter(r=>r.status==="ok").length," activos"]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:`text-sm font-bold ${n<500?"text-green-400":n<1500?"text-amber-400":"text-red-400"}`,children:n>0?`${n}ms`:"â€”"}),e.jsx("p",{className:"text-dark-500 text-[10px]",children:"latencia"})]})]})}),h&&i.length>0&&e.jsx("div",{className:"ml-4 mt-1 space-y-1",children:i.map((r,y)=>e.jsxs("div",{className:`flex items-center gap-2 p-2 rounded-lg text-xs border ${r.status==="ok"?"bg-green-500/5 border-green-500/10":"bg-red-500/5 border-red-500/10"}`,children:[e.jsx("div",{className:`w-2 h-2 rounded-full ${r.status==="ok"?"bg-green-400":"bg-red-400"}`}),e.jsxs("span",{className:"text-dark-300 font-mono truncate flex-1",title:r.url,children:[r.url.replace("https://","").slice(0,35),"..."]}),e.jsx("span",{className:`font-bold ${r.status==="ok"?"text-green-400":"text-red-400"}`,children:r.status==="ok"?`${r.latency}ms`:"FAIL"}),r.blockNumber>0&&e.jsxs("span",{className:"text-dark-500",children:["#",r.blockNumber.toLocaleString()]})]},y))})]},s)}),e.jsx("div",{className:"bg-dark-800/30 rounded-xl p-3 border border-dark-700/30 mt-4",children:e.jsx("p",{className:"text-dark-500 text-xs text-center",children:"ðŸ’¡ FallbackProvider cambia automÃ¡ticamente al siguiente RPC si uno falla. Verde = <500ms Â· Amarillo = <1500ms Â· Rojo = lento o caÃ­do."})})]})]})}export{T as default};
