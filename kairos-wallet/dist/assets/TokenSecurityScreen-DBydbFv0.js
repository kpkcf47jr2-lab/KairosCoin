import{d as g,j as e,e as v,S as y,m as k,Z as S,a1 as z,T as w,w as T,f as E,az as $,aj as A}from"./ui-Bym_0wSS.js";import{u as C,C as O,E as I,F}from"./index-DCca9e1h.js";import{getAddress as L,Contract as R,ZeroAddress as j,formatUnits as h}from"./crypto-1JBTrmrY.js";import"./vendor-CCYniLZC.js";const B=[...F,"function owner() view returns (address)","function getOwner() view returns (address)","function totalSupply() view returns (uint256)","function maxTransactionAmount() view returns (uint256)","function maxWalletAmount() view returns (uint256)","function tradingEnabled() view returns (bool)"];async function P(f,p){const u=I(f),r=new R(p,B,u),a=[];let t=100,x="?",d="?",c=18,i=0n;try{[x,d,c,i]=await Promise.all([r.name(),r.symbol(),r.decimals(),r.totalSupply()]),a.push({label:"Token v√°lido",status:"pass",detail:`${x} (${d})`})}catch{return a.push({label:"Token v√°lido",status:"fail",detail:"No se pudo leer contrato"}),{score:0,checks:a,name:"?",symbol:"?",risk:"critical"}}try{const n=await u.getCode(p);n==="0x"?(a.push({label:"Smart Contract",status:"fail",detail:"No es un contrato (EOA)"}),t-=50):n.length>100&&a.push({label:"Smart Contract",status:"pass",detail:`C√≥digo: ${n.length} bytes`})}catch{}let o=null;try{o=await r.owner(),o===j?(a.push({label:"Propiedad renunciada",status:"pass",detail:"Owner = 0x0 (bueno)"}),t+=5):(a.push({label:"Tiene due√±o",status:"warn",detail:`Owner: ${o.slice(0,10)}...`}),t-=10)}catch{try{o=await r.getOwner(),a.push({label:"Tiene due√±o",status:"warn",detail:`Owner: ${o.slice(0,10)}...`}),t-=10}catch{a.push({label:"Sin funci√≥n owner()",status:"info",detail:"No se puede verificar"})}}if(i>0n){const n=h(i,c),l=parseFloat(n);l>1e15?(a.push({label:"Supply extremo",status:"warn",detail:`${l.toExponential(2)} tokens`}),t-=15):a.push({label:"Supply razonable",status:"pass",detail:`${l.toLocaleString()} tokens`})}try{const n=await r.maxTransactionAmount(),l=parseFloat(h(n,c)),b=parseFloat(h(i,c)),s=l/b*100;s<1?(a.push({label:"L√≠mite de TX muy bajo",status:"fail",detail:`${s.toFixed(2)}% del supply. Posible honeypot.`}),t-=30):s<5&&(a.push({label:"L√≠mite de TX",status:"warn",detail:`${s.toFixed(2)}% del supply`}),t-=10)}catch{}if(o&&o!==j)try{const n=await r.balanceOf(o),l=i>0n?Number(n*10000n/i)/100:0;l>50?(a.push({label:"Owner concentra tokens",status:"fail",detail:`${l.toFixed(1)}% del supply`}),t-=25):l>20?(a.push({label:"Owner tiene muchos tokens",status:"warn",detail:`${l.toFixed(1)}% del supply`}),t-=10):a.push({label:"Distribuci√≥n del owner",status:"pass",detail:`${l.toFixed(1)}% del supply`})}catch{}try{const n=await u.getBlockNumber();a.push({label:"Bloque actual",status:"info",detail:`#${n.toLocaleString()}`})}catch{}t=Math.max(0,Math.min(100,t));let m="low";return t<30?m="critical":t<50?m="high":t<70&&(m="medium"),{score:t,checks:a,name:x,symbol:d,decimals:c,totalSupply:h(i,c),risk:m}}function U(){const{goBack:f,activeChainId:p,showToast:u}=C(),[r,a]=g.useState(""),[t,x]=g.useState(null),[d,c]=g.useState(!1),i=O[p],o=async()=>{if(r){try{L(r)}catch{u("Direcci√≥n inv√°lida","error");return}c(!0),x(null);try{const s=await P(p,r);x(s)}catch(s){u("Error al analizar: "+s.message,"error")}finally{c(!1)}}},m=s=>s>=70?"text-green-400":s>=50?"text-yellow-400":s>=30?"text-orange-400":"text-red-400",n=s=>s>=70?"from-green-500/20 to-green-500/5":s>=50?"from-yellow-500/20 to-yellow-500/5":s>=30?"from-orange-500/20 to-orange-500/5":"from-red-500/20 to-red-500/5",l=s=>{switch(s){case"low":return{text:"BAJO RIESGO",color:"text-green-400",bg:"bg-green-500/20"};case"medium":return{text:"RIESGO MEDIO",color:"text-yellow-400",bg:"bg-yellow-500/20"};case"high":return{text:"ALTO RIESGO",color:"text-orange-400",bg:"bg-orange-500/20"};case"critical":return{text:"‚ö†Ô∏è PELIGROSO",color:"text-red-400",bg:"bg-red-500/20"};default:return{text:"?",color:"text-dark-400",bg:"bg-dark-800"}}},b=s=>{switch(s){case"pass":return e.jsx(A,{className:"text-green-400 flex-shrink-0",size:14});case"warn":return e.jsx(w,{className:"text-yellow-400 flex-shrink-0",size:14});case"fail":return e.jsx($,{className:"text-red-400 flex-shrink-0",size:14});default:return e.jsx(E,{className:"text-dark-400 flex-shrink-0",size:14})}};return e.jsxs("div",{className:"screen-container",children:[e.jsxs("div",{className:"flex items-center gap-3 p-4 border-b border-dark-800",children:[e.jsx("button",{onClick:f,className:"text-dark-300 hover:text-white",children:e.jsx(v,{size:20})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(y,{className:"text-kairos-400",size:20}),e.jsx("h1",{className:"text-lg font-bold text-white",children:"Auditor√≠a de Token"})]})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"text",value:r,onChange:s=>a(s.target.value),onKeyDown:s=>s.key==="Enter"&&o(),placeholder:"Pega la direcci√≥n del contrato...",className:"w-full bg-dark-800 border border-dark-700 rounded-xl px-4 py-3 pr-12 text-white placeholder-dark-500 focus:border-kairos-500 focus:outline-none text-sm font-mono"}),e.jsx("button",{onClick:o,disabled:d||!r,className:"absolute right-2 top-1/2 -translate-y-1/2 p-2 bg-kairos-500 rounded-lg text-dark-950 disabled:opacity-50",children:d?e.jsx(k.div,{animate:{rotate:360},transition:{repeat:1/0,duration:1},children:e.jsx(S,{size:16})}):e.jsx(z,{size:16})})]}),e.jsxs("p",{className:"text-dark-500 text-xs text-center",children:["Red: ",i?.shortName," ‚Ä¢ An√°lisis on-chain en tiempo real"]}),t&&e.jsxs(k.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"space-y-4",children:[e.jsxs("div",{className:`bg-gradient-to-b ${n(t.score)} rounded-2xl p-6 border border-dark-700 text-center`,children:[e.jsx("div",{className:"inline-flex items-center justify-center w-24 h-24 rounded-full border-4 border-current mb-3",children:e.jsx("span",{className:`text-3xl font-black ${m(t.score)}`,children:t.score})}),e.jsxs("p",{className:"text-white font-bold text-lg",children:[t.name," (",t.symbol,")"]}),e.jsx("div",{className:"mt-2 inline-block",children:e.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-bold ${l(t.risk).color} ${l(t.risk).bg}`,children:l(t.risk).text})}),t.totalSupply&&e.jsxs("p",{className:"text-dark-400 text-xs mt-2",children:["Supply: ",parseFloat(t.totalSupply).toLocaleString()]})]}),e.jsx("div",{className:"bg-dark-800/50 rounded-xl border border-dark-700 divide-y divide-dark-700",children:t.checks.map((s,N)=>e.jsxs("div",{className:"flex items-start gap-3 p-3",children:[b(s.status),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-white text-sm",children:s.label}),e.jsx("p",{className:"text-dark-400 text-xs truncate",children:s.detail})]})]},N))}),t.risk==="critical"||t.risk==="high"?e.jsx("div",{className:"bg-red-500/10 border border-red-500/20 rounded-xl p-4",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(w,{className:"text-red-400 flex-shrink-0 mt-0.5",size:16}),e.jsxs("div",{children:[e.jsx("p",{className:"text-red-400 font-semibold text-sm",children:"Precauci√≥n"}),e.jsx("p",{className:"text-dark-300 text-xs mt-1",children:"Este token muestra se√±ales de riesgo. Investiga m√°s antes de invertir. Ning√∫n an√°lisis automatizado reemplaza tu propia investigaci√≥n (DYOR)."})]})]})}):null,e.jsxs("a",{href:`${i?.blockExplorerUrl}/token/${r}`,target:"_blank",rel:"noopener noreferrer",className:"flex items-center justify-center gap-2 py-3 rounded-xl bg-dark-800 border border-dark-700 text-kairos-400 text-sm font-semibold",children:[e.jsx(T,{size:14})," Ver contrato en ",i?.shortName]})]}),!t&&!d&&e.jsxs("div",{className:"mt-8 text-center space-y-4",children:[e.jsx(y,{className:"mx-auto text-dark-600",size:48}),e.jsxs("div",{children:[e.jsx("p",{className:"text-dark-300 text-sm font-semibold",children:"Analiza cualquier token"}),e.jsx("p",{className:"text-dark-500 text-xs mt-1",children:"Verificamos el contrato on-chain: propiedad, supply, l√≠mites de TX, concentraci√≥n de holders y m√°s."})]}),e.jsxs("div",{className:"text-left bg-dark-800/30 rounded-xl p-4 space-y-2",children:[e.jsx("p",{className:"text-dark-300 text-xs font-semibold",children:"üîç ¬øQu√© verificamos?"}),e.jsxs("ul",{className:"text-dark-500 text-xs space-y-1",children:[e.jsx("li",{children:"‚Ä¢ Validez del contrato y c√≥digo"}),e.jsx("li",{children:"‚Ä¢ Si el owner renunci√≥ la propiedad"}),e.jsx("li",{children:"‚Ä¢ Supply total y distribuci√≥n"}),e.jsx("li",{children:"‚Ä¢ L√≠mites de transacci√≥n (honeypot check)"}),e.jsx("li",{children:"‚Ä¢ Concentraci√≥n de tokens del owner"})]})]})]})]})]})}export{U as default};
