import{a as c,B,al as k,a1 as W,f as $,am as S,e as K,j as e,w as g,ac as M,an as V,m as Q,Z as C,Q as O,V as U}from"./ui-C9JhL7YV.js";import{u as A,c as z}from"./index-Bwyd3ZIE.js";import{a as T}from"./ai-BdxcZUDQ.js";import"./vendor-09nSF2_j.js";import"./marketData-K1zKCjjj.js";import"./indicators-DJQYQkcq.js";import"./kairosScript-CBe04qQ3.js";function X(){const{aiMessages:h,addAiMessage:d,aiLoading:x,setAiLoading:b,clearAiMessages:E,currentPrice:n,selectedPair:o,priceChange24h:j,setSelectedPair:f,setPage:v}=A(),[m,N]=c.useState(""),[I,p]=c.useState(null),y=c.useRef(null);c.useEffect(()=>{var t;(t=y.current)==null||t.scrollIntoView({behavior:"smooth"})},[h]);const u=c.useCallback(async t=>{var s;const a=t||m.trim();if(!(!a||x)){d({role:"user",content:a,time:new Date().toLocaleTimeString()}),t||N(""),b(!0);try{const i=n?{symbol:o,price:n,changePercent:j,high:n*1.02,low:n*.98,volume:0,quoteVolume:0}:null,r=await T.chat(a,i);((s=r.action)==null?void 0:s.type)==="changePair"&&f(r.action.pair),d({role:"assistant",content:r.text,strategy:r.strategy,kairosScript:r.kairosScript,action:r.action,time:new Date().toLocaleTimeString()})}catch(i){d({role:"assistant",content:`❌ Error: ${i.message}`,time:new Date().toLocaleTimeString()})}b(!1)}},[m,x,n,o,j]),D=(t,a)=>{navigator.clipboard.writeText(t),p(a),setTimeout(()=>p(null),2e3)},L=[{label:`Analiza ${z(o)}`,icon:B,prompt:`Analiza ${o}`},{label:"Crea un Script Bot",icon:k,prompt:`Crea un kairos script ganador para ${o}`},{label:"Estrategia ganadora",icon:W,prompt:`Dame una estrategia para ${z(o)} según el mercado`},{label:"¿Qué es el RSI?",icon:$,prompt:"¿Qué es el RSI y cómo se usa?"},{label:"Muéstrame SOLUSDT",icon:S,prompt:"Muéstrame SOLUSDT"},{label:"Ayuda",icon:K,prompt:"¿Qué puedes hacer?"}],P=t=>t.split(`
`).map((a,s)=>{const r=a.split(/(\*\*.*?\*\*)/g).map((l,w)=>l.startsWith("**")&&l.endsWith("**")?e.jsx("strong",{children:l.slice(2,-2)},w):l.startsWith("_")&&l.endsWith("_")?e.jsx("em",{className:"text-[var(--text-dim)]",children:l.slice(1,-1)},w):l);return a.startsWith("━━")||a.startsWith("──")?e.jsx("div",{className:"border-t border-[var(--border)] my-1.5 pt-1",children:r},s):a.startsWith("•")||a.startsWith("- ")?e.jsx("p",{className:"ml-2 my-0.5",children:r},s):a===""?e.jsx("div",{className:"h-1"},s):e.jsx("p",{className:"my-0.5",children:r},s)}),R=(t,a)=>{var i;const s=t.role==="user";return e.jsx(Q.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:`flex ${s?"justify-end":"justify-start"}`,children:e.jsxs("div",{className:`max-w-[90%] rounded-2xl p-3 ${s?"bg-[var(--gold)] text-white rounded-br-md":"bg-[var(--dark-3)] text-[var(--text)] rounded-bl-md"}`,children:[!s&&e.jsxs("div",{className:"flex items-center gap-1 mb-1.5",children:[e.jsx(g,{size:12,className:"text-[var(--gold)]"}),e.jsx("span",{className:"text-[10px] text-[var(--gold)] font-bold",children:"Kairos AI"})]}),e.jsx("div",{className:"text-[13px] whitespace-pre-wrap leading-relaxed",children:P(t.content)}),((i=t.action)==null?void 0:i.type)==="changePair"&&e.jsxs("div",{className:"mt-2 flex items-center gap-2",children:[e.jsxs("div",{className:"flex items-center gap-1.5 px-2.5 py-1 bg-[var(--gold)]/10 border border-[var(--gold)]/20 rounded-lg",children:[e.jsx(S,{size:12,className:"text-[var(--gold)]"}),e.jsxs("span",{className:"text-xs text-[var(--gold)] font-semibold",children:["Gráfico: ",t.action.pair]})]}),e.jsx("button",{onClick:()=>{f(t.action.pair),v("chart")},className:"px-2 py-1 text-[11px] bg-[var(--dark-4)] text-[var(--text-dim)] hover:text-[var(--gold)] rounded-lg transition-colors",children:"Ver gráfico →"})]}),t.strategy&&e.jsxs("div",{className:"mt-2 p-2.5 bg-[var(--dark-4)] rounded-xl border border-[var(--gold)]/20",children:[e.jsxs("div",{className:"flex items-center gap-1 mb-1",children:[e.jsx(C,{size:12,className:"text-[var(--gold)]"}),e.jsx("span",{className:"text-xs font-bold text-[var(--gold)]",children:"Estrategia"})]}),e.jsx("p",{className:"text-xs mb-1",children:t.strategy.name||"Auto Strategy"}),e.jsxs("div",{className:"flex items-center gap-2 text-[10px] text-[var(--text-dim)]",children:[e.jsxs("span",{children:["SL: ",t.strategy.stopLoss]}),e.jsxs("span",{children:["TP: ",t.strategy.takeProfit]}),e.jsxs("span",{children:["R:R: ",t.strategy.riskReward]})]}),e.jsx("button",{onClick:()=>{A.getState().addStrategy(t.strategy),d({role:"assistant",content:"✅ Estrategia guardada. Actívala desde **Bots** → crear bot con esta estrategia.",time:new Date().toLocaleTimeString()})},className:"mt-1.5 px-3 py-1 bg-[var(--gold)] text-white text-xs font-bold rounded-lg hover:bg-[var(--gold-light)] transition-colors",children:"Guardar Estrategia"})]}),t.kairosScript&&e.jsxs("div",{className:"mt-2 rounded-xl overflow-hidden border border-[var(--gold)]/20",children:[e.jsxs("div",{className:"flex items-center justify-between px-3 py-1.5 bg-[var(--gold)]/10",children:[e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx(k,{size:12,className:"text-[var(--gold)]"}),e.jsx("span",{className:"text-[11px] font-bold text-[var(--gold)]",children:"Kairos Script"})]}),e.jsx("button",{onClick:()=>D(t.kairosScript,a),className:"flex items-center gap-1 px-2 py-0.5 text-[10px] bg-[var(--dark)] rounded-md text-[var(--text-dim)] hover:text-[var(--gold)] transition-colors",children:I===a?e.jsxs(e.Fragment,{children:[e.jsx(O,{size:10})," Copiado"]}):e.jsxs(e.Fragment,{children:[e.jsx(U,{size:10})," Copiar"]})})]}),e.jsx("pre",{className:"p-3 bg-[#0B0E11] text-[11px] leading-relaxed overflow-x-auto max-h-64 overflow-y-auto",children:e.jsx("code",{className:"text-[var(--text-secondary)]",children:t.kairosScript})}),e.jsxs("div",{className:"flex items-center gap-2 px-3 py-1.5 bg-[var(--dark-4)]",children:[e.jsxs("button",{onClick:()=>{navigator.clipboard.writeText(t.kairosScript),p(a),setTimeout(()=>p(null),2e3),v("bots")},className:"flex items-center gap-1 px-3 py-1 bg-[var(--gold)] text-white text-[11px] font-bold rounded-lg hover:bg-[var(--gold-light)] transition-colors",children:[e.jsx(C,{size:11})," Copiar e ir a Bots"]}),e.jsx("button",{onClick:()=>v("strategies"),className:"px-2 py-1 text-[11px] text-[var(--text-dim)] hover:text-[var(--gold)] transition-colors",children:"Ver Scripts →"})]})]}),e.jsx("p",{className:`text-[10px] mt-1.5 ${s?"text-white/60":"text-[var(--text-dim)]"}`,children:t.time})]})},a)};return e.jsxs("div",{className:"flex-1 flex flex-col h-full overflow-hidden",children:[e.jsx("div",{className:"p-4 border-b border-[var(--border)] bg-[var(--dark-2)] shrink-0",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-8 h-8 rounded-lg bg-[var(--gold)]/20 flex items-center justify-center",children:e.jsx(g,{size:18,className:"text-[var(--gold)]"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-sm font-bold",children:"Kairos AI"}),e.jsx("p",{className:"text-[10px] text-[var(--text-dim)]",children:"Experto de trading • Análisis en tiempo real"})]})]}),e.jsx("button",{onClick:()=>{E(),T.clearHistory()},className:"p-1.5 text-[var(--text-dim)] hover:text-[var(--red)] transition-colors",children:e.jsx(M,{size:14})})]})}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-3",children:[h.length===0&&e.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-center",children:[e.jsx(g,{size:48,className:"text-[var(--gold)] mb-4"}),e.jsx("h3",{className:"text-lg font-bold mb-1",children:"Kairos AI"}),e.jsx("p",{className:"text-sm text-[var(--text-dim)] mb-4 max-w-xs",children:"Experto en trading. Analizo el mercado, genero estrategias y creo código para bots automáticos."}),e.jsx("div",{className:"grid grid-cols-2 gap-2 w-full max-w-sm",children:L.map((t,a)=>{const s=t.icon;return e.jsxs("button",{onClick:()=>u(t.prompt),className:"flex items-center gap-2 p-2.5 bg-[var(--dark-3)] border border-[var(--border)] rounded-xl text-[12px] hover:border-[var(--gold)]/30 transition-colors text-left",children:[e.jsx(s,{size:14,className:"text-[var(--gold)] shrink-0"}),e.jsx("span",{className:"truncate",children:t.label})]},a)})})]}),h.map(R),x&&e.jsx("div",{className:"flex justify-start",children:e.jsxs("div",{className:"bg-[var(--dark-3)] rounded-2xl rounded-bl-md p-3",children:[e.jsxs("div",{className:"flex items-center gap-1 mb-1",children:[e.jsx(g,{size:12,className:"text-[var(--gold)]"}),e.jsx("span",{className:"text-[10px] text-[var(--gold)] font-bold",children:"Kairos AI"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:"flex gap-1",children:[e.jsx("div",{className:"w-2 h-2 rounded-full bg-[var(--gold)] animate-bounce",style:{animationDelay:"0ms"}}),e.jsx("div",{className:"w-2 h-2 rounded-full bg-[var(--gold)] animate-bounce",style:{animationDelay:"150ms"}}),e.jsx("div",{className:"w-2 h-2 rounded-full bg-[var(--gold)] animate-bounce",style:{animationDelay:"300ms"}})]}),e.jsx("span",{className:"text-[10px] text-[var(--text-dim)]",children:"Analizando mercado..."})]})]})}),e.jsx("div",{ref:y})]}),e.jsx("div",{className:"p-3 border-t border-[var(--border)] bg-[var(--dark-2)] shrink-0",children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{value:m,onChange:t=>N(t.target.value),onKeyDown:t=>t.key==="Enter"&&!t.shiftKey&&u(),placeholder:"Analiza BTC, crea un script, ¿qué es RSI?...",className:"flex-1 text-sm"}),e.jsx("button",{onClick:()=>u(),disabled:!m.trim()||x,className:"px-4 py-2 bg-[var(--gold)] text-white rounded-xl hover:bg-[var(--gold-light)] transition-colors disabled:opacity-50",children:e.jsx(V,{size:16})})]})})]})}export{X as default};
//# sourceMappingURL=AIChat-hq3PGPUK.js.map
