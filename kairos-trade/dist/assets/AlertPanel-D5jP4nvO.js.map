{"version":3,"file":"AlertPanel-D5jP4nvO.js","sources":["../../src/services/alerts.js","../../src/components/Alerts/AlertPanel.jsx"],"sourcesContent":["// Kairos Trade â€” Smart Alert System\n// Real-time price alerts + technical signal detection\n\nimport marketData from './marketData';\nimport { calculateEMA, calculateRSI, calculateMACD, detectCrossover } from './indicators';\n\nconst ALERTS_KEY = 'kairos_trade_alerts';\n\nclass AlertService {\n  constructor() {\n    this.alerts = this._load();\n    this.triggered = [];\n    this.monitoring = false;\n    this.interval = null;\n    this.callbacks = new Set();\n  }\n\n  _load() {\n    try { return JSON.parse(localStorage.getItem(ALERTS_KEY)) || []; }\n    catch { return []; }\n  }\n\n  _save() {\n    localStorage.setItem(ALERTS_KEY, JSON.stringify(this.alerts));\n  }\n\n  // â”€â”€â”€ Subscribe to alert events â”€â”€â”€\n  subscribe(callback) {\n    this.callbacks.add(callback);\n    return () => this.callbacks.delete(callback);\n  }\n\n  _notify(alert) {\n    this.callbacks.forEach(cb => cb(alert));\n\n    // Browser notification\n    if (Notification.permission === 'granted') {\n      new Notification(`Kairos Trade â€” ${alert.symbol}`, {\n        body: alert.message,\n        icon: 'data:image/svg+xml,<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 100 100\"><rect width=\"100\" height=\"100\" rx=\"20\" fill=\"%23D4AF37\"/><text x=\"50\" y=\"70\" font-size=\"60\" text-anchor=\"middle\" fill=\"%230A0A0F\" font-family=\"serif\" font-weight=\"bold\">K</text></svg>',\n      });\n    }\n  }\n\n  // â”€â”€â”€ Request notification permission â”€â”€â”€\n  async requestPermission() {\n    if (Notification.permission !== 'granted') {\n      await Notification.requestPermission();\n    }\n  }\n\n  // â”€â”€â”€ Create price alert â”€â”€â”€\n  addPriceAlert(symbol, condition, price, options = {}) {\n    const alert = {\n      id: Date.now().toString(36),\n      type: 'price',\n      symbol,\n      condition, // 'above' | 'below' | 'crosses'\n      targetPrice: parseFloat(price),\n      active: true,\n      repeat: options.repeat || false,\n      message: `${symbol} ${condition === 'above' ? '>' : '<'} $${price}`,\n      createdAt: new Date().toISOString(),\n    };\n    this.alerts.push(alert);\n    this._save();\n    this._ensureMonitoring();\n    return alert;\n  }\n\n  // â”€â”€â”€ Create technical signal alert â”€â”€â”€\n  addSignalAlert(symbol, signalType, params = {}) {\n    const descriptions = {\n      ema_cross: `EMA ${params.fast || 20}/${params.slow || 50} Cross`,\n      rsi_oversold: `RSI < ${params.threshold || 30}`,\n      rsi_overbought: `RSI > ${params.threshold || 70}`,\n      macd_cross: 'MACD Signal Cross',\n      volume_spike: `Volume Spike > ${params.multiplier || 2}x avg`,\n    };\n\n    const alert = {\n      id: Date.now().toString(36),\n      type: 'signal',\n      symbol,\n      signalType,\n      params,\n      active: true,\n      repeat: params.repeat || false,\n      message: `${symbol}: ${descriptions[signalType] || signalType}`,\n      createdAt: new Date().toISOString(),\n    };\n    this.alerts.push(alert);\n    this._save();\n    this._ensureMonitoring();\n    return alert;\n  }\n\n  // â”€â”€â”€ Remove alert â”€â”€â”€\n  removeAlert(id) {\n    this.alerts = this.alerts.filter(a => a.id !== id);\n    this._save();\n  }\n\n  // â”€â”€â”€ Get all alerts â”€â”€â”€\n  getAlerts() {\n    return this.alerts;\n  }\n\n  // â”€â”€â”€ Get triggered history â”€â”€â”€\n  getTriggered() {\n    return this.triggered;\n  }\n\n  // â”€â”€â”€ Start monitoring â”€â”€â”€\n  _ensureMonitoring() {\n    if (this.monitoring) return;\n    this.monitoring = true;\n\n    this.interval = setInterval(() => this._check(), 15000); // Check every 15s\n    this._check(); // Immediate first check\n  }\n\n  // â”€â”€â”€ Stop monitoring â”€â”€â”€\n  stop() {\n    this.monitoring = false;\n    if (this.interval) clearInterval(this.interval);\n  }\n\n  // â”€â”€â”€ Check all alerts â”€â”€â”€\n  async _check() {\n    const active = this.alerts.filter(a => a.active);\n    if (active.length === 0) return;\n\n    // Group by symbol\n    const bySymbol = {};\n    active.forEach(a => {\n      if (!bySymbol[a.symbol]) bySymbol[a.symbol] = [];\n      bySymbol[a.symbol].push(a);\n    });\n\n    for (const [symbol, alerts] of Object.entries(bySymbol)) {\n      try {\n        const price = await marketData.getPrice(symbol);\n\n        for (const alert of alerts) {\n          let triggered = false;\n\n          if (alert.type === 'price') {\n            if (alert.condition === 'above' && price >= alert.targetPrice) triggered = true;\n            if (alert.condition === 'below' && price <= alert.targetPrice) triggered = true;\n          }\n\n          if (alert.type === 'signal') {\n            triggered = await this._checkSignal(symbol, alert);\n          }\n\n          if (triggered) {\n            alert.triggeredAt = new Date().toISOString();\n            alert.triggeredPrice = price;\n            this.triggered.push({ ...alert });\n            this._notify({\n              ...alert,\n              currentPrice: price,\n              message: `ðŸ”” ${alert.message} â€” Precio actual: $${price.toLocaleString()}`,\n            });\n\n            if (!alert.repeat) {\n              alert.active = false;\n            }\n          }\n        }\n      } catch {}\n    }\n\n    this._save();\n  }\n\n  // â”€â”€â”€ Check technical signal â”€â”€â”€\n  async _checkSignal(symbol, alert) {\n    try {\n      const candles = await marketData.getCandles(symbol, '1h', 60);\n      const closes = candles.map(c => c.close);\n      const len = closes.length;\n\n      switch (alert.signalType) {\n        case 'ema_cross': {\n          const fast = calculateEMA(closes, alert.params.fast || 20);\n          const slow = calculateEMA(closes, alert.params.slow || 50);\n          const cross = detectCrossover(fast, slow, len - 1);\n          return cross !== null;\n        }\n        case 'rsi_oversold': {\n          const rsi = calculateRSI(closes, alert.params.period || 14);\n          return rsi[len - 1] < (alert.params.threshold || 30);\n        }\n        case 'rsi_overbought': {\n          const rsi = calculateRSI(closes, alert.params.period || 14);\n          return rsi[len - 1] > (alert.params.threshold || 70);\n        }\n        case 'macd_cross': {\n          const { macd, signal } = calculateMACD(closes);\n          return detectCrossover(macd, signal, len - 1) !== null;\n        }\n        case 'volume_spike': {\n          const volumes = candles.map(c => c.volume);\n          const avgVol = volumes.slice(-20).reduce((s, v) => s + v, 0) / 20;\n          return volumes[len - 1] > avgVol * (alert.params.multiplier || 2);\n        }\n        default:\n          return false;\n      }\n    } catch {\n      return false;\n    }\n  }\n}\n\nexport const alertService = new AlertService();\nexport default alertService;\n","// Kairos Trade â€” Alert Panel (Premium v2)\nimport { useState, useEffect } from 'react';\nimport { motion, AnimatePresence } from 'framer-motion';\nimport {\n  Bell, Plus, Trash2, TrendingUp, TrendingDown, Activity,\n  Zap, ChevronRight, AlertTriangle, CheckCircle, X\n} from 'lucide-react';\nimport useStore from '../../store/useStore';\nimport alertService from '../../services/alerts';\nimport { formatPair } from '../../utils/pairUtils';\n\nconst SIGNAL_TYPES = [\n  { id: 'ema_cross', label: 'EMA Cruce', desc: 'EMA 20/50 crossover', icon: Activity },\n  { id: 'rsi_oversold', label: 'RSI Sobreventa', desc: 'RSI < 30', icon: TrendingDown },\n  { id: 'rsi_overbought', label: 'RSI Sobrecompra', desc: 'RSI > 70', icon: TrendingUp },\n  { id: 'macd_cross', label: 'MACD Cruce', desc: 'MACD/Signal crossover', icon: Zap },\n  { id: 'volume_spike', label: 'Spike Volumen', desc: 'Volumen > 2x promedio', icon: AlertTriangle },\n];\n\nexport default function AlertPanel() {\n  const { selectedPair } = useStore();\n  const [alerts, setAlerts] = useState([]);\n  const [triggered, setTriggered] = useState([]);\n  const [tab, setTab] = useState('active'); // active | triggered | create\n  const [form, setForm] = useState({\n    type: 'price',\n    condition: 'above',\n    price: '',\n    signalType: 'ema_cross',\n    repeat: false,\n  });\n\n  useEffect(() => {\n    setAlerts(alertService.getAlerts());\n    setTriggered(alertService.getTriggered());\n\n    const unsub = alertService.subscribe(() => {\n      setAlerts([...alertService.getAlerts()]);\n      setTriggered([...alertService.getTriggered()]);\n    });\n\n    alertService.requestPermission();\n    return unsub;\n  }, []);\n\n  const handleCreate = () => {\n    if (form.type === 'price') {\n      if (!form.price) return;\n      alertService.addPriceAlert(selectedPair, form.condition, form.price, { repeat: form.repeat });\n    } else {\n      alertService.addSignalAlert(selectedPair, form.signalType, { repeat: form.repeat });\n    }\n    setAlerts([...alertService.getAlerts()]);\n    setForm({ type: 'price', condition: 'above', price: '', signalType: 'ema_cross', repeat: false });\n    setTab('active');\n  };\n\n  const handleDelete = (id) => {\n    alertService.removeAlert(id);\n    setAlerts([...alertService.getAlerts()]);\n  };\n\n  const activeAlerts = alerts.filter(a => a.active);\n  const inactiveAlerts = alerts.filter(a => !a.active);\n\n  return (\n    <div className=\"flex-1 overflow-y-auto px-5 py-5 space-y-5\">\n      {/* Header */}\n      <motion.div initial={{ opacity: 0, y: 8 }} animate={{ opacity: 1, y: 0 }}\n        className=\"flex items-center justify-between gap-3\">\n        <div className=\"min-w-0\">\n          <h1 className=\"text-lg font-bold flex items-center gap-2\">\n            <Bell size={18} className=\"text-[var(--gold)] shrink-0\" />\n            Alertas\n          </h1>\n          <p className=\"text-xs text-[var(--text-dim)] mt-0.5\">\n            {activeAlerts.length} alerta{activeAlerts.length !== 1 ? 's' : ''} activa{activeAlerts.length !== 1 ? 's' : ''}\n          </p>\n        </div>\n        <button\n          onClick={() => setTab('create')}\n          className=\"flex items-center gap-2 px-4 py-2 rounded-xl text-xs font-semibold text-white transition-all hover:opacity-90 shrink-0\"\n          style={{ background: 'linear-gradient(135deg, #3B82F6, #2563EB)' }}\n        >\n          <Plus size={14} />\n          Nueva Alerta\n        </button>\n      </motion.div>\n\n      {/* Tabs */}\n      <div className=\"flex gap-1 p-1 rounded-xl\"\n        style={{ background: 'rgba(24,26,32,0.8)', border: '1px solid rgba(30,34,45,0.5)' }}>\n        {[\n          { id: 'active', label: `Activas (${activeAlerts.length})` },\n          { id: 'triggered', label: `Disparadas (${triggered.length})` },\n          { id: 'create', label: 'Crear' },\n        ].map(t => (\n          <button\n            key={t.id}\n            onClick={() => setTab(t.id)}\n            className={`flex-1 py-2 text-xs font-bold rounded-lg transition-all duration-200\n              ${tab === t.id ? 'text-white' : 'text-[var(--text-dim)]'}`}\n            style={tab === t.id ? { background: 'linear-gradient(135deg, rgba(59,130,246,0.2), rgba(59,130,246,0.08))', border: '1px solid rgba(59,130,246,0.15)' } : {}}\n          >\n            {t.label}\n          </button>\n        ))}\n      </div>\n\n      {/* Create alert form */}\n      <AnimatePresence>\n        {tab === 'create' && (\n          <motion.div\n            initial={{ opacity: 0, y: 10 }}\n            animate={{ opacity: 1, y: 0 }}\n            exit={{ opacity: 0, y: -10 }}\n            className=\"rounded-xl p-5 space-y-4\"\n            style={{\n              background: 'linear-gradient(135deg, rgba(17,19,24,0.8), rgba(24,26,32,0.6))',\n              border: '1px solid rgba(30,34,45,0.5)',\n            }}\n          >\n            <h3 className=\"text-sm font-bold\">Crear Alerta para {formatPair(selectedPair)}</h3>\n\n            {/* Type toggle */}\n            <div className=\"flex gap-2\">\n              <button\n                onClick={() => setForm({ ...form, type: 'price' })}\n                className={`flex-1 py-2 text-xs font-bold rounded-lg transition-all\n                  ${form.type === 'price' ? 'bg-[var(--gold)]/15 text-[var(--gold)] border border-[var(--gold)]/20' : 'bg-[var(--dark-3)] text-[var(--text-dim)] border border-transparent'}`}\n              >\n                Precio\n              </button>\n              <button\n                onClick={() => setForm({ ...form, type: 'signal' })}\n                className={`flex-1 py-2 text-xs font-bold rounded-lg transition-all\n                  ${form.type === 'signal' ? 'bg-[var(--gold)]/15 text-[var(--gold)] border border-[var(--gold)]/20' : 'bg-[var(--dark-3)] text-[var(--text-dim)] border border-transparent'}`}\n              >\n                SeÃ±al TÃ©cnica\n              </button>\n            </div>\n\n            {form.type === 'price' ? (\n              <>\n                {/* Condition */}\n                <div className=\"flex gap-2\">\n                  {['above', 'below'].map(c => (\n                    <button\n                      key={c}\n                      onClick={() => setForm({ ...form, condition: c })}\n                      className={`flex-1 py-2 text-xs font-bold rounded-lg transition-all flex items-center justify-center gap-1.5\n                        ${form.condition === c\n                          ? c === 'above' ? 'bg-[var(--green)]/10 text-[var(--green)] border border-[var(--green)]/15' : 'bg-[var(--red)]/10 text-[var(--red)] border border-[var(--red)]/15'\n                          : 'bg-[var(--dark-3)] text-[var(--text-dim)] border border-transparent'\n                        }`}\n                    >\n                      {c === 'above' ? <TrendingUp size={12} /> : <TrendingDown size={12} />}\n                      {c === 'above' ? 'Sube a' : 'Baja a'}\n                    </button>\n                  ))}\n                </div>\n                <div>\n                  <label className=\"text-[11px] text-[var(--text-dim)] mb-1.5 block font-medium\">Precio objetivo (USD)</label>\n                  <input\n                    type=\"number\"\n                    value={form.price}\n                    onChange={e => setForm({ ...form, price: e.target.value })}\n                    placeholder=\"Ej: 100000\"\n                    className=\"w-full\"\n                    step=\"any\"\n                  />\n                </div>\n              </>\n            ) : (\n              <div className=\"space-y-2\">\n                {SIGNAL_TYPES.map(s => {\n                  const Icon = s.icon;\n                  return (\n                    <button\n                      key={s.id}\n                      onClick={() => setForm({ ...form, signalType: s.id })}\n                      className={`w-full flex items-center gap-3 p-3 rounded-lg transition-all text-left\n                        ${form.signalType === s.id ? 'bg-[var(--gold)]/10 border border-[var(--gold)]/15' : 'bg-[var(--dark-3)] border border-transparent hover:border-[var(--border)]'}`}\n                    >\n                      <div className={`w-8 h-8 rounded-lg flex items-center justify-center ${form.signalType === s.id ? 'bg-[var(--gold)]/15' : 'bg-[var(--dark-4)]'}`}>\n                        <Icon size={14} className={form.signalType === s.id ? 'text-[var(--gold)]' : 'text-[var(--text-dim)]'} />\n                      </div>\n                      <div>\n                        <p className=\"text-xs font-bold\">{s.label}</p>\n                        <p className=\"text-[10px] text-[var(--text-dim)]\">{s.desc}</p>\n                      </div>\n                    </button>\n                  );\n                })}\n              </div>\n            )}\n\n            {/* Repeat toggle */}\n            <label className=\"flex items-center gap-2 cursor-pointer\">\n              <div className={`w-9 h-5 rounded-full transition-colors relative ${form.repeat ? 'bg-[var(--gold)]' : 'bg-[var(--dark-4)]'}`}\n                onClick={() => setForm({ ...form, repeat: !form.repeat })}>\n                <div className={`absolute top-0.5 w-4 h-4 rounded-full bg-white transition-transform ${form.repeat ? 'translate-x-4' : 'translate-x-0.5'}`} />\n              </div>\n              <span className=\"text-xs text-[var(--text-dim)]\">Repetir alerta</span>\n            </label>\n\n            <button\n              onClick={handleCreate}\n              disabled={form.type === 'price' && !form.price}\n              className=\"w-full py-3 text-white font-bold rounded-xl text-sm transition-all disabled:opacity-40\"\n              style={{ background: 'linear-gradient(135deg, #3B82F6, #2563EB)', boxShadow: '0 4px 15px rgba(59,130,246,0.25)' }}\n            >\n              Crear Alerta\n            </button>\n          </motion.div>\n        )}\n      </AnimatePresence>\n\n      {/* Active alerts list */}\n      {tab === 'active' && (\n        <div className=\"space-y-2\">\n          {activeAlerts.length === 0 ? (\n            <div className=\"text-center py-12\">\n              <Bell size={40} className=\"mx-auto text-[var(--text-dim)]/20 mb-3\" />\n              <p className=\"text-sm text-[var(--text-dim)]\">No hay alertas activas</p>\n              <button onClick={() => setTab('create')} className=\"text-xs text-[var(--gold)] mt-2 font-semibold\">\n                Crear primera alerta â†’\n              </button>\n            </div>\n          ) : activeAlerts.map((alert, i) => (\n            <motion.div\n              key={alert.id}\n              initial={{ opacity: 0, y: 5 }}\n              animate={{ opacity: 1, y: 0 }}\n              transition={{ delay: i * 0.04 }}\n              className=\"flex items-center gap-3 p-3 rounded-xl group\"\n              style={{\n                background: 'linear-gradient(135deg, rgba(17,19,24,0.8), rgba(24,26,32,0.6))',\n                border: '1px solid rgba(30,34,45,0.5)',\n              }}\n            >\n              <div className=\"w-9 h-9 rounded-lg flex items-center justify-center shrink-0\"\n                style={{ background: alert.type === 'price' ? 'rgba(59,130,246,0.08)' : 'rgba(139,92,246,0.08)' }}>\n                {alert.type === 'price'\n                  ? (alert.condition === 'above' ? <TrendingUp size={16} className=\"text-[var(--green)]\" /> : <TrendingDown size={16} className=\"text-[var(--red)]\" />)\n                  : <Zap size={16} className=\"text-purple-400\" />\n                }\n              </div>\n              <div className=\"flex-1 min-w-0\">\n                <p className=\"text-[13px] font-semibold truncate\">{alert.symbol}</p>\n                <p className=\"text-[11px] text-[var(--text-dim)] truncate\">{alert.message}</p>\n              </div>\n              <div className=\"flex items-center gap-2\">\n                {alert.repeat && (\n                  <span className=\"text-[9px] font-bold text-[var(--gold)] bg-[var(--gold)]/10 px-1.5 py-0.5 rounded\">â†»</span>\n                )}\n                <span className=\"w-2 h-2 rounded-full bg-[var(--green)] animate-pulse\" />\n                <button\n                  onClick={() => handleDelete(alert.id)}\n                  className=\"p-1.5 rounded-lg text-[var(--text-dim)] hover:text-[var(--red)] hover:bg-[var(--red)]/[0.06] transition-all opacity-0 group-hover:opacity-100\"\n                >\n                  <Trash2 size={13} />\n                </button>\n              </div>\n            </motion.div>\n          ))}\n        </div>\n      )}\n\n      {/* Triggered alerts list */}\n      {tab === 'triggered' && (\n        <div className=\"space-y-2\">\n          {triggered.length === 0 ? (\n            <div className=\"text-center py-12\">\n              <CheckCircle size={40} className=\"mx-auto text-[var(--text-dim)]/20 mb-3\" />\n              <p className=\"text-sm text-[var(--text-dim)]\">No hay alertas disparadas</p>\n            </div>\n          ) : [...triggered].reverse().map((alert, i) => (\n            <motion.div\n              key={`${alert.id}-${i}`}\n              initial={{ opacity: 0 }}\n              animate={{ opacity: 1 }}\n              className=\"flex items-center gap-3 p-3 rounded-xl\"\n              style={{\n                background: 'linear-gradient(135deg, rgba(14,203,129,0.04), rgba(17,19,24,0.6))',\n                border: '1px solid rgba(14,203,129,0.08)',\n              }}\n            >\n              <div className=\"w-9 h-9 rounded-lg bg-[var(--green)]/[0.08] flex items-center justify-center shrink-0\">\n                <CheckCircle size={16} className=\"text-[var(--green)]\" />\n              </div>\n              <div className=\"flex-1 min-w-0\">\n                <p className=\"text-[13px] font-semibold truncate\">{alert.symbol}</p>\n                <p className=\"text-[11px] text-[var(--text-dim)] truncate\">{alert.message}</p>\n              </div>\n              <div className=\"text-right\">\n                <p className=\"text-xs font-mono text-[var(--green)]\">${alert.triggeredPrice?.toLocaleString()}</p>\n                <p className=\"text-[9px] text-[var(--text-dim)]\">\n                  {new Date(alert.triggeredAt).toLocaleTimeString()}\n                </p>\n              </div>\n            </motion.div>\n          ))}\n        </div>\n      )}\n    </div>\n  );\n}\n"],"names":["ALERTS_KEY","AlertService","callback","alert","cb","symbol","condition","price","options","signalType","params","descriptions","id","active","a","bySymbol","alerts","marketData","triggered","candles","closes","c","len","fast","calculateEMA","slow","detectCrossover","calculateRSI","macd","signal","calculateMACD","volumes","avgVol","s","alertService","SIGNAL_TYPES","Activity","TrendingDown","TrendingUp","Zap","AlertTriangle","AlertPanel","selectedPair","useStore","setAlerts","useState","setTriggered","tab","setTab","form","setForm","useEffect","unsub","handleCreate","handleDelete","activeAlerts","jsxs","motion","jsx","Bell","Plus","AnimatePresence","formatPair","Fragment","e","Icon","i","Trash2","CheckCircle","_a"],"mappings":"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"}