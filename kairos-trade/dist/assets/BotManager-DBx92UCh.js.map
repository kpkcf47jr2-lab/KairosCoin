{"version":3,"file":"BotManager-DBx92UCh.js","sources":["../../src/services/gridBot.js","../../src/services/dcaBot.js","../../src/components/Bots/BotManager.jsx"],"sourcesContent":["// Kairos Trade ‚Äî Grid Bot Engine\n// Implements grid trading strategy: places buy/sell orders at predefined price levels\n// Creates a \"grid\" of limit orders above and below current price\n\nimport marketData from './marketData';\nimport { feeService } from './feeService';\n\nclass GridBotEngine {\n  constructor() {\n    this.activeBots = new Map();\n  }\n\n  /**\n   * Start a Grid Bot\n   * @param {Object} config - { id, pair, upperPrice, lowerPrice, gridLines, investment, onLog, onTrade }\n   */\n  start(config) {\n    if (this.activeBots.has(config.id)) return;\n\n    const { pair, upperPrice, lowerPrice, gridLines, investment, onLog, onTrade } = config;\n\n    // Calculate grid levels\n    const priceStep = (upperPrice - lowerPrice) / (gridLines - 1);\n    const levels = [];\n    for (let i = 0; i < gridLines; i++) {\n      levels.push(+(lowerPrice + priceStep * i).toFixed(2));\n    }\n\n    const investmentPerGrid = investment / (gridLines - 1);\n\n    const state = {\n      id: config.id,\n      pair,\n      levels,\n      priceStep,\n      investmentPerGrid,\n      activeOrders: new Map(), // level -> order\n      filledBuys: [], // levels where buy was filled\n      totalProfit: 0,\n      trades: 0,\n      running: true,\n      lastPrice: null,\n    };\n\n    this.activeBots.set(config.id, state);\n    onLog?.(`üìä Grid Bot started: ${gridLines} levels from $${lowerPrice} to $${upperPrice}`);\n    onLog?.(`üí∞ Investment per grid: $${investmentPerGrid.toFixed(2)}`);\n\n    // Place initial grid orders based on current price\n    this._startMonitor(state, onLog, onTrade);\n  }\n\n  async _startMonitor(state, onLog, onTrade) {\n    const checkPrice = async () => {\n      if (!state.running) return;\n\n      try {\n        const ticker = await marketData.get24hrTicker(state.pair);\n        const currentPrice = ticker.price;\n        const prevPrice = state.lastPrice;\n        state.lastPrice = currentPrice;\n\n        if (!prevPrice) {\n          // First run ‚Äî identify which levels to place buys vs sells\n          onLog?.(`üìà Current price: $${currentPrice.toFixed(2)}`);\n          for (const level of state.levels) {\n            if (level < currentPrice) {\n              // Place buy below current price\n              state.activeOrders.set(level, { side: 'buy', price: level, status: 'pending' });\n            } else if (level > currentPrice) {\n              // Sell levels - will be activated after a buy fills\n            }\n          }\n          const buyCount = state.activeOrders.size;\n          onLog?.(`üü¢ ${buyCount} buy orders placed below current price`);\n          return;\n        }\n\n        // Check if price crossed any grid levels\n        for (const level of state.levels) {\n          const order = state.activeOrders.get(level);\n\n          // Price dropped below a buy level = buy triggered\n          if (order?.side === 'buy' && order.status === 'pending' && currentPrice <= level) {\n            const qty = state.investmentPerGrid / level;\n            // Platform fee on grid buy (0.05% of volume)\n            feeService.applyVolumeFee(level, qty);\n            order.status = 'filled';\n            state.filledBuys.push(level);\n            state.trades++;\n\n            onTrade?.({\n              symbol: state.pair,\n              side: 'buy',\n              type: 'grid',\n              quantity: +qty.toFixed(6),\n              price: level,\n              gridLevel: level,\n            });\n            onLog?.(`‚úÖ BUY filled at $${level} (qty: ${qty.toFixed(6)})`);\n\n            // Place sell at the next level above\n            const sellLevel = level + state.priceStep;\n            if (sellLevel <= state.levels[state.levels.length - 1]) {\n              state.activeOrders.set(sellLevel, {\n                side: 'sell',\n                price: sellLevel,\n                status: 'pending',\n                buyLevel: level,\n                quantity: qty,\n              });\n              onLog?.(`üì§ SELL order placed at $${sellLevel.toFixed(2)}`);\n            }\n          }\n\n          // Price rose above a sell level = sell triggered\n          if (order?.side === 'sell' && order.status === 'pending' && currentPrice >= level) {\n            order.status = 'filled';\n            const rawProfit = (level - order.buyLevel) * order.quantity;\n            // Platform fee on grid sell (0.05% of volume)\n            const sellFee = feeService.applyVolumeFee(level, order.quantity);\n            const profit = rawProfit - sellFee;\n            state.totalProfit += profit;\n            state.trades++;\n\n            onTrade?.({\n              symbol: state.pair,\n              side: 'sell',\n              type: 'grid',\n              quantity: +order.quantity.toFixed(6),\n              price: level,\n              profit: +profit.toFixed(2),\n              gridLevel: level,\n            });\n            onLog?.(`‚úÖ SELL filled at $${level.toFixed(2)} ‚Äî Profit: +$${profit.toFixed(2)}`);\n\n            // Re-place the buy at the level below\n            const rebuyLevel = level - state.priceStep;\n            if (rebuyLevel >= state.levels[0]) {\n              state.activeOrders.set(rebuyLevel, {\n                side: 'buy',\n                price: rebuyLevel,\n                status: 'pending',\n              });\n              onLog?.(`üì• BUY order re-placed at $${rebuyLevel.toFixed(2)}`);\n            }\n          }\n        }\n      } catch (err) {\n        onLog?.(`‚ùå Error: ${err.message}`);\n      }\n    };\n\n    // Check every 10 seconds\n    await checkPrice();\n    const interval = setInterval(checkPrice, 10000);\n    state._interval = interval;\n  }\n\n  stop(botId) {\n    const state = this.activeBots.get(botId);\n    if (state) {\n      state.running = false;\n      if (state._interval) clearInterval(state._interval);\n      this.activeBots.delete(botId);\n    }\n  }\n\n  getStats(botId) {\n    const state = this.activeBots.get(botId);\n    if (!state) return null;\n    return {\n      levels: state.levels.length,\n      activeOrders: [...state.activeOrders.values()].filter(o => o.status === 'pending').length,\n      filledBuys: state.filledBuys.length,\n      totalProfit: state.totalProfit,\n      trades: state.trades,\n      lastPrice: state.lastPrice,\n    };\n  }\n\n  isRunning(botId) {\n    return this.activeBots.has(botId);\n  }\n}\n\nexport const gridBotEngine = new GridBotEngine();\nexport default gridBotEngine;\n","// Kairos Trade ‚Äî DCA Bot Engine\n// Dollar Cost Averaging: buys a fixed $ amount at regular intervals\n// Optionally applies conditions (RSI oversold, price dip, etc.)\n\nimport marketData from './marketData';\nimport { calculateRSI } from './indicators';\nimport { feeService } from './feeService';\n\nclass DCABotEngine {\n  constructor() {\n    this.activeBots = new Map();\n  }\n\n  /**\n   * Start a DCA Bot\n   * @param {Object} config - {\n   *   id, pair, investmentPerOrder, intervalMinutes,\n   *   maxOrders, useRsiFilter, rsiPeriod, rsiThreshold,\n   *   usePriceDipFilter, dipPercent,\n   *   onLog, onTrade\n   * }\n   */\n  start(config) {\n    if (this.activeBots.has(config.id)) return;\n\n    const {\n      pair, investmentPerOrder, intervalMinutes, maxOrders = 100,\n      useRsiFilter = false, rsiPeriod = 14, rsiThreshold = 40,\n      usePriceDipFilter = false, dipPercent = 3,\n      onLog, onTrade,\n    } = config;\n\n    const state = {\n      id: config.id,\n      pair,\n      investmentPerOrder,\n      intervalMinutes,\n      maxOrders,\n      useRsiFilter,\n      rsiPeriod,\n      rsiThreshold,\n      usePriceDipFilter,\n      dipPercent,\n      executedOrders: 0,\n      totalInvested: 0,\n      totalQuantity: 0,\n      avgPrice: 0,\n      prices: [],\n      running: true,\n      lastBuyPrice: null,\n      startTime: Date.now(),\n    };\n\n    this.activeBots.set(config.id, state);\n    onLog?.(`üìä DCA Bot started: $${investmentPerOrder} every ${intervalMinutes}min on ${pair}`);\n    if (useRsiFilter) onLog?.(`üìâ RSI filter enabled: buy when RSI < ${rsiThreshold}`);\n    if (usePriceDipFilter) onLog?.(`üìâ Dip filter enabled: buy when price drops ${dipPercent}%`);\n\n    this._startMonitor(state, onLog, onTrade);\n  }\n\n  async _startMonitor(state, onLog, onTrade) {\n    const executeBuy = async () => {\n      if (!state.running) return;\n      if (state.executedOrders >= state.maxOrders) {\n        onLog?.(`üèÅ Max orders reached (${state.maxOrders}). DCA Bot stopped.`);\n        this.stop(state.id);\n        return;\n      }\n\n      try {\n        const ticker = await marketData.get24hrTicker(state.pair);\n        const currentPrice = ticker.price;\n\n        // Check RSI filter\n        if (state.useRsiFilter) {\n          try {\n            const candles = await marketData.getCandles(state.pair, '1h', 100);\n            const closes = candles.map(c => c.close);\n            const rsi = calculateRSI(closes, state.rsiPeriod);\n            const currentRSI = rsi[rsi.length - 1];\n\n            if (currentRSI > state.rsiThreshold) {\n              onLog?.(`‚è∏Ô∏è RSI ${currentRSI.toFixed(1)} > ${state.rsiThreshold} ‚Äî skipping buy`);\n              return;\n            }\n            onLog?.(`üìâ RSI ${currentRSI.toFixed(1)} < ${state.rsiThreshold} ‚Äî proceeding with buy`);\n          } catch (err) {\n            onLog?.(`‚ö†Ô∏è RSI check failed, proceeding anyway: ${err.message}`);\n          }\n        }\n\n        // Check price dip filter\n        if (state.usePriceDipFilter && state.lastBuyPrice) {\n          const dropPercent = ((state.lastBuyPrice - currentPrice) / state.lastBuyPrice) * 100;\n          if (dropPercent < state.dipPercent) {\n            onLog?.(`‚è∏Ô∏è Price drop ${dropPercent.toFixed(2)}% < ${state.dipPercent}% ‚Äî skipping buy`);\n            return;\n          }\n          onLog?.(`üìâ Price dropped ${dropPercent.toFixed(2)}% ‚Äî proceeding with buy`);\n        }\n\n        // Execute buy\n        const quantity = state.investmentPerOrder / currentPrice;\n        // Platform fee on DCA buy (0.05% of volume)\n        feeService.applyVolumeFee(currentPrice, quantity);\n        state.executedOrders++;\n        state.totalInvested += state.investmentPerOrder;\n        state.totalQuantity += quantity;\n        state.avgPrice = state.totalInvested / state.totalQuantity;\n        state.lastBuyPrice = currentPrice;\n        state.prices.push(currentPrice);\n\n        onTrade?.({\n          symbol: state.pair,\n          side: 'buy',\n          type: 'dca',\n          quantity: +quantity.toFixed(8),\n          price: currentPrice,\n          dcaOrder: state.executedOrders,\n          avgPrice: +state.avgPrice.toFixed(2),\n        });\n\n        onLog?.(`‚úÖ DCA Buy #${state.executedOrders}: ${quantity.toFixed(6)} ${state.pair.replace('USDT', '')} @ $${currentPrice.toFixed(2)}`);\n        onLog?.(`üìä Avg price: $${state.avgPrice.toFixed(2)} | Total invested: $${state.totalInvested.toFixed(2)}`);\n\n      } catch (err) {\n        onLog?.(`‚ùå Error: ${err.message}`);\n      }\n    };\n\n    // Execute first buy immediately\n    await executeBuy();\n\n    // Then on interval\n    const interval = setInterval(executeBuy, state.intervalMinutes * 60 * 1000);\n    state._interval = interval;\n  }\n\n  stop(botId) {\n    const state = this.activeBots.get(botId);\n    if (state) {\n      state.running = false;\n      if (state._interval) clearInterval(state._interval);\n      this.activeBots.delete(botId);\n    }\n  }\n\n  getStats(botId) {\n    const state = this.activeBots.get(botId);\n    if (!state) return null;\n\n    const currentValue = state.totalQuantity * (state.lastBuyPrice || 0);\n    const unrealizedPnl = currentValue - state.totalInvested;\n\n    return {\n      executedOrders: state.executedOrders,\n      maxOrders: state.maxOrders,\n      totalInvested: state.totalInvested,\n      totalQuantity: state.totalQuantity,\n      avgPrice: state.avgPrice,\n      currentPrice: state.lastBuyPrice,\n      unrealizedPnl,\n      unrealizedPnlPercent: state.totalInvested > 0 ? (unrealizedPnl / state.totalInvested * 100) : 0,\n      runningTime: Date.now() - state.startTime,\n    };\n  }\n\n  isRunning(botId) {\n    return this.activeBots.has(botId);\n  }\n}\n\nexport const dcaBotEngine = new DCABotEngine();\nexport default dcaBotEngine;\n","// Kairos Trade ‚Äî Bot Management Panel (Elite v3)\nimport { useState, useEffect, useCallback } from 'react';\nimport { motion, AnimatePresence } from 'framer-motion';\nimport { Bot, Plus, Play, Pause, Square, Trash2, Settings, TrendingUp, TrendingDown, AlertCircle, Grid3x3, DollarSign, Zap, Code2, Edit3, BarChart3, Link2, ArrowRight, ChevronDown } from 'lucide-react';\nimport useStore from '../../store/useStore';\nimport { tradingEngine } from '../../services/tradingEngine';\nimport gridBotEngine from '../../services/gridBot';\nimport dcaBotEngine from '../../services/dcaBot';\nimport { brokerService } from '../../services/broker';\nimport { POPULAR_PAIRS, TIMEFRAMES } from '../../constants';\nimport { formatPair } from '../../utils/pairUtils';\nimport StrategyEditor from './StrategyEditor';\n\nconst BOT_TYPES = [\n  { id: 'signal', label: 'Signal Bot', icon: Zap, desc: 'Indicadores t√©cnicos predefinidos', color: '#3B82F6' },\n  { id: 'script', label: 'Script Bot', icon: Code2, desc: 'Estrategia personalizada con c√≥digo', color: '#A855F7' },\n  { id: 'grid', label: 'Grid Bot', icon: Grid3x3, desc: 'Compra y vende en niveles de precio', color: '#00DC82' },\n  { id: 'dca', label: 'DCA Bot', icon: DollarSign, desc: 'Inversi√≥n a intervalos regulares', color: '#22D3EE' },\n];\n\nexport default function BotManager() {\n  const { bots, addBot, updateBot, removeBot, strategies, addStrategy, brokers, setPage, setSelectedPair } = useStore();\n  const [showCreate, setShowCreate] = useState(false);\n  const [showStrategyEditor, setShowStrategyEditor] = useState(false);\n  const [editingStrategy, setEditingStrategy] = useState(null);\n  const [botType, setBotType] = useState('signal');\n  const [logs, setLogs] = useState([]);\n  const [showLiveActivity, setShowLiveActivity] = useState(false);\n  const [createError, setCreateError] = useState('');\n  const [brokerBalances, setBrokerBalances] = useState({});\n  const [livePnL, setLivePnL] = useState({});  // Real-time P&L per bot\n  const [form, setForm] = useState({\n    name: '', pair: 'BTCKAIROS', timeframe: '1h', strategyId: '', brokerId: '',\n    balance: '1000', riskPercent: '2', maxTrades: '10',\n    trailingStop: false, trailingStopPct: '1.5', trailingActivation: '0.5',\n    // Grid bot fields\n    upperPrice: '', lowerPrice: '', gridLines: '10',\n    // DCA bot fields\n    investmentPerOrder: '100', intervalMinutes: '60', maxOrders: '50',\n    useRsiFilter: false, rsiThreshold: '40', usePriceDipFilter: false, dipPercent: '3',\n    // Script bot fields\n    scriptCode: '', scriptStrategyId: '',\n  });\n\n  // Fetch real balances from connected brokers (auto-reconnect if needed)\n  const fetchBrokerBalances = useCallback(async () => {\n    for (const broker of brokers.filter(b => b.connected)) {\n      try {\n        // Auto-reconnect if broker service lost the connection (e.g. page reload)\n        if (!brokerService.connections?.has(broker.id)) {\n          await brokerService.connect(broker);\n        }\n        const result = await brokerService.getBalances(broker.id);\n        const balArr = Array.isArray(result) ? result : result?.balances || [];\n        setBrokerBalances(prev => ({ ...prev, [broker.id]: { balances: balArr, loading: false, error: false } }));\n      } catch (err) {\n        console.warn('Balance fetch failed for', broker.id, err.message);\n        setBrokerBalances(prev => ({ ...prev, [broker.id]: { balances: [], loading: false, error: true } }));\n      }\n    }\n  }, [brokers]);\n\n  useEffect(() => {\n    fetchBrokerBalances();\n    const interval = setInterval(fetchBrokerBalances, 30000);\n    return () => clearInterval(interval);\n  }, [fetchBrokerBalances]);\n\n  // Poll live P&L from trading engine every second\n  useEffect(() => {\n    const tick = setInterval(() => {\n      const activeBots = bots.filter(b => b.status === 'active');\n      if (activeBots.length === 0) return;\n      const updates = {};\n      activeBots.forEach(bot => {\n        const live = tradingEngine.getLiveData(bot.id);\n        if (live) updates[bot.id] = live;\n      });\n      if (Object.keys(updates).length > 0) {\n        setLivePnL(prev => ({ ...prev, ...updates }));\n      }\n    }, 1000);\n    return () => clearInterval(tick);\n  }, [bots]);\n\n  // Auto-restart active bots on mount (survives navigation + page refresh)\n  useEffect(() => {\n    const currentBots = useStore.getState().bots;\n    const activeBotsList = currentBots.filter(b => b.status === 'active');\n\n    for (const bot of activeBotsList) {\n      if (tradingEngine.activeBots.has(bot.id)) {\n        // Bot is already running ‚Äî re-attach fresh callbacks\n        tradingEngine.setCallbacks(bot.id,\n          (trade) => addTrade(bot, trade),\n          (msg) => addLog(bot, msg),\n        );\n      } else {\n        // Bot shows active but engine lost it (page refresh) ‚Äî restart\n        const type = bot.botType || 'signal';\n        if (type === 'signal' || type === 'script') {\n          tradingEngine.startBot(\n            { ...bot, status: 'active' },\n            (trade) => addTrade(bot, trade),\n            (msg) => addLog(bot, msg),\n          );\n        } else if (type === 'grid') {\n          gridBotEngine.start({\n            id: bot.id, pair: bot.pair,\n            upperPrice: bot.upperPrice, lowerPrice: bot.lowerPrice,\n            gridLines: bot.gridLines, investment: bot.balance,\n            onLog: (msg) => addLog(bot, msg),\n            onTrade: (trade) => addTrade(bot, trade),\n          });\n        } else if (type === 'dca') {\n          dcaBotEngine.start({\n            id: bot.id, pair: bot.pair,\n            investmentPerOrder: bot.investmentPerOrder,\n            intervalMinutes: bot.intervalMinutes, maxOrders: bot.maxOrders,\n            onLog: (msg) => addLog(bot, msg),\n            onTrade: (trade) => addTrade(bot, trade),\n          });\n        }\n      }\n    }\n\n    // Load existing logs from engine buffer (survived navigation)\n    const allLogs = tradingEngine.getAllLogs();\n    if (allLogs.length > 0) {\n      setLogs(prev => {\n        if (prev.length > 0) return prev; // Don't double-add\n        return allLogs.map(l => ({\n          type: 'log', bot: l.botName, message: l.message,\n          time: new Date(l.time).toLocaleTimeString(),\n        }));\n      });\n    }\n  // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n\n  // Helper: get broker info for a bot\n  const getBrokerForBot = (bot) => brokers.find(b => b.id === bot.brokerId);\n  const getBrokerBalance = (brokerId) => brokerBalances[brokerId] || null;\n\n  // Navigate to chart with bot's pair\n  const goToChart = (bot) => {\n    setSelectedPair(bot.pair);\n    setPage('chart');\n  };\n\n  const handleCreate = () => {\n    setCreateError('');\n\n    // Auto-generate name if empty\n    const botName = form.name.trim() || `Bot ${new Date().toLocaleTimeString('es', { hour: '2-digit', minute: '2-digit' })}`;\n\n    if (!form.pair) {\n      setCreateError('Selecciona un par de trading');\n      return;\n    }\n\n    const botData = {\n      name: botName,\n      pair: form.pair,\n      botType,\n      brokerId: form.brokerId,\n    };\n\n    if (botType === 'signal') {\n      const strategy = strategies.find(s => s.id === form.strategyId) || {\n        name: 'EMA Cross 9/21',\n        entry: { condition: 'EMA 9 cruza EMA 21', indicator: 'ema_cross', params: { fastEma: 9, slowEma: 21 } },\n        exit: { condition: 'Cruce opuesto', indicator: 'ema_cross', params: { fastEma: 9, slowEma: 21 } },\n        stopLoss: '2', takeProfit: '4',\n      };\n      Object.assign(botData, {\n        timeframe: form.timeframe, strategy,\n        balance: parseFloat(form.balance), riskPercent: parseFloat(form.riskPercent),\n        maxTrades: parseInt(form.maxTrades),\n        trailingStop: form.trailingStop,\n        trailingStopPct: form.trailingStop ? parseFloat(form.trailingStopPct) : undefined,\n        trailingActivation: form.trailingStop ? parseFloat(form.trailingActivation) : undefined,\n      });\n    } else if (botType === 'script') {\n      // Custom script bot ‚Äî uses Kairos Script engine\n      if (!form.scriptStrategyId) {\n        setCreateError('Selecciona una estrategia o crea una nueva');\n        return;\n      }\n      const customStrategy = strategies.find(s => s.id === form.scriptStrategyId);\n      if (!customStrategy?.code) {\n        setCreateError('La estrategia seleccionada no tiene c√≥digo. Ed√≠tala y guarda el c√≥digo primero.');\n        return;\n      }\n      Object.assign(botData, {\n        timeframe: form.timeframe,\n        strategy: { type: 'custom_script', code: customStrategy.code, name: customStrategy.name },\n        balance: parseFloat(form.balance), riskPercent: parseFloat(form.riskPercent),\n        maxTrades: parseInt(form.maxTrades),\n        scriptName: customStrategy.name,\n        trailingStop: form.trailingStop,\n        trailingStopPct: form.trailingStop ? parseFloat(form.trailingStopPct) : undefined,\n        trailingActivation: form.trailingStop ? parseFloat(form.trailingActivation) : undefined,\n      });\n    } else if (botType === 'grid') {\n      if (!form.upperPrice || !form.lowerPrice) {\n        setCreateError('Ingresa el precio superior e inferior para el grid');\n        return;\n      }\n      Object.assign(botData, {\n        upperPrice: parseFloat(form.upperPrice), lowerPrice: parseFloat(form.lowerPrice),\n        gridLines: parseInt(form.gridLines), balance: parseFloat(form.balance),\n      });\n    } else if (botType === 'dca') {\n      Object.assign(botData, {\n        investmentPerOrder: parseFloat(form.investmentPerOrder),\n        intervalMinutes: parseInt(form.intervalMinutes), maxOrders: parseInt(form.maxOrders),\n        useRsiFilter: form.useRsiFilter, rsiThreshold: parseInt(form.rsiThreshold),\n        usePriceDipFilter: form.usePriceDipFilter, dipPercent: parseFloat(form.dipPercent),\n        balance: parseFloat(form.investmentPerOrder) * parseInt(form.maxOrders),\n      });\n    }\n\n    addBot(botData);\n    setShowCreate(false);\n    setCreateError('');\n  };\n\n  const addLog = (bot, msg) => {\n    setLogs(prev => [...prev.slice(-100), { type: 'log', bot: bot.name, message: msg, time: new Date().toLocaleTimeString() }]);\n  };\n\n  const addTrade = (bot, trade) => {\n    // Don't count errors as trades\n    if (trade.status === 'error') {\n      setLogs(prev => [...prev.slice(-100), { type: 'error', bot: bot.name, message: `Error: ${trade.error}`, time: new Date().toLocaleTimeString() }]);\n      return;\n    }\n\n    setLogs(prev => [...prev.slice(-100), { type: 'trade', bot: bot.name, ...trade, time: new Date().toLocaleTimeString() }]);\n    // Update bot stats ‚Äî only count successful trades\n    const current = useStore.getState().bots.find(b => b.id === bot.id);\n    if (current) {\n      const trades = (current.trades || 0) + 1;\n      const profit = parseFloat(trade.profit) || 0;\n      const pnl = (current.pnl || 0) + profit;\n\n      // Track win rate: only on close actions with profit data\n      let winRate = current.winRate || 0;\n      if (trade.action === 'close' && profit !== 0) {\n        const totalClosed = (current._closedTrades || 0) + 1;\n        const totalWins = (current._wins || 0) + (profit > 0 ? 1 : 0);\n        winRate = totalClosed > 0 ? (totalWins / totalClosed) * 100 : 0;\n        updateBot(bot.id, { trades, pnl, winRate, _closedTrades: totalClosed, _wins: totalWins });\n      } else {\n        updateBot(bot.id, { trades, pnl });\n      }\n    }\n  };\n\n  const handleStart = async (bot) => {\n    updateBot(bot.id, { status: 'active' });\n    const type = bot.botType || 'signal';\n\n    if (type === 'signal' || type === 'script') {\n      tradingEngine.startBot(\n        { ...bot, status: 'active' },\n        (trade) => addTrade(bot, trade),\n        (msg) => addLog(bot, msg),\n      );\n    } else if (type === 'grid') {\n      gridBotEngine.start({\n        id: bot.id, pair: bot.pair,\n        upperPrice: bot.upperPrice, lowerPrice: bot.lowerPrice,\n        gridLines: bot.gridLines, investment: bot.balance,\n        onLog: (msg) => addLog(bot, msg),\n        onTrade: (trade) => addTrade(bot, trade),\n      });\n    } else if (type === 'dca') {\n      dcaBotEngine.start({\n        id: bot.id, pair: bot.pair,\n        investmentPerOrder: bot.investmentPerOrder,\n        intervalMinutes: bot.intervalMinutes, maxOrders: bot.maxOrders,\n        useRsiFilter: bot.useRsiFilter, rsiThreshold: bot.rsiThreshold,\n        usePriceDipFilter: bot.usePriceDipFilter, dipPercent: bot.dipPercent,\n        onLog: (msg) => addLog(bot, msg),\n        onTrade: (trade) => addTrade(bot, trade),\n      });\n    }\n  };\n\n  const handleStop = (bot) => {\n    const type = bot.botType || 'signal';\n    if (type === 'signal' || type === 'script') tradingEngine.stopBot(bot.id);\n    else if (type === 'grid') gridBotEngine.stop(bot.id);\n    else if (type === 'dca') dcaBotEngine.stop(bot.id);\n    updateBot(bot.id, { status: 'stopped' });\n  };\n\n  const handlePause = (bot) => {\n    handleStop(bot);\n    updateBot(bot.id, { status: 'paused' });\n  };\n\n  const handleDelete = (bot) => {\n    handleStop(bot);\n    removeBot(bot.id);\n  };\n\n  const getStatusColor = (status) => {\n    switch (status) {\n      case 'active': return 'var(--green)';\n      case 'paused': return 'var(--gold)';\n      case 'error': return 'var(--red)';\n      default: return 'var(--text-dim)';\n    }\n  };\n\n  const getTypeInfo = (type) => BOT_TYPES.find(t => t.id === type) || BOT_TYPES[0];\n\n  return (\n    <div className=\"flex-1 overflow-y-auto overflow-x-hidden px-3 md:px-5 py-4 md:py-5 space-y-4 md:space-y-5 min-w-0\">\n      <div className=\"flex items-center justify-between gap-3\">\n        <div className=\"min-w-0\">\n          <h1 className=\"text-lg font-bold\">Trading Bots</h1>\n          <p className=\"text-xs text-[var(--text-dim)]\">\n            {bots.filter(b => b.status === 'active').length} activos de {bots.length} total\n          </p>\n        </div>\n        <button onClick={() => setShowCreate(!showCreate)} className=\"flex items-center gap-2 px-4 py-2 btn-gold rounded-xl text-xs font-semibold shrink-0\">\n          <Plus size={14} /> Crear Bot\n        </button>\n      </div>\n\n      {/* Create bot form */}\n      <AnimatePresence>\n        {showCreate && (\n          <motion.div initial={{ opacity: 0, height: 0 }} animate={{ opacity: 1, height: 'auto' }} exit={{ opacity: 0, height: 0 }}\n            className=\"rounded-xl overflow-hidden\" style={{ background: 'var(--surface)', border: '1px solid var(--border)' }}>\n            <div className=\"p-5 space-y-5\">\n              <h3 className=\"text-sm font-bold text-[var(--text)]\">Nuevo Bot de Trading</h3>\n\n              {/* Bot type selector */}\n              <div className=\"grid grid-cols-2 sm:grid-cols-4 gap-2\">\n                {BOT_TYPES.map(t => {\n                  const Icon = t.icon;\n                  return (\n                    <button key={t.id} onClick={() => setBotType(t.id)}\n                      className={`p-3 rounded-xl text-center transition-all flex flex-col items-center justify-center min-w-0 ${botType === t.id ? 'ring-1' : 'hover:bg-[var(--surface-2)]'}`}\n                      style={{\n                        background: botType === t.id ? `${t.color}10` : 'var(--surface-2)',\n                        borderColor: botType === t.id ? `${t.color}40` : 'var(--border)',\n                        border: `1px solid ${botType === t.id ? t.color + '30' : 'var(--border)'}`,\n                      }}>\n                      <Icon size={20} style={{ color: t.color }} className=\"mb-1.5 shrink-0\" />\n                      <p className=\"text-xs font-bold truncate w-full\" style={{ color: botType === t.id ? t.color : 'var(--text)' }}>{t.label}</p>\n                      <p className=\"text-[10px] text-[var(--text-dim)] mt-0.5 truncate w-full\">{t.desc}</p>\n                    </button>\n                  );\n                })}\n              </div>\n\n              {/* Common fields */}\n              <div className=\"grid grid-cols-2 gap-4\">\n                <div>\n                  <label className=\"text-[10px] text-[var(--text-dim)] mb-1 block font-semibold uppercase tracking-wider\">Nombre</label>\n                  <input value={form.name} onChange={(e) => setForm({ ...form, name: e.target.value })} placeholder=\"Mi Bot\" className=\"w-full\" />\n                </div>\n                <div>\n                  <label className=\"text-[10px] text-[var(--text-dim)] mb-1 block font-semibold uppercase tracking-wider\">Par</label>\n                  <select value={form.pair} onChange={(e) => setForm({ ...form, pair: e.target.value })} className=\"w-full\">\n                    {POPULAR_PAIRS.map(p => <option key={p} value={p}>{formatPair(p)}</option>)}\n                  </select>\n                </div>\n              </div>\n\n              {/* Signal bot fields */}\n              {botType === 'signal' && (\n                <div className=\"space-y-4\">\n                  <div className=\"grid grid-cols-3 gap-4\">\n                    <div>\n                      <label className=\"text-[10px] text-[var(--text-dim)] mb-1 block font-semibold uppercase tracking-wider\">Timeframe</label>\n                      <select value={form.timeframe} onChange={(e) => setForm({ ...form, timeframe: e.target.value })} className=\"w-full\">\n                        {TIMEFRAMES.map(tf => <option key={tf.value} value={tf.value}>{tf.label}</option>)}\n                      </select>\n                    </div>\n                    <div>\n                      <label className=\"text-[10px] text-[var(--text-dim)] mb-1 block font-semibold uppercase tracking-wider\">Balance ($)</label>\n                      <input type=\"number\" value={form.balance} onChange={(e) => setForm({ ...form, balance: e.target.value })} className=\"w-full\" />\n                    </div>\n                    <div>\n                      <label className=\"text-[10px] text-[var(--text-dim)] mb-1 block font-semibold uppercase tracking-wider\">Riesgo (%)</label>\n                      <input type=\"number\" value={form.riskPercent} onChange={(e) => setForm({ ...form, riskPercent: e.target.value })} className=\"w-full\" />\n                    </div>\n                  </div>\n                  {/* Trailing Stop */}\n                  <div className=\"bg-[var(--dark)] rounded-lg p-3 border border-[var(--border)]\">\n                    <div className=\"flex items-center justify-between mb-2\">\n                      <div>\n                        <p className=\"text-xs font-bold flex items-center gap-1\">üìê Trailing Stop</p>\n                        <p className=\"text-[10px] text-[var(--text-dim)]\">SL que se mueve protegiendo ganancias</p>\n                      </div>\n                      <button\n                        onClick={() => setForm({ ...form, trailingStop: !form.trailingStop })}\n                        className={`w-10 h-5 rounded-full transition-colors relative ${form.trailingStop ? 'bg-[var(--gold)]' : 'bg-[var(--dark-4)]'}`}\n                      >\n                        <div className={`w-4 h-4 bg-white rounded-full absolute top-0.5 transition-transform ${form.trailingStop ? 'left-5' : 'left-0.5'}`} />\n                      </button>\n                    </div>\n                    {form.trailingStop && (\n                      <div className=\"grid grid-cols-2 gap-3 mt-2\">\n                        <div>\n                          <label className=\"text-[10px] text-[var(--text-dim)] mb-1 block\">Trail Distance (%)</label>\n                          <input type=\"number\" step=\"0.1\" value={form.trailingStopPct} onChange={(e) => setForm({ ...form, trailingStopPct: e.target.value })} className=\"w-full\" />\n                        </div>\n                        <div>\n                          <label className=\"text-[10px] text-[var(--text-dim)] mb-1 block\">Activaci√≥n (%)</label>\n                          <input type=\"number\" step=\"0.1\" value={form.trailingActivation} onChange={(e) => setForm({ ...form, trailingActivation: e.target.value })} className=\"w-full\" />\n                        </div>\n                      </div>\n                    )}\n                  </div>\n                </div>\n              )}\n\n              {/* Script bot fields */}\n              {botType === 'script' && (\n                <div className=\"space-y-4\">\n                  <div className=\"grid grid-cols-3 gap-4\">\n                    <div>\n                      <label className=\"text-[10px] text-[var(--text-dim)] mb-1 block font-semibold uppercase tracking-wider\">Timeframe</label>\n                      <select value={form.timeframe} onChange={(e) => setForm({ ...form, timeframe: e.target.value })} className=\"w-full\">\n                        {TIMEFRAMES.map(tf => <option key={tf.value} value={tf.value}>{tf.label}</option>)}\n                      </select>\n                    </div>\n                    <div>\n                      <label className=\"text-[10px] text-[var(--text-dim)] mb-1 block font-semibold uppercase tracking-wider\">Balance ($)</label>\n                      <input type=\"number\" value={form.balance} onChange={(e) => setForm({ ...form, balance: e.target.value })} className=\"w-full\" />\n                    </div>\n                    <div>\n                      <label className=\"text-[10px] text-[var(--text-dim)] mb-1 block font-semibold uppercase tracking-wider\">Riesgo (%)</label>\n                      <input type=\"number\" value={form.riskPercent} onChange={(e) => setForm({ ...form, riskPercent: e.target.value })} className=\"w-full\" />\n                    </div>\n                  </div>\n                  {/* Trailing Stop */}\n                  <div className=\"bg-[var(--dark)] rounded-lg p-3 border border-[var(--border)]\">\n                    <div className=\"flex items-center justify-between mb-2\">\n                      <div>\n                        <p className=\"text-xs font-bold flex items-center gap-1\">üìê Trailing Stop</p>\n                        <p className=\"text-[10px] text-[var(--text-dim)]\">SL que se mueve protegiendo ganancias</p>\n                      </div>\n                      <button\n                        onClick={() => setForm({ ...form, trailingStop: !form.trailingStop })}\n                        className={`w-10 h-5 rounded-full transition-colors relative ${form.trailingStop ? 'bg-[var(--gold)]' : 'bg-[var(--dark-4)]'}`}\n                      >\n                        <div className={`w-4 h-4 bg-white rounded-full absolute top-0.5 transition-transform ${form.trailingStop ? 'left-5' : 'left-0.5'}`} />\n                      </button>\n                    </div>\n                    {form.trailingStop && (\n                      <div className=\"grid grid-cols-2 gap-3 mt-2\">\n                        <div>\n                          <label className=\"text-[10px] text-[var(--text-dim)] mb-1 block\">Trail Distance (%)</label>\n                          <input type=\"number\" step=\"0.1\" value={form.trailingStopPct} onChange={(e) => setForm({ ...form, trailingStopPct: e.target.value })} className=\"w-full\" />\n                        </div>\n                        <div>\n                          <label className=\"text-[10px] text-[var(--text-dim)] mb-1 block\">Activaci√≥n (%)</label>\n                          <input type=\"number\" step=\"0.1\" value={form.trailingActivation} onChange={(e) => setForm({ ...form, trailingActivation: e.target.value })} className=\"w-full\" />\n                        </div>\n                      </div>\n                    )}\n                  </div>\n\n                  {/* Strategy selector or create new */}\n                  <div>\n                    <label className=\"text-[10px] text-[var(--text-dim)] mb-1 block font-semibold uppercase tracking-wider\">Estrategia</label>\n                    <div className=\"flex gap-2\">\n                      <select value={form.scriptStrategyId} onChange={(e) => setForm({ ...form, scriptStrategyId: e.target.value })} className=\"flex-1\">\n                        <option value=\"\">Seleccionar estrategia...</option>\n                        {strategies.filter(s => s.type === 'custom_script').map(s => (\n                          <option key={s.id} value={s.id}>{s.name}</option>\n                        ))}\n                      </select>\n                      <button onClick={() => setShowStrategyEditor(true)}\n                        className=\"flex items-center gap-1.5 px-3 py-1.5 rounded-lg text-xs font-bold shrink-0\"\n                        style={{ background: 'rgba(168,85,247,0.1)', border: '1px solid rgba(168,85,247,0.2)', color: '#A855F7' }}>\n                        <Code2 size={13} /> {strategies.filter(s => s.type === 'custom_script').length > 0 ? 'Crear Nueva' : 'Crear Estrategia'}\n                      </button>\n                    </div>\n                  </div>\n                </div>\n              )}\n\n              {/* Grid bot fields */}\n              {botType === 'grid' && (\n                <div className=\"grid grid-cols-2 gap-4\">\n                  <div>\n                    <label className=\"text-[10px] text-[var(--text-dim)] mb-1 block font-semibold uppercase tracking-wider\">Precio Superior ($)</label>\n                    <input type=\"number\" value={form.upperPrice} onChange={(e) => setForm({ ...form, upperPrice: e.target.value })} placeholder=\"100000\" className=\"w-full\" />\n                  </div>\n                  <div>\n                    <label className=\"text-[10px] text-[var(--text-dim)] mb-1 block font-semibold uppercase tracking-wider\">Precio Inferior ($)</label>\n                    <input type=\"number\" value={form.lowerPrice} onChange={(e) => setForm({ ...form, lowerPrice: e.target.value })} placeholder=\"90000\" className=\"w-full\" />\n                  </div>\n                  <div>\n                    <label className=\"text-[10px] text-[var(--text-dim)] mb-1 block font-semibold uppercase tracking-wider\">Niveles de Grid</label>\n                    <input type=\"number\" value={form.gridLines} onChange={(e) => setForm({ ...form, gridLines: e.target.value })} className=\"w-full\" />\n                  </div>\n                  <div>\n                    <label className=\"text-[10px] text-[var(--text-dim)] mb-1 block font-semibold uppercase tracking-wider\">Inversi√≥n Total ($)</label>\n                    <input type=\"number\" value={form.balance} onChange={(e) => setForm({ ...form, balance: e.target.value })} className=\"w-full\" />\n                  </div>\n                </div>\n              )}\n\n              {/* DCA bot fields */}\n              {botType === 'dca' && (\n                <>\n                  <div className=\"grid grid-cols-3 gap-4\">\n                    <div>\n                      <label className=\"text-[10px] text-[var(--text-dim)] mb-1 block font-semibold uppercase tracking-wider\">$ por Compra</label>\n                      <input type=\"number\" value={form.investmentPerOrder} onChange={(e) => setForm({ ...form, investmentPerOrder: e.target.value })} className=\"w-full\" />\n                    </div>\n                    <div>\n                      <label className=\"text-[10px] text-[var(--text-dim)] mb-1 block font-semibold uppercase tracking-wider\">Intervalo (min)</label>\n                      <input type=\"number\" value={form.intervalMinutes} onChange={(e) => setForm({ ...form, intervalMinutes: e.target.value })} className=\"w-full\" />\n                    </div>\n                    <div>\n                      <label className=\"text-[10px] text-[var(--text-dim)] mb-1 block font-semibold uppercase tracking-wider\">M√°x. Compras</label>\n                      <input type=\"number\" value={form.maxOrders} onChange={(e) => setForm({ ...form, maxOrders: e.target.value })} className=\"w-full\" />\n                    </div>\n                  </div>\n                  <div className=\"flex flex-wrap gap-4\">\n                    <label className=\"flex items-center gap-2 text-xs text-[var(--text-secondary)] cursor-pointer\">\n                      <input type=\"checkbox\" checked={form.useRsiFilter} onChange={(e) => setForm({ ...form, useRsiFilter: e.target.checked })}\n                        className=\"w-4 h-4 rounded accent-[var(--gold)]\" />\n                      Filtro RSI (comprar solo si RSI &lt; {form.rsiThreshold})\n                    </label>\n                    <label className=\"flex items-center gap-2 text-xs text-[var(--text-secondary)] cursor-pointer\">\n                      <input type=\"checkbox\" checked={form.usePriceDipFilter} onChange={(e) => setForm({ ...form, usePriceDipFilter: e.target.checked })}\n                        className=\"w-4 h-4 rounded accent-[var(--gold)]\" />\n                      Filtro de Ca√≠da (comprar cuando baje {form.dipPercent}%)\n                    </label>\n                  </div>\n                </>\n              )}\n\n              {/* Broker selector ‚Äî real execution */}\n              {brokers.filter(b => b.connected).length > 0 && (\n                <div>\n                  <label className=\"text-[10px] text-[var(--text-dim)] mb-1 block font-semibold uppercase tracking-wider\">Broker (ejecuci√≥n real)</label>\n                  <select value={form.brokerId} onChange={(e) => setForm({ ...form, brokerId: e.target.value })} className=\"w-full\">\n                    <option value=\"\">Demo (sin broker)</option>\n                    {brokers.filter(b => b.connected).map(b => (\n                      <option key={b.id} value={b.id}>üü¢ {b.name || b.broker} ‚Äî Real</option>\n                    ))}\n                  </select>\n                  {form.brokerId && (\n                    <p className=\"text-[10px] text-[var(--red)] mt-1 font-semibold\">‚ö†Ô∏è Este bot ejecutar√° √≥rdenes REALES con dinero real</p>\n                  )}\n                </div>\n              )}\n\n              {createError && (\n                <p className=\"text-xs text-[var(--red)] font-semibold px-1\">‚ö†Ô∏è {createError}</p>\n              )}\n              <div className=\"flex gap-2\">\n                <button onClick={handleCreate} className=\"flex-1 py-2.5 btn-gold rounded-xl text-sm font-bold text-center justify-center\">Crear Bot</button>\n                <button onClick={() => { setShowCreate(false); setCreateError(''); }} className=\"px-4 py-2.5 bg-[var(--surface-2)] text-[var(--text-dim)] rounded-xl text-sm border border-[var(--border)] text-center shrink-0\">Cancelar</button>\n              </div>\n            </div>\n          </motion.div>\n        )}\n      </AnimatePresence>\n\n      {/* Bot list */}\n      {bots.length === 0 ? (\n        <div className=\"rounded-2xl p-16 text-center\" style={{ background: 'var(--surface)', border: '1px solid var(--border)' }}>\n          <Bot size={56} className=\"text-[var(--text-dim)]/20 mx-auto mb-5\" />\n          <p className=\"text-lg text-[var(--text-dim)] font-semibold\">No hay bots creados</p>\n          <p className=\"text-sm text-[var(--text-dim)] mt-2\">Crea tu primer bot para automatizar tu trading</p>\n          <button onClick={() => setShowCreate(true)} className=\"mt-5 px-6 py-3 btn-gold rounded-xl text-sm font-bold inline-flex items-center gap-2\">\n            <Plus size={16} /> Crear Bot\n          </button>\n        </div>\n      ) : (\n        <div className=\"space-y-4\">\n          {bots.map(bot => {\n            const typeInfo = getTypeInfo(bot.botType || 'signal');\n            const TypeIcon = typeInfo.icon;\n            const broker = getBrokerForBot(bot);\n            const balanceData = bot.brokerId ? getBrokerBalance(bot.brokerId) : null;\n            const strategyName = bot.scriptName || bot.strategy?.name || 'Default';\n\n            return (\n              <motion.div key={bot.id} layout className=\"rounded-2xl overflow-hidden min-w-0\"\n                style={{ background: 'var(--surface)', border: `1px solid ${bot.status === 'active' ? 'rgba(0,220,130,0.2)' : 'var(--border)'}` }}>\n\n                {/* Bot header ‚Äî clickable to go to chart */}\n                <div className=\"p-5 cursor-pointer hover:bg-white/[0.02] transition-colors\"\n                  onClick={() => goToChart(bot)}>\n                  <div className=\"flex items-center justify-between gap-3 mb-4\">\n                    <div className=\"flex items-center gap-4 min-w-0 flex-1\">\n                      <div className=\"w-12 h-12 rounded-xl flex items-center justify-center shrink-0\"\n                        style={{ background: `${typeInfo.color}12`, border: `1px solid ${typeInfo.color}25` }}>\n                        <TypeIcon size={24} style={{ color: typeInfo.color }} />\n                      </div>\n                      <div className=\"min-w-0 flex-1\">\n                        <div className=\"flex items-center gap-2.5 flex-wrap\">\n                          <p className=\"text-base font-bold truncate\">{bot.name}</p>\n                          <span className=\"text-[10px] font-bold px-2 py-0.5 rounded-lg uppercase tracking-wider shrink-0\"\n                            style={{ background: `${typeInfo.color}15`, color: typeInfo.color }}>\n                            {typeInfo.label}\n                          </span>\n                        </div>\n                        <div className=\"flex items-center gap-2 mt-1 text-sm text-[var(--text-dim)] flex-wrap\">\n                          <span className=\"font-semibold text-[var(--text-secondary)]\">{formatPair(bot.pair)}</span>\n                          {bot.timeframe && <span>‚Ä¢ {bot.timeframe}</span>}\n                          <span>‚Ä¢ {strategyName}</span>\n                        </div>\n                      </div>\n                    </div>\n                    <div className=\"flex items-center gap-3 shrink-0\">\n                      <span className=\"px-3 py-1.5 rounded-lg text-xs font-bold whitespace-nowrap\"\n                        style={{ color: getStatusColor(bot.status), background: `${getStatusColor(bot.status)}15`, border: `1px solid ${getStatusColor(bot.status)}20` }}>\n                        {bot.status === 'active' ? '‚óè Activo' : bot.status === 'paused' ? '‚ùö‚ùö Pausado' : '‚ñ† Detenido'}\n                      </span>\n                      <ArrowRight size={16} className=\"text-[var(--text-dim)]\" />\n                    </div>\n                  </div>\n\n                  {/* Broker + Balance info */}\n                  <div className=\"flex items-center gap-3 flex-wrap\">\n                    {broker ? (\n                      <div className=\"flex items-center gap-2 px-3 py-2 rounded-lg text-xs\" style={{ background: 'var(--surface-2)', border: '1px solid var(--border)' }}>\n                        <Link2 size={13} className=\"text-[var(--green)] shrink-0\" />\n                        <span className=\"font-semibold text-[var(--text)]\">{broker.label || broker.name || broker.broker}</span>\n                        <span className=\"text-[var(--green)] font-bold\">‚Ä¢ Conectado</span>\n                      </div>\n                    ) : (\n                      <div className=\"flex items-center gap-2 px-3 py-2 rounded-lg text-xs\" style={{ background: 'var(--surface-2)', border: '1px solid var(--border)' }}>\n                        <span className=\"text-[var(--text-dim)]\">üìã Modo Demo</span>\n                      </div>\n                    )}\n                    {balanceData && balanceData.balances.length > 0 && (\n                      <div className=\"flex items-center gap-2 px-3 py-2 rounded-lg text-xs\" style={{ background: 'var(--surface-2)', border: '1px solid var(--border)' }}>\n                        <DollarSign size={13} className=\"text-[var(--gold)] shrink-0\" />\n                        <span className=\"font-semibold text-[var(--text)]\">\n                          Saldo: {balanceData.balances.slice(0, 3).map(b => `${parseFloat(b.free).toFixed(4)} ${b.asset}`).join(' ‚Ä¢ ')}\n                        </span>\n                      </div>\n                    )}\n                  </div>\n                </div>\n\n                {/* Stats row */}\n                {/* Stats row ‚Äî with LIVE unrealized P&L */}\n                {(() => {\n                  const live = livePnL[bot.id];\n                  const closedPnl = parseFloat(bot.pnl) || 0;\n                  const unrealized = live?.unrealizedPnl || 0;\n                  const totalPnl = closedPnl + unrealized;\n                  const pnlPct = live?.pnlPercent || 0;\n                  const initial = parseFloat(bot.balance) || 0;\n                  const currentBal = initial + totalPnl;\n                  const isUp = totalPnl >= 0;\n                  const hasPosition = !!live?.position;\n                  return (\n                <div className=\"grid grid-cols-2 gap-px\" style={{ background: 'var(--border)', borderTop: '1px solid var(--border)' }}>\n                  <div className=\"p-3 sm:p-3.5 text-center\" style={{ background: 'var(--surface)' }}>\n                    <p className=\"text-[10px] sm:text-xs text-[var(--text-dim)] mb-1\">Trades</p>\n                    <p className=\"text-base sm:text-lg font-bold\">{bot.trades || 0}</p>\n                  </div>\n                  <div className=\"p-3 sm:p-3.5 text-center\" style={{ background: 'var(--surface)' }}>\n                    <p className=\"text-[10px] sm:text-xs text-[var(--text-dim)] mb-1\">\n                      {hasPosition ? 'üìä P&L Vivo' : 'P&L'}\n                    </p>\n                    <p className={`text-base sm:text-lg font-bold ${isUp ? 'text-[var(--green)]' : 'text-[var(--red)]'}`}>\n                      {isUp ? '+' : ''}${totalPnl.toFixed(2)}\n                    </p>\n                    {hasPosition && (\n                      <p className={`text-[10px] font-bold ${pnlPct >= 0 ? 'text-[var(--green)]' : 'text-[var(--red)]'}`}>\n                        {pnlPct >= 0 ? '+' : ''}{pnlPct.toFixed(2)}%\n                      </p>\n                    )}\n                  </div>\n                  <div className=\"p-3 sm:p-3.5 text-center\" style={{ background: 'var(--surface)' }}>\n                    <p className=\"text-[10px] sm:text-xs text-[var(--text-dim)] mb-1\">Win Rate</p>\n                    <p className=\"text-base sm:text-lg font-bold text-[var(--gold)]\">{(bot.winRate || 0).toFixed(0)}%</p>\n                  </div>\n                  <div className=\"p-3 sm:p-3.5 text-center\" style={{ background: 'var(--surface)' }}>\n                    <p className=\"text-[10px] sm:text-xs text-[var(--text-dim)] mb-1\">Balance</p>\n                    <div>\n                      <p className={`text-base sm:text-lg font-bold ${currentBal >= initial ? 'text-[var(--green)]' : 'text-[var(--red)]'}`}>\n                        ${currentBal.toFixed(2)}\n                      </p>\n                      <p className=\"text-[10px] text-[var(--text-dim)]\">\n                        Inicio: ${initial.toFixed(2)}\n                      </p>\n                    </div>\n                  </div>\n                </div>\n                  );\n                })()}\n\n                {/* Action buttons ‚Äî bigger */}\n                <div className=\"flex gap-2 sm:gap-3 p-3 sm:p-4 flex-wrap items-center\" style={{ borderTop: '1px solid var(--border)' }}>\n                  {bot.status !== 'active' ? (\n                    <button onClick={(e) => { e.stopPropagation(); handleStart(bot); }}\n                      className=\"inline-flex items-center justify-center gap-2 px-5 py-2.5 bg-[var(--green)]/10 text-[var(--green)] rounded-xl text-sm font-bold hover:bg-[var(--green)]/20 transition-colors border border-[var(--green)]/20\">\n                      <Play size={15} className=\"shrink-0\" /> Iniciar\n                    </button>\n                  ) : (\n                    <button onClick={(e) => { e.stopPropagation(); handlePause(bot); }}\n                      className=\"inline-flex items-center justify-center gap-2 px-5 py-2.5 bg-[var(--gold)]/10 text-[var(--gold)] rounded-xl text-sm font-bold hover:bg-[var(--gold)]/20 transition-colors border border-[var(--gold)]/20\">\n                      <Pause size={15} className=\"shrink-0\" /> Pausar\n                    </button>\n                  )}\n                  <button onClick={(e) => { e.stopPropagation(); handleStop(bot); }}\n                    className=\"inline-flex items-center justify-center gap-2 px-5 py-2.5 text-[var(--text-dim)] rounded-xl text-sm hover:text-[var(--text)] transition-colors\"\n                    style={{ background: 'var(--surface-2)', border: '1px solid var(--border)' }}>\n                    <Square size={15} className=\"shrink-0\" /> Detener\n                  </button>\n                  <button onClick={(e) => { e.stopPropagation(); goToChart(bot); }}\n                    className=\"inline-flex items-center justify-center gap-2 px-5 py-2.5 text-[var(--gold)] rounded-xl text-sm font-semibold hover:bg-[var(--gold)]/10 transition-colors\"\n                    style={{ background: 'var(--surface-2)', border: '1px solid var(--gold)/20' }}>\n                    <BarChart3 size={15} className=\"shrink-0\" /> Ver Gr√°fico\n                  </button>\n                  <button onClick={(e) => { e.stopPropagation(); handleDelete(bot); }}\n                    className=\"ml-auto inline-flex items-center justify-center gap-1.5 px-4 py-2.5 text-[var(--text-dim)] hover:text-[var(--red)] hover:bg-[var(--red)]/10 rounded-xl text-sm transition-colors\">\n                    <Trash2 size={14} className=\"shrink-0\" /> Eliminar\n                  </button>\n                </div>\n              </motion.div>\n            );\n          })}\n        </div>\n      )}\n\n      {/* Live logs ‚Äî collapsible */}\n      {logs.length > 0 && (\n        <div className=\"rounded-2xl overflow-hidden\" style={{ background: 'var(--surface)', border: '1px solid var(--border)' }}>\n          <button\n            onClick={() => setShowLiveActivity(prev => !prev)}\n            className=\"w-full flex items-center justify-between p-4 cursor-pointer hover:bg-[var(--gold)]/5 transition-colors\"\n            style={{ borderBottom: showLiveActivity ? '1px solid var(--border)' : 'none' }}\n          >\n            <h3 className=\"text-base font-bold flex items-center gap-2\">\n              <div className=\"w-2.5 h-2.5 rounded-full bg-[var(--green)] animate-pulse\" />\n              Actividad en Vivo\n              <span className=\"text-xs font-normal text-[var(--text-dim)] ml-1\">({logs.length})</span>\n            </h3>\n            <div className=\"flex items-center gap-2\">\n              {showLiveActivity && (\n                <span onClick={(e) => { e.stopPropagation(); setLogs([]); }} className=\"text-sm text-[var(--text-dim)] hover:text-[var(--gold)] transition-colors px-3 py-1 rounded-lg hover:bg-[var(--gold)]/10\">Limpiar</span>\n              )}\n              <ChevronDown\n                size={18}\n                className=\"text-[var(--text-dim)] transition-transform duration-300\"\n                style={{ transform: showLiveActivity ? 'rotate(180deg)' : 'rotate(0deg)' }}\n              />\n            </div>\n          </button>\n          <AnimatePresence initial={false}>\n            {showLiveActivity && (\n              <motion.div\n                initial={{ height: 0, opacity: 0 }}\n                animate={{ height: 'auto', opacity: 1 }}\n                exit={{ height: 0, opacity: 0 }}\n                transition={{ duration: 0.25, ease: 'easeInOut' }}\n                className=\"overflow-hidden\"\n              >\n                <div className=\"max-h-56 overflow-y-auto p-4 space-y-1.5 font-mono text-xs\">\n                  {logs.slice(-50).reverse().map((log, i) => (\n                    <div key={i} className=\"flex items-start gap-2 py-0.5\">\n                      <span className=\"text-[var(--text-dim)] shrink-0\">{log.time}</span>\n                      <span className=\"text-[var(--gold)] shrink-0 font-semibold\">[{log.bot}]</span>\n                      <span className=\"text-[var(--text-secondary)]\">{log.message || `${log.side?.toUpperCase()} ${log.quantity} @ $${log.price}`}</span>\n                    </div>\n                  ))}\n                </div>\n              </motion.div>\n            )}\n          </AnimatePresence>\n        </div>\n      )}\n\n      {/* Mis Estrategias Custom */}\n      {strategies.filter(s => s.type === 'custom_script').length > 0 && (\n        <div className=\"space-y-4\">\n          <div className=\"flex items-center justify-between gap-3\">\n            <h2 className=\"text-base font-bold flex items-center gap-2.5 min-w-0\">\n              <Code2 size={18} className=\"text-[#A855F7] shrink-0\" /> Mis Estrategias\n            </h2>\n            <button onClick={() => setShowStrategyEditor(true)}\n              className=\"text-sm text-[var(--text-dim)] hover:text-[#A855F7] transition-colors flex items-center gap-1.5 shrink-0 px-3 py-1.5 rounded-xl hover:bg-[#A855F7]/10\">\n              <Plus size={14} /> Nueva\n            </button>\n          </div>\n          <div className=\"grid grid-cols-1 sm:grid-cols-2 gap-3\">\n            {strategies.filter(s => s.type === 'custom_script').map(s => (\n              <div key={s.id} className=\"rounded-xl p-4 transition-colors hover:bg-[var(--dark-3)] min-w-0\"\n                style={{ background: 'var(--surface)', border: '1px solid var(--border)' }}>\n                <div className=\"flex items-center justify-between mb-2 gap-2\">\n                  <span className=\"text-sm font-bold text-[var(--text)] flex items-center gap-2 min-w-0 truncate\">\n                    <Code2 size={14} className=\"text-[#A855F7] shrink-0\" /> <span className=\"truncate\">{s.name}</span>\n                  </span>\n                  <button onClick={() => { setEditingStrategy(s); setShowStrategyEditor(true); }}\n                    className=\"text-[var(--text-dim)] hover:text-[#A855F7] transition-colors shrink-0 p-1.5 rounded-lg hover:bg-[#A855F7]/10\">\n                    <Edit3 size={14} />\n                  </button>\n                </div>\n                <p className=\"text-xs text-[var(--text-dim)] truncate\">\n                  {s.code?.split('\\n').filter(l => l.trim() && !l.trim().startsWith('//')).length || 0} l√≠neas de l√≥gica\n                </p>\n                <p className=\"text-[11px] text-[var(--text-dim)] mt-1.5 truncate\">\n                  Creada: {new Date(s.createdAt).toLocaleDateString('es')}\n                </p>\n              </div>\n            ))}\n          </div>\n        </div>\n      )}\n\n      {/* Strategy Editor Modal */}\n      <AnimatePresence>\n        {showStrategyEditor && (\n          <motion.div initial={{ opacity: 0 }} animate={{ opacity: 1 }} exit={{ opacity: 0 }}\n            className=\"fixed inset-0 z-50 flex items-center justify-center p-4\"\n            style={{ background: 'rgba(0,0,0,0.7)', backdropFilter: 'blur(8px)' }}\n            onClick={() => { setShowStrategyEditor(false); setEditingStrategy(null); }}>\n            <motion.div initial={{ scale: 0.95, opacity: 0 }} animate={{ scale: 1, opacity: 1 }} exit={{ scale: 0.95, opacity: 0 }}\n              className=\"w-full max-w-2xl max-h-[90vh] overflow-y-auto\"\n              onClick={(e) => e.stopPropagation()}>\n              <StrategyEditor\n                initialCode={editingStrategy?.code}\n                initialName={editingStrategy?.name}\n                editMode={!!editingStrategy}\n                onClose={() => { setShowStrategyEditor(false); setEditingStrategy(null); }}\n                onSave={(strategy) => {\n                  const saved = addStrategy(strategy);\n                  setForm(prev => ({ ...prev, scriptStrategyId: saved.id }));\n                  setShowStrategyEditor(false);\n                  setEditingStrategy(null);\n                }}\n              />\n            </motion.div>\n          </motion.div>\n        )}\n      </AnimatePresence>\n    </div>\n  );\n}\n"],"names":["GridBotEngine","config","pair","upperPrice","lowerPrice","gridLines","investment","onLog","onTrade","priceStep","levels","i","investmentPerGrid","state","checkPrice","currentPrice","marketData","prevPrice","level","buyCount","order","qty","feeService","sellLevel","rawProfit","sellFee","profit","rebuyLevel","err","interval","botId","o","gridBotEngine","DCABotEngine","investmentPerOrder","intervalMinutes","maxOrders","useRsiFilter","rsiPeriod","rsiThreshold","usePriceDipFilter","dipPercent","executeBuy","closes","c","rsi","calculateRSI","currentRSI","dropPercent","quantity","unrealizedPnl","dcaBotEngine","BOT_TYPES","Zap","Code2","Grid3x3","DollarSign","BotManager","bots","addBot","updateBot","removeBot","strategies","addStrategy","brokers","setPage","setSelectedPair","useStore","showCreate","setShowCreate","useState","showStrategyEditor","setShowStrategyEditor","editingStrategy","setEditingStrategy","botType","setBotType","logs","setLogs","showLiveActivity","setShowLiveActivity","createError","setCreateError","brokerBalances","setBrokerBalances","livePnL","setLivePnL","form","setForm","fetchBrokerBalances","useCallback","broker","b","_a","brokerService","result","balArr","prev","useEffect","tick","activeBots","updates","bot","live","tradingEngine","activeBotsList","trade","addTrade","msg","addLog","type","allLogs","l","getBrokerForBot","getBrokerBalance","brokerId","goToChart","handleCreate","botName","botData","strategy","s","customStrategy","current","trades","pnl","winRate","totalClosed","totalWins","handleStart","handleStop","handlePause","handleDelete","getStatusColor","status","getTypeInfo","t","jsxs","jsx","Plus","AnimatePresence","motion","Icon","e","POPULAR_PAIRS","p","formatPair","TIMEFRAMES","tf","Fragment","Bot","typeInfo","TypeIcon","balanceData","strategyName","ArrowRight","Link2","closedPnl","unrealized","totalPnl","pnlPct","initial","currentBal","isUp","hasPosition","Play","Pause","Square","BarChart3","Trash2","ChevronDown","log","Edit3","StrategyEditor","saved"],"mappings":"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"}