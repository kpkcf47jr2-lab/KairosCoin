{"version":3,"file":"PortfolioAnalytics-DaCAoNGo.js","sources":["../../src/components/Portfolio/PortfolioAnalytics.jsx"],"sourcesContent":["// Kairos Trade — Portfolio Analytics (Elite Dashboard)\n// Equity curve, P&L stats, drawdown, win rate, Sharpe ratio\nimport { useState, useMemo, useEffect, useRef } from 'react';\nimport { motion } from 'framer-motion';\nimport {\n  TrendingUp, TrendingDown, BarChart3, Activity, Target, Shield,\n  Calendar, DollarSign, Percent, Award, AlertTriangle, ArrowUpRight,\n  ArrowDownRight, Clock, Zap, Filter\n} from 'lucide-react';\nimport useStore from '../../store/useStore';\nimport { tradingEngine } from '../../services/tradingEngine';\n\n// ─── Mini sparkline component ───\nfunction Sparkline({ data, color = '#D4AF37', height = 40, width = 120 }) {\n  if (!data || data.length < 2) return null;\n  const min = Math.min(...data);\n  const max = Math.max(...data);\n  const range = max - min || 1;\n  const points = data.map((v, i) => {\n    const x = (i / (data.length - 1)) * width;\n    const y = height - ((v - min) / range) * (height - 4) - 2;\n    return `${x},${y}`;\n  }).join(' ');\n  return (\n    <svg width={width} height={height} className=\"shrink-0\">\n      <polyline fill=\"none\" stroke={color} strokeWidth=\"1.5\" points={points} />\n    </svg>\n  );\n}\n\n// ─── Equity chart (canvas) ───\nfunction EquityChart({ trades, height = 280 }) {\n  const canvasRef = useRef(null);\n\n  useEffect(() => {\n    const canvas = canvasRef.current;\n    if (!canvas || trades.length < 1) return;\n    const ctx = canvas.getContext('2d');\n    const dpr = window.devicePixelRatio || 1;\n    const rect = canvas.getBoundingClientRect();\n    canvas.width = rect.width * dpr;\n    canvas.height = rect.height * dpr;\n    ctx.scale(dpr, dpr);\n    const W = rect.width;\n    const H = rect.height;\n\n    // Build equity curve\n    const startBalance = 1000; // Normalized\n    let equity = startBalance;\n    const points = [{ x: 0, y: startBalance }];\n    let maxEquity = startBalance;\n    const drawdowns = [0];\n\n    trades.forEach((t, i) => {\n      equity += (t.pnl || 0);\n      maxEquity = Math.max(maxEquity, equity);\n      const dd = maxEquity > 0 ? ((maxEquity - equity) / maxEquity) * 100 : 0;\n      drawdowns.push(dd);\n      points.push({ x: i + 1, y: equity });\n    });\n\n    const minY = Math.min(...points.map(p => p.y));\n    const maxY = Math.max(...points.map(p => p.y));\n    const rangeY = maxY - minY || 1;\n    const pad = { top: 20, bottom: 40, left: 60, right: 20 };\n    const chartW = W - pad.left - pad.right;\n    const chartH = H - pad.top - pad.bottom;\n\n    // Clear\n    ctx.clearRect(0, 0, W, H);\n\n    // Grid lines\n    ctx.strokeStyle = 'rgba(255,255,255,0.04)';\n    ctx.lineWidth = 1;\n    for (let i = 0; i <= 4; i++) {\n      const y = pad.top + (chartH / 4) * i;\n      ctx.beginPath();\n      ctx.moveTo(pad.left, y);\n      ctx.lineTo(W - pad.right, y);\n      ctx.stroke();\n      // Labels\n      ctx.fillStyle = 'rgba(255,255,255,0.3)';\n      ctx.font = '10px Inter, sans-serif';\n      ctx.textAlign = 'right';\n      const val = maxY - (rangeY / 4) * i;\n      ctx.fillText(`$${val.toFixed(0)}`, pad.left - 8, y + 3);\n    }\n\n    // Drawdown fill (bottom area)\n    if (drawdowns.length > 1) {\n      const maxDD = Math.max(...drawdowns) || 1;\n      ctx.fillStyle = 'rgba(234,57,67,0.08)';\n      ctx.beginPath();\n      ctx.moveTo(pad.left, H - pad.bottom);\n      drawdowns.forEach((dd, i) => {\n        const x = pad.left + (i / Math.max(drawdowns.length - 1, 1)) * chartW;\n        const y = H - pad.bottom - (dd / Math.max(maxDD, 1)) * (chartH * 0.3);\n        ctx.lineTo(x, y);\n      });\n      ctx.lineTo(pad.left + chartW, H - pad.bottom);\n      ctx.closePath();\n      ctx.fill();\n    }\n\n    // Equity line\n    ctx.strokeStyle = '#D4AF37';\n    ctx.lineWidth = 2;\n    ctx.beginPath();\n    points.forEach((p, i) => {\n      const x = pad.left + (p.x / Math.max(points.length - 1, 1)) * chartW;\n      const y = pad.top + (1 - (p.y - minY) / rangeY) * chartH;\n      if (i === 0) ctx.moveTo(x, y);\n      else ctx.lineTo(x, y);\n    });\n    ctx.stroke();\n\n    // Gradient fill under line\n    const gradient = ctx.createLinearGradient(0, pad.top, 0, H - pad.bottom);\n    gradient.addColorStop(0, 'rgba(212,175,55,0.15)');\n    gradient.addColorStop(1, 'rgba(212,175,55,0)');\n    ctx.fillStyle = gradient;\n    ctx.beginPath();\n    points.forEach((p, i) => {\n      const x = pad.left + (p.x / Math.max(points.length - 1, 1)) * chartW;\n      const y = pad.top + (1 - (p.y - minY) / rangeY) * chartH;\n      if (i === 0) ctx.moveTo(x, y);\n      else ctx.lineTo(x, y);\n    });\n    ctx.lineTo(pad.left + chartW, H - pad.bottom);\n    ctx.lineTo(pad.left, H - pad.bottom);\n    ctx.closePath();\n    ctx.fill();\n\n    // Dots on significant points\n    const last = points[points.length - 1];\n    const lx = pad.left + (last.x / Math.max(points.length - 1, 1)) * chartW;\n    const ly = pad.top + (1 - (last.y - minY) / rangeY) * chartH;\n    ctx.fillStyle = '#D4AF37';\n    ctx.beginPath();\n    ctx.arc(lx, ly, 4, 0, Math.PI * 2);\n    ctx.fill();\n\n    // X-axis labels\n    ctx.fillStyle = 'rgba(255,255,255,0.3)';\n    ctx.font = '10px Inter, sans-serif';\n    ctx.textAlign = 'center';\n    const step = Math.max(1, Math.floor(trades.length / 6));\n    for (let i = 0; i < trades.length; i += step) {\n      const x = pad.left + ((i + 1) / Math.max(points.length - 1, 1)) * chartW;\n      const d = new Date(trades[i].closedAt || trades[i].time);\n      ctx.fillText(d.toLocaleDateString('es', { day: '2-digit', month: 'short' }), x, H - pad.bottom + 16);\n    }\n  }, [trades, height]);\n\n  return (\n    <canvas\n      ref={canvasRef}\n      style={{ width: '100%', height }}\n      className=\"rounded-xl\"\n    />\n  );\n}\n\n// ─── Distribution bar ───\nfunction DistributionBar({ wins, losses, neutral }) {\n  const total = wins + losses + neutral || 1;\n  return (\n    <div className=\"flex h-2 rounded-full overflow-hidden bg-[var(--dark-4)]\">\n      <div style={{ width: `${(wins / total) * 100}%` }} className=\"bg-emerald-500\" />\n      <div style={{ width: `${(neutral / total) * 100}%` }} className=\"bg-yellow-500/50\" />\n      <div style={{ width: `${(losses / total) * 100}%` }} className=\"bg-red-500\" />\n    </div>\n  );\n}\n\nexport default function PortfolioAnalytics() {\n  const { tradeHistory, bots, brokers } = useStore();\n  const [timeFilter, setTimeFilter] = useState('all');\n  const [botFilter, setBotFilter] = useState('all');\n\n  // Get ALL trades from store + active bots\n  const allTrades = useMemo(() => {\n    let trades = [...(tradeHistory || [])];\n    // Add any trades from trading engine logs\n    return trades.sort((a, b) => {\n      const tA = new Date(a.closedAt || a.time || 0).getTime();\n      const tB = new Date(b.closedAt || b.time || 0).getTime();\n      return tA - tB;\n    });\n  }, [tradeHistory]);\n\n  // Filter trades by time\n  const filteredTrades = useMemo(() => {\n    let trades = allTrades;\n    if (botFilter !== 'all') {\n      trades = trades.filter(t => t.botId === botFilter || t.botName === botFilter);\n    }\n    if (timeFilter === 'today') {\n      const today = new Date().setHours(0, 0, 0, 0);\n      trades = trades.filter(t => new Date(t.closedAt || t.time).getTime() >= today);\n    } else if (timeFilter === '7d') {\n      const week = Date.now() - 7 * 86400000;\n      trades = trades.filter(t => new Date(t.closedAt || t.time).getTime() >= week);\n    } else if (timeFilter === '30d') {\n      const month = Date.now() - 30 * 86400000;\n      trades = trades.filter(t => new Date(t.closedAt || t.time).getTime() >= month);\n    }\n    return trades;\n  }, [allTrades, timeFilter, botFilter]);\n\n  // Compute analytics\n  const stats = useMemo(() => {\n    const trades = filteredTrades;\n    if (trades.length === 0) return null;\n\n    const wins = trades.filter(t => (t.pnl || 0) > 0);\n    const losses = trades.filter(t => (t.pnl || 0) < 0);\n    const neutral = trades.filter(t => (t.pnl || 0) === 0);\n\n    const totalPnl = trades.reduce((s, t) => s + (t.pnl || 0), 0);\n    const totalWinPnl = wins.reduce((s, t) => s + t.pnl, 0);\n    const totalLossPnl = losses.reduce((s, t) => s + Math.abs(t.pnl), 0);\n    const avgWin = wins.length > 0 ? totalWinPnl / wins.length : 0;\n    const avgLoss = losses.length > 0 ? totalLossPnl / losses.length : 0;\n    const winRate = (wins.length / trades.length) * 100;\n    const profitFactor = totalLossPnl > 0 ? totalWinPnl / totalLossPnl : totalWinPnl > 0 ? Infinity : 0;\n\n    // Max drawdown\n    let peak = 0;\n    let maxDD = 0;\n    let equity = 0;\n    const equityCurve = [];\n    trades.forEach(t => {\n      equity += (t.pnl || 0);\n      equityCurve.push(equity);\n      peak = Math.max(peak, equity);\n      const dd = peak > 0 ? ((peak - equity) / peak) * 100 : 0;\n      maxDD = Math.max(maxDD, dd);\n    });\n\n    // Sharpe Ratio (simplified — annualized if daily PnL data)\n    const returns = trades.map(t => t.pnl || 0);\n    const avgReturn = returns.reduce((a, b) => a + b, 0) / returns.length;\n    const variance = returns.reduce((s, r) => s + (r - avgReturn) ** 2, 0) / returns.length;\n    const stdDev = Math.sqrt(variance);\n    const sharpeRatio = stdDev > 0 ? (avgReturn / stdDev) * Math.sqrt(252) : 0;\n\n    // Best/worst trade\n    const bestTrade = trades.reduce((best, t) => (t.pnl || 0) > (best.pnl || 0) ? t : best, trades[0]);\n    const worstTrade = trades.reduce((worst, t) => (t.pnl || 0) < (worst.pnl || 0) ? t : worst, trades[0]);\n\n    // Consecutive wins/losses\n    let maxConsecWins = 0, maxConsecLosses = 0, curWins = 0, curLosses = 0;\n    trades.forEach(t => {\n      if (t.pnl > 0) { curWins++; curLosses = 0; maxConsecWins = Math.max(maxConsecWins, curWins); }\n      else if (t.pnl < 0) { curLosses++; curWins = 0; maxConsecLosses = Math.max(maxConsecLosses, curLosses); }\n    });\n\n    // Avg hold time\n    const avgHoldTime = trades.reduce((s, t) => {\n      if (t.closedAt && t.time) {\n        return s + (new Date(t.closedAt).getTime() - new Date(t.time).getTime());\n      }\n      return s;\n    }, 0) / Math.max(trades.length, 1);\n\n    // Daily PnL for chart\n    const dailyPnl = {};\n    trades.forEach(t => {\n      const d = new Date(t.closedAt || t.time).toLocaleDateString();\n      dailyPnl[d] = (dailyPnl[d] || 0) + (t.pnl || 0);\n    });\n\n    // Risk/Reward ratio\n    const riskReward = avgLoss > 0 ? avgWin / avgLoss : avgWin > 0 ? Infinity : 0;\n\n    // Expectancy\n    const expectancy = (winRate / 100 * avgWin) - ((1 - winRate / 100) * avgLoss);\n\n    return {\n      totalTrades: trades.length,\n      wins: wins.length,\n      losses: losses.length,\n      neutral: neutral.length,\n      totalPnl,\n      winRate,\n      avgWin,\n      avgLoss,\n      profitFactor,\n      maxDrawdown: maxDD,\n      sharpeRatio,\n      bestTrade,\n      worstTrade,\n      maxConsecWins,\n      maxConsecLosses,\n      equityCurve,\n      avgHoldTime,\n      dailyPnl,\n      riskReward,\n      expectancy,\n    };\n  }, [filteredTrades]);\n\n  // Stat card subcomponent\n  const StatCard = ({ icon: Icon, label, value, subtitle, color = 'var(--gold)', small = false }) => (\n    <div className=\"bg-[var(--dark-2)] border border-[var(--border)] rounded-xl p-3 flex flex-col gap-1\">\n      <div className=\"flex items-center gap-2 text-[var(--text-dim)]\">\n        <Icon size={14} style={{ color }} />\n        <span className=\"text-xs\">{label}</span>\n      </div>\n      <p className={`font-bold ${small ? 'text-base' : 'text-lg'}`} style={{ color }}>{value}</p>\n      {subtitle && <p className=\"text-[10px] text-[var(--text-dim)]\">{subtitle}</p>}\n    </div>\n  );\n\n  const formatTime = (ms) => {\n    if (ms < 60000) return `${Math.round(ms / 1000)}s`;\n    if (ms < 3600000) return `${Math.round(ms / 60000)}m`;\n    if (ms < 86400000) return `${(ms / 3600000).toFixed(1)}h`;\n    return `${(ms / 86400000).toFixed(1)}d`;\n  };\n\n  return (\n    <div className=\"flex-1 overflow-y-auto p-4 space-y-4\">\n      {/* Header */}\n      <div className=\"flex items-center justify-between\">\n        <div>\n          <h1 className=\"text-xl font-bold flex items-center gap-2\">\n            <Activity size={22} className=\"text-[var(--gold)]\" /> Portfolio Analytics\n          </h1>\n          <p className=\"text-sm text-[var(--text-dim)]\">Rendimiento detallado de tu trading</p>\n        </div>\n\n        {/* Filters */}\n        <div className=\"flex gap-2\">\n          <select\n            value={timeFilter}\n            onChange={(e) => setTimeFilter(e.target.value)}\n            className=\"text-xs bg-[var(--dark-2)] border border-[var(--border)] rounded-lg px-2 py-1.5 text-[var(--text)]\"\n          >\n            <option value=\"all\">Todo</option>\n            <option value=\"today\">Hoy</option>\n            <option value=\"7d\">7 días</option>\n            <option value=\"30d\">30 días</option>\n          </select>\n          <select\n            value={botFilter}\n            onChange={(e) => setBotFilter(e.target.value)}\n            className=\"text-xs bg-[var(--dark-2)] border border-[var(--border)] rounded-lg px-2 py-1.5 text-[var(--text)]\"\n          >\n            <option value=\"all\">Todos los Bots</option>\n            {bots.map(b => (\n              <option key={b.id} value={b.id}>{b.name}</option>\n            ))}\n          </select>\n        </div>\n      </div>\n\n      {!stats ? (\n        <div className=\"flex-1 flex flex-col items-center justify-center py-20 text-center\">\n          <BarChart3 size={48} className=\"text-[var(--text-dim)] mb-4\" />\n          <h2 className=\"text-lg font-bold mb-2\">Sin datos de trading aún</h2>\n          <p className=\"text-sm text-[var(--text-dim)] max-w-md\">\n            Activa tus bots o ejecuta trades manuales para ver analytics detallados aquí.\n          </p>\n        </div>\n      ) : (\n        <>\n          {/* Top KPIs */}\n          <div className=\"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-6 gap-3\">\n            <StatCard\n              icon={DollarSign}\n              label=\"P&L Total\"\n              value={`${stats.totalPnl >= 0 ? '+' : ''}$${stats.totalPnl.toFixed(2)}`}\n              color={stats.totalPnl >= 0 ? '#10B981' : '#EF4444'}\n              subtitle={`${stats.totalTrades} trades`}\n            />\n            <StatCard\n              icon={Target}\n              label=\"Win Rate\"\n              value={`${stats.winRate.toFixed(1)}%`}\n              color={stats.winRate >= 50 ? '#10B981' : '#EF4444'}\n              subtitle={`${stats.wins}W / ${stats.losses}L`}\n            />\n            <StatCard\n              icon={TrendingUp}\n              label=\"Profit Factor\"\n              value={stats.profitFactor === Infinity ? '∞' : stats.profitFactor.toFixed(2)}\n              color={stats.profitFactor >= 1 ? '#10B981' : '#EF4444'}\n              subtitle=\"Win$ / Loss$\"\n            />\n            <StatCard\n              icon={AlertTriangle}\n              label=\"Max Drawdown\"\n              value={`${stats.maxDrawdown.toFixed(1)}%`}\n              color={stats.maxDrawdown < 10 ? '#10B981' : stats.maxDrawdown < 25 ? '#F59E0B' : '#EF4444'}\n              subtitle=\"Caída máxima\"\n            />\n            <StatCard\n              icon={Zap}\n              label=\"Sharpe Ratio\"\n              value={stats.sharpeRatio.toFixed(2)}\n              color={stats.sharpeRatio >= 1 ? '#10B981' : stats.sharpeRatio >= 0 ? '#F59E0B' : '#EF4444'}\n              subtitle={stats.sharpeRatio >= 2 ? 'Excelente' : stats.sharpeRatio >= 1 ? 'Bueno' : 'Mejorable'}\n            />\n            <StatCard\n              icon={Award}\n              label=\"Expectancy\"\n              value={`$${stats.expectancy.toFixed(2)}`}\n              color={stats.expectancy >= 0 ? '#10B981' : '#EF4444'}\n              subtitle=\"$ esperado/trade\"\n            />\n          </div>\n\n          {/* Equity Curve */}\n          <div className=\"bg-[var(--dark-2)] border border-[var(--border)] rounded-xl p-4\">\n            <div className=\"flex items-center justify-between mb-3\">\n              <h2 className=\"text-sm font-bold flex items-center gap-2\">\n                <TrendingUp size={16} className=\"text-[var(--gold)]\" /> Curva de Equity\n              </h2>\n              <div className=\"text-xs text-[var(--text-dim)]\">\n                {filteredTrades.length} trades • Drawdown en rojo\n              </div>\n            </div>\n            <EquityChart trades={filteredTrades} />\n          </div>\n\n          {/* Win/Loss Distribution + Details */}\n          <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n            {/* Distribution */}\n            <div className=\"bg-[var(--dark-2)] border border-[var(--border)] rounded-xl p-4 space-y-4\">\n              <h3 className=\"text-sm font-bold flex items-center gap-2\">\n                <BarChart3 size={14} className=\"text-[var(--gold)]\" /> Distribución\n              </h3>\n              <DistributionBar wins={stats.wins} losses={stats.losses} neutral={stats.neutral} />\n              <div className=\"flex justify-between text-xs\">\n                <span className=\"text-emerald-400\">{stats.wins} wins ({stats.winRate.toFixed(0)}%)</span>\n                {stats.neutral > 0 && <span className=\"text-yellow-400\">{stats.neutral} neutral</span>}\n                <span className=\"text-red-400\">{stats.losses} losses ({(100 - stats.winRate).toFixed(0)}%)</span>\n              </div>\n\n              <div className=\"grid grid-cols-2 gap-3 text-sm\">\n                <div className=\"bg-[var(--dark)] rounded-lg p-3\">\n                  <p className=\"text-[10px] text-[var(--text-dim)] mb-1\">Avg Win</p>\n                  <p className=\"text-emerald-400 font-bold\">+${stats.avgWin.toFixed(2)}</p>\n                </div>\n                <div className=\"bg-[var(--dark)] rounded-lg p-3\">\n                  <p className=\"text-[10px] text-[var(--text-dim)] mb-1\">Avg Loss</p>\n                  <p className=\"text-red-400 font-bold\">-${stats.avgLoss.toFixed(2)}</p>\n                </div>\n                <div className=\"bg-[var(--dark)] rounded-lg p-3\">\n                  <p className=\"text-[10px] text-[var(--text-dim)] mb-1\">Max Wins Seguidos</p>\n                  <p className=\"text-emerald-400 font-bold\">{stats.maxConsecWins}</p>\n                </div>\n                <div className=\"bg-[var(--dark)] rounded-lg p-3\">\n                  <p className=\"text-[10px] text-[var(--text-dim)] mb-1\">Max Losses Seguidos</p>\n                  <p className=\"text-red-400 font-bold\">{stats.maxConsecLosses}</p>\n                </div>\n              </div>\n            </div>\n\n            {/* Key metrics */}\n            <div className=\"bg-[var(--dark-2)] border border-[var(--border)] rounded-xl p-4 space-y-4\">\n              <h3 className=\"text-sm font-bold flex items-center gap-2\">\n                <Shield size={14} className=\"text-[var(--gold)]\" /> Métricas Clave\n              </h3>\n              \n              {[\n                { label: 'Risk/Reward Ratio', value: stats.riskReward === Infinity ? '∞' : `1:${stats.riskReward.toFixed(2)}`, good: stats.riskReward >= 1.5 },\n                { label: 'Profit Factor', value: stats.profitFactor === Infinity ? '∞' : stats.profitFactor.toFixed(2), good: stats.profitFactor >= 1.5 },\n                { label: 'Tiempo Prom. en Trade', value: formatTime(stats.avgHoldTime), neutral: true },\n                { label: 'Mejor Trade', value: `+$${(stats.bestTrade?.pnl || 0).toFixed(2)}`, good: true },\n                { label: 'Peor Trade', value: `-$${Math.abs(stats.worstTrade?.pnl || 0).toFixed(2)}`, good: false },\n                { label: 'Expectancy por Trade', value: `$${stats.expectancy.toFixed(2)}`, good: stats.expectancy > 0 },\n              ].map((item, i) => (\n                <div key={i} className=\"flex items-center justify-between py-1.5 border-b border-[var(--border)] last:border-0\">\n                  <span className=\"text-xs text-[var(--text-dim)]\">{item.label}</span>\n                  <span className={`text-sm font-bold ${item.neutral ? 'text-[var(--text)]' : item.good ? 'text-emerald-400' : 'text-red-400'}`}>\n                    {item.value}\n                  </span>\n                </div>\n              ))}\n            </div>\n          </div>\n\n          {/* Daily PnL Heatmap */}\n          <div className=\"bg-[var(--dark-2)] border border-[var(--border)] rounded-xl p-4\">\n            <h3 className=\"text-sm font-bold flex items-center gap-2 mb-3\">\n              <Calendar size={14} className=\"text-[var(--gold)]\" /> P&L Diario\n            </h3>\n            <div className=\"flex gap-1.5 flex-wrap\">\n              {Object.entries(stats.dailyPnl).slice(-60).map(([date, pnl], i) => {\n                const intensity = Math.min(Math.abs(pnl) / (Math.max(...Object.values(stats.dailyPnl).map(Math.abs)) || 1), 1);\n                const bg = pnl >= 0\n                  ? `rgba(16,185,129,${0.15 + intensity * 0.6})`\n                  : `rgba(239,68,68,${0.15 + intensity * 0.6})`;\n                return (\n                  <div\n                    key={i}\n                    className=\"w-8 h-8 rounded flex items-center justify-center text-[8px] font-bold cursor-default group relative\"\n                    style={{ background: bg }}\n                    title={`${date}: ${pnl >= 0 ? '+' : ''}$${pnl.toFixed(2)}`}\n                  >\n                    {new Date(date).getDate()}\n                  </div>\n                );\n              })}\n            </div>\n            <div className=\"flex gap-4 mt-2 text-[10px] text-[var(--text-dim)]\">\n              <span className=\"flex items-center gap-1\">\n                <div className=\"w-3 h-3 rounded bg-emerald-500/30\" /> Ganancia\n              </span>\n              <span className=\"flex items-center gap-1\">\n                <div className=\"w-3 h-3 rounded bg-red-500/30\" /> Pérdida\n              </span>\n              <span>Más intenso = mayor monto</span>\n            </div>\n          </div>\n\n          {/* Recent Trades Table */}\n          <div className=\"bg-[var(--dark-2)] border border-[var(--border)] rounded-xl p-4\">\n            <h3 className=\"text-sm font-bold flex items-center gap-2 mb-3\">\n              <Clock size={14} className=\"text-[var(--gold)]\" /> Últimos Trades\n            </h3>\n            <div className=\"overflow-x-auto\">\n              <table className=\"w-full text-xs\">\n                <thead>\n                  <tr className=\"text-[var(--text-dim)] border-b border-[var(--border)]\">\n                    <th className=\"text-left py-2 px-2\">Par</th>\n                    <th className=\"text-left py-2 px-2\">Lado</th>\n                    <th className=\"text-right py-2 px-2\">Entrada</th>\n                    <th className=\"text-right py-2 px-2\">Salida</th>\n                    <th className=\"text-right py-2 px-2\">P&L</th>\n                    <th className=\"text-right py-2 px-2\">Fecha</th>\n                  </tr>\n                </thead>\n                <tbody>\n                  {filteredTrades.slice(-20).reverse().map((t, i) => (\n                    <tr key={i} className=\"border-b border-[var(--border)]/50 hover:bg-white/[0.02]\">\n                      <td className=\"py-2 px-2 font-mono\">{t.pair || t.symbol || '—'}</td>\n                      <td className=\"py-2 px-2\">\n                        <span className={`px-1.5 py-0.5 rounded text-[10px] font-bold ${t.side === 'buy' ? 'bg-emerald-500/20 text-emerald-400' : 'bg-red-500/20 text-red-400'}`}>\n                          {(t.side || '—').toUpperCase()}\n                        </span>\n                      </td>\n                      <td className=\"py-2 px-2 text-right font-mono\">${(t.entryPrice || 0).toFixed(2)}</td>\n                      <td className=\"py-2 px-2 text-right font-mono\">${(t.exitPrice || 0).toFixed(2)}</td>\n                      <td className={`py-2 px-2 text-right font-bold ${(t.pnl || 0) >= 0 ? 'text-emerald-400' : 'text-red-400'}`}>\n                        {(t.pnl || 0) >= 0 ? '+' : ''}${(t.pnl || 0).toFixed(2)}\n                      </td>\n                      <td className=\"py-2 px-2 text-right text-[var(--text-dim)]\">\n                        {new Date(t.closedAt || t.time || Date.now()).toLocaleDateString('es', { day: '2-digit', month: 'short', hour: '2-digit', minute: '2-digit' })}\n                      </td>\n                    </tr>\n                  ))}\n                </tbody>\n              </table>\n            </div>\n          </div>\n        </>\n      )}\n    </div>\n  );\n}\n"],"names":["EquityChart","trades","height","canvasRef","useRef","useEffect","canvas","ctx","dpr","rect","W","H","startBalance","equity","points","maxEquity","drawdowns","t","i","dd","minY","p","maxY","rangeY","pad","chartW","chartH","y","val","maxDD","x","gradient","last","lx","ly","step","d","jsx","DistributionBar","wins","losses","neutral","total","jsxs","PortfolioAnalytics","tradeHistory","bots","brokers","useStore","timeFilter","setTimeFilter","useState","botFilter","setBotFilter","allTrades","useMemo","a","b","tA","tB","filteredTrades","today","week","month","stats","totalPnl","s","totalWinPnl","totalLossPnl","avgWin","avgLoss","winRate","profitFactor","peak","equityCurve","returns","avgReturn","variance","r","stdDev","sharpeRatio","bestTrade","best","worstTrade","worst","maxConsecWins","maxConsecLosses","curWins","curLosses","avgHoldTime","dailyPnl","riskReward","expectancy","StatCard","Icon","label","value","subtitle","color","small","formatTime","ms","Activity","e","Fragment","DollarSign","Target","TrendingUp","AlertTriangle","Zap","Award","BarChart3","Shield","_a","_b","item","Calendar","date","pnl","intensity","bg","Clock"],"mappings":"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"}