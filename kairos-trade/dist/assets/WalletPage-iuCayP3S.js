var Qx=Object.defineProperty;var kp=r=>{throw TypeError(r)};var Wx=(r,e,t)=>e in r?Qx(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t;var L=(r,e,t)=>Wx(r,typeof e!="symbol"?e+"":e,t),qu=(r,e,t)=>e.has(r)||kp("Cannot "+t);var y=(r,e,t)=>(qu(r,e,"read from private field"),t?t.call(r):e.get(r)),z=(r,e,t)=>e.has(r)?kp("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(r):e.set(r,t),P=(r,e,t,n)=>(qu(r,e,"write to private field"),n?n.call(r,t):e.set(r,t),t),K=(r,e,t)=>(qu(r,e,"access private method"),t);var aa=(r,e,t,n)=>({set _(s){P(r,e,s,t)},get _(){return y(r,e,n)}});import{g as Jx,aQ as Em,aR as Ki,a as ie,j as w,o as Ys,m as Te,h as Nl,X as qo,W as ro,Z as Yx,S as Ia,ak as _s,Q as du,V as za,aw as Zx,aj as Td,at as Xx,aS as Am,aT as ev,y as tv,q as rv,as as ll,an as tf,v as Cl,F as nv,x as rf,K as sv,N as iv,a6 as ov,a5 as av}from"./ui-Xrp8OYat.js";import{j as Bi,k as oe,l as X,m as Le,n as Bs,o as H,p as _e,q as Bl,r as pu,s as Ee,v as ce,w as Im,x as Rl,y as oo,z as cn,C as ln,D as cv,E as Sm,F as ze,G as Fe,H as qa,I as lv,J as kd,K as Om,L as St,M as uv,N as Va,O as vt,Q as hv,R as fv,S as Dm,U as gu,V as _m,W as dv,X as Ud,Y as nr,Z as Ir,$ as nf,a0 as sf,a1 as pv,a2 as Vu,a3 as $d,a4 as gv,a5 as tn,a6 as Up,a7 as yv,a8 as mv,a9 as wv,aa as bv,ab as $p,u as Ku,ac as xv,d as Fp,ad as Vo,ae as of,af as Lp,ag as jp,ah as vv}from"./index-BWvYVe9P.js";import"./vendor-adQwlP3i.js";function Ev(r){r=atob(r);const e=new Uint8Array(r.length);for(let t=0;t<r.length;t++)e[t]=r.charCodeAt(t);return Bi(e)}function Av(r){const e=Bi(r);let t="";for(let n=0;n<e.length;n++)t+=String.fromCharCode(e[n]);return btoa(t)}var xo;class Nm{constructor(e,t,n){L(this,"filter");L(this,"emitter");z(this,xo);P(this,xo,t),oe(this,{emitter:e,filter:n})}async removeListener(){y(this,xo)!=null&&await this.emitter.off(this.filter,y(this,xo))}}xo=new WeakMap;function Cm(r){async function e(t,n){X(n==null||!n.cancelled,"request cancelled before sending","CANCELLED");const s=t.url.split(":")[0].toLowerCase();X(s==="http"||s==="https",`unsupported protocol ${s}`,"UNSUPPORTED_OPERATION",{info:{protocol:s},operation:"request"}),X(s==="https"||!t.credentials||t.allowInsecureAuthentication,"insecure authorized connections unsupported","UNSUPPORTED_OPERATION",{operation:"request"});let i=null;const o=new AbortController,a=setTimeout(()=>{i=Le("request timeout","TIMEOUT"),o.abort()},t.timeout);n&&n.addListener(()=>{i=Le("request cancelled","CANCELLED"),o.abort()});const c=Object.assign({},r,{method:t.method,headers:new Headers(Array.from(t)),body:t.body||void 0,signal:o.signal});let l;try{l=await fetch(t.url,c)}catch(d){throw clearTimeout(a),i||d}clearTimeout(a);const u={};l.headers.forEach((d,p)=>{u[p.toLowerCase()]=d});const h=await l.arrayBuffer(),f=h==null?null:new Uint8Array(h);return{statusCode:l.status,statusMessage:l.statusText,headers:u,body:f}}return e}const Iv=12,Sv=250;let Mp=Cm();const Ov=new RegExp("^data:([^;:]*)?(;base64)?,(.*)$","i"),Dv=new RegExp("^ipfs://(ipfs/)?(.*)$","i");let Hu=!1;async function Bm(r,e){try{const t=r.match(Ov);if(!t)throw new Error("invalid data");return new Rs(200,"OK",{"content-type":t[1]||"text/plain"},t[2]?Ev(t[3]):Nv(t[3]))}catch{return new Rs(599,"BAD REQUEST (invalid data: URI)",{},null,new qn(r))}}function Rm(r){async function e(t,n){try{const s=t.match(Dv);if(!s)throw new Error("invalid link");return new qn(`${r}${s[2]}`)}catch{return new Rs(599,"BAD REQUEST (invalid IPFS URI)",{},null,new qn(t))}}return e}const Lc={data:Bm,ipfs:Rm("https://gateway.ipfs.io/ipfs/")},Pm=new WeakMap;var li,ps;class _v{constructor(e){z(this,li);z(this,ps);P(this,li,[]),P(this,ps,!1),Pm.set(e,()=>{if(!y(this,ps)){P(this,ps,!0);for(const t of y(this,li))setTimeout(()=>{t()},0);P(this,li,[])}})}addListener(e){X(!y(this,ps),"singal already cancelled","UNSUPPORTED_OPERATION",{operation:"fetchCancelSignal.addCancelListener"}),y(this,li).push(e)}get cancelled(){return y(this,ps)}checkSignal(){X(!this.cancelled,"cancelled","CANCELLED",{})}}li=new WeakMap,ps=new WeakMap;function jc(r){if(r==null)throw new Error("missing signal; should not happen");return r.checkSignal(),r}var vo,Eo,Dr,Nn,Ao,Io,Ye,Yt,Cn,ui,hi,fi,Qr,_r,gs,di,Sa;const ou=class ou{constructor(e){z(this,di);z(this,vo);z(this,Eo);z(this,Dr);z(this,Nn);z(this,Ao);z(this,Io);z(this,Ye);z(this,Yt);z(this,Cn);z(this,ui);z(this,hi);z(this,fi);z(this,Qr);z(this,_r);z(this,gs);P(this,Io,String(e)),P(this,vo,!1),P(this,Eo,!0),P(this,Dr,{}),P(this,Nn,""),P(this,Ao,3e5),P(this,_r,{slotInterval:Sv,maxAttempts:Iv}),P(this,gs,null)}get url(){return y(this,Io)}set url(e){P(this,Io,String(e))}get body(){return y(this,Ye)==null?null:new Uint8Array(y(this,Ye))}set body(e){if(e==null)P(this,Ye,void 0),P(this,Yt,void 0);else if(typeof e=="string")P(this,Ye,Bs(e)),P(this,Yt,"text/plain");else if(e instanceof Uint8Array)P(this,Ye,e),P(this,Yt,"application/octet-stream");else if(typeof e=="object")P(this,Ye,Bs(JSON.stringify(e))),P(this,Yt,"application/json");else throw new Error("invalid body")}hasBody(){return y(this,Ye)!=null}get method(){return y(this,Nn)?y(this,Nn):this.hasBody()?"POST":"GET"}set method(e){e==null&&(e=""),P(this,Nn,String(e).toUpperCase())}get headers(){const e=Object.assign({},y(this,Dr));return y(this,Cn)&&(e.authorization=`Basic ${Av(Bs(y(this,Cn)))}`),this.allowGzip&&(e["accept-encoding"]="gzip"),e["content-type"]==null&&y(this,Yt)&&(e["content-type"]=y(this,Yt)),this.body&&(e["content-length"]=String(this.body.length)),e}getHeader(e){return this.headers[e.toLowerCase()]}setHeader(e,t){y(this,Dr)[String(e).toLowerCase()]=String(t)}clearHeaders(){P(this,Dr,{})}[Symbol.iterator](){const e=this.headers,t=Object.keys(e);let n=0;return{next:()=>{if(n<t.length){const s=t[n++];return{value:[s,e[s]],done:!1}}return{value:void 0,done:!0}}}}get credentials(){return y(this,Cn)||null}setCredentials(e,t){H(!e.match(/:/),"invalid basic authentication username","username","[REDACTED]"),P(this,Cn,`${e}:${t}`)}get allowGzip(){return y(this,Eo)}set allowGzip(e){P(this,Eo,!!e)}get allowInsecureAuthentication(){return!!y(this,vo)}set allowInsecureAuthentication(e){P(this,vo,!!e)}get timeout(){return y(this,Ao)}set timeout(e){H(e>=0,"timeout must be non-zero","timeout",e),P(this,Ao,e)}get preflightFunc(){return y(this,ui)||null}set preflightFunc(e){P(this,ui,e)}get processFunc(){return y(this,hi)||null}set processFunc(e){P(this,hi,e)}get retryFunc(){return y(this,fi)||null}set retryFunc(e){P(this,fi,e)}get getUrlFunc(){return y(this,gs)||Mp}set getUrlFunc(e){P(this,gs,e)}toString(){return`<FetchRequest method=${JSON.stringify(this.method)} url=${JSON.stringify(this.url)} headers=${JSON.stringify(this.headers)} body=${y(this,Ye)?_e(y(this,Ye)):"null"}>`}setThrottleParams(e){e.slotInterval!=null&&(y(this,_r).slotInterval=e.slotInterval),e.maxAttempts!=null&&(y(this,_r).maxAttempts=e.maxAttempts)}send(){return X(y(this,Qr)==null,"request already sent","UNSUPPORTED_OPERATION",{operation:"fetchRequest.send"}),P(this,Qr,new _v(this)),K(this,di,Sa).call(this,0,zp()+this.timeout,0,this,new Rs(0,"",{},null,this))}cancel(){X(y(this,Qr)!=null,"request has not been sent","UNSUPPORTED_OPERATION",{operation:"fetchRequest.cancel"});const e=Pm.get(this);if(!e)throw new Error("missing signal; should not happen");e()}redirect(e){const t=this.url.split(":")[0].toLowerCase(),n=e.split(":")[0].toLowerCase();X(this.method==="GET"&&(t!=="https"||n!=="http")&&e.match(/^https?:/),"unsupported redirect","UNSUPPORTED_OPERATION",{operation:`redirect(${this.method} ${JSON.stringify(this.url)} => ${JSON.stringify(e)})`});const s=new ou(e);return s.method="GET",s.allowGzip=this.allowGzip,s.timeout=this.timeout,P(s,Dr,Object.assign({},y(this,Dr))),y(this,Ye)&&P(s,Ye,new Uint8Array(y(this,Ye))),P(s,Yt,y(this,Yt)),s}clone(){const e=new ou(this.url);return P(e,Nn,y(this,Nn)),y(this,Ye)&&P(e,Ye,y(this,Ye)),P(e,Yt,y(this,Yt)),P(e,Dr,Object.assign({},y(this,Dr))),P(e,Cn,y(this,Cn)),this.allowGzip&&(e.allowGzip=!0),e.timeout=this.timeout,this.allowInsecureAuthentication&&(e.allowInsecureAuthentication=!0),P(e,ui,y(this,ui)),P(e,hi,y(this,hi)),P(e,fi,y(this,fi)),P(e,_r,Object.assign({},y(this,_r))),P(e,gs,y(this,gs)),e}static lockConfig(){Hu=!0}static getGateway(e){return Lc[e.toLowerCase()]||null}static registerGateway(e,t){if(e=e.toLowerCase(),e==="http"||e==="https")throw new Error(`cannot intercept ${e}; use registerGetUrl`);if(Hu)throw new Error("gateways locked");Lc[e]=t}static registerGetUrl(e){if(Hu)throw new Error("gateways locked");Mp=e}static createGetUrlFunc(e){return Cm(e)}static createDataGateway(){return Bm}static createIpfsGatewayFunc(e){return Rm(e)}};vo=new WeakMap,Eo=new WeakMap,Dr=new WeakMap,Nn=new WeakMap,Ao=new WeakMap,Io=new WeakMap,Ye=new WeakMap,Yt=new WeakMap,Cn=new WeakMap,ui=new WeakMap,hi=new WeakMap,fi=new WeakMap,Qr=new WeakMap,_r=new WeakMap,gs=new WeakMap,di=new WeakSet,Sa=async function(e,t,n,s,i){var u,h,f;if(e>=y(this,_r).maxAttempts)return i.makeServerError("exceeded maximum retry limit");X(zp()<=t,"timeout","TIMEOUT",{operation:"request.send",reason:"timeout",request:s}),n>0&&await Cv(n);let o=this.clone();const a=(o.url.split(":")[0]||"").toLowerCase();if(a in Lc){const d=await Lc[a](o.url,jc(y(s,Qr)));if(d instanceof Rs){let p=d;if(this.processFunc){jc(y(s,Qr));try{p=await this.processFunc(o,p)}catch(g){(g.throttle==null||typeof g.stall!="number")&&p.makeServerError("error in post-processing function",g).assertOk()}}return p}o=d}this.preflightFunc&&(o=await this.preflightFunc(o));const c=await this.getUrlFunc(o,jc(y(s,Qr)));let l=new Rs(c.statusCode,c.statusMessage,c.headers,c.body,s);if(l.statusCode===301||l.statusCode===302){try{const d=l.headers.location||"";return K(u=o.redirect(d),di,Sa).call(u,e+1,t,0,s,l)}catch{}return l}else if(l.statusCode===429&&(this.retryFunc==null||await this.retryFunc(o,l,e))){const d=l.headers["retry-after"];let p=y(this,_r).slotInterval*Math.trunc(Math.random()*Math.pow(2,e));return typeof d=="string"&&d.match(/^[1-9][0-9]*$/)&&(p=parseInt(d)),K(h=o.clone(),di,Sa).call(h,e+1,t,p,s,l)}if(this.processFunc){jc(y(s,Qr));try{l=await this.processFunc(o,l)}catch(d){(d.throttle==null||typeof d.stall!="number")&&l.makeServerError("error in post-processing function",d).assertOk();let p=y(this,_r).slotInterval*Math.trunc(Math.random()*Math.pow(2,e));return d.stall>=0&&(p=d.stall),K(f=o.clone(),di,Sa).call(f,e+1,t,p,s,l)}}return l};let qn=ou;var cc,lc,uc,Zt,So,pi;const Pp=class Pp{constructor(e,t,n,s,i){z(this,cc);z(this,lc);z(this,uc);z(this,Zt);z(this,So);z(this,pi);P(this,cc,e),P(this,lc,t),P(this,uc,Object.keys(n).reduce((o,a)=>(o[a.toLowerCase()]=String(n[a]),o),{})),P(this,Zt,s==null?null:new Uint8Array(s)),P(this,So,i||null),P(this,pi,{message:""})}toString(){return`<FetchResponse status=${this.statusCode} body=${y(this,Zt)?_e(y(this,Zt)):"null"}>`}get statusCode(){return y(this,cc)}get statusMessage(){return y(this,lc)}get headers(){return Object.assign({},y(this,uc))}get body(){return y(this,Zt)==null?null:new Uint8Array(y(this,Zt))}get bodyText(){try{return y(this,Zt)==null?"":Bl(y(this,Zt))}catch{X(!1,"response body is not valid UTF-8 data","UNSUPPORTED_OPERATION",{operation:"bodyText",info:{response:this}})}}get bodyJson(){try{return JSON.parse(this.bodyText)}catch{X(!1,"response body is not valid JSON","UNSUPPORTED_OPERATION",{operation:"bodyJson",info:{response:this}})}}[Symbol.iterator](){const e=this.headers,t=Object.keys(e);let n=0;return{next:()=>{if(n<t.length){const s=t[n++];return{value:[s,e[s]],done:!1}}return{value:void 0,done:!0}}}}makeServerError(e,t){let n;e?n=`CLIENT ESCALATED SERVER ERROR (${this.statusCode} ${this.statusMessage}; ${e})`:(e=`${this.statusCode} ${this.statusMessage}`,n=`CLIENT ESCALATED SERVER ERROR (${e})`);const s=new Pp(599,n,this.headers,this.body,y(this,So)||void 0);return P(s,pi,{message:e,error:t}),s}throwThrottleError(e,t){t==null?t=-1:H(Number.isInteger(t)&&t>=0,"invalid stall timeout","stall",t);const n=new Error(e||"throttling requests");throw oe(n,{stall:t,throttle:!0}),n}getHeader(e){return this.headers[e.toLowerCase()]}hasBody(){return y(this,Zt)!=null}get request(){return y(this,So)}ok(){return y(this,pi).message===""&&this.statusCode>=200&&this.statusCode<300}assertOk(){if(this.ok())return;let{message:e,error:t}=y(this,pi);e===""&&(e=`server response ${this.statusCode} ${this.statusMessage}`);let n=null;this.request&&(n=this.request.url);let s=null;try{y(this,Zt)&&(s=Bl(y(this,Zt)))}catch{}X(!1,e,"SERVER_ERROR",{request:this.request||"unknown request",response:this,error:t,info:{requestUrl:n,responseBody:s,responseStatus:`${this.statusCode} ${this.statusMessage}`}})}};cc=new WeakMap,lc=new WeakMap,uc=new WeakMap,Zt=new WeakMap,So=new WeakMap,pi=new WeakMap;let Rs=Pp;function zp(){return new Date().getTime()}function Nv(r){return Bs(r.replace(/%([0-9a-f][0-9a-f])/gi,(e,t)=>String.fromCharCode(parseInt(t,16))))}function Cv(r){return new Promise(e=>setTimeout(e,r))}const Bv=BigInt(-1),Sr=BigInt(0),ao=BigInt(1),Rv=BigInt(5),Hi={};let po="0000";for(;po.length<80;)po+=po;function zs(r){let e=po;for(;e.length<r;)e+=e;return BigInt("1"+e.substring(0,r))}function ca(r,e,t){const n=BigInt(e.width);if(e.signed){const s=ao<<n-ao;X(t==null||r>=-s&&r<s,"overflow","NUMERIC_FAULT",{operation:t,fault:"overflow",value:r}),r>Sr?r=Rl(oo(r,n),n):r=-Rl(oo(-r,n),n)}else{const s=ao<<n;X(t==null||r>=0&&r<s,"overflow","NUMERIC_FAULT",{operation:t,fault:"overflow",value:r}),r=(r%s+s)%s&s-ao}return r}function Gu(r){typeof r=="number"&&(r=`fixed128x${r}`);let e=!0,t=128,n=18;if(typeof r=="string"){if(r!=="fixed")if(r==="ufixed")e=!1;else{const i=r.match(/^(u?)fixed([0-9]+)x([0-9]+)$/);H(i,"invalid fixed format","format",r),e=i[1]!=="u",t=parseInt(i[2]),n=parseInt(i[3])}}else if(r){const i=r,o=(a,c,l)=>i[a]==null?l:(H(typeof i[a]===c,"invalid fixed format ("+a+" not "+c+")","format."+a,i[a]),i[a]);e=o("signed","boolean",e),t=o("width","number",t),n=o("decimals","number",n)}H(t%8===0,"invalid FixedNumber width (not byte aligned)","format.width",t),H(n<=80,"invalid FixedNumber decimals (too large)","format.decimals",n);const s=(e?"":"u")+"fixed"+String(t)+"x"+String(n);return{signed:e,width:t,decimals:n,name:s}}function Pv(r,e){let t="";r<Sr&&(t="-",r*=Bv);let n=r.toString();if(e===0)return t+n;for(;n.length<=e;)n=po+n;const s=n.length-e;for(n=n.substring(0,s)+"."+n.substring(s);n[0]==="0"&&n[1]!==".";)n=n.substring(1);for(;n[n.length-1]==="0"&&n[n.length-2]!==".";)n=n.substring(0,n.length-1);return t+n}var Nr,Ie,At,xe,Qs,bn,af,cf,lf,uf;const ls=class ls{constructor(e,t,n){z(this,xe);L(this,"format");z(this,Nr);z(this,Ie);z(this,At);L(this,"_value");pu(e,Hi,"FixedNumber"),P(this,Ie,t),P(this,Nr,n);const s=Pv(t,n.decimals);oe(this,{format:n.name,_value:s}),P(this,At,zs(n.decimals))}get signed(){return y(this,Nr).signed}get width(){return y(this,Nr).width}get decimals(){return y(this,Nr).decimals}get value(){return y(this,Ie)}addUnsafe(e){return K(this,xe,af).call(this,e)}add(e){return K(this,xe,af).call(this,e,"add")}subUnsafe(e){return K(this,xe,cf).call(this,e)}sub(e){return K(this,xe,cf).call(this,e,"sub")}mulUnsafe(e){return K(this,xe,lf).call(this,e)}mul(e){return K(this,xe,lf).call(this,e,"mul")}mulSignal(e){K(this,xe,Qs).call(this,e);const t=y(this,Ie)*y(e,Ie);return X(t%y(this,At)===Sr,"precision lost during signalling mul","NUMERIC_FAULT",{operation:"mulSignal",fault:"underflow",value:this}),K(this,xe,bn).call(this,t/y(this,At),"mulSignal")}divUnsafe(e){return K(this,xe,uf).call(this,e)}div(e){return K(this,xe,uf).call(this,e,"div")}divSignal(e){X(y(e,Ie)!==Sr,"division by zero","NUMERIC_FAULT",{operation:"div",fault:"divide-by-zero",value:this}),K(this,xe,Qs).call(this,e);const t=y(this,Ie)*y(this,At);return X(t%y(e,Ie)===Sr,"precision lost during signalling div","NUMERIC_FAULT",{operation:"divSignal",fault:"underflow",value:this}),K(this,xe,bn).call(this,t/y(e,Ie),"divSignal")}cmp(e){let t=this.value,n=e.value;const s=this.decimals-e.decimals;return s>0?n*=zs(s):s<0&&(t*=zs(-s)),t<n?-1:t>n?1:0}eq(e){return this.cmp(e)===0}lt(e){return this.cmp(e)<0}lte(e){return this.cmp(e)<=0}gt(e){return this.cmp(e)>0}gte(e){return this.cmp(e)>=0}floor(){let e=y(this,Ie);return y(this,Ie)<Sr&&(e-=y(this,At)-ao),e=y(this,Ie)/y(this,At)*y(this,At),K(this,xe,bn).call(this,e,"floor")}ceiling(){let e=y(this,Ie);return y(this,Ie)>Sr&&(e+=y(this,At)-ao),e=y(this,Ie)/y(this,At)*y(this,At),K(this,xe,bn).call(this,e,"ceiling")}round(e){if(e==null&&(e=0),e>=this.decimals)return this;const t=this.decimals-e,n=Rv*zs(t-1);let s=this.value+n;const i=zs(t);return s=s/i*i,ca(s,y(this,Nr),"round"),new ls(Hi,s,y(this,Nr))}isZero(){return y(this,Ie)===Sr}isNegative(){return y(this,Ie)<Sr}toString(){return this._value}toUnsafeFloat(){return parseFloat(this.toString())}toFormat(e){return ls.fromString(this.toString(),e)}static fromValue(e,t,n){const s=t==null?0:Ee(t),i=Gu(n);let o=ce(e,"value");const a=s-i.decimals;if(a>0){const c=zs(a);X(o%c===Sr,"value loses precision for format","NUMERIC_FAULT",{operation:"fromValue",fault:"underflow",value:e}),o/=c}else a<0&&(o*=zs(-a));return ca(o,i,"fromValue"),new ls(Hi,o,i)}static fromString(e,t){const n=e.match(/^(-?)([0-9]*)\.?([0-9]*)$/);H(n&&n[2].length+n[3].length>0,"invalid FixedNumber string value","value",e);const s=Gu(t);let i=n[2]||"0",o=n[3]||"";for(;o.length<s.decimals;)o+=po;X(o.substring(s.decimals).match(/^0*$/),"too many decimals for format","NUMERIC_FAULT",{operation:"fromString",fault:"underflow",value:e}),o=o.substring(0,s.decimals);const a=BigInt(n[1]+i+o);return ca(a,s,"fromString"),new ls(Hi,a,s)}static fromBytes(e,t){let n=Im(Bi(e,"value"));const s=Gu(t);return s.signed&&(n=Rl(n,s.width)),ca(n,s,"fromBytes"),new ls(Hi,n,s)}};Nr=new WeakMap,Ie=new WeakMap,At=new WeakMap,xe=new WeakSet,Qs=function(e){H(this.format===e.format,"incompatible format; use fixedNumber.toFormat","other",e)},bn=function(e,t){return e=ca(e,y(this,Nr),t),new ls(Hi,e,y(this,Nr))},af=function(e,t){return K(this,xe,Qs).call(this,e),K(this,xe,bn).call(this,y(this,Ie)+y(e,Ie),t)},cf=function(e,t){return K(this,xe,Qs).call(this,e),K(this,xe,bn).call(this,y(this,Ie)-y(e,Ie),t)},lf=function(e,t){return K(this,xe,Qs).call(this,e),K(this,xe,bn).call(this,y(this,Ie)*y(e,Ie)/y(this,At),t)},uf=function(e,t){return X(y(e,Ie)!==Sr,"division by zero","NUMERIC_FAULT",{operation:"div",fault:"divide-by-zero",value:this}),K(this,xe,Qs).call(this,e),K(this,xe,bn).call(this,y(this,Ie)*y(this,At)/y(e,Ie),t)};let Pl=ls;const Tv=["wei","kwei","mwei","gwei","szabo","finney","ether"];function Fd(r,e){let t=18;if(typeof e=="string"){const n=Tv.indexOf(e);H(n>=0,"invalid unit","unit",e),t=3*n}else e!=null&&(t=Ee(e,"unit"));return Pl.fromValue(r,t,{decimals:t,width:512}).toString()}function kv(r,e){H(typeof r=="string","value must be a string","value",r);let t=18;return t=Ee(e,"unit"),Pl.fromString(r,{decimals:t,width:512}).value}const Ot=32,hf=new Uint8Array(Ot),Uv=["then"],Mc={},Tm=new WeakMap;function Zs(r){return Tm.get(r)}function qp(r,e){Tm.set(r,e)}function la(r,e){const t=new Error(`deferred error during ABI decoding triggered accessing ${r}`);throw t.error=e,t}function ff(r,e,t){return r.indexOf(null)>=0?e.map((n,s)=>n instanceof Ko?ff(Zs(n),n,t):n):r.reduce((n,s,i)=>{let o=e.getValue(s);return s in n||(t&&o instanceof Ko&&(o=ff(Zs(o),o,t)),n[s]=o),n},{})}var Oo;const uo=class uo extends Array{constructor(...t){const n=t[0];let s=t[1],i=(t[2]||[]).slice(),o=!0;n!==Mc&&(s=t,i=[],o=!1);super(s.length);z(this,Oo);s.forEach((l,u)=>{this[u]=l});const a=i.reduce((l,u)=>(typeof u=="string"&&l.set(u,(l.get(u)||0)+1),l),new Map);if(qp(this,Object.freeze(s.map((l,u)=>{const h=i[u];return h!=null&&a.get(h)===1?h:null}))),P(this,Oo,[]),y(this,Oo)==null&&y(this,Oo),!o)return;Object.freeze(this);const c=new Proxy(this,{get:(l,u,h)=>{if(typeof u=="string"){if(u.match(/^[0-9]+$/)){const d=Ee(u,"%index");if(d<0||d>=this.length)throw new RangeError("out of result range");const p=l[d];return p instanceof Error&&la(`index ${d}`,p),p}if(Uv.indexOf(u)>=0)return Reflect.get(l,u,h);const f=l[u];if(f instanceof Function)return function(...d){return f.apply(this===h?l:this,d)};if(!(u in l))return l.getValue.apply(this===h?l:this,[u])}return Reflect.get(l,u,h)}});return qp(c,Zs(this)),c}toArray(t){const n=[];return this.forEach((s,i)=>{s instanceof Error&&la(`index ${i}`,s),t&&s instanceof uo&&(s=s.toArray(t)),n.push(s)}),n}toObject(t){const n=Zs(this);return n.reduce((s,i,o)=>(X(i!=null,`value at index ${o} unnamed`,"UNSUPPORTED_OPERATION",{operation:"toObject()"}),ff(n,this,t)),{})}slice(t,n){t==null&&(t=0),t<0&&(t+=this.length,t<0&&(t=0)),n==null&&(n=this.length),n<0&&(n+=this.length,n<0&&(n=0)),n>this.length&&(n=this.length);const s=Zs(this),i=[],o=[];for(let a=t;a<n;a++)i.push(this[a]),o.push(s[a]);return new uo(Mc,i,o)}filter(t,n){const s=Zs(this),i=[],o=[];for(let a=0;a<this.length;a++){const c=this[a];c instanceof Error&&la(`index ${a}`,c),t.call(n,c,a,this)&&(i.push(c),o.push(s[a]))}return new uo(Mc,i,o)}map(t,n){const s=[];for(let i=0;i<this.length;i++){const o=this[i];o instanceof Error&&la(`index ${i}`,o),s.push(t.call(n,o,i,this))}return s}getValue(t){const n=Zs(this).indexOf(t);if(n===-1)return;const s=this[n];return s instanceof Error&&la(`property ${JSON.stringify(t)}`,s.error),s}static fromItems(t,n){return new uo(Mc,t,n)}};Oo=new WeakMap;let Ko=uo;function Vp(r){let e=Sm(r);return X(e.length<=Ot,"value out-of-bounds","BUFFER_OVERRUN",{buffer:e,length:Ot,offset:e.length}),e.length!==Ot&&(e=ln(cn([hf.slice(e.length%Ot),e]))),e}class Gn{constructor(e,t,n,s){L(this,"name");L(this,"type");L(this,"localName");L(this,"dynamic");oe(this,{name:e,type:t,localName:n,dynamic:s},{name:"string",type:"string",localName:"string",dynamic:"boolean"})}_throwError(e,t){H(!1,e,this.localName,t)}}var Bn,gi,Do,ul;class df{constructor(){z(this,Do);z(this,Bn);z(this,gi);P(this,Bn,[]),P(this,gi,0)}get data(){return cn(y(this,Bn))}get length(){return y(this,gi)}appendWriter(e){return K(this,Do,ul).call(this,ln(e.data))}writeBytes(e){let t=ln(e);const n=t.length%Ot;return n&&(t=ln(cn([t,hf.slice(n)]))),K(this,Do,ul).call(this,t)}writeValue(e){return K(this,Do,ul).call(this,Vp(e))}writeUpdatableValue(){const e=y(this,Bn).length;return y(this,Bn).push(hf),P(this,gi,y(this,gi)+Ot),t=>{y(this,Bn)[e]=Vp(t)}}}Bn=new WeakMap,gi=new WeakMap,Do=new WeakSet,ul=function(e){return y(this,Bn).push(e),P(this,gi,y(this,gi)+e.length),e.length};var Ut,Xt,yi,mi,ys,Fi,gf,km;const Tp=class Tp{constructor(e,t,n){z(this,Fi);L(this,"allowLoose");z(this,Ut);z(this,Xt);z(this,yi);z(this,mi);z(this,ys);oe(this,{allowLoose:!!t}),P(this,Ut,ln(e)),P(this,yi,0),P(this,mi,null),P(this,ys,n??1024),P(this,Xt,0)}get data(){return _e(y(this,Ut))}get dataLength(){return y(this,Ut).length}get consumed(){return y(this,Xt)}get bytes(){return new Uint8Array(y(this,Ut))}subReader(e){const t=new Tp(y(this,Ut).slice(y(this,Xt)+e),this.allowLoose,y(this,ys));return P(t,mi,this),t}readBytes(e,t){let n=K(this,Fi,km).call(this,0,e,!!t);return K(this,Fi,gf).call(this,e),P(this,Xt,y(this,Xt)+n.length),n.slice(0,e)}readValue(){return Im(this.readBytes(Ot))}readIndex(){return cv(this.readBytes(Ot))}};Ut=new WeakMap,Xt=new WeakMap,yi=new WeakMap,mi=new WeakMap,ys=new WeakMap,Fi=new WeakSet,gf=function(e){var t;if(y(this,mi))return K(t=y(this,mi),Fi,gf).call(t,e);P(this,yi,y(this,yi)+e),X(y(this,ys)<1||y(this,yi)<=y(this,ys)*this.dataLength,`compressed ABI data exceeds inflation ratio of ${y(this,ys)} ( see: https://github.com/ethers-io/ethers.js/issues/4537 )`,"BUFFER_OVERRUN",{buffer:ln(y(this,Ut)),offset:y(this,Xt),length:e,info:{bytesRead:y(this,yi),dataLength:this.dataLength}})},km=function(e,t,n){let s=Math.ceil(t/Ot)*Ot;return y(this,Xt)+s>y(this,Ut).length&&(this.allowLoose&&n&&y(this,Xt)+t<=y(this,Ut).length?s=t:X(!1,"data out-of-bounds","BUFFER_OVERRUN",{buffer:ln(y(this,Ut)),length:y(this,Ut).length,offset:y(this,Xt)+s})),y(this,Ut).slice(y(this,Xt),y(this,Xt)+s)};let pf=Tp;function $v(r){const e=ze(r.from);let n=ce(r.nonce,"tx.nonce").toString(16);return n==="0"?n="0x":n.length%2?n="0x0"+n:n="0x"+n,ze(Fe(qa(lv([e,n])),12))}const En={};function ee(r,e){let t=!1;return e<0&&(t=!0,e*=-1),new Et(En,`${t?"":"u"}int${e}`,r,{signed:t,width:e})}function ye(r,e){return new Et(En,`bytes${e||""}`,r,{size:e})}const Kp=Symbol.for("_ethers_typed");var wi;const In=class In{constructor(e,t,n,s){L(this,"type");L(this,"value");z(this,wi);L(this,"_typedSymbol");s==null&&(s=null),pu(En,e,"Typed"),oe(this,{_typedSymbol:Kp,type:t,value:n}),P(this,wi,s),this.format()}format(){if(this.type==="array")throw new Error("");if(this.type==="dynamicArray")throw new Error("");return this.type==="tuple"?`tuple(${this.value.map(e=>e.format()).join(",")})`:this.type}defaultValue(){return 0}minValue(){return 0}maxValue(){return 0}isBigInt(){return!!this.type.match(/^u?int[0-9]+$/)}isData(){return this.type.startsWith("bytes")}isString(){return this.type==="string"}get tupleName(){if(this.type!=="tuple")throw TypeError("not a tuple");return y(this,wi)}get arrayLength(){if(this.type!=="array")throw TypeError("not an array");return y(this,wi)===!0?-1:y(this,wi)===!1?this.value.length:null}static from(e,t){return new In(En,e,t)}static uint8(e){return ee(e,8)}static uint16(e){return ee(e,16)}static uint24(e){return ee(e,24)}static uint32(e){return ee(e,32)}static uint40(e){return ee(e,40)}static uint48(e){return ee(e,48)}static uint56(e){return ee(e,56)}static uint64(e){return ee(e,64)}static uint72(e){return ee(e,72)}static uint80(e){return ee(e,80)}static uint88(e){return ee(e,88)}static uint96(e){return ee(e,96)}static uint104(e){return ee(e,104)}static uint112(e){return ee(e,112)}static uint120(e){return ee(e,120)}static uint128(e){return ee(e,128)}static uint136(e){return ee(e,136)}static uint144(e){return ee(e,144)}static uint152(e){return ee(e,152)}static uint160(e){return ee(e,160)}static uint168(e){return ee(e,168)}static uint176(e){return ee(e,176)}static uint184(e){return ee(e,184)}static uint192(e){return ee(e,192)}static uint200(e){return ee(e,200)}static uint208(e){return ee(e,208)}static uint216(e){return ee(e,216)}static uint224(e){return ee(e,224)}static uint232(e){return ee(e,232)}static uint240(e){return ee(e,240)}static uint248(e){return ee(e,248)}static uint256(e){return ee(e,256)}static uint(e){return ee(e,256)}static int8(e){return ee(e,-8)}static int16(e){return ee(e,-16)}static int24(e){return ee(e,-24)}static int32(e){return ee(e,-32)}static int40(e){return ee(e,-40)}static int48(e){return ee(e,-48)}static int56(e){return ee(e,-56)}static int64(e){return ee(e,-64)}static int72(e){return ee(e,-72)}static int80(e){return ee(e,-80)}static int88(e){return ee(e,-88)}static int96(e){return ee(e,-96)}static int104(e){return ee(e,-104)}static int112(e){return ee(e,-112)}static int120(e){return ee(e,-120)}static int128(e){return ee(e,-128)}static int136(e){return ee(e,-136)}static int144(e){return ee(e,-144)}static int152(e){return ee(e,-152)}static int160(e){return ee(e,-160)}static int168(e){return ee(e,-168)}static int176(e){return ee(e,-176)}static int184(e){return ee(e,-184)}static int192(e){return ee(e,-192)}static int200(e){return ee(e,-200)}static int208(e){return ee(e,-208)}static int216(e){return ee(e,-216)}static int224(e){return ee(e,-224)}static int232(e){return ee(e,-232)}static int240(e){return ee(e,-240)}static int248(e){return ee(e,-248)}static int256(e){return ee(e,-256)}static int(e){return ee(e,-256)}static bytes1(e){return ye(e,1)}static bytes2(e){return ye(e,2)}static bytes3(e){return ye(e,3)}static bytes4(e){return ye(e,4)}static bytes5(e){return ye(e,5)}static bytes6(e){return ye(e,6)}static bytes7(e){return ye(e,7)}static bytes8(e){return ye(e,8)}static bytes9(e){return ye(e,9)}static bytes10(e){return ye(e,10)}static bytes11(e){return ye(e,11)}static bytes12(e){return ye(e,12)}static bytes13(e){return ye(e,13)}static bytes14(e){return ye(e,14)}static bytes15(e){return ye(e,15)}static bytes16(e){return ye(e,16)}static bytes17(e){return ye(e,17)}static bytes18(e){return ye(e,18)}static bytes19(e){return ye(e,19)}static bytes20(e){return ye(e,20)}static bytes21(e){return ye(e,21)}static bytes22(e){return ye(e,22)}static bytes23(e){return ye(e,23)}static bytes24(e){return ye(e,24)}static bytes25(e){return ye(e,25)}static bytes26(e){return ye(e,26)}static bytes27(e){return ye(e,27)}static bytes28(e){return ye(e,28)}static bytes29(e){return ye(e,29)}static bytes30(e){return ye(e,30)}static bytes31(e){return ye(e,31)}static bytes32(e){return ye(e,32)}static address(e){return new In(En,"address",e)}static bool(e){return new In(En,"bool",!!e)}static bytes(e){return new In(En,"bytes",e)}static string(e){return new In(En,"string",e)}static array(e,t){throw new Error("not implemented yet")}static tuple(e,t){throw new Error("not implemented yet")}static overrides(e){return new In(En,"overrides",Object.assign({},e))}static isTyped(e){return e&&typeof e=="object"&&"_typedSymbol"in e&&e._typedSymbol===Kp}static dereference(e,t){if(In.isTyped(e)){if(e.type!==t)throw new Error(`invalid type: expecetd ${t}, got ${e.type}`);return e.value}return e}};wi=new WeakMap;let Et=In;class Fv extends Gn{constructor(e){super("address","address",e,!1)}defaultValue(){return"0x0000000000000000000000000000000000000000"}encode(e,t){let n=Et.dereference(t,"string");try{n=ze(n)}catch(s){return this._throwError(s.message,t)}return e.writeValue(n)}decode(e){return ze(kd(e.readValue(),20))}}class Lv extends Gn{constructor(t){super(t.name,t.type,"_",t.dynamic);L(this,"coder");this.coder=t}defaultValue(){return this.coder.defaultValue()}encode(t,n){return this.coder.encode(t,n)}decode(t){return this.coder.decode(t)}}function Um(r,e,t){let n=[];if(Array.isArray(t))n=t;else if(t&&typeof t=="object"){let c={};n=e.map(l=>{const u=l.localName;return X(u,"cannot encode object for signature with missing names","INVALID_ARGUMENT",{argument:"values",info:{coder:l},value:t}),X(!c[u],"cannot encode object for signature with duplicate names","INVALID_ARGUMENT",{argument:"values",info:{coder:l},value:t}),c[u]=!0,t[u]})}else H(!1,"invalid tuple value","tuple",t);H(e.length===n.length,"types/value length mismatch","tuple",t);let s=new df,i=new df,o=[];e.forEach((c,l)=>{let u=n[l];if(c.dynamic){let h=i.length;c.encode(i,u);let f=s.writeUpdatableValue();o.push(d=>{f(d+h)})}else c.encode(s,u)}),o.forEach(c=>{c(s.length)});let a=r.appendWriter(s);return a+=r.appendWriter(i),a}function $m(r,e){let t=[],n=[],s=r.subReader(0);return e.forEach(i=>{let o=null;if(i.dynamic){let a=r.readIndex(),c=s.subReader(a);try{o=i.decode(c)}catch(l){if(St(l,"BUFFER_OVERRUN"))throw l;o=l,o.baseType=i.name,o.name=i.localName,o.type=i.type}}else try{o=i.decode(r)}catch(a){if(St(a,"BUFFER_OVERRUN"))throw a;o=a,o.baseType=i.name,o.name=i.localName,o.type=i.type}if(o==null)throw new Error("investigate");t.push(o),n.push(i.localName||null)}),Ko.fromItems(t,n)}class jv extends Gn{constructor(t,n,s){const i=t.type+"["+(n>=0?n:"")+"]",o=n===-1||t.dynamic;super("array",i,s,o);L(this,"coder");L(this,"length");oe(this,{coder:t,length:n})}defaultValue(){const t=this.coder.defaultValue(),n=[];for(let s=0;s<this.length;s++)n.push(t);return n}encode(t,n){const s=Et.dereference(n,"array");Array.isArray(s)||this._throwError("expected array value",s);let i=this.length;i===-1&&(i=s.length,t.writeValue(s.length)),Om(s.length,i,"coder array"+(this.localName?" "+this.localName:""));let o=[];for(let a=0;a<s.length;a++)o.push(this.coder);return Um(t,o,s)}decode(t){let n=this.length;n===-1&&(n=t.readIndex(),X(n*Ot<=t.dataLength,"insufficient data length","BUFFER_OVERRUN",{buffer:t.bytes,offset:n*Ot,length:t.dataLength}));let s=[];for(let i=0;i<n;i++)s.push(new Lv(this.coder));return $m(t,s)}}class Mv extends Gn{constructor(e){super("bool","bool",e,!1)}defaultValue(){return!1}encode(e,t){const n=Et.dereference(t,"bool");return e.writeValue(n?1:0)}decode(e){return!!e.readValue()}}class Fm extends Gn{constructor(e,t){super(e,e,t,!0)}defaultValue(){return"0x"}encode(e,t){t=ln(t);let n=e.writeValue(t.length);return n+=e.writeBytes(t),n}decode(e){return e.readBytes(e.readIndex(),!0)}}class zv extends Fm{constructor(e){super("bytes",e)}decode(e){return _e(super.decode(e))}}class qv extends Gn{constructor(t,n){let s="bytes"+String(t);super(s,s,n,!1);L(this,"size");oe(this,{size:t},{size:"number"})}defaultValue(){return"0x0000000000000000000000000000000000000000000000000000000000000000".substring(0,2+this.size*2)}encode(t,n){let s=ln(Et.dereference(n,this.type));return s.length!==this.size&&this._throwError("incorrect data length",n),t.writeBytes(s)}decode(t){return _e(t.readBytes(this.size))}}const Vv=new Uint8Array([]);class Kv extends Gn{constructor(e){super("null","",e,!1)}defaultValue(){return null}encode(e,t){return t!=null&&this._throwError("not null",t),e.writeBytes(Vv)}decode(e){return e.readBytes(0),null}}const Hv=BigInt(0),Gv=BigInt(1),Qv=BigInt("0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff");class Wv extends Gn{constructor(t,n,s){const i=(n?"int":"uint")+t*8;super(i,i,s,!1);L(this,"size");L(this,"signed");oe(this,{size:t,signed:n},{size:"number",signed:"boolean"})}defaultValue(){return 0}encode(t,n){let s=ce(Et.dereference(n,this.type)),i=oo(Qv,Ot*8);if(this.signed){let o=oo(i,this.size*8-1);(s>o||s<-(o+Gv))&&this._throwError("value out-of-bounds",n),s=uv(s,8*Ot)}else(s<Hv||s>oo(i,this.size*8))&&this._throwError("value out-of-bounds",n);return t.writeValue(s)}decode(t){let n=oo(t.readValue(),this.size*8);return this.signed&&(n=Rl(n,this.size*8)),n}}class Jv extends Fm{constructor(e){super("string",e)}defaultValue(){return""}encode(e,t){return super.encode(e,Bs(Et.dereference(t,"string")))}decode(e){return Bl(super.decode(e))}}class zc extends Gn{constructor(t,n){let s=!1;const i=[];t.forEach(a=>{a.dynamic&&(s=!0),i.push(a.type)});const o="tuple("+i.join(",")+")";super("tuple",o,n,s);L(this,"coders");oe(this,{coders:Object.freeze(t.slice())})}defaultValue(){const t=[];this.coders.forEach(s=>{t.push(s.defaultValue())});const n=this.coders.reduce((s,i)=>{const o=i.localName;return o&&(s[o]||(s[o]=0),s[o]++),s},{});return this.coders.forEach((s,i)=>{let o=s.localName;!o||n[o]!==1||(o==="length"&&(o="_length"),t[o]==null&&(t[o]=t[i]))}),Object.freeze(t)}encode(t,n){const s=Et.dereference(n,"tuple");return Um(t,this.coders,s)}decode(t){return $m(t,this.coders)}}var Yv="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";const Hp=new Map([[8217,"apostrophe"],[8260,"fraction slash"],[12539,"middle dot"]]),Gp=4;function Zv(r){let e=0;function t(){return r[e++]<<8|r[e++]}let n=t(),s=1,i=[0,1];for(let v=1;v<n;v++)i.push(s+=t());let o=t(),a=e;e+=o;let c=0,l=0;function u(){return c==0&&(l=l<<8|r[e++],c=8),l>>--c&1}const h=31,f=2**h,d=f>>>1,p=d>>1,g=f-1;let m=0;for(let v=0;v<h;v++)m=m<<1|u();let E=[],O=0,x=f;for(;;){let v=Math.floor(((m-O+1)*s-1)/x),S=0,D=n;for(;D-S>1;){let F=S+D>>>1;v<i[F]?D=F:S=F}if(S==0)break;E.push(S);let R=O+Math.floor(x*i[S]/s),_=O+Math.floor(x*i[S+1]/s)-1;for(;((R^_)&d)==0;)m=m<<1&g|u(),R=R<<1&g,_=_<<1&g|1;for(;R&~_&p;)m=m&d|m<<1&g>>>1|u(),R=R<<1^d,_=(_^d)<<1|d|1;O=R,x=1+_-R}let b=n-4;return E.map(v=>{switch(v-b){case 3:return b+65792+(r[a++]<<16|r[a++]<<8|r[a++]);case 2:return b+256+(r[a++]<<8|r[a++]);case 1:return b+r[a++];default:return v-1}})}function Xv(r){let e=0;return()=>r[e++]}function Lm(r){return Xv(Zv(eE(r)))}function eE(r){let e=[];[..."ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"].forEach((s,i)=>e[s.charCodeAt(0)]=i);let t=r.length,n=new Uint8Array(6*t>>3);for(let s=0,i=0,o=0,a=0;s<t;s++)a=a<<6|e[r.charCodeAt(s)],o+=6,o>=8&&(n[i++]=a>>(o-=8));return n}function tE(r){return r&1?~r>>1:r>>1}function rE(r,e){let t=Array(r);for(let n=0,s=0;n<r;n++)t[n]=s+=tE(e());return t}function Ka(r,e=0){let t=[];for(;;){let n=r(),s=r();if(!s)break;e+=n;for(let i=0;i<s;i++)t.push(e+i);e+=s+1}return t}function jm(r){return Ha(()=>{let e=Ka(r);if(e.length)return e})}function Mm(r){let e=[];for(;;){let t=r();if(t==0)break;e.push(nE(t,r))}for(;;){let t=r()-1;if(t<0)break;e.push(sE(t,r))}return e.flat()}function Ha(r){let e=[];for(;;){let t=r(e.length);if(!t)break;e.push(t)}return e}function zm(r,e,t){let n=Array(r).fill().map(()=>[]);for(let s=0;s<e;s++)rE(r,t).forEach((i,o)=>n[o].push(i));return n}function nE(r,e){let t=1+e(),n=e(),s=Ha(e);return zm(s.length,1+r,e).flatMap((o,a)=>{let[c,...l]=o;return Array(s[a]).fill().map((u,h)=>{let f=h*n;return[c+h*t,l.map(d=>d+f)]})})}function sE(r,e){let t=1+e();return zm(t,1+r,e).map(s=>[s[0],s.slice(1)])}function iE(r){let e=[],t=Ka(r);return s(n([]),[]),e;function n(i){let o=r(),a=Ha(()=>{let c=Ka(r).map(l=>t[l]);if(c.length)return n(c)});return{S:o,B:a,Q:i}}function s({S:i,B:o},a,c){if(!(i&4&&c===a[a.length-1])){i&2&&(c=a[a.length-1]),i&1&&e.push(a);for(let l of o)for(let u of l.Q)s(l,[...a,u],c)}}}function oE(r){return r.toString(16).toUpperCase().padStart(2,"0")}function qm(r){return`{${oE(r)}}`}function aE(r){let e=[];for(let t=0,n=r.length;t<n;){let s=r.codePointAt(t);t+=s<65536?1:2,e.push(s)}return e}function Ho(r){let t=r.length;if(t<4096)return String.fromCodePoint(...r);let n=[];for(let s=0;s<t;)n.push(String.fromCodePoint(...r.slice(s,s+=4096)));return n.join("")}function cE(r,e){let t=r.length,n=t-e.length;for(let s=0;n==0&&s<t;s++)n=r[s]-e[s];return n}var lE="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";const Ga=44032,Tl=4352,kl=4449,Ul=4519,Vm=19,Km=21,Go=28,$l=Km*Go,uE=Vm*$l,hE=Ga+uE,fE=Tl+Vm,dE=kl+Km,pE=Ul+Go;function Oa(r){return r>>24&255}function Hm(r){return r&16777215}let yf,Qp,mf,hl;function gE(){let r=Lm(lE);yf=new Map(jm(r).flatMap((e,t)=>e.map(n=>[n,t+1<<24]))),Qp=new Set(Ka(r)),mf=new Map,hl=new Map;for(let[e,t]of Mm(r)){if(!Qp.has(e)&&t.length==2){let[n,s]=t,i=hl.get(n);i||(i=new Map,hl.set(n,i)),i.set(s,e)}mf.set(e,t.reverse())}}function Gm(r){return r>=Ga&&r<hE}function yE(r,e){if(r>=Tl&&r<fE&&e>=kl&&e<dE)return Ga+(r-Tl)*$l+(e-kl)*Go;if(Gm(r)&&e>Ul&&e<pE&&(r-Ga)%Go==0)return r+(e-Ul);{let t=hl.get(r);return t&&(t=t.get(e),t)?t:-1}}function Qm(r){yf||gE();let e=[],t=[],n=!1;function s(i){let o=yf.get(i);o&&(n=!0,i|=o),e.push(i)}for(let i of r)for(;;){if(i<128)e.push(i);else if(Gm(i)){let o=i-Ga,a=o/$l|0,c=o%$l/Go|0,l=o%Go;s(Tl+a),s(kl+c),l>0&&s(Ul+l)}else{let o=mf.get(i);o?t.push(...o):s(i)}if(!t.length)break;i=t.pop()}if(n&&e.length>1){let i=Oa(e[0]);for(let o=1;o<e.length;o++){let a=Oa(e[o]);if(a==0||i<=a){i=a;continue}let c=o-1;for(;;){let l=e[c+1];if(e[c+1]=e[c],e[c]=l,!c||(i=Oa(e[--c]),i<=a))break}i=Oa(e[o])}}return e}function mE(r){let e=[],t=[],n=-1,s=0;for(let i of r){let o=Oa(i),a=Hm(i);if(n==-1)o==0?n=a:e.push(a);else if(s>0&&s>=o)o==0?(e.push(n,...t),t.length=0,n=a):t.push(a),s=o;else{let c=yE(n,a);c>=0?n=c:s==0&&o==0?(e.push(n),n=a):(t.push(a),s=o)}}return n>=0&&e.push(n,...t),e}function Wm(r){return Qm(r).map(Hm)}function wE(r){return mE(Qm(r))}const Wp=45,Jm=".",Ym=65039,Zm=1,Fl=r=>Array.from(r);function Qa(r,e){return r.P.has(e)||r.Q.has(e)}class bE extends Array{get is_emoji(){return!0}}let wf,Xm,ri,bf,ew,go,Qu,no,Ws,Jp,xf;function Ld(){if(wf)return;let r=Lm(Yv);const e=()=>Ka(r),t=()=>new Set(e()),n=(u,h)=>h.forEach(f=>u.add(f));wf=new Map(Mm(r)),Xm=t(),ri=e(),bf=new Set(e().map(u=>ri[u])),ri=new Set(ri),ew=t(),t();let s=jm(r),i=r();const o=()=>{let u=new Set;return e().forEach(h=>n(u,s[h])),n(u,e()),u};go=Ha(u=>{let h=Ha(r).map(f=>f+96);if(h.length){let f=u>=i;h[0]-=32,h=Ho(h),f&&(h=`Restricted[${h}]`);let d=o(),p=o(),g=!r();return{N:h,P:d,Q:p,M:g,R:f}}}),Qu=t(),no=new Map;let a=e().concat(Fl(Qu)).sort((u,h)=>u-h);a.forEach((u,h)=>{let f=r(),d=a[h]=f?a[h-f]:{V:[],M:new Map};d.V.push(u),Qu.has(u)||no.set(u,d)});for(let{V:u,M:h}of new Set(no.values())){let f=[];for(let p of u){let g=go.filter(E=>Qa(E,p)),m=f.find(({G:E})=>g.some(O=>E.has(O)));m||(m={G:new Set,V:[]},f.push(m)),m.V.push(p),n(m.G,g)}let d=f.flatMap(p=>Fl(p.G));for(let{G:p,V:g}of f){let m=new Set(d.filter(E=>!p.has(E)));for(let E of g)h.set(E,m)}}Ws=new Set;let c=new Set;const l=u=>Ws.has(u)?c.add(u):Ws.add(u);for(let u of go){for(let h of u.P)l(h);for(let h of u.Q)l(h)}for(let u of Ws)!no.has(u)&&!c.has(u)&&no.set(u,Zm);n(Ws,Wm(Ws)),Jp=iE(r).map(u=>bE.from(u)).sort(cE),xf=new Map;for(let u of Jp){let h=[xf];for(let f of u){let d=h.map(p=>{let g=p.get(f);return g||(g=new Map,p.set(f,g)),g});f===Ym?h.push(...d):h=d}for(let f of h)f.V=u}}function jd(r){return(tw(r)?"":`${Md(yu([r]))} `)+qm(r)}function Md(r){return`"${r}"`}function xE(r){if(r.length>=4&&r[2]==Wp&&r[3]==Wp)throw new Error(`invalid label extension: "${Ho(r.slice(0,4))}"`)}function vE(r){for(let t=r.lastIndexOf(95);t>0;)if(r[--t]!==95)throw new Error("underscore allowed only at start")}function EE(r){let e=r[0],t=Hp.get(e);if(t)throw Ta(`leading ${t}`);let n=r.length,s=-1;for(let i=1;i<n;i++){e=r[i];let o=Hp.get(e);if(o){if(s==i)throw Ta(`${t} + ${o}`);s=i+1,t=o}}if(s==n)throw Ta(`trailing ${t}`)}function yu(r,e=1/0,t=qm){let n=[];AE(r[0])&&n.push(""),r.length>e&&(e>>=1,r=[...r.slice(0,e),8230,...r.slice(-e)]);let s=0,i=r.length;for(let o=0;o<i;o++){let a=r[o];tw(a)&&(n.push(Ho(r.slice(s,o))),n.push(t(a)),s=o+1)}return n.push(Ho(r.slice(s,i))),n.join("")}function AE(r){return Ld(),ri.has(r)}function tw(r){return Ld(),ew.has(r)}function IE(r){return _E(SE(r,wE,BE))}function SE(r,e,t){if(!r)return[];Ld();let n=0;return r.split(Jm).map(s=>{let i=aE(s),o={input:i,offset:n};n+=i.length+1;try{let a=o.tokens=CE(i,e,t),c=a.length,l;if(!c)throw new Error("empty label");let u=o.output=a.flat();if(vE(u),!(o.emoji=c>1||a[0].is_emoji)&&u.every(f=>f<128))xE(u),l="ASCII";else{let f=a.flatMap(d=>d.is_emoji?[]:d);if(!f.length)l="Emoji";else{if(ri.has(u[0]))throw Ta("leading combining mark");for(let g=1;g<c;g++){let m=a[g];if(!m.is_emoji&&ri.has(m[0]))throw Ta(`emoji + combining mark: "${Ho(a[g-1])} + ${yu([m[0]])}"`)}EE(u);let d=Fl(new Set(f)),[p]=DE(d);NE(p,f),OE(p,d),l=p.N}}o.type=l}catch(a){o.error=a}return o})}function OE(r,e){let t,n=[];for(let s of e){let i=no.get(s);if(i===Zm)return;if(i){let o=i.M.get(s);if(t=t?t.filter(a=>o.has(a)):Fl(o),!t.length)return}else n.push(s)}if(t){for(let s of t)if(n.every(i=>Qa(s,i)))throw new Error(`whole-script confusable: ${r.N}/${s.N}`)}}function DE(r){let e=go;for(let t of r){let n=e.filter(s=>Qa(s,t));if(!n.length)throw go.some(s=>Qa(s,t))?nw(e[0],t):rw(t);if(e=n,n.length==1)break}return e}function _E(r){return r.map(({input:e,error:t,output:n})=>{if(t){let s=t.message;throw new Error(r.length==1?s:`Invalid label ${Md(yu(e,63))}: ${s}`)}return Ho(n)}).join(Jm)}function rw(r){return new Error(`disallowed character: ${jd(r)}`)}function nw(r,e){let t=jd(e),n=go.find(s=>s.P.has(e));return n&&(t=`${n.N} ${t}`),new Error(`illegal mixture: ${r.N} + ${t}`)}function Ta(r){return new Error(`illegal placement: ${r}`)}function NE(r,e){for(let t of e)if(!Qa(r,t))throw nw(r,t);if(r.M){let t=Wm(e);for(let n=1,s=t.length;n<s;n++)if(bf.has(t[n])){let i=n+1;for(let o;i<s&&bf.has(o=t[i]);i++)for(let a=n;a<i;a++)if(t[a]==o)throw new Error(`duplicate non-spacing marks: ${jd(o)}`);if(i-n>Gp)throw new Error(`excessive non-spacing marks: ${Md(yu(t.slice(n-1,i)))} (${i-n}/${Gp})`);n=i}}}function CE(r,e,t){let n=[],s=[];for(r=r.slice().reverse();r.length;){let i=RE(r);if(i)s.length&&(n.push(e(s)),s=[]),n.push(t(i));else{let o=r.pop();if(Ws.has(o))s.push(o);else{let a=wf.get(o);if(a)s.push(...a);else if(!Xm.has(o))throw rw(o)}}}return s.length&&n.push(e(s)),n}function BE(r){return r.filter(e=>e!=Ym)}function RE(r,e){let t=xf,n,s=r.length;for(;s&&(t=t.get(r[--s]),!!t);){let{V:i}=t;i&&(n=i,r.length=s)}return n}const sw=new Uint8Array(32);sw.fill(0);function Yp(r){return H(r.length!==0,"invalid ENS name; empty component","comp",r),r}function iw(r){const e=Bs(PE(r)),t=[];if(r.length===0)return t;let n=0;for(let s=0;s<e.length;s++)e[s]===46&&(t.push(Yp(e.slice(n,s))),n=s+1);return H(n<e.length,"invalid ENS name; empty component","name",r),t.push(Yp(e.slice(n))),t}function PE(r){try{if(r.length===0)throw new Error("empty label");return IE(r)}catch(e){H(!1,`invalid ENS name (${e.message})`,"name",r)}}function vf(r){H(typeof r=="string","invalid ENS name; not a string","name",r),H(r.length,"invalid ENS name (empty label)","name",r);let e=sw;const t=iw(r);for(;t.length;)e=qa(cn([e,qa(t.pop())]));return _e(e)}function TE(r,e){const t=e;return H(t<=255,"DNS encoded label cannot exceed 255","length",t),_e(cn(iw(r).map(n=>{H(n.length<=t,`label ${JSON.stringify(r)} exceeds ${t} bytes`,"name",r);const s=new Uint8Array(n.length+1);return s.set(n,1),s[0]=s.length-1,s})))+"00"}function Dt(r){const e=new Set;return r.forEach(t=>e.add(t)),Object.freeze(e)}const kE="external public payable override",UE=Dt(kE.split(" ")),ow="constant external internal payable private public pure view override",$E=Dt(ow.split(" ")),aw="constructor error event fallback function receive struct",cw=Dt(aw.split(" ")),lw="calldata memory storage payable indexed",FE=Dt(lw.split(" ")),LE="tuple returns",jE=[aw,lw,LE,ow].join(" "),ME=Dt(jE.split(" ")),zE={"(":"OPEN_PAREN",")":"CLOSE_PAREN","[":"OPEN_BRACKET","]":"CLOSE_BRACKET",",":"COMMA","@":"AT"},qE=new RegExp("^(\\s*)"),VE=new RegExp("^([0-9]+)"),KE=new RegExp("^([a-zA-Z$_][a-zA-Z0-9$_]*)"),uw=new RegExp("^([a-zA-Z$_][a-zA-Z0-9$_]*)$"),hw=new RegExp("^(address|bool|bytes([0-9]*)|string|u?int([0-9]*))$");var ot,Cr,hc,Ef;const au=class au{constructor(e){z(this,hc);z(this,ot);z(this,Cr);P(this,ot,0),P(this,Cr,e.slice())}get offset(){return y(this,ot)}get length(){return y(this,Cr).length-y(this,ot)}clone(){return new au(y(this,Cr))}reset(){P(this,ot,0)}popKeyword(e){const t=this.peek();if(t.type!=="KEYWORD"||!e.has(t.text))throw new Error(`expected keyword ${t.text}`);return this.pop().text}popType(e){if(this.peek().type!==e){const t=this.peek();throw new Error(`expected ${e}; got ${t.type} ${JSON.stringify(t.text)}`)}return this.pop().text}popParen(){const e=this.peek();if(e.type!=="OPEN_PAREN")throw new Error("bad start");const t=K(this,hc,Ef).call(this,y(this,ot)+1,e.match+1);return P(this,ot,e.match+1),t}popParams(){const e=this.peek();if(e.type!=="OPEN_PAREN")throw new Error("bad start");const t=[];for(;y(this,ot)<e.match-1;){const n=this.peek().linkNext;t.push(K(this,hc,Ef).call(this,y(this,ot)+1,n)),P(this,ot,n)}return P(this,ot,e.match+1),t}peek(){if(y(this,ot)>=y(this,Cr).length)throw new Error("out-of-bounds");return y(this,Cr)[y(this,ot)]}peekKeyword(e){const t=this.peekType("KEYWORD");return t!=null&&e.has(t)?t:null}peekType(e){if(this.length===0)return null;const t=this.peek();return t.type===e?t.text:null}pop(){const e=this.peek();return aa(this,ot)._++,e}toString(){const e=[];for(let t=y(this,ot);t<y(this,Cr).length;t++){const n=y(this,Cr)[t];e.push(`${n.type}:${n.text}`)}return`<TokenString ${e.join(" ")}>`}};ot=new WeakMap,Cr=new WeakMap,hc=new WeakSet,Ef=function(e=0,t=0){return new au(y(this,Cr).slice(e,t).map(n=>Object.freeze(Object.assign({},n,{match:n.match-e,linkBack:n.linkBack-e,linkNext:n.linkNext-e}))))};let Pr=au;function Ls(r){const e=[],t=o=>{const a=i<r.length?JSON.stringify(r[i]):"$EOI";throw new Error(`invalid token ${a} at ${i}: ${o}`)};let n=[],s=[],i=0;for(;i<r.length;){let o=r.substring(i),a=o.match(qE);a&&(i+=a[1].length,o=r.substring(i));const c={depth:n.length,linkBack:-1,linkNext:-1,match:-1,type:"",text:"",offset:i,value:-1};e.push(c);let l=zE[o[0]]||"";if(l){if(c.type=l,c.text=o[0],i++,l==="OPEN_PAREN")n.push(e.length-1),s.push(e.length-1);else if(l=="CLOSE_PAREN")n.length===0&&t("no matching open bracket"),c.match=n.pop(),e[c.match].match=e.length-1,c.depth--,c.linkBack=s.pop(),e[c.linkBack].linkNext=e.length-1;else if(l==="COMMA")c.linkBack=s.pop(),e[c.linkBack].linkNext=e.length-1,s.push(e.length-1);else if(l==="OPEN_BRACKET")c.type="BRACKET";else if(l==="CLOSE_BRACKET"){let u=e.pop().text;if(e.length>0&&e[e.length-1].type==="NUMBER"){const h=e.pop().text;u=h+u,e[e.length-1].value=Ee(h)}if(e.length===0||e[e.length-1].type!=="BRACKET")throw new Error("missing opening bracket");e[e.length-1].text+=u}continue}if(a=o.match(KE),a){if(c.text=a[1],i+=c.text.length,ME.has(c.text)){c.type="KEYWORD";continue}if(c.text.match(hw)){c.type="TYPE";continue}c.type="ID";continue}if(a=o.match(VE),a){c.text=a[1],c.type="NUMBER",i+=c.text.length;continue}throw new Error(`unexpected token ${JSON.stringify(o[0])} at position ${i}`)}return new Pr(e.map(o=>Object.freeze(o)))}function Zp(r,e){let t=[];for(const n in e.keys())r.has(n)&&t.push(n);if(t.length>1)throw new Error(`conflicting types: ${t.join(", ")}`)}function mu(r,e){if(e.peekKeyword(cw)){const t=e.pop().text;if(t!==r)throw new Error(`expected ${r}, got ${t}`)}return e.popType("ID")}function Vn(r,e){const t=new Set;for(;;){const n=r.peekType("KEYWORD");if(n==null||e&&!e.has(n))break;if(r.pop(),t.has(n))throw new Error(`duplicate keywords: ${JSON.stringify(n)}`);t.add(n)}return Object.freeze(t)}function fw(r){let e=Vn(r,$E);return Zp(e,Dt("constant payable nonpayable".split(" "))),Zp(e,Dt("pure view payable nonpayable".split(" "))),e.has("view")?"view":e.has("pure")?"pure":e.has("payable")?"payable":e.has("nonpayable")?"nonpayable":e.has("constant")?"view":"nonpayable"}function jn(r,e){return r.popParams().map(t=>ct.from(t,e))}function dw(r){if(r.peekType("AT")){if(r.pop(),r.peekType("NUMBER"))return ce(r.pop().text);throw new Error("invalid gas")}return null}function Ri(r){if(r.length)throw new Error(`unexpected tokens at offset ${r.offset}: ${r.toString()}`)}const HE=new RegExp(/^(.*)\[([0-9]*)\]$/);function Xp(r){const e=r.match(hw);if(H(e,"invalid type","type",r),r==="uint")return"uint256";if(r==="int")return"int256";if(e[2]){const t=parseInt(e[2]);H(t!==0&&t<=32,"invalid bytes length","type",r)}else if(e[3]){const t=parseInt(e[3]);H(t!==0&&t<=256&&t%8===0,"invalid numeric width","type",r)}return r}const ke={},Kt=Symbol.for("_ethers_internal"),eg="_ParamTypeInternal",tg="_ErrorInternal",rg="_EventInternal",ng="_ConstructorInternal",sg="_FallbackInternal",ig="_FunctionInternal",og="_StructInternal";var _o,fl;const ur=class ur{constructor(e,t,n,s,i,o,a,c){z(this,_o);L(this,"name");L(this,"type");L(this,"baseType");L(this,"indexed");L(this,"components");L(this,"arrayLength");L(this,"arrayChildren");if(pu(e,ke,"ParamType"),Object.defineProperty(this,Kt,{value:eg}),o&&(o=Object.freeze(o.slice())),s==="array"){if(a==null||c==null)throw new Error("")}else if(a!=null||c!=null)throw new Error("");if(s==="tuple"){if(o==null)throw new Error("")}else if(o!=null)throw new Error("");oe(this,{name:t,type:n,baseType:s,indexed:i,components:o,arrayLength:a,arrayChildren:c})}format(e){if(e==null&&(e="sighash"),e==="json"){const n=this.name||"";if(this.isArray()){const i=JSON.parse(this.arrayChildren.format("json"));return i.name=n,i.type+=`[${this.arrayLength<0?"":String(this.arrayLength)}]`,JSON.stringify(i)}const s={type:this.baseType==="tuple"?"tuple":this.type,name:n};return typeof this.indexed=="boolean"&&(s.indexed=this.indexed),this.isTuple()&&(s.components=this.components.map(i=>JSON.parse(i.format(e)))),JSON.stringify(s)}let t="";return this.isArray()?(t+=this.arrayChildren.format(e),t+=`[${this.arrayLength<0?"":String(this.arrayLength)}]`):this.isTuple()?t+="("+this.components.map(n=>n.format(e)).join(e==="full"?", ":",")+")":t+=this.type,e!=="sighash"&&(this.indexed===!0&&(t+=" indexed"),e==="full"&&this.name&&(t+=" "+this.name)),t}isArray(){return this.baseType==="array"}isTuple(){return this.baseType==="tuple"}isIndexable(){return this.indexed!=null}walk(e,t){if(this.isArray()){if(!Array.isArray(e))throw new Error("invalid array value");if(this.arrayLength!==-1&&e.length!==this.arrayLength)throw new Error("array is wrong length");const n=this;return e.map(s=>n.arrayChildren.walk(s,t))}if(this.isTuple()){if(!Array.isArray(e))throw new Error("invalid tuple value");if(e.length!==this.components.length)throw new Error("array is wrong length");const n=this;return e.map((s,i)=>n.components[i].walk(s,t))}return t(this.type,e)}async walkAsync(e,t){const n=[],s=[e];return K(this,_o,fl).call(this,n,e,t,i=>{s[0]=i}),n.length&&await Promise.all(n),s[0]}static from(e,t){if(ur.isParamType(e))return e;if(typeof e=="string")try{return ur.from(Ls(e),t)}catch{H(!1,"invalid param type","obj",e)}else if(e instanceof Pr){let a="",c="",l=null;Vn(e,Dt(["tuple"])).has("tuple")||e.peekType("OPEN_PAREN")?(c="tuple",l=e.popParams().map(g=>ur.from(g)),a=`tuple(${l.map(g=>g.format()).join(",")})`):(a=Xp(e.popType("TYPE")),c=a);let u=null,h=null;for(;e.length&&e.peekType("BRACKET");){const g=e.pop();u=new ur(ke,"",a,c,null,l,h,u),h=g.value,a+=g.text,c="array",l=null}let f=null;if(Vn(e,FE).has("indexed")){if(!t)throw new Error("");f=!0}const p=e.peekType("ID")?e.pop().text:"";if(e.length)throw new Error("leftover tokens");return new ur(ke,p,a,c,f,l,h,u)}const n=e.name;H(!n||typeof n=="string"&&n.match(uw),"invalid name","obj.name",n);let s=e.indexed;s!=null&&(H(t,"parameter cannot be indexed","obj.indexed",e.indexed),s=!!s);let i=e.type,o=i.match(HE);if(o){const a=parseInt(o[2]||"-1"),c=ur.from({type:o[1],components:e.components});return new ur(ke,n||"",i,"array",s,null,a,c)}if(i==="tuple"||i.startsWith("tuple(")||i.startsWith("(")){const a=e.components!=null?e.components.map(l=>ur.from(l)):null;return new ur(ke,n||"",i,"tuple",s,a,null,null)}return i=Xp(e.type),new ur(ke,n||"",i,i,s,null,null,null)}static isParamType(e){return e&&e[Kt]===eg}};_o=new WeakSet,fl=function(e,t,n,s){if(this.isArray()){if(!Array.isArray(t))throw new Error("invalid array value");if(this.arrayLength!==-1&&t.length!==this.arrayLength)throw new Error("array is wrong length");const o=this.arrayChildren,a=t.slice();a.forEach((c,l)=>{var u;K(u=o,_o,fl).call(u,e,c,n,h=>{a[l]=h})}),s(a);return}if(this.isTuple()){const o=this.components;let a;if(Array.isArray(t))a=t.slice();else{if(t==null||typeof t!="object")throw new Error("invalid tuple value");a=o.map(c=>{if(!c.name)throw new Error("cannot use object value with unnamed components");if(!(c.name in t))throw new Error(`missing value for component ${c.name}`);return t[c.name]})}if(a.length!==this.components.length)throw new Error("array is wrong length");a.forEach((c,l)=>{var u;K(u=o[l],_o,fl).call(u,e,c,n,h=>{a[l]=h})}),s(a);return}const i=n(this.type,t);i.then?e.push((async function(){s(await i)})()):s(i)};let ct=ur;class Pi{constructor(e,t,n){L(this,"type");L(this,"inputs");pu(e,ke,"Fragment"),n=Object.freeze(n.slice()),oe(this,{type:t,inputs:n})}static from(e){if(typeof e=="string"){try{Pi.from(JSON.parse(e))}catch{}return Pi.from(Ls(e))}if(e instanceof Pr)switch(e.peekKeyword(cw)){case"constructor":return Fn.from(e);case"error":return Mt.from(e);case"event":return rn.from(e);case"fallback":case"receive":return Sn.from(e);case"function":return nn.from(e);case"struct":return Di.from(e)}else if(typeof e=="object"){switch(e.type){case"constructor":return Fn.from(e);case"error":return Mt.from(e);case"event":return rn.from(e);case"fallback":case"receive":return Sn.from(e);case"function":return nn.from(e);case"struct":return Di.from(e)}X(!1,`unsupported type: ${e.type}`,"UNSUPPORTED_OPERATION",{operation:"Fragment.from"})}H(!1,"unsupported frgament object","obj",e)}static isConstructor(e){return Fn.isFragment(e)}static isError(e){return Mt.isFragment(e)}static isEvent(e){return rn.isFragment(e)}static isFunction(e){return nn.isFragment(e)}static isStruct(e){return Di.isFragment(e)}}class wu extends Pi{constructor(t,n,s,i){super(t,n,i);L(this,"name");H(typeof s=="string"&&s.match(uw),"invalid identifier","name",s),i=Object.freeze(i.slice()),oe(this,{name:s})}}function Wa(r,e){return"("+e.map(t=>t.format(r)).join(r==="full"?", ":",")+")"}class Mt extends wu{constructor(e,t,n){super(e,"error",t,n),Object.defineProperty(this,Kt,{value:tg})}get selector(){return Va(this.format("sighash")).substring(0,10)}format(e){if(e==null&&(e="sighash"),e==="json")return JSON.stringify({type:"error",name:this.name,inputs:this.inputs.map(n=>JSON.parse(n.format(e)))});const t=[];return e!=="sighash"&&t.push("error"),t.push(this.name+Wa(e,this.inputs)),t.join(" ")}static from(e){if(Mt.isFragment(e))return e;if(typeof e=="string")return Mt.from(Ls(e));if(e instanceof Pr){const t=mu("error",e),n=jn(e);return Ri(e),new Mt(ke,t,n)}return new Mt(ke,e.name,e.inputs?e.inputs.map(ct.from):[])}static isFragment(e){return e&&e[Kt]===tg}}class rn extends wu{constructor(t,n,s,i){super(t,"event",n,s);L(this,"anonymous");Object.defineProperty(this,Kt,{value:rg}),oe(this,{anonymous:i})}get topicHash(){return Va(this.format("sighash"))}format(t){if(t==null&&(t="sighash"),t==="json")return JSON.stringify({type:"event",anonymous:this.anonymous,name:this.name,inputs:this.inputs.map(s=>JSON.parse(s.format(t)))});const n=[];return t!=="sighash"&&n.push("event"),n.push(this.name+Wa(t,this.inputs)),t!=="sighash"&&this.anonymous&&n.push("anonymous"),n.join(" ")}static getTopicHash(t,n){return n=(n||[]).map(i=>ct.from(i)),new rn(ke,t,n,!1).topicHash}static from(t){if(rn.isFragment(t))return t;if(typeof t=="string")try{return rn.from(Ls(t))}catch{H(!1,"invalid event fragment","obj",t)}else if(t instanceof Pr){const n=mu("event",t),s=jn(t,!0),i=!!Vn(t,Dt(["anonymous"])).has("anonymous");return Ri(t),new rn(ke,n,s,i)}return new rn(ke,t.name,t.inputs?t.inputs.map(n=>ct.from(n,!0)):[],!!t.anonymous)}static isFragment(t){return t&&t[Kt]===rg}}class Fn extends Pi{constructor(t,n,s,i,o){super(t,n,s);L(this,"payable");L(this,"gas");Object.defineProperty(this,Kt,{value:ng}),oe(this,{payable:i,gas:o})}format(t){if(X(t!=null&&t!=="sighash","cannot format a constructor for sighash","UNSUPPORTED_OPERATION",{operation:"format(sighash)"}),t==="json")return JSON.stringify({type:"constructor",stateMutability:this.payable?"payable":"undefined",payable:this.payable,gas:this.gas!=null?this.gas:void 0,inputs:this.inputs.map(s=>JSON.parse(s.format(t)))});const n=[`constructor${Wa(t,this.inputs)}`];return this.payable&&n.push("payable"),this.gas!=null&&n.push(`@${this.gas.toString()}`),n.join(" ")}static from(t){if(Fn.isFragment(t))return t;if(typeof t=="string")try{return Fn.from(Ls(t))}catch{H(!1,"invalid constuctor fragment","obj",t)}else if(t instanceof Pr){Vn(t,Dt(["constructor"]));const n=jn(t),s=!!Vn(t,UE).has("payable"),i=dw(t);return Ri(t),new Fn(ke,"constructor",n,s,i)}return new Fn(ke,"constructor",t.inputs?t.inputs.map(ct.from):[],!!t.payable,t.gas!=null?t.gas:null)}static isFragment(t){return t&&t[Kt]===ng}}class Sn extends Pi{constructor(t,n,s){super(t,"fallback",n);L(this,"payable");Object.defineProperty(this,Kt,{value:sg}),oe(this,{payable:s})}format(t){const n=this.inputs.length===0?"receive":"fallback";if(t==="json"){const s=this.payable?"payable":"nonpayable";return JSON.stringify({type:n,stateMutability:s})}return`${n}()${this.payable?" payable":""}`}static from(t){if(Sn.isFragment(t))return t;if(typeof t=="string")try{return Sn.from(Ls(t))}catch{H(!1,"invalid fallback fragment","obj",t)}else if(t instanceof Pr){const n=t.toString(),s=t.peekKeyword(Dt(["fallback","receive"]));if(H(s,"type must be fallback or receive","obj",n),t.popKeyword(Dt(["fallback","receive"]))==="receive"){const c=jn(t);return H(c.length===0,"receive cannot have arguments","obj.inputs",c),Vn(t,Dt(["payable"])),Ri(t),new Sn(ke,[],!0)}let o=jn(t);o.length?H(o.length===1&&o[0].type==="bytes","invalid fallback inputs","obj.inputs",o.map(c=>c.format("minimal")).join(", ")):o=[ct.from("bytes")];const a=fw(t);if(H(a==="nonpayable"||a==="payable","fallback cannot be constants","obj.stateMutability",a),Vn(t,Dt(["returns"])).has("returns")){const c=jn(t);H(c.length===1&&c[0].type==="bytes","invalid fallback outputs","obj.outputs",c.map(l=>l.format("minimal")).join(", "))}return Ri(t),new Sn(ke,o,a==="payable")}if(t.type==="receive")return new Sn(ke,[],!0);if(t.type==="fallback"){const n=[ct.from("bytes")],s=t.stateMutability==="payable";return new Sn(ke,n,s)}H(!1,"invalid fallback description","obj",t)}static isFragment(t){return t&&t[Kt]===sg}}class nn extends wu{constructor(t,n,s,i,o,a){super(t,"function",n,i);L(this,"constant");L(this,"outputs");L(this,"stateMutability");L(this,"payable");L(this,"gas");Object.defineProperty(this,Kt,{value:ig}),o=Object.freeze(o.slice()),oe(this,{constant:s==="view"||s==="pure",gas:a,outputs:o,payable:s==="payable",stateMutability:s})}get selector(){return Va(this.format("sighash")).substring(0,10)}format(t){if(t==null&&(t="sighash"),t==="json")return JSON.stringify({type:"function",name:this.name,constant:this.constant,stateMutability:this.stateMutability!=="nonpayable"?this.stateMutability:void 0,payable:this.payable,gas:this.gas!=null?this.gas:void 0,inputs:this.inputs.map(s=>JSON.parse(s.format(t))),outputs:this.outputs.map(s=>JSON.parse(s.format(t)))});const n=[];return t!=="sighash"&&n.push("function"),n.push(this.name+Wa(t,this.inputs)),t!=="sighash"&&(this.stateMutability!=="nonpayable"&&n.push(this.stateMutability),this.outputs&&this.outputs.length&&(n.push("returns"),n.push(Wa(t,this.outputs))),this.gas!=null&&n.push(`@${this.gas.toString()}`)),n.join(" ")}static getSelector(t,n){return n=(n||[]).map(i=>ct.from(i)),new nn(ke,t,"view",n,[],null).selector}static from(t){if(nn.isFragment(t))return t;if(typeof t=="string")try{return nn.from(Ls(t))}catch{H(!1,"invalid function fragment","obj",t)}else if(t instanceof Pr){const s=mu("function",t),i=jn(t),o=fw(t);let a=[];Vn(t,Dt(["returns"])).has("returns")&&(a=jn(t));const c=dw(t);return Ri(t),new nn(ke,s,o,i,a,c)}let n=t.stateMutability;return n==null&&(n="payable",typeof t.constant=="boolean"?(n="view",t.constant||(n="payable",typeof t.payable=="boolean"&&!t.payable&&(n="nonpayable"))):typeof t.payable=="boolean"&&!t.payable&&(n="nonpayable")),new nn(ke,t.name,n,t.inputs?t.inputs.map(ct.from):[],t.outputs?t.outputs.map(ct.from):[],t.gas!=null?t.gas:null)}static isFragment(t){return t&&t[Kt]===ig}}class Di extends wu{constructor(e,t,n){super(e,"struct",t,n),Object.defineProperty(this,Kt,{value:og})}format(){throw new Error("@TODO")}static from(e){if(typeof e=="string")try{return Di.from(Ls(e))}catch{H(!1,"invalid struct fragment","obj",e)}else if(e instanceof Pr){const t=mu("struct",e),n=jn(e);return Ri(e),new Di(ke,t,n)}return new Di(ke,e.name,e.inputs?e.inputs.map(ct.from):[])}static isFragment(e){return e&&e[Kt]===og}}const kr=new Map;kr.set(0,"GENERIC_PANIC");kr.set(1,"ASSERT_FALSE");kr.set(17,"OVERFLOW");kr.set(18,"DIVIDE_BY_ZERO");kr.set(33,"ENUM_RANGE_ERROR");kr.set(34,"BAD_STORAGE_DATA");kr.set(49,"STACK_UNDERFLOW");kr.set(50,"ARRAY_RANGE_ERROR");kr.set(65,"OUT_OF_MEMORY");kr.set(81,"UNINITIALIZED_FUNCTION_CALL");const GE=new RegExp(/^bytes([0-9]*)$/),QE=new RegExp(/^(u?int)([0-9]*)$/);let Wu=null,ag=1024;function WE(r,e,t,n){let s="missing revert data",i=null;const o=null;let a=null;if(t){s="execution reverted";const l=Bi(t);if(t=_e(t),l.length===0)s+=" (no data present; likely require(false) occurred",i="require(false)";else if(l.length%32!==4)s+=" (could not decode reason; invalid data length)";else if(_e(l.slice(0,4))==="0x08c379a0")try{i=n.decode(["string"],l.slice(4))[0],a={signature:"Error(string)",name:"Error",args:[i]},s+=`: ${JSON.stringify(i)}`}catch{s+=" (could not decode reason; invalid string data)"}else if(_e(l.slice(0,4))==="0x4e487b71")try{const u=Number(n.decode(["uint256"],l.slice(4))[0]);a={signature:"Panic(uint256)",name:"Panic",args:[u]},i=`Panic due to ${kr.get(u)||"UNKNOWN"}(${u})`,s+=`: ${i}`}catch{s+=" (could not decode panic code)"}else s+=" (unknown custom error)"}const c={to:e.to?ze(e.to):null,data:e.data||"0x"};return e.from&&(c.from=ze(e.from)),Le(s,"CALL_EXCEPTION",{action:r,data:t,reason:i,transaction:c,invocation:o,revert:a})}var ms,so;const cu=class cu{constructor(){z(this,ms)}getDefaultValue(e){const t=e.map(s=>K(this,ms,so).call(this,ct.from(s)));return new zc(t,"_").defaultValue()}encode(e,t){Om(t.length,e.length,"types/values length mismatch");const n=e.map(o=>K(this,ms,so).call(this,ct.from(o))),s=new zc(n,"_"),i=new df;return s.encode(i,t),i.data}decode(e,t,n){const s=e.map(o=>K(this,ms,so).call(this,ct.from(o)));return new zc(s,"_").decode(new pf(t,n,ag))}static _setDefaultMaxInflation(e){H(typeof e=="number"&&Number.isInteger(e),"invalid defaultMaxInflation factor","value",e),ag=e}static defaultAbiCoder(){return Wu==null&&(Wu=new cu),Wu}static getBuiltinCallException(e,t,n){return WE(e,t,n,cu.defaultAbiCoder())}};ms=new WeakSet,so=function(e){if(e.isArray())return new jv(K(this,ms,so).call(this,e.arrayChildren),e.arrayLength,e.name);if(e.isTuple())return new zc(e.components.map(n=>K(this,ms,so).call(this,n)),e.name);switch(e.baseType){case"address":return new Fv(e.name);case"bool":return new Mv(e.name);case"string":return new Jv(e.name);case"bytes":return new zv(e.name);case"":return new Kv(e.name)}let t=e.type.match(QE);if(t){let n=parseInt(t[2]||"256");return H(n!==0&&n<=256&&n%8===0,"invalid "+t[1]+" bit length","param",e),new Wv(n/8,t[1]==="int",e.name)}if(t=e.type.match(GE),t){let n=parseInt(t[1]);return H(n!==0&&n<=32,"invalid bytes length","param",e),new qv(n,e.name)}H(!1,"invalid type","type",e.type)};let Ja=cu;class JE{constructor(e,t,n){L(this,"fragment");L(this,"name");L(this,"signature");L(this,"topic");L(this,"args");const s=e.name,i=e.format();oe(this,{fragment:e,name:s,signature:i,topic:t,args:n})}}class YE{constructor(e,t,n,s){L(this,"fragment");L(this,"name");L(this,"args");L(this,"signature");L(this,"selector");L(this,"value");const i=e.name,o=e.format();oe(this,{fragment:e,name:i,args:n,signature:o,selector:t,value:s})}}class ZE{constructor(e,t,n){L(this,"fragment");L(this,"name");L(this,"args");L(this,"signature");L(this,"selector");const s=e.name,i=e.format();oe(this,{fragment:e,name:s,args:n,signature:i,selector:t})}}class cg{constructor(e){L(this,"hash");L(this,"_isIndexed");oe(this,{hash:e,_isIndexed:!0})}static isIndexed(e){return!!(e&&e._isIndexed)}}const lg={0:"generic panic",1:"assert(false)",17:"arithmetic overflow",18:"division or modulo by zero",33:"enum overflow",34:"invalid encoded storage byte array accessed",49:"out-of-bounds array access; popping on an empty array",50:"out-of-bounds access of an array or bytesN",65:"out of memory",81:"uninitialized function"},ug={"0x08c379a0":{signature:"Error(string)",name:"Error",inputs:["string"],reason:r=>`reverted with reason string ${JSON.stringify(r)}`},"0x4e487b71":{signature:"Panic(uint256)",name:"Panic",inputs:["uint256"],reason:r=>{let e="unknown panic code";return r>=0&&r<=255&&lg[r.toString()]&&(e=lg[r.toString()]),`reverted with panic code 0x${r.toString(16)} (${e})`}}};var Wr,Jr,Yr,mt,un,dl,pl;const ti=class ti{constructor(e){z(this,un);L(this,"fragments");L(this,"deploy");L(this,"fallback");L(this,"receive");z(this,Wr);z(this,Jr);z(this,Yr);z(this,mt);let t=[];typeof e=="string"?t=JSON.parse(e):t=e,P(this,Yr,new Map),P(this,Wr,new Map),P(this,Jr,new Map);const n=[];for(const o of t)try{n.push(Pi.from(o))}catch(a){console.log(`[Warning] Invalid Fragment ${JSON.stringify(o)}:`,a.message)}oe(this,{fragments:Object.freeze(n)});let s=null,i=!1;P(this,mt,this.getAbiCoder()),this.fragments.forEach((o,a)=>{let c;switch(o.type){case"constructor":if(this.deploy){console.log("duplicate definition - constructor");return}oe(this,{deploy:o});return;case"fallback":o.inputs.length===0?i=!0:(H(!s||o.payable!==s.payable,"conflicting fallback fragments",`fragments[${a}]`,o),s=o,i=s.payable);return;case"function":c=y(this,Yr);break;case"event":c=y(this,Jr);break;case"error":c=y(this,Wr);break;default:return}const l=o.format();c.has(l)||c.set(l,o)}),this.deploy||oe(this,{deploy:Fn.from("constructor()")}),oe(this,{fallback:s,receive:i})}format(e){const t=e?"minimal":"full";return this.fragments.map(s=>s.format(t))}formatJson(){const e=this.fragments.map(t=>t.format("json"));return JSON.stringify(e.map(t=>JSON.parse(t)))}getAbiCoder(){return Ja.defaultAbiCoder()}getFunctionName(e){const t=K(this,un,dl).call(this,e,null,!1);return H(t,"no matching function","key",e),t.name}hasFunction(e){return!!K(this,un,dl).call(this,e,null,!1)}getFunction(e,t){return K(this,un,dl).call(this,e,t||null,!0)}forEachFunction(e){const t=Array.from(y(this,Yr).keys());t.sort((n,s)=>n.localeCompare(s));for(let n=0;n<t.length;n++){const s=t[n];e(y(this,Yr).get(s),n)}}getEventName(e){const t=K(this,un,pl).call(this,e,null,!1);return H(t,"no matching event","key",e),t.name}hasEvent(e){return!!K(this,un,pl).call(this,e,null,!1)}getEvent(e,t){return K(this,un,pl).call(this,e,t||null,!0)}forEachEvent(e){const t=Array.from(y(this,Jr).keys());t.sort((n,s)=>n.localeCompare(s));for(let n=0;n<t.length;n++){const s=t[n];e(y(this,Jr).get(s),n)}}getError(e,t){if(vt(e)){const s=e.toLowerCase();if(ug[s])return Mt.from(ug[s].signature);for(const i of y(this,Wr).values())if(s===i.selector)return i;return null}if(e.indexOf("(")===-1){const s=[];for(const[i,o]of y(this,Wr))i.split("(")[0]===e&&s.push(o);if(s.length===0)return e==="Error"?Mt.from("error Error(string)"):e==="Panic"?Mt.from("error Panic(uint256)"):null;if(s.length>1){const i=s.map(o=>JSON.stringify(o.format())).join(", ");H(!1,`ambiguous error description (i.e. ${i})`,"name",e)}return s[0]}if(e=Mt.from(e).format(),e==="Error(string)")return Mt.from("error Error(string)");if(e==="Panic(uint256)")return Mt.from("error Panic(uint256)");const n=y(this,Wr).get(e);return n||null}forEachError(e){const t=Array.from(y(this,Wr).keys());t.sort((n,s)=>n.localeCompare(s));for(let n=0;n<t.length;n++){const s=t[n];e(y(this,Wr).get(s),n)}}_decodeParams(e,t){return y(this,mt).decode(e,t)}_encodeParams(e,t){return y(this,mt).encode(e,t)}encodeDeploy(e){return this._encodeParams(this.deploy.inputs,e||[])}decodeErrorResult(e,t){if(typeof e=="string"){const n=this.getError(e);H(n,"unknown error","fragment",e),e=n}return H(Fe(t,0,4)===e.selector,`data signature does not match error ${e.name}.`,"data",t),this._decodeParams(e.inputs,Fe(t,4))}encodeErrorResult(e,t){if(typeof e=="string"){const n=this.getError(e);H(n,"unknown error","fragment",e),e=n}return cn([e.selector,this._encodeParams(e.inputs,t||[])])}decodeFunctionData(e,t){if(typeof e=="string"){const n=this.getFunction(e);H(n,"unknown function","fragment",e),e=n}return H(Fe(t,0,4)===e.selector,`data signature does not match function ${e.name}.`,"data",t),this._decodeParams(e.inputs,Fe(t,4))}encodeFunctionData(e,t){if(typeof e=="string"){const n=this.getFunction(e);H(n,"unknown function","fragment",e),e=n}return cn([e.selector,this._encodeParams(e.inputs,t||[])])}decodeFunctionResult(e,t){if(typeof e=="string"){const i=this.getFunction(e);H(i,"unknown function","fragment",e),e=i}let n="invalid length for result data";const s=ln(t);if(s.length%32===0)try{return y(this,mt).decode(e.outputs,s)}catch{n="could not decode result data"}X(!1,n,"BAD_DATA",{value:_e(s),info:{method:e.name,signature:e.format()}})}makeError(e,t){const n=Bi(e,"data"),s=Ja.getBuiltinCallException("call",t,n);if(s.message.startsWith("execution reverted (unknown custom error)")){const a=_e(n.slice(0,4)),c=this.getError(a);if(c)try{const l=y(this,mt).decode(c.inputs,n.slice(4));s.revert={name:c.name,signature:c.format(),args:l},s.reason=s.revert.signature,s.message=`execution reverted: ${s.reason}`}catch{s.message="execution reverted (coult not decode custom error)"}}const o=this.parseTransaction(t);return o&&(s.invocation={method:o.name,signature:o.signature,args:o.args}),s}encodeFunctionResult(e,t){if(typeof e=="string"){const n=this.getFunction(e);H(n,"unknown function","fragment",e),e=n}return _e(y(this,mt).encode(e.outputs,t||[]))}encodeFilterTopics(e,t){if(typeof e=="string"){const i=this.getEvent(e);H(i,"unknown event","eventFragment",e),e=i}X(t.length<=e.inputs.length,`too many arguments for ${e.format()}`,"UNEXPECTED_ARGUMENT",{count:t.length,expectedCount:e.inputs.length});const n=[];e.anonymous||n.push(e.topicHash);const s=(i,o)=>i.type==="string"?Va(o):i.type==="bytes"?qa(_e(o)):(i.type==="bool"&&typeof o=="boolean"?o=o?"0x01":"0x00":i.type.match(/^u?int/)?o=kd(o):i.type.match(/^bytes/)?o=hv(o,32):i.type==="address"&&y(this,mt).encode(["address"],[o]),fv(_e(o),32));for(t.forEach((i,o)=>{const a=e.inputs[o];if(!a.indexed){H(i==null,"cannot filter non-indexed parameters; must be null","contract."+a.name,i);return}i==null?n.push(null):a.baseType==="array"||a.baseType==="tuple"?H(!1,"filtering with tuples or arrays not supported","contract."+a.name,i):Array.isArray(i)?n.push(i.map(c=>s(a,c))):n.push(s(a,i))});n.length&&n[n.length-1]===null;)n.pop();return n}encodeEventLog(e,t){if(typeof e=="string"){const o=this.getEvent(e);H(o,"unknown event","eventFragment",e),e=o}const n=[],s=[],i=[];return e.anonymous||n.push(e.topicHash),H(t.length===e.inputs.length,"event arguments/values mismatch","values",t),e.inputs.forEach((o,a)=>{const c=t[a];if(o.indexed)if(o.type==="string")n.push(Va(c));else if(o.type==="bytes")n.push(qa(c));else{if(o.baseType==="tuple"||o.baseType==="array")throw new Error("not implemented");n.push(y(this,mt).encode([o.type],[c]))}else s.push(o),i.push(c)}),{data:y(this,mt).encode(s,i),topics:n}}decodeEventLog(e,t,n){if(typeof e=="string"){const d=this.getEvent(e);H(d,"unknown event","eventFragment",e),e=d}if(n!=null&&!e.anonymous){const d=e.topicHash;H(vt(n[0],32)&&n[0].toLowerCase()===d,"fragment/topic mismatch","topics[0]",n[0]),n=n.slice(1)}const s=[],i=[],o=[];e.inputs.forEach((d,p)=>{d.indexed?d.type==="string"||d.type==="bytes"||d.baseType==="tuple"||d.baseType==="array"?(s.push(ct.from({type:"bytes32",name:d.name})),o.push(!0)):(s.push(d),o.push(!1)):(i.push(d),o.push(!1))});const a=n!=null?y(this,mt).decode(s,cn(n)):null,c=y(this,mt).decode(i,t,!0),l=[],u=[];let h=0,f=0;return e.inputs.forEach((d,p)=>{let g=null;if(d.indexed)if(a==null)g=new cg(null);else if(o[p])g=new cg(a[f++]);else try{g=a[f++]}catch(m){g=m}else try{g=c[h++]}catch(m){g=m}l.push(g),u.push(d.name||null)}),Ko.fromItems(l,u)}parseTransaction(e){const t=Bi(e.data,"tx.data"),n=ce(e.value!=null?e.value:0,"tx.value"),s=this.getFunction(_e(t.slice(0,4)));if(!s)return null;const i=y(this,mt).decode(s.inputs,t.slice(4));return new YE(s,s.selector,i,n)}parseCallResult(e){throw new Error("@TODO")}parseLog(e){const t=this.getEvent(e.topics[0]);return!t||t.anonymous?null:new JE(t,t.topicHash,this.decodeEventLog(t,e.data,e.topics))}parseError(e){const t=_e(e),n=this.getError(Fe(t,0,4));if(!n)return null;const s=y(this,mt).decode(n.inputs,Fe(t,4));return new ZE(n,n.selector,s)}static from(e){return e instanceof ti?e:typeof e=="string"?new ti(JSON.parse(e)):typeof e.formatJson=="function"?new ti(e.formatJson()):typeof e.format=="function"?new ti(e.format("json")):new ti(e)}};Wr=new WeakMap,Jr=new WeakMap,Yr=new WeakMap,mt=new WeakMap,un=new WeakSet,dl=function(e,t,n){if(vt(e)){const i=e.toLowerCase();for(const o of y(this,Yr).values())if(i===o.selector)return o;return null}if(e.indexOf("(")===-1){const i=[];for(const[o,a]of y(this,Yr))o.split("(")[0]===e&&i.push(a);if(t){const o=t.length>0?t[t.length-1]:null;let a=t.length,c=!0;Et.isTyped(o)&&o.type==="overrides"&&(c=!1,a--);for(let l=i.length-1;l>=0;l--){const u=i[l].inputs.length;u!==a&&(!c||u!==a-1)&&i.splice(l,1)}for(let l=i.length-1;l>=0;l--){const u=i[l].inputs;for(let h=0;h<t.length;h++)if(Et.isTyped(t[h])){if(h>=u.length){if(t[h].type==="overrides")continue;i.splice(l,1);break}if(t[h].type!==u[h].baseType){i.splice(l,1);break}}}}if(i.length===1&&t&&t.length!==i[0].inputs.length){const o=t[t.length-1];(o==null||Array.isArray(o)||typeof o!="object")&&i.splice(0,1)}if(i.length===0)return null;if(i.length>1&&n){const o=i.map(a=>JSON.stringify(a.format())).join(", ");H(!1,`ambiguous function description (i.e. matches ${o})`,"key",e)}return i[0]}const s=y(this,Yr).get(nn.from(e).format());return s||null},pl=function(e,t,n){if(vt(e)){const i=e.toLowerCase();for(const o of y(this,Jr).values())if(i===o.topicHash)return o;return null}if(e.indexOf("(")===-1){const i=[];for(const[o,a]of y(this,Jr))o.split("(")[0]===e&&i.push(a);if(t){for(let o=i.length-1;o>=0;o--)i[o].inputs.length<t.length&&i.splice(o,1);for(let o=i.length-1;o>=0;o--){const a=i[o].inputs;for(let c=0;c<t.length;c++)if(Et.isTyped(t[c])&&t[c].type!==a[c].baseType){i.splice(o,1);break}}}if(i.length===0)return null;if(i.length>1&&n){const o=i.map(a=>JSON.stringify(a.format())).join(", ");H(!1,`ambiguous event description (i.e. matches ${o})`,"key",e)}return i[0]}const s=y(this,Jr).get(rn.from(e).format());return s||null};let Af=ti;class zd extends gu{constructor(t,n,s){super(t,t.provider);L(this,"interface");L(this,"fragment");L(this,"args");const i=n.decodeEventLog(s,t.data,t.topics);oe(this,{args:i,fragment:s,interface:n})}get eventName(){return this.fragment.name}get eventSignature(){return this.fragment.format()}}class pw extends gu{constructor(t,n){super(t,t.provider);L(this,"error");oe(this,{error:n})}}var No;class XE extends _m{constructor(t,n,s){super(s,n);z(this,No);P(this,No,t)}get logs(){return super.logs.map(t=>{const n=t.topics.length?y(this,No).getEvent(t.topics[0]):null;if(n)try{return new zd(t,y(this,No),n)}catch(s){return new pw(t,s)}return t})}}No=new WeakMap;var fc;class qd extends Dm{constructor(t,n,s){super(s,n);z(this,fc);P(this,fc,t)}async wait(t,n){const s=await super.wait(t,n);return s==null?null:new XE(y(this,fc),this.provider,s)}}fc=new WeakMap;class gw extends Nm{constructor(t,n,s,i){super(t,n,s);L(this,"log");oe(this,{log:i})}async getBlock(){return await this.log.getBlock()}async getTransaction(){return await this.log.getTransaction()}async getTransactionReceipt(){return await this.log.getTransactionReceipt()}}class e2 extends gw{constructor(e,t,n,s,i){super(e,t,n,new zd(i,e.interface,s));const o=e.interface.decodeEventLog(s,this.log.data,this.log.topics);oe(this,{args:o,fragment:s})}get eventName(){return this.fragment.name}get eventSignature(){return this.fragment.format()}}const hg=BigInt(0);function yw(r){return r&&typeof r.call=="function"}function mw(r){return r&&typeof r.estimateGas=="function"}function bu(r){return r&&typeof r.resolveName=="function"}function ww(r){return r&&typeof r.sendTransaction=="function"}function bw(r){if(r!=null){if(bu(r))return r;if(r.provider)return r.provider}}var dc;class t2{constructor(e,t,n){z(this,dc);L(this,"fragment");if(oe(this,{fragment:t}),t.inputs.length<n.length)throw new Error("too many arguments");const s=Ti(e.runner,"resolveName"),i=bu(s)?s:null;P(this,dc,(async function(){const o=await Promise.all(t.inputs.map((a,c)=>n[c]==null?null:a.walkAsync(n[c],(u,h)=>u==="address"?Array.isArray(h)?Promise.all(h.map(f=>nr(f,i))):nr(h,i):h)));return e.interface.encodeFilterTopics(t,o)})())}getTopicFilter(){return y(this,dc)}}dc=new WeakMap;function Ti(r,e){return r==null?null:typeof r[e]=="function"?r:r.provider&&typeof r.provider[e]=="function"?r.provider:null}function ni(r){return r==null?null:r.provider||null}async function xw(r,e){const t=Et.dereference(r,"overrides");H(typeof t=="object","invalid overrides parameter","overrides",r);const n=nf(t);return H(n.to==null||(e||[]).indexOf("to")>=0,"cannot override to","overrides.to",n.to),H(n.data==null||(e||[]).indexOf("data")>=0,"cannot override data","overrides.data",n.data),n.from&&(n.from=n.from),n}async function r2(r,e,t){const n=Ti(r,"resolveName"),s=bu(n)?n:null;return await Promise.all(e.map((i,o)=>i.walkAsync(t[o],(a,c)=>(c=Et.dereference(c,a),a==="address"?nr(c,s):c))))}function n2(r){const e=async function(o){const a=await xw(o,["data"]);a.to=await r.getAddress(),a.from&&(a.from=await nr(a.from,bw(r.runner)));const c=r.interface,l=ce(a.value||hg,"overrides.value")===hg,u=(a.data||"0x")==="0x";c.fallback&&!c.fallback.payable&&c.receive&&!u&&!l&&H(!1,"cannot send data to receive or send value to non-payable fallback","overrides",o),H(c.fallback||u,"cannot send data to receive-only contract","overrides.data",a.data);const h=c.receive||c.fallback&&c.fallback.payable;return H(h||l,"cannot send value to non-payable fallback","overrides.value",a.value),H(c.fallback||u,"cannot send data to receive-only contract","overrides.data",a.data),a},t=async function(o){const a=Ti(r.runner,"call");X(yw(a),"contract runner does not support calling","UNSUPPORTED_OPERATION",{operation:"call"});const c=await e(o);try{return await a.call(c)}catch(l){throw Ud(l)&&l.data?r.interface.makeError(l.data,c):l}},n=async function(o){const a=r.runner;X(ww(a),"contract runner does not support sending transactions","UNSUPPORTED_OPERATION",{operation:"sendTransaction"});const c=await a.sendTransaction(await e(o)),l=ni(r.runner);return new qd(r.interface,l,c)},s=async function(o){const a=Ti(r.runner,"estimateGas");return X(mw(a),"contract runner does not support gas estimation","UNSUPPORTED_OPERATION",{operation:"estimateGas"}),await a.estimateGas(await e(o))},i=async o=>await n(o);return oe(i,{_contract:r,estimateGas:s,populateTransaction:e,send:n,staticCall:t}),i}function s2(r,e){const t=function(...l){const u=r.interface.getFunction(e,l);return X(u,"no matching fragment","UNSUPPORTED_OPERATION",{operation:"fragment",info:{key:e,args:l}}),u},n=async function(...l){const u=t(...l);let h={};if(u.inputs.length+1===l.length&&(h=await xw(l.pop()),h.from&&(h.from=await nr(h.from,bw(r.runner)))),u.inputs.length!==l.length)throw new Error("internal error: fragment inputs doesn't match arguments; should not happen");const f=await r2(r.runner,u.inputs,l);return Object.assign({},h,await Ir({to:r.getAddress(),data:r.interface.encodeFunctionData(u,f)}))},s=async function(...l){const u=await a(...l);return u.length===1?u[0]:u},i=async function(...l){const u=r.runner;X(ww(u),"contract runner does not support sending transactions","UNSUPPORTED_OPERATION",{operation:"sendTransaction"});const h=await u.sendTransaction(await n(...l)),f=ni(r.runner);return new qd(r.interface,f,h)},o=async function(...l){const u=Ti(r.runner,"estimateGas");return X(mw(u),"contract runner does not support gas estimation","UNSUPPORTED_OPERATION",{operation:"estimateGas"}),await u.estimateGas(await n(...l))},a=async function(...l){const u=Ti(r.runner,"call");X(yw(u),"contract runner does not support calling","UNSUPPORTED_OPERATION",{operation:"call"});const h=await n(...l);let f="0x";try{f=await u.call(h)}catch(p){throw Ud(p)&&p.data?r.interface.makeError(p.data,h):p}const d=t(...l);return r.interface.decodeFunctionResult(d,f)},c=async(...l)=>t(...l).constant?await s(...l):await i(...l);return oe(c,{name:r.interface.getFunctionName(e),_contract:r,_key:e,getFragment:t,estimateGas:o,populateTransaction:n,send:i,staticCall:s,staticCallResult:a}),Object.defineProperty(c,"fragment",{configurable:!1,enumerable:!0,get:()=>{const l=r.interface.getFunction(e);return X(l,"no matching fragment","UNSUPPORTED_OPERATION",{operation:"fragment",info:{key:e}}),l}}),c}function i2(r,e){const t=function(...s){const i=r.interface.getEvent(e,s);return X(i,"no matching fragment","UNSUPPORTED_OPERATION",{operation:"fragment",info:{key:e,args:s}}),i},n=function(...s){return new t2(r,t(...s),s)};return oe(n,{name:r.interface.getEventName(e),_contract:r,_key:e,getFragment:t}),Object.defineProperty(n,"fragment",{configurable:!1,enumerable:!0,get:()=>{const s=r.interface.getEvent(e);return X(s,"no matching fragment","UNSUPPORTED_OPERATION",{operation:"fragment",info:{key:e}}),s}}),n}const Ll=Symbol.for("_ethersInternal_contract"),vw=new WeakMap;function o2(r,e){vw.set(r[Ll],e)}function Jt(r){return vw.get(r[Ll])}function a2(r){return r&&typeof r=="object"&&"getTopicFilter"in r&&typeof r.getTopicFilter=="function"&&r.fragment}async function Vd(r,e){let t,n=null;if(Array.isArray(e)){const i=function(o){if(vt(o,32))return o;const a=r.interface.getEvent(o);return H(a,"unknown fragment","name",o),a.topicHash};t=e.map(o=>o==null?null:Array.isArray(o)?o.map(i):i(o))}else e==="*"?t=[null]:typeof e=="string"?vt(e,32)?t=[e]:(n=r.interface.getEvent(e),H(n,"unknown fragment","event",e),t=[n.topicHash]):a2(e)?t=await e.getTopicFilter():"fragment"in e?(n=e.fragment,t=[n.topicHash]):H(!1,"unknown event name","event",e);t=t.map(i=>{if(i==null)return null;if(Array.isArray(i)){const o=Array.from(new Set(i.map(a=>a.toLowerCase())).values());return o.length===1?o[0]:(o.sort(),o)}return i.toLowerCase()});const s=t.map(i=>i==null?"null":Array.isArray(i)?i.join("|"):i).join("&");return{fragment:n,tag:s,topics:t}}async function Da(r,e){const{subs:t}=Jt(r);return t.get((await Vd(r,e)).tag)||null}async function fg(r,e,t){const n=ni(r.runner);X(n,"contract runner does not support subscribing","UNSUPPORTED_OPERATION",{operation:e});const{fragment:s,tag:i,topics:o}=await Vd(r,t),{addr:a,subs:c}=Jt(r);let l=c.get(i);if(!l){const h={address:a||r,topics:o},f=m=>{let E=s;if(E==null)try{E=r.interface.getEvent(m.topics[0])}catch{}if(E){const O=E,x=s?r.interface.decodeEventLog(s,m.data,m.topics):[];Sf(r,t,x,b=>new e2(r,b,t,O,m))}else Sf(r,t,[],O=>new gw(r,O,t,m))};let d=[];l={tag:i,listeners:[],start:()=>{d.length||d.push(n.on(h,f))},stop:async()=>{if(d.length==0)return;let m=d;d=[],await Promise.all(m),n.off(h,f)}},c.set(i,l)}return l}let If=Promise.resolve();async function c2(r,e,t,n){await If;const s=await Da(r,e);if(!s)return!1;const i=s.listeners.length;return s.listeners=s.listeners.filter(({listener:o,once:a})=>{const c=Array.from(t);n&&c.push(n(a?null:o));try{o.call(r,...c)}catch{}return!a}),s.listeners.length===0&&(s.stop(),Jt(r).subs.delete(s.tag)),i>0}async function Sf(r,e,t,n){try{await If}catch{}const s=c2(r,e,t,n);return If=s,await s}const qc=["then"];var vm;vm=Ll;const Ma=class Ma{constructor(e,t,n,s){L(this,"target");L(this,"interface");L(this,"runner");L(this,"filters");L(this,vm);L(this,"fallback");H(typeof e=="string"||dv(e),"invalid value for Contract target","target",e),n==null&&(n=null);const i=Af.from(t);oe(this,{target:e,runner:n,interface:i}),Object.defineProperty(this,Ll,{value:{}});let o,a=null,c=null;if(s){const h=ni(n);c=new qd(this.interface,h,s)}let l=new Map;if(typeof e=="string")if(vt(e))a=e,o=Promise.resolve(e);else{const h=Ti(n,"resolveName");if(!bu(h))throw Le("contract runner does not support name resolution","UNSUPPORTED_OPERATION",{operation:"resolveName"});o=h.resolveName(e).then(f=>{if(f==null)throw Le("an ENS name used for a contract target must be correctly configured","UNCONFIGURED_NAME",{value:e});return Jt(this).addr=f,f})}else o=e.getAddress().then(h=>{if(h==null)throw new Error("TODO");return Jt(this).addr=h,h});o2(this,{addrPromise:o,addr:a,deployTx:c,subs:l});const u=new Proxy({},{get:(h,f,d)=>{if(typeof f=="symbol"||qc.indexOf(f)>=0)return Reflect.get(h,f,d);try{return this.getEvent(f)}catch(p){if(!St(p,"INVALID_ARGUMENT")||p.argument!=="key")throw p}},has:(h,f)=>qc.indexOf(f)>=0?Reflect.has(h,f):Reflect.has(h,f)||this.interface.hasEvent(String(f))});return oe(this,{filters:u}),oe(this,{fallback:i.receive||i.fallback?n2(this):null}),new Proxy(this,{get:(h,f,d)=>{if(typeof f=="symbol"||f in h||qc.indexOf(f)>=0)return Reflect.get(h,f,d);try{return h.getFunction(f)}catch(p){if(!St(p,"INVALID_ARGUMENT")||p.argument!=="key")throw p}},has:(h,f)=>typeof f=="symbol"||f in h||qc.indexOf(f)>=0?Reflect.has(h,f):h.interface.hasFunction(f)})}connect(e){return new Ma(this.target,this.interface,e)}attach(e){return new Ma(e,this.interface,this.runner)}async getAddress(){return await Jt(this).addrPromise}async getDeployedCode(){const e=ni(this.runner);X(e,"runner does not support .provider","UNSUPPORTED_OPERATION",{operation:"getDeployedCode"});const t=await e.getCode(await this.getAddress());return t==="0x"?null:t}async waitForDeployment(){const e=this.deploymentTransaction();if(e)return await e.wait(),this;if(await this.getDeployedCode()!=null)return this;const n=ni(this.runner);return X(n!=null,"contract runner does not support .provider","UNSUPPORTED_OPERATION",{operation:"waitForDeployment"}),new Promise((s,i)=>{const o=async()=>{try{if(await this.getDeployedCode()!=null)return s(this);n.once("block",o)}catch(a){i(a)}};o()})}deploymentTransaction(){return Jt(this).deployTx}getFunction(e){return typeof e!="string"&&(e=e.format()),s2(this,e)}getEvent(e){return typeof e!="string"&&(e=e.format()),i2(this,e)}async queryTransaction(e){throw new Error("@TODO")}async queryFilter(e,t,n){t==null&&(t=0),n==null&&(n="latest");const{addr:s,addrPromise:i}=Jt(this),o=s||await i,{fragment:a,topics:c}=await Vd(this,e),l={address:o,topics:c,fromBlock:t,toBlock:n},u=ni(this.runner);return X(u,"contract runner does not have a provider","UNSUPPORTED_OPERATION",{operation:"queryFilter"}),(await u.getLogs(l)).map(h=>{let f=a;if(f==null)try{f=this.interface.getEvent(h.topics[0])}catch{}if(f)try{return new zd(h,this.interface,f)}catch(d){return new pw(h,d)}return new gu(h,u)})}async on(e,t){const n=await fg(this,"on",e);return n.listeners.push({listener:t,once:!1}),n.start(),this}async once(e,t){const n=await fg(this,"once",e);return n.listeners.push({listener:t,once:!0}),n.start(),this}async emit(e,...t){return await Sf(this,e,t,null)}async listenerCount(e){if(e){const s=await Da(this,e);return s?s.listeners.length:0}const{subs:t}=Jt(this);let n=0;for(const{listeners:s}of t.values())n+=s.length;return n}async listeners(e){if(e){const s=await Da(this,e);return s?s.listeners.map(({listener:i})=>i):[]}const{subs:t}=Jt(this);let n=[];for(const{listeners:s}of t.values())n=n.concat(s.map(({listener:i})=>i));return n}async off(e,t){const n=await Da(this,e);if(!n)return this;if(t){const s=n.listeners.map(({listener:i})=>i).indexOf(t);s>=0&&n.listeners.splice(s,1)}return(t==null||n.listeners.length===0)&&(n.stop(),Jt(this).subs.delete(n.tag)),this}async removeAllListeners(e){if(e){const t=await Da(this,e);if(!t)return this;t.stop(),Jt(this).subs.delete(t.tag)}else{const{subs:t}=Jt(this);for(const{tag:n,stop:s}of t.values())s(),t.delete(n)}return this}async addListener(e,t){return await this.on(e,t)}async removeListener(e,t){return await this.off(e,t)}static buildClass(e){class t extends Ma{constructor(s,i=null){super(s,e,i)}}return t}static from(e,t,n){return n==null&&(n=null),new this(e,t,n)}};let Of=Ma;function l2(){return Of}class _i extends l2(){}function Ju(r){return r.match(/^ipfs:\/\/ipfs\//i)?r=r.substring(12):r.match(/^ipfs:\/\//i)?r=r.substring(7):H(!1,"unsupported IPFS format","link",r),`https://gateway.ipfs.io/ipfs/${r}`}class u2{constructor(e){L(this,"name");oe(this,{name:e})}connect(e){return this}supportsCoinType(e){return!1}async encodeAddress(e,t){throw new Error("unsupported coin")}async decodeAddress(e,t){throw new Error("unsupported coin")}}const Ew=new RegExp("^(ipfs)://(.*)$","i"),dg=[new RegExp("^(https)://(.*)$","i"),new RegExp("^(data):(.*)$","i"),Ew,new RegExp("^eip155:[0-9]+/(erc[0-9]+):(.*)$","i")];var ws,bi,bs,io,lu,Aw;const ho=class ho{constructor(e,t,n){z(this,bs);L(this,"provider");L(this,"address");L(this,"name");z(this,ws);z(this,bi);oe(this,{provider:e,address:t,name:n}),P(this,ws,null),P(this,bi,new _i(t,["function supportsInterface(bytes4) view returns (bool)","function resolve(bytes, bytes) view returns (bytes)","function addr(bytes32) view returns (address)","function addr(bytes32, uint) view returns (bytes)","function text(bytes32, string) view returns (string)","function contenthash(bytes32) view returns (bytes)"],e))}async supportsWildcard(){return y(this,ws)==null&&P(this,ws,(async()=>{try{return await y(this,bi).supportsInterface("0x9061b923")}catch(e){if(St(e,"CALL_EXCEPTION"))return!1;throw P(this,ws,null),e}})()),await y(this,ws)}async getAddress(e){if(e==null&&(e=60),e===60)try{const i=await K(this,bs,io).call(this,"addr(bytes32)");return i==null||i===sf?null:i}catch(i){if(St(i,"CALL_EXCEPTION"))return null;throw i}if(e>=0&&e<2147483648){let i=e+2147483648;const o=await K(this,bs,io).call(this,"addr(bytes32,uint)",[i]);if(vt(o,20))return ze(o)}let t=null;for(const i of this.provider.plugins)if(i instanceof u2&&i.supportsCoinType(e)){t=i;break}if(t==null)return null;const n=await K(this,bs,io).call(this,"addr(bytes32,uint)",[e]);if(n==null||n==="0x")return null;const s=await t.decodeAddress(e,n);if(s!=null)return s;X(!1,"invalid coin data","UNSUPPORTED_OPERATION",{operation:`getAddress(${e})`,info:{coinType:e,data:n}})}async getText(e){const t=await K(this,bs,io).call(this,"text(bytes32,string)",[e]);return t==null||t==="0x"?null:t}async getContentHash(){const e=await K(this,bs,io).call(this,"contenthash(bytes32)");if(e==null||e==="0x")return null;const t=e.match(/^0x(e3010170|e5010172)(([0-9a-f][0-9a-f])([0-9a-f][0-9a-f])([0-9a-f]*))$/);if(t){const s=t[1]==="e3010170"?"ipfs":"ipns",i=parseInt(t[4],16);if(t[5].length===i*2)return`${s}://${pv("0x"+t[2])}`}const n=e.match(/^0xe40101fa011b20([0-9a-f]*)$/);if(n&&n[1].length===64)return`bzz://${n[1]}`;X(!1,"invalid or unsupported content hash data","UNSUPPORTED_OPERATION",{operation:"getContentHash()",info:{data:e}})}async getAvatar(){return(await this._getAvatar()).url}async _getAvatar(){const e=[{type:"name",value:this.name}];try{const t=await this.getText("avatar");if(t==null)return e.push({type:"!avatar",value:""}),{url:null,linkage:e};e.push({type:"avatar",value:t});for(let n=0;n<dg.length;n++){const s=t.match(dg[n]);if(s==null)continue;const i=s[1].toLowerCase();switch(i){case"https":case"data":return e.push({type:"url",value:t}),{linkage:e,url:t};case"ipfs":{const o=Ju(t);return e.push({type:"ipfs",value:t}),e.push({type:"url",value:o}),{linkage:e,url:o}}case"erc721":case"erc1155":{const o=i==="erc721"?"tokenURI(uint256)":"uri(uint256)";e.push({type:i,value:t});const a=await this.getAddress();if(a==null)return e.push({type:"!owner",value:""}),{url:null,linkage:e};const c=(s[2]||"").split("/");if(c.length!==2)return e.push({type:`!${i}caip`,value:s[2]||""}),{url:null,linkage:e};const l=c[1],u=new _i(c[0],["function tokenURI(uint) view returns (string)","function ownerOf(uint) view returns (address)","function uri(uint) view returns (string)","function balanceOf(address, uint256) view returns (uint)"],this.provider);if(i==="erc721"){const g=await u.ownerOf(l);if(a!==g)return e.push({type:"!owner",value:g}),{url:null,linkage:e};e.push({type:"owner",value:g})}else if(i==="erc1155"){const g=await u.balanceOf(a,l);if(!g)return e.push({type:"!balance",value:"0"}),{url:null,linkage:e};e.push({type:"balance",value:g.toString()})}let h=await u[o](l);if(h==null||h==="0x")return e.push({type:"!metadata-url",value:""}),{url:null,linkage:e};e.push({type:"metadata-url-base",value:h}),i==="erc1155"&&(h=h.replace("{id}",kd(l,32).substring(2)),e.push({type:"metadata-url-expanded",value:h})),h.match(/^ipfs:/i)&&(h=Ju(h)),e.push({type:"metadata-url",value:h});let f={};const d=await new qn(h).send();d.assertOk();try{f=d.bodyJson}catch{try{e.push({type:"!metadata",value:d.bodyText})}catch{const E=d.body;return E&&e.push({type:"!metadata",value:_e(E)}),{url:null,linkage:e}}return{url:null,linkage:e}}if(!f)return e.push({type:"!metadata",value:""}),{url:null,linkage:e};e.push({type:"metadata",value:JSON.stringify(f)});let p=f.image;if(typeof p!="string")return e.push({type:"!imageUrl",value:""}),{url:null,linkage:e};if(!p.match(/^(https:\/\/|data:)/i)){if(p.match(Ew)==null)return e.push({type:"!imageUrl-ipfs",value:p}),{url:null,linkage:e};e.push({type:"imageUrl-ipfs",value:p}),p=Ju(p)}return e.push({type:"url",value:p}),{linkage:e,url:p}}}}}catch{}return{linkage:e,url:null}}static async getEnsAddress(e){const t=await e.getNetwork(),n=t.getPlugin("org.ethers.plugins.network.Ens");return X(n,"network does not support ENS","UNSUPPORTED_OPERATION",{operation:"getEnsAddress",info:{network:t}}),n.address}static async fromName(e,t){var s;let n=t;for(;;){if(n===""||n==="."||t!=="eth"&&n==="eth")return null;const i=await K(s=ho,lu,Aw).call(s,e,n);if(i!=null){const o=new ho(e,i,t);return n!==t&&!await o.supportsWildcard()?null:o}n=n.split(".").slice(1).join(".")}}};ws=new WeakMap,bi=new WeakMap,bs=new WeakSet,io=async function(e,t){t=(t||[]).slice();const n=y(this,bi).interface;t.unshift(vf(this.name));let s=null;await this.supportsWildcard()&&(s=n.getFunction(e),X(s,"missing fragment","UNKNOWN_ERROR",{info:{funcName:e}}),t=[TE(this.name,255),n.encodeFunctionData(s,t)],e="resolve(bytes,bytes)"),t.push({enableCcipRead:!0});try{const i=await y(this,bi)[e](...t);return s?n.decodeFunctionResult(s,i)[0]:i}catch(i){if(!St(i,"CALL_EXCEPTION"))throw i}return null},lu=new WeakSet,Aw=async function(e,t){const n=await ho.getEnsAddress(e);try{const i=await new _i(n,["function resolver(bytes32) view returns (address)"],e).resolver(vf(t),{enableCcipRead:!0});return i===sf?null:i}catch(s){throw s}return null},z(ho,lu);let jl=ho;const pg=BigInt(0);function ge(r,e){return(function(t){return t==null?e:r(t)})}function Ya(r,e){return(t=>{if(e&&t==null)return null;if(!Array.isArray(t))throw new Error("not an array");return t.map(n=>r(n))})}function wc(r,e){return(t=>{const n={};for(const s in r){let i=s;if(e&&s in e&&!(i in t)){for(const o of e[s])if(o in t){i=o;break}}try{const o=r[s](t[i]);o!==void 0&&(n[s]=o)}catch(o){const a=o instanceof Error?o.message:"not-an-error";X(!1,`invalid value for value.${s} (${a})`,"BAD_DATA",{value:t})}}return n})}function h2(r){switch(r){case!0:case"true":return!0;case!1:case"false":return!1}H(!1,`invalid boolean; ${JSON.stringify(r)}`,"value",r)}function Qo(r){return H(vt(r,!0),"invalid data","value",r),r}function at(r){return H(vt(r,32),"invalid hash","value",r),r}const f2=wc({address:ze,blockHash:at,blockNumber:Ee,data:Qo,index:Ee,removed:ge(h2,!1),topics:Ya(at),transactionHash:at,transactionIndex:Ee},{index:["logIndex"]});function d2(r){return f2(r)}const p2=wc({hash:ge(at),parentHash:at,parentBeaconBlockRoot:ge(at,null),number:Ee,timestamp:Ee,nonce:ge(Qo),difficulty:ce,gasLimit:ce,gasUsed:ce,stateRoot:ge(at,null),receiptsRoot:ge(at,null),blobGasUsed:ge(ce,null),excessBlobGas:ge(ce,null),miner:ge(ze),prevRandao:ge(at,null),extraData:Qo,baseFeePerGas:ge(ce)},{prevRandao:["mixHash"]});function g2(r){const e=p2(r);return e.transactions=r.transactions.map(t=>typeof t=="string"?t:Iw(t)),e}const y2=wc({transactionIndex:Ee,blockNumber:Ee,transactionHash:at,address:ze,topics:Ya(at),data:Qo,index:Ee,blockHash:at},{index:["logIndex"]});function m2(r){return y2(r)}const w2=wc({to:ge(ze,null),from:ge(ze,null),contractAddress:ge(ze,null),index:Ee,root:ge(_e),gasUsed:ce,blobGasUsed:ge(ce,null),logsBloom:ge(Qo),blockHash:at,hash:at,logs:Ya(m2),blockNumber:Ee,cumulativeGasUsed:ce,effectiveGasPrice:ge(ce),blobGasPrice:ge(ce,null),status:ge(Ee),type:ge(Ee,0)},{effectiveGasPrice:["gasPrice"],hash:["transactionHash"],index:["transactionIndex"]});function b2(r){return w2(r)}function Iw(r){r.to&&ce(r.to)===pg&&(r.to="0x0000000000000000000000000000000000000000");const e=wc({hash:at,index:ge(Ee,void 0),type:t=>t==="0x"||t==null?0:Ee(t),accessList:ge($d,null),blobVersionedHashes:ge(Ya(at,!0),null),authorizationList:ge(Ya(t=>{let n;if(t.signature)n=t.signature;else{let s=t.yParity;s==="0x1b"?s=0:s==="0x1c"&&(s=1),n=Object.assign({},t,{yParity:s})}return{address:ze(t.address),chainId:ce(t.chainId),nonce:ce(t.nonce),signature:Vu.from(n)}},!1),null),blockHash:ge(at,null),blockNumber:ge(Ee,null),transactionIndex:ge(Ee,null),from:ze,gasPrice:ge(ce),maxPriorityFeePerGas:ge(ce),maxFeePerGas:ge(ce),maxFeePerBlobGas:ge(ce,null),gasLimit:ce,to:ge(ze,null),value:ce,nonce:Ee,data:Qo,creates:ge(ze,null),chainId:ge(ce,null)},{data:["input"],gasLimit:["gas"],index:["transactionIndex"]})(r);if(e.to==null&&e.creates==null&&(e.creates=$v(e)),(r.type===1||r.type===2)&&r.accessList==null&&(e.accessList=[]),r.signature?e.signature=Vu.from(r.signature):e.signature=Vu.from(r),e.chainId==null){const t=e.signature.legacyChainId;t!=null&&(e.chainId=t)}return e.blockHash&&ce(e.blockHash)===pg&&(e.blockHash=null),e}const x2="0x00000000000C2E074eC69A0dFb2997BA6C7d2e1e";class bc{constructor(e){L(this,"name");oe(this,{name:e})}clone(){return new bc(this.name)}}class xu extends bc{constructor(t,n){t==null&&(t=0);super(`org.ethers.network.plugins.GasCost#${t||0}`);L(this,"effectiveBlock");L(this,"txBase");L(this,"txCreate");L(this,"txDataZero");L(this,"txDataNonzero");L(this,"txAccessListStorageKey");L(this,"txAccessListAddress");const s={effectiveBlock:t};function i(o,a){let c=(n||{})[o];c==null&&(c=a),H(typeof c=="number",`invalud value for ${o}`,"costs",n),s[o]=c}i("txBase",21e3),i("txCreate",32e3),i("txDataZero",4),i("txDataNonzero",16),i("txAccessListStorageKey",1900),i("txAccessListAddress",2400),oe(this,s)}clone(){return new xu(this.effectiveBlock,this)}}class vu extends bc{constructor(t,n){super("org.ethers.plugins.network.Ens");L(this,"address");L(this,"targetNetwork");oe(this,{address:t||x2,targetNetwork:n??1})}clone(){return new vu(this.address,this.targetNetwork)}}var pc,gc;class v2 extends bc{constructor(t,n){super("org.ethers.plugins.network.FetchUrlFeeDataPlugin");z(this,pc);z(this,gc);P(this,pc,t),P(this,gc,n)}get url(){return y(this,pc)}get processFunc(){return y(this,gc)}clone(){return this}}pc=new WeakMap,gc=new WeakMap;const Yu=new Map;var Co,Bo,xs;const fo=class fo{constructor(e,t){z(this,Co);z(this,Bo);z(this,xs);P(this,Co,e),P(this,Bo,ce(t)),P(this,xs,new Map)}toJSON(){return{name:this.name,chainId:String(this.chainId)}}get name(){return y(this,Co)}set name(e){P(this,Co,e)}get chainId(){return y(this,Bo)}set chainId(e){P(this,Bo,ce(e,"chainId"))}matches(e){if(e==null)return!1;if(typeof e=="string"){try{return this.chainId===ce(e)}catch{}return this.name===e}if(typeof e=="number"||typeof e=="bigint"){try{return this.chainId===ce(e)}catch{}return!1}if(typeof e=="object"){if(e.chainId!=null){try{return this.chainId===ce(e.chainId)}catch{}return!1}return e.name!=null?this.name===e.name:!1}return!1}get plugins(){return Array.from(y(this,xs).values())}attachPlugin(e){if(y(this,xs).get(e.name))throw new Error(`cannot replace existing plugin: ${e.name} `);return y(this,xs).set(e.name,e.clone()),this}getPlugin(e){return y(this,xs).get(e)||null}getPlugins(e){return this.plugins.filter(t=>t.name.split("#")[0]===e)}clone(){const e=new fo(this.name,this.chainId);return this.plugins.forEach(t=>{e.attachPlugin(t.clone())}),e}computeIntrinsicGas(e){const t=this.getPlugin("org.ethers.plugins.network.GasCost")||new xu;let n=t.txBase;if(e.to==null&&(n+=t.txCreate),e.data)for(let s=2;s<e.data.length;s+=2)e.data.substring(s,s+2)==="00"?n+=t.txDataZero:n+=t.txDataNonzero;if(e.accessList){const s=$d(e.accessList);for(const i in s)n+=t.txAccessListAddress+t.txAccessListStorageKey*s[i].storageKeys.length}return n}static from(e){if(E2(),e==null)return fo.from("mainnet");if(typeof e=="number"&&(e=BigInt(e)),typeof e=="string"||typeof e=="bigint"){const t=Yu.get(e);if(t)return t();if(typeof e=="bigint")return new fo("unknown",e);H(!1,"unknown network","network",e)}if(typeof e.clone=="function")return e.clone();if(typeof e=="object"){H(typeof e.name=="string"&&typeof e.chainId=="number","invalid network object name or chainId","network",e);const t=new fo(e.name,e.chainId);return(e.ensAddress||e.ensNetwork!=null)&&t.attachPlugin(new vu(e.ensAddress,e.ensNetwork)),t}H(!1,"invalid network","network",e)}static register(e,t){typeof e=="number"&&(e=BigInt(e));const n=Yu.get(e);n&&H(!1,`conflicting network for ${JSON.stringify(n.name)}`,"nameOrChainId",e),Yu.set(e,t)}};Co=new WeakMap,Bo=new WeakMap,xs=new WeakMap;let on=fo;function gg(r,e){const t=String(r);if(!t.match(/^[0-9.]+$/))throw new Error(`invalid gwei value: ${r}`);const n=t.split(".");if(n.length===1&&n.push(""),n.length!==2)throw new Error(`invalid gwei value: ${r}`);for(;n[1].length<e;)n[1]+="0";if(n[1].length>9){let s=BigInt(n[1].substring(0,9));n[1].substring(9).match(/^0+$/)||s++,n[1]=s.toString()}return BigInt(n[0]+n[1])}function yg(r){return new v2(r,async(e,t,n)=>{n.setHeader("User-Agent","ethers");let s;try{const[i,o]=await Promise.all([n.send(),e()]);s=i;const a=s.bodyJson.standard;return{gasPrice:o.gasPrice,maxFeePerGas:gg(a.maxFee,9),maxPriorityFeePerGas:gg(a.maxPriorityFee,9)}}catch(i){X(!1,`error encountered with polygon gas station (${JSON.stringify(n.url)})`,"SERVER_ERROR",{request:n,response:s,error:i})}})}let mg=!1;function E2(){if(mg)return;mg=!0;function r(e,t,n){const s=function(){const i=new on(e,t);return n.ensNetwork!=null&&i.attachPlugin(new vu(null,n.ensNetwork)),i.attachPlugin(new xu),(n.plugins||[]).forEach(o=>{i.attachPlugin(o)}),i};on.register(e,s),on.register(t,s),n.altNames&&n.altNames.forEach(i=>{on.register(i,s)})}r("mainnet",1,{ensNetwork:1,altNames:["homestead"]}),r("ropsten",3,{ensNetwork:3}),r("rinkeby",4,{ensNetwork:4}),r("goerli",5,{ensNetwork:5}),r("kovan",42,{ensNetwork:42}),r("sepolia",11155111,{ensNetwork:11155111}),r("holesky",17e3,{ensNetwork:17e3}),r("classic",61,{}),r("classicKotti",6,{}),r("arbitrum",42161,{ensNetwork:1}),r("arbitrum-goerli",421613,{}),r("arbitrum-sepolia",421614,{}),r("base",8453,{ensNetwork:1}),r("base-goerli",84531,{}),r("base-sepolia",84532,{}),r("bnb",56,{ensNetwork:1}),r("bnbt",97,{}),r("filecoin",314,{}),r("filecoin-calibration",314159,{}),r("linea",59144,{ensNetwork:1}),r("linea-goerli",59140,{}),r("linea-sepolia",59141,{}),r("matic",137,{ensNetwork:1,plugins:[yg("https://gasstation.polygon.technology/v2")]}),r("matic-amoy",80002,{}),r("matic-mumbai",80001,{altNames:["maticMumbai","maticmum"],plugins:[yg("https://gasstation-testnet.polygon.technology/v2")]}),r("optimism",10,{ensNetwork:1,plugins:[]}),r("optimism-goerli",420,{}),r("optimism-sepolia",11155420,{}),r("xdai",100,{ensNetwork:1})}function Df(r){return JSON.parse(JSON.stringify(r))}var Rn,fr,vs,Zr,Ro,gl;class A2{constructor(e){z(this,Ro);z(this,Rn);z(this,fr);z(this,vs);z(this,Zr);P(this,Rn,e),P(this,fr,null),P(this,vs,4e3),P(this,Zr,-2)}get pollingInterval(){return y(this,vs)}set pollingInterval(e){P(this,vs,e)}start(){y(this,fr)||(P(this,fr,y(this,Rn)._setTimeout(K(this,Ro,gl).bind(this),y(this,vs))),K(this,Ro,gl).call(this))}stop(){y(this,fr)&&(y(this,Rn)._clearTimeout(y(this,fr)),P(this,fr,null))}pause(e){this.stop(),e&&P(this,Zr,-2)}resume(){this.start()}}Rn=new WeakMap,fr=new WeakMap,vs=new WeakMap,Zr=new WeakMap,Ro=new WeakSet,gl=async function(){try{const e=await y(this,Rn).getBlockNumber();if(y(this,Zr)===-2){P(this,Zr,e);return}if(e!==y(this,Zr)){for(let t=y(this,Zr)+1;t<=e;t++){if(y(this,fr)==null)return;await y(this,Rn).emit("block",t)}P(this,Zr,e)}}catch{}y(this,fr)!=null&&P(this,fr,y(this,Rn)._setTimeout(K(this,Ro,gl).bind(this),y(this,vs)))};var xi,vi,Es;class Kd{constructor(e){z(this,xi);z(this,vi);z(this,Es);P(this,xi,e),P(this,Es,!1),P(this,vi,t=>{this._poll(t,y(this,xi))})}async _poll(e,t){throw new Error("sub-classes must override this")}start(){y(this,Es)||(P(this,Es,!0),y(this,vi).call(this,-2),y(this,xi).on("block",y(this,vi)))}stop(){y(this,Es)&&(P(this,Es,!1),y(this,xi).off("block",y(this,vi)))}pause(e){this.stop()}resume(){this.start()}}xi=new WeakMap,vi=new WeakMap,Es=new WeakMap;var Po,Pn;class I2 extends Kd{constructor(t,n){super(t);z(this,Po);z(this,Pn);P(this,Po,n),P(this,Pn,-2)}pause(t){t&&P(this,Pn,-2),super.pause(t)}async _poll(t,n){const s=await n.getBlock(y(this,Po));s!=null&&(y(this,Pn)===-2?P(this,Pn,s.number):s.number>y(this,Pn)&&(n.emit(y(this,Po),s.number),P(this,Pn,s.number)))}}Po=new WeakMap,Pn=new WeakMap;var uu;class S2 extends Kd{constructor(t,n){super(t);z(this,uu);P(this,uu,Df(n))}async _poll(t,n){throw new Error("@TODO")}}uu=new WeakMap;var To;class O2 extends Kd{constructor(t,n){super(t);z(this,To);P(this,To,n)}async _poll(t,n){const s=await n.getTransactionReceipt(y(this,To));s&&n.emit(y(this,To),s)}}To=new WeakMap;var Tn,ko,Uo,As,dr,hu,Sw;class Hd{constructor(e,t){z(this,hu);z(this,Tn);z(this,ko);z(this,Uo);z(this,As);z(this,dr);P(this,Tn,e),P(this,ko,Df(t)),P(this,Uo,K(this,hu,Sw).bind(this)),P(this,As,!1),P(this,dr,-2)}start(){y(this,As)||(P(this,As,!0),y(this,dr)===-2&&y(this,Tn).getBlockNumber().then(e=>{P(this,dr,e)}),y(this,Tn).on("block",y(this,Uo)))}stop(){y(this,As)&&(P(this,As,!1),y(this,Tn).off("block",y(this,Uo)))}pause(e){this.stop(),e&&P(this,dr,-2)}resume(){this.start()}}Tn=new WeakMap,ko=new WeakMap,Uo=new WeakMap,As=new WeakMap,dr=new WeakMap,hu=new WeakSet,Sw=async function(e){if(y(this,dr)===-2)return;const t=Df(y(this,ko));t.fromBlock=y(this,dr)+1,t.toBlock=e;const n=await y(this,Tn).getLogs(t);if(n.length===0){y(this,dr)<e-60&&P(this,dr,e-60);return}for(const s of n)y(this,Tn).emit(y(this,ko),s),P(this,dr,s.blockNumber)};const D2=BigInt(2),_2=10;function Vc(r){return r&&typeof r.then=="function"}function yl(r,e){return r+":"+JSON.stringify(e,(t,n)=>{if(n==null)return"null";if(typeof n=="bigint")return`bigint:${n.toString()}`;if(typeof n=="string")return n.toLowerCase();if(typeof n=="object"&&!Array.isArray(n)){const s=Object.keys(n);return s.sort(),s.reduce((i,o)=>(i[o]=n[o],i),{})}return n})}class Ow{constructor(e){L(this,"name");oe(this,{name:e})}start(){}stop(){}pause(e){}resume(){}}function N2(r){return JSON.parse(JSON.stringify(r))}function _f(r){return r=Array.from(new Set(r).values()),r.sort(),r}async function Zu(r,e){if(r==null)throw new Error("invalid event");if(Array.isArray(r)&&(r={topics:r}),typeof r=="string")switch(r){case"block":case"debug":case"error":case"finalized":case"network":case"pending":case"safe":return{type:r,tag:r}}if(vt(r,32)){const t=r.toLowerCase();return{type:"transaction",tag:yl("tx",{hash:t}),hash:t}}if(r.orphan){const t=r;return{type:"orphan",tag:yl("orphan",t),filter:N2(t)}}if(r.address||r.topics){const t=r,n={topics:(t.topics||[]).map(s=>s==null?null:Array.isArray(s)?_f(s.map(i=>i.toLowerCase())):s.toLowerCase())};if(t.address){const s=[],i=[],o=a=>{vt(a)?s.push(a):i.push((async()=>{s.push(await nr(a,e))})())};Array.isArray(t.address)?t.address.forEach(o):o(t.address),i.length&&await Promise.all(i),n.address=_f(s.map(a=>a.toLowerCase()))}return{filter:n,tag:yl("event",n),type:"event"}}H(!1,"unknown ProviderEvent","event",r)}function Xu(){return new Date().getTime()}const C2={cacheTimeout:250,pollingInterval:4e3};var wt,Is,bt,$o,er,Ei,Ss,kn,yc,pr,Fo,Lo,he,Qt,Nf,Cf,_a,Bf,Na,ml;class B2{constructor(e,t){z(this,he);z(this,wt);z(this,Is);z(this,bt);z(this,$o);z(this,er);z(this,Ei);z(this,Ss);z(this,kn);z(this,yc);z(this,pr);z(this,Fo);z(this,Lo);if(P(this,Lo,Object.assign({},C2,t||{})),e==="any")P(this,Ei,!0),P(this,er,null);else if(e){const n=on.from(e);P(this,Ei,!1),P(this,er,Promise.resolve(n)),setTimeout(()=>{this.emit("network",n,null)},0)}else P(this,Ei,!1),P(this,er,null);P(this,kn,-1),P(this,Ss,new Map),P(this,wt,new Map),P(this,Is,new Map),P(this,bt,null),P(this,$o,!1),P(this,yc,1),P(this,pr,new Map),P(this,Fo,!1)}get pollingInterval(){return y(this,Lo).pollingInterval}get provider(){return this}get plugins(){return Array.from(y(this,Is).values())}attachPlugin(e){if(y(this,Is).get(e.name))throw new Error(`cannot replace existing plugin: ${e.name} `);return y(this,Is).set(e.name,e.connect(this)),this}getPlugin(e){return y(this,Is).get(e)||null}get disableCcipRead(){return y(this,Fo)}set disableCcipRead(e){P(this,Fo,!!e)}async ccipReadFetch(e,t,n){if(this.disableCcipRead||n.length===0||e.to==null)return null;const s=e.to.toLowerCase(),i=t.toLowerCase(),o=[];for(let a=0;a<n.length;a++){const c=n[a],l=c.replace("{sender}",s).replace("{data}",i),u=new qn(l);c.indexOf("{data}")===-1&&(u.body={data:i,sender:s}),this.emit("debug",{action:"sendCcipReadFetchRequest",request:u,index:a,urls:n});let h="unknown error",f;try{f=await u.send()}catch(d){o.push(d.message),this.emit("debug",{action:"receiveCcipReadFetchError",request:u,result:{error:d}});continue}try{const d=f.bodyJson;if(d.data)return this.emit("debug",{action:"receiveCcipReadFetchResult",request:u,result:d}),d.data;d.message&&(h=d.message),this.emit("debug",{action:"receiveCcipReadFetchError",request:u,result:d})}catch{}X(f.statusCode<400||f.statusCode>=500,`response not found during CCIP fetch: ${h}`,"OFFCHAIN_FAULT",{reason:"404_MISSING_RESOURCE",transaction:e,info:{url:c,errorMessage:h}}),o.push(h)}X(!1,`error encountered during CCIP fetch: ${o.map(a=>JSON.stringify(a)).join(", ")}`,"OFFCHAIN_FAULT",{reason:"500_SERVER_ERROR",transaction:e,info:{urls:n,errorMessages:o}})}_wrapBlock(e,t){return new gv(g2(e),this)}_wrapLog(e,t){return new gu(d2(e),this)}_wrapTransactionReceipt(e,t){return new _m(b2(e),this)}_wrapTransactionResponse(e,t){return new Dm(Iw(e),this)}_detectNetwork(){X(!1,"sub-classes must implement this","UNSUPPORTED_OPERATION",{operation:"_detectNetwork"})}async _perform(e){X(!1,`unsupported method: ${e.method}`,"UNSUPPORTED_OPERATION",{operation:e.method,info:e})}async getBlockNumber(){const e=Ee(await K(this,he,Qt).call(this,{method:"getBlockNumber"}),"%response");return y(this,kn)>=0&&P(this,kn,e),e}_getAddress(e){return nr(e,this)}_getBlockTag(e){if(e==null)return"latest";switch(e){case"earliest":return"0x0";case"finalized":case"latest":case"pending":case"safe":return e}if(vt(e))return vt(e,32)?e:tn(e);if(typeof e=="bigint"&&(e=Ee(e,"blockTag")),typeof e=="number")return e>=0?tn(e):y(this,kn)>=0?tn(y(this,kn)+e):this.getBlockNumber().then(t=>tn(t+e));H(!1,"invalid blockTag","blockTag",e)}_getFilter(e){const t=(e.topics||[]).map(c=>c==null?null:Array.isArray(c)?_f(c.map(l=>l.toLowerCase())):c.toLowerCase()),n="blockHash"in e?e.blockHash:void 0,s=(c,l,u)=>{let h;switch(c.length){case 0:break;case 1:h=c[0];break;default:c.sort(),h=c}if(n&&(l!=null||u!=null))throw new Error("invalid filter");const f={};return h&&(f.address=h),t.length&&(f.topics=t),l&&(f.fromBlock=l),u&&(f.toBlock=u),n&&(f.blockHash=n),f};let i=[];if(e.address)if(Array.isArray(e.address))for(const c of e.address)i.push(this._getAddress(c));else i.push(this._getAddress(e.address));let o;"fromBlock"in e&&(o=this._getBlockTag(e.fromBlock));let a;return"toBlock"in e&&(a=this._getBlockTag(e.toBlock)),i.filter(c=>typeof c!="string").length||o!=null&&typeof o!="string"||a!=null&&typeof a!="string"?Promise.all([Promise.all(i),o,a]).then(c=>s(c[0],c[1],c[2])):s(i,o,a)}_getTransactionRequest(e){const t=nf(e),n=[];if(["to","from"].forEach(s=>{if(t[s]==null)return;const i=nr(t[s],this);Vc(i)?n.push((async function(){t[s]=await i})()):t[s]=i}),t.blockTag!=null){const s=this._getBlockTag(t.blockTag);Vc(s)?n.push((async function(){t.blockTag=await s})()):t.blockTag=s}return n.length?(async function(){return await Promise.all(n),t})():t}async getNetwork(){if(y(this,er)==null){const s=(async()=>{try{const i=await this._detectNetwork();return this.emit("network",i,null),i}catch(i){throw y(this,er)===s&&P(this,er,null),i}})();return P(this,er,s),(await s).clone()}const e=y(this,er),[t,n]=await Promise.all([e,this._detectNetwork()]);return t.chainId!==n.chainId&&(y(this,Ei)?(this.emit("network",n,t),y(this,er)===e&&P(this,er,Promise.resolve(n))):X(!1,`network changed: ${t.chainId} => ${n.chainId} `,"NETWORK_ERROR",{event:"changed"})),t.clone()}async getFeeData(){const e=await this.getNetwork(),t=async()=>{const{_block:s,gasPrice:i,priorityFee:o}=await Ir({_block:K(this,he,Bf).call(this,"latest",!1),gasPrice:(async()=>{try{const u=await K(this,he,Qt).call(this,{method:"getGasPrice"});return ce(u,"%response")}catch{}return null})(),priorityFee:(async()=>{try{const u=await K(this,he,Qt).call(this,{method:"getPriorityFee"});return ce(u,"%response")}catch{}return null})()});let a=null,c=null;const l=this._wrapBlock(s,e);return l&&l.baseFeePerGas&&(c=o??BigInt("1000000000"),a=l.baseFeePerGas*D2+c),new Up(i,a,c)},n=e.getPlugin("org.ethers.plugins.network.FetchUrlFeeDataPlugin");if(n){const s=new qn(n.url),i=await n.processFunc(t,this,s);return new Up(i.gasPrice,i.maxFeePerGas,i.maxPriorityFeePerGas)}return await t()}async estimateGas(e){let t=this._getTransactionRequest(e);return Vc(t)&&(t=await t),ce(await K(this,he,Qt).call(this,{method:"estimateGas",transaction:t}),"%response")}async call(e){const{tx:t,blockTag:n}=await Ir({tx:this._getTransactionRequest(e),blockTag:this._getBlockTag(e.blockTag)});return await K(this,he,Cf).call(this,K(this,he,Nf).call(this,t,n,e.enableCcipRead?0:-1))}async getBalance(e,t){return ce(await K(this,he,_a).call(this,{method:"getBalance"},e,t),"%response")}async getTransactionCount(e,t){return Ee(await K(this,he,_a).call(this,{method:"getTransactionCount"},e,t),"%response")}async getCode(e,t){return _e(await K(this,he,_a).call(this,{method:"getCode"},e,t))}async getStorage(e,t,n){const s=ce(t,"position");return _e(await K(this,he,_a).call(this,{method:"getStorage",position:s},e,n))}async broadcastTransaction(e){const{blockNumber:t,hash:n,network:s}=await Ir({blockNumber:this.getBlockNumber(),hash:this._perform({method:"broadcastTransaction",signedTransaction:e}),network:this.getNetwork()}),i=yv.from(e);if(i.hash!==n)throw new Error("@TODO: the returned hash did not match");return this._wrapTransactionResponse(i,s).replaceableTransaction(t)}async getBlock(e,t){const{network:n,params:s}=await Ir({network:this.getNetwork(),params:K(this,he,Bf).call(this,e,!!t)});return s==null?null:this._wrapBlock(s,n)}async getTransaction(e){const{network:t,params:n}=await Ir({network:this.getNetwork(),params:K(this,he,Qt).call(this,{method:"getTransaction",hash:e})});return n==null?null:this._wrapTransactionResponse(n,t)}async getTransactionReceipt(e){const{network:t,params:n}=await Ir({network:this.getNetwork(),params:K(this,he,Qt).call(this,{method:"getTransactionReceipt",hash:e})});if(n==null)return null;if(n.gasPrice==null&&n.effectiveGasPrice==null){const s=await K(this,he,Qt).call(this,{method:"getTransaction",hash:e});if(s==null)throw new Error("report this; could not find tx or effectiveGasPrice");n.effectiveGasPrice=s.gasPrice}return this._wrapTransactionReceipt(n,t)}async getTransactionResult(e){const{result:t}=await Ir({network:this.getNetwork(),result:K(this,he,Qt).call(this,{method:"getTransactionResult",hash:e})});return t==null?null:_e(t)}async getLogs(e){let t=this._getFilter(e);Vc(t)&&(t=await t);const{network:n,params:s}=await Ir({network:this.getNetwork(),params:K(this,he,Qt).call(this,{method:"getLogs",filter:t})});return s.map(i=>this._wrapLog(i,n))}_getProvider(e){X(!1,"provider cannot connect to target network","UNSUPPORTED_OPERATION",{operation:"_getProvider()"})}async getResolver(e){return await jl.fromName(this,e)}async getAvatar(e){const t=await this.getResolver(e);return t?await t.getAvatar():null}async resolveName(e){const t=await this.getResolver(e);return t?await t.getAddress():null}async lookupAddress(e){e=ze(e);const t=vf(e.substring(2).toLowerCase()+".addr.reverse");try{const n=await jl.getEnsAddress(this),i=await new _i(n,["function resolver(bytes32) view returns (address)"],this).resolver(t);if(i==null||i===sf)return null;const a=await new _i(i,["function name(bytes32) view returns (string)"],this).name(t);return await this.resolveName(a)!==e?null:a}catch(n){if(St(n,"BAD_DATA")&&n.value==="0x"||St(n,"CALL_EXCEPTION"))return null;throw n}return null}async waitForTransaction(e,t,n){const s=t??1;return s===0?this.getTransactionReceipt(e):new Promise(async(i,o)=>{let a=null;const c=(async l=>{try{const u=await this.getTransactionReceipt(e);if(u!=null&&l-u.blockNumber+1>=s){i(u),a&&(clearTimeout(a),a=null);return}}catch(u){console.log("EEE",u)}this.once("block",c)});n!=null&&(a=setTimeout(()=>{a!=null&&(a=null,this.off("block",c),o(Le("timeout","TIMEOUT",{reason:"timeout"})))},n)),c(await this.getBlockNumber())})}async waitForBlock(e){X(!1,"not implemented yet","NOT_IMPLEMENTED",{operation:"waitForBlock"})}_clearTimeout(e){const t=y(this,pr).get(e);t&&(t.timer&&clearTimeout(t.timer),y(this,pr).delete(e))}_setTimeout(e,t){t==null&&(t=0);const n=aa(this,yc)._++,s=()=>{y(this,pr).delete(n),e()};if(this.paused)y(this,pr).set(n,{timer:null,func:s,time:t});else{const i=setTimeout(s,t);y(this,pr).set(n,{timer:i,func:s,time:Xu()})}return n}_forEachSubscriber(e){for(const t of y(this,wt).values())e(t.subscriber)}_getSubscriber(e){switch(e.type){case"debug":case"error":case"network":return new Ow(e.type);case"block":{const t=new A2(this);return t.pollingInterval=this.pollingInterval,t}case"safe":case"finalized":return new I2(this,e.type);case"event":return new Hd(this,e.filter);case"transaction":return new O2(this,e.hash);case"orphan":return new S2(this,e.filter)}throw new Error(`unsupported event: ${e.type}`)}_recoverSubscriber(e,t){for(const n of y(this,wt).values())if(n.subscriber===e){n.started&&n.subscriber.stop(),n.subscriber=t,n.started&&t.start(),y(this,bt)!=null&&t.pause(y(this,bt));break}}async on(e,t){const n=await K(this,he,ml).call(this,e);return n.listeners.push({listener:t,once:!1}),n.started||(n.subscriber.start(),n.started=!0,y(this,bt)!=null&&n.subscriber.pause(y(this,bt))),this}async once(e,t){const n=await K(this,he,ml).call(this,e);return n.listeners.push({listener:t,once:!0}),n.started||(n.subscriber.start(),n.started=!0,y(this,bt)!=null&&n.subscriber.pause(y(this,bt))),this}async emit(e,...t){const n=await K(this,he,Na).call(this,e,t);if(!n||n.listeners.length===0)return!1;const s=n.listeners.length;return n.listeners=n.listeners.filter(({listener:i,once:o})=>{const a=new Nm(this,o?null:i,e);try{i.call(this,...t,a)}catch{}return!o}),n.listeners.length===0&&(n.started&&n.subscriber.stop(),y(this,wt).delete(n.tag)),s>0}async listenerCount(e){if(e){const n=await K(this,he,Na).call(this,e);return n?n.listeners.length:0}let t=0;for(const{listeners:n}of y(this,wt).values())t+=n.length;return t}async listeners(e){if(e){const n=await K(this,he,Na).call(this,e);return n?n.listeners.map(({listener:s})=>s):[]}let t=[];for(const{listeners:n}of y(this,wt).values())t=t.concat(n.map(({listener:s})=>s));return t}async off(e,t){const n=await K(this,he,Na).call(this,e);if(!n)return this;if(t){const s=n.listeners.map(({listener:i})=>i).indexOf(t);s>=0&&n.listeners.splice(s,1)}return(!t||n.listeners.length===0)&&(n.started&&n.subscriber.stop(),y(this,wt).delete(n.tag)),this}async removeAllListeners(e){if(e){const{tag:t,started:n,subscriber:s}=await K(this,he,ml).call(this,e);n&&s.stop(),y(this,wt).delete(t)}else for(const[t,{started:n,subscriber:s}]of y(this,wt))n&&s.stop(),y(this,wt).delete(t);return this}async addListener(e,t){return await this.on(e,t)}async removeListener(e,t){return this.off(e,t)}get destroyed(){return y(this,$o)}destroy(){this.removeAllListeners();for(const e of y(this,pr).keys())this._clearTimeout(e);P(this,$o,!0)}get paused(){return y(this,bt)!=null}set paused(e){!!e!==this.paused&&(this.paused?this.resume():this.pause(!1))}pause(e){if(P(this,kn,-1),y(this,bt)!=null){if(y(this,bt)==!!e)return;X(!1,"cannot change pause type; resume first","UNSUPPORTED_OPERATION",{operation:"pause"})}this._forEachSubscriber(t=>t.pause(e)),P(this,bt,!!e);for(const t of y(this,pr).values())t.timer&&clearTimeout(t.timer),t.time=Xu()-t.time}resume(){if(y(this,bt)!=null){this._forEachSubscriber(e=>e.resume()),P(this,bt,null);for(const e of y(this,pr).values()){let t=e.time;t<0&&(t=0),e.time=Xu(),setTimeout(e.func,t)}}}}wt=new WeakMap,Is=new WeakMap,bt=new WeakMap,$o=new WeakMap,er=new WeakMap,Ei=new WeakMap,Ss=new WeakMap,kn=new WeakMap,yc=new WeakMap,pr=new WeakMap,Fo=new WeakMap,Lo=new WeakMap,he=new WeakSet,Qt=async function(e){const t=y(this,Lo).cacheTimeout;if(t<0)return await this._perform(e);const n=yl(e.method,e);let s=y(this,Ss).get(n);return s||(s=this._perform(e),y(this,Ss).set(n,s),setTimeout(()=>{y(this,Ss).get(n)===s&&y(this,Ss).delete(n)},t)),await s},Nf=async function(e,t,n){X(n<_2,"CCIP read exceeded maximum redirections","OFFCHAIN_FAULT",{reason:"TOO_MANY_REDIRECTS",transaction:Object.assign({},e,{blockTag:t,enableCcipRead:!0})});const s=nf(e);try{return _e(await this._perform({method:"call",transaction:s,blockTag:t}))}catch(i){if(!this.disableCcipRead&&Ud(i)&&i.data&&n>=0&&t==="latest"&&s.to!=null&&Fe(i.data,0,4)==="0x556f1830"){const o=i.data,a=await nr(s.to,this);let c;try{c=U2(Fe(i.data,4))}catch(h){X(!1,h.message,"OFFCHAIN_FAULT",{reason:"BAD_DATA",transaction:s,info:{data:o}})}X(c.sender.toLowerCase()===a.toLowerCase(),"CCIP Read sender mismatch","CALL_EXCEPTION",{action:"call",data:o,reason:"OffchainLookup",transaction:s,invocation:null,revert:{signature:"OffchainLookup(address,string[],bytes,bytes4,bytes)",name:"OffchainLookup",args:c.errorArgs}});const l=await this.ccipReadFetch(s,c.calldata,c.urls);X(l!=null,"CCIP Read failed to fetch data","OFFCHAIN_FAULT",{reason:"FETCH_FAILED",transaction:s,info:{data:i.data,errorArgs:c.errorArgs}});const u={to:a,data:cn([c.selector,k2([l,c.extraData])])};this.emit("debug",{action:"sendCcipReadCall",transaction:u});try{const h=await K(this,he,Nf).call(this,u,t,n+1);return this.emit("debug",{action:"receiveCcipReadCallResult",transaction:Object.assign({},u),result:h}),h}catch(h){throw this.emit("debug",{action:"receiveCcipReadCallError",transaction:Object.assign({},u),error:h}),h}}throw i}},Cf=async function(e){const{value:t}=await Ir({network:this.getNetwork(),value:e});return t},_a=async function(e,t,n){let s=this._getAddress(t),i=this._getBlockTag(n);return(typeof s!="string"||typeof i!="string")&&([s,i]=await Promise.all([s,i])),await K(this,he,Cf).call(this,K(this,he,Qt).call(this,Object.assign(e,{address:s,blockTag:i})))},Bf=async function(e,t){if(vt(e,32))return await K(this,he,Qt).call(this,{method:"getBlock",blockHash:e,includeTransactions:t});let n=this._getBlockTag(e);return typeof n!="string"&&(n=await n),await K(this,he,Qt).call(this,{method:"getBlock",blockTag:n,includeTransactions:t})},Na=async function(e,t){let n=await Zu(e,this);return n.type==="event"&&t&&t.length>0&&t[0].removed===!0&&(n=await Zu({orphan:"drop-log",log:t[0]},this)),y(this,wt).get(n.tag)||null},ml=async function(e){const t=await Zu(e,this),n=t.tag;let s=y(this,wt).get(n);return s||(s={subscriber:this._getSubscriber(t),tag:n,addressableMap:new WeakMap,nameMap:new Map,started:!1,listeners:[]},y(this,wt).set(n,s)),s};function R2(r,e){try{const t=Rf(r,e);if(t)return Bl(t)}catch{}return null}function Rf(r,e){if(r==="0x")return null;try{const t=Ee(Fe(r,e,e+32)),n=Ee(Fe(r,t,t+32));return Fe(r,t+32,t+32+n)}catch{}return null}function wg(r){const e=Sm(r);if(e.length>32)throw new Error("internal; should not happen");const t=new Uint8Array(32);return t.set(e,32-e.length),t}function P2(r){if(r.length%32===0)return r;const e=new Uint8Array(Math.ceil(r.length/32)*32);return e.set(r),e}const T2=new Uint8Array([]);function k2(r){const e=[];let t=0;for(let n=0;n<r.length;n++)e.push(T2),t+=32;for(let n=0;n<r.length;n++){const s=Bi(r[n]);e[n]=wg(t),e.push(wg(s.length)),e.push(P2(s)),t+=32+Math.ceil(s.length/32)*32}return cn(e)}const bg="0x0000000000000000000000000000000000000000000000000000000000000000";function U2(r){const e={sender:"",urls:[],calldata:"",selector:"",extraData:"",errorArgs:[]};X(mv(r)>=160,"insufficient OffchainLookup data","OFFCHAIN_FAULT",{reason:"insufficient OffchainLookup data"});const t=Fe(r,0,32);X(Fe(t,0,12)===Fe(bg,0,12),"corrupt OffchainLookup sender","OFFCHAIN_FAULT",{reason:"corrupt OffchainLookup sender"}),e.sender=Fe(t,12);try{const n=[],s=Ee(Fe(r,32,64)),i=Ee(Fe(r,s,s+32)),o=Fe(r,s+32);for(let a=0;a<i;a++){const c=R2(o,a*32);if(c==null)throw new Error("abort");n.push(c)}e.urls=n}catch{X(!1,"corrupt OffchainLookup urls","OFFCHAIN_FAULT",{reason:"corrupt OffchainLookup urls"})}try{const n=Rf(r,64);if(n==null)throw new Error("abort");e.calldata=n}catch{X(!1,"corrupt OffchainLookup calldata","OFFCHAIN_FAULT",{reason:"corrupt OffchainLookup calldata"})}X(Fe(r,100,128)===Fe(bg,0,28),"corrupt OffchainLookup callbaackSelector","OFFCHAIN_FAULT",{reason:"corrupt OffchainLookup callbaackSelector"}),e.selector=Fe(r,96,100);try{const n=Rf(r,128);if(n==null)throw new Error("abort");e.extraData=n}catch{X(!1,"corrupt OffchainLookup extraData","OFFCHAIN_FAULT",{reason:"corrupt OffchainLookup extraData"})}return e.errorArgs="sender,urls,calldata,selector,extraData".split(/,/).map(n=>e[n]),e}function $2(r){return JSON.parse(JSON.stringify(r))}var It,Xr,Ai,Os,Ii,jo,Fs,Pf,Tf;class Dw{constructor(e){z(this,Fs);z(this,It);z(this,Xr);z(this,Ai);z(this,Os);z(this,Ii);z(this,jo);P(this,It,e),P(this,Xr,null),P(this,Ai,K(this,Fs,Pf).bind(this)),P(this,Os,!1),P(this,Ii,null),P(this,jo,!1)}_subscribe(e){throw new Error("subclasses must override this")}_emitResults(e,t){throw new Error("subclasses must override this")}_recover(e){throw new Error("subclasses must override this")}start(){y(this,Os)||(P(this,Os,!0),K(this,Fs,Pf).call(this,-2))}stop(){y(this,Os)&&(P(this,Os,!1),P(this,jo,!0),K(this,Fs,Tf).call(this),y(this,It).off("block",y(this,Ai)))}pause(e){e&&K(this,Fs,Tf).call(this),y(this,It).off("block",y(this,Ai))}resume(){this.start()}}It=new WeakMap,Xr=new WeakMap,Ai=new WeakMap,Os=new WeakMap,Ii=new WeakMap,jo=new WeakMap,Fs=new WeakSet,Pf=async function(e){try{y(this,Xr)==null&&P(this,Xr,this._subscribe(y(this,It)));let t=null;try{t=await y(this,Xr)}catch(i){if(!St(i,"UNSUPPORTED_OPERATION")||i.operation!=="eth_newFilter")throw i}if(t==null){P(this,Xr,null),y(this,It)._recoverSubscriber(this,this._recover(y(this,It)));return}const n=await y(this,It).getNetwork();if(y(this,Ii)||P(this,Ii,n),y(this,Ii).chainId!==n.chainId)throw new Error("chaid changed");if(y(this,jo))return;const s=await y(this,It).send("eth_getFilterChanges",[t]);await this._emitResults(y(this,It),s)}catch(t){console.log("@TODO",t)}y(this,It).once("block",y(this,Ai))},Tf=function(){const e=y(this,Xr);e&&(P(this,Xr,null),e.then(t=>{y(this,It).destroyed||y(this,It).send("eth_uninstallFilter",[t])}))};var Si;class F2 extends Dw{constructor(t,n){super(t);z(this,Si);P(this,Si,$2(n))}_recover(t){return new Hd(t,y(this,Si))}async _subscribe(t){return await t.send("eth_newFilter",[y(this,Si)])}async _emitResults(t,n){for(const s of n)t.emit(y(this,Si),t._wrapLog(s,t._network))}}Si=new WeakMap;class L2 extends Dw{async _subscribe(e){return await e.send("eth_newPendingTransactionFilter",[])}async _emitResults(e,t){for(const n of t)e.emit("pending",n)}}const j2="bigint,boolean,function,number,string,symbol".split(/,/g);function wl(r){if(r==null||j2.indexOf(typeof r)>=0||typeof r.getAddress=="function")return r;if(Array.isArray(r))return r.map(wl);if(typeof r=="object")return Object.keys(r).reduce((e,t)=>(e[t]=r[t],e),{});throw new Error(`should not happen: ${r} (${typeof r})`)}function M2(r){return new Promise(e=>{setTimeout(e,r)})}function Gi(r){return r&&r.toLowerCase()}function xg(r){return r&&typeof r.pollingInterval=="number"}const _w={polling:!1,staticNetwork:null,batchStallTime:10,batchMaxSize:1<<20,batchMaxCount:100,cacheTimeout:250,pollingInterval:4e3};class eh extends bv{constructor(t,n){super(t);L(this,"address");n=ze(n),oe(this,{address:n})}connect(t){X(!1,"cannot reconnect JsonRpcSigner","UNSUPPORTED_OPERATION",{operation:"signer.connect"})}async getAddress(){return this.address}async populateTransaction(t){return await this.populateCall(t)}async sendUncheckedTransaction(t){const n=wl(t),s=[];if(n.from){const o=n.from;s.push((async()=>{const a=await nr(o,this.provider);H(a!=null&&a.toLowerCase()===this.address.toLowerCase(),"from address mismatch","transaction",t),n.from=a})())}else n.from=this.address;if(n.gasLimit==null&&s.push((async()=>{n.gasLimit=await this.provider.estimateGas({...n,from:this.address})})()),n.to!=null){const o=n.to;s.push((async()=>{n.to=await nr(o,this.provider)})())}s.length&&await Promise.all(s);const i=this.provider.getRpcTransaction(n);return this.provider.send("eth_sendTransaction",[i])}async sendTransaction(t){const n=await this.provider.getBlockNumber(),s=await this.sendUncheckedTransaction(t);return await new Promise((i,o)=>{const a=[1e3,100];let c=0;const l=async()=>{try{const u=await this.provider.getTransaction(s);if(u!=null){i(u.replaceableTransaction(n));return}}catch(u){if(St(u,"CANCELLED")||St(u,"BAD_DATA")||St(u,"NETWORK_ERROR")||St(u,"UNSUPPORTED_OPERATION")){u.info==null&&(u.info={}),u.info.sendTransactionHash=s,o(u);return}if(St(u,"INVALID_ARGUMENT")&&(c++,u.info==null&&(u.info={}),u.info.sendTransactionHash=s,c>10)){o(u);return}this.provider.emit("error",Le("failed to fetch transation after sending (will try again)","UNKNOWN_ERROR",{error:u}))}this.provider._setTimeout(()=>{l()},a.pop()||4e3)};l()})}async signTransaction(t){const n=wl(t);if(n.from){const i=await nr(n.from,this.provider);H(i!=null&&i.toLowerCase()===this.address.toLowerCase(),"from address mismatch","transaction",t),n.from=i}else n.from=this.address;const s=this.provider.getRpcTransaction(n);return await this.provider.send("eth_signTransaction",[s])}async signMessage(t){const n=typeof t=="string"?Bs(t):t;return await this.provider.send("personal_sign",[_e(n),this.address.toLowerCase()])}async signTypedData(t,n,s){const i=wl(s),o=await $p.resolveNames(t,n,i,async a=>{const c=await nr(a);return H(c!=null,"TypedData does not support null address","value",a),c});return await this.provider.send("eth_signTypedData_v4",[this.address.toLowerCase(),JSON.stringify($p.getPayload(o.domain,n,o.value))])}async unlock(t){return this.provider.send("personal_unlockAccount",[this.address.toLowerCase(),t,null])}async _legacySignMessage(t){const n=typeof t=="string"?Bs(t):t;return await this.provider.send("eth_sign",[this.address.toLowerCase(),_e(n)])}}var Oi,Mo,Un,en,Br,gr,$t,mc,kf;class z2 extends B2{constructor(t,n){super(t,n);z(this,mc);z(this,Oi);z(this,Mo);z(this,Un);z(this,en);z(this,Br);z(this,gr);z(this,$t);P(this,Mo,1),P(this,Oi,Object.assign({},_w,n||{})),P(this,Un,[]),P(this,en,null),P(this,gr,null),P(this,$t,null);{let i=null;const o=new Promise(a=>{i=a});P(this,Br,{promise:o,resolve:i})}const s=this._getOption("staticNetwork");typeof s=="boolean"?(H(!s||t!=="any","staticNetwork cannot be used on special network 'any'","options",n),s&&t!=null&&P(this,gr,on.from(t))):s&&(H(t==null||s.matches(t),"staticNetwork MUST match network object","options",n),P(this,gr,s))}_getOption(t){return y(this,Oi)[t]}get _network(){return X(y(this,gr),"network is not available yet","NETWORK_ERROR"),y(this,gr)}async _perform(t){if(t.method==="call"||t.method==="estimateGas"){let s=t.transaction;if(s&&s.type!=null&&ce(s.type)&&s.maxFeePerGas==null&&s.maxPriorityFeePerGas==null){const i=await this.getFeeData();i.maxFeePerGas==null&&i.maxPriorityFeePerGas==null&&(t=Object.assign({},t,{transaction:Object.assign({},s,{type:void 0})}))}}const n=this.getRpcRequest(t);return n!=null?await this.send(n.method,n.args):super._perform(t)}async _detectNetwork(){const t=this._getOption("staticNetwork");if(t)if(t===!0){if(y(this,gr))return y(this,gr)}else return t;return y(this,$t)?await y(this,$t):this.ready?(P(this,$t,(async()=>{try{const n=on.from(ce(await this.send("eth_chainId",[])));return P(this,$t,null),n}catch(n){throw P(this,$t,null),n}})()),await y(this,$t)):(P(this,$t,(async()=>{const n={id:aa(this,Mo)._++,method:"eth_chainId",params:[],jsonrpc:"2.0"};this.emit("debug",{action:"sendRpcPayload",payload:n});let s;try{s=(await this._send(n))[0],P(this,$t,null)}catch(i){throw P(this,$t,null),this.emit("debug",{action:"receiveRpcError",error:i}),i}if(this.emit("debug",{action:"receiveRpcResult",result:s}),"result"in s)return on.from(ce(s.result));throw this.getRpcError(n,s)})()),await y(this,$t))}_start(){y(this,Br)==null||y(this,Br).resolve==null||(y(this,Br).resolve(),P(this,Br,null),(async()=>{for(;y(this,gr)==null&&!this.destroyed;)try{P(this,gr,await this._detectNetwork())}catch(t){if(this.destroyed)break;console.log("JsonRpcProvider failed to detect network and cannot start up; retry in 1s (perhaps the URL is wrong or the node is not started)"),this.emit("error",Le("failed to bootstrap network detection","NETWORK_ERROR",{event:"initial-network-discovery",info:{error:t}})),await M2(1e3)}K(this,mc,kf).call(this)})())}async _waitUntilReady(){if(y(this,Br)!=null)return await y(this,Br).promise}_getSubscriber(t){return t.type==="pending"?new L2(this):t.type==="event"?this._getOption("polling")?new Hd(this,t.filter):new F2(this,t.filter):t.type==="orphan"&&t.filter.orphan==="drop-log"?new Ow("orphan"):super._getSubscriber(t)}get ready(){return y(this,Br)==null}getRpcTransaction(t){const n={};return["chainId","gasLimit","gasPrice","type","maxFeePerGas","maxPriorityFeePerGas","nonce","value"].forEach(s=>{if(t[s]==null)return;let i=s;s==="gasLimit"&&(i="gas"),n[i]=tn(ce(t[s],`tx.${s}`))}),["from","to","data"].forEach(s=>{t[s]!=null&&(n[s]=_e(t[s]))}),t.accessList&&(n.accessList=$d(t.accessList)),t.blobVersionedHashes&&(n.blobVersionedHashes=t.blobVersionedHashes.map(s=>s.toLowerCase())),t.authorizationList&&(n.authorizationList=t.authorizationList.map(s=>{const i=wv(s);return{address:i.address,nonce:tn(i.nonce),chainId:tn(i.chainId),yParity:tn(i.signature.yParity),r:tn(i.signature.r),s:tn(i.signature.s)}})),n}getRpcRequest(t){switch(t.method){case"chainId":return{method:"eth_chainId",args:[]};case"getBlockNumber":return{method:"eth_blockNumber",args:[]};case"getGasPrice":return{method:"eth_gasPrice",args:[]};case"getPriorityFee":return{method:"eth_maxPriorityFeePerGas",args:[]};case"getBalance":return{method:"eth_getBalance",args:[Gi(t.address),t.blockTag]};case"getTransactionCount":return{method:"eth_getTransactionCount",args:[Gi(t.address),t.blockTag]};case"getCode":return{method:"eth_getCode",args:[Gi(t.address),t.blockTag]};case"getStorage":return{method:"eth_getStorageAt",args:[Gi(t.address),"0x"+t.position.toString(16),t.blockTag]};case"broadcastTransaction":return{method:"eth_sendRawTransaction",args:[t.signedTransaction]};case"getBlock":if("blockTag"in t)return{method:"eth_getBlockByNumber",args:[t.blockTag,!!t.includeTransactions]};if("blockHash"in t)return{method:"eth_getBlockByHash",args:[t.blockHash,!!t.includeTransactions]};break;case"getTransaction":return{method:"eth_getTransactionByHash",args:[t.hash]};case"getTransactionReceipt":return{method:"eth_getTransactionReceipt",args:[t.hash]};case"call":return{method:"eth_call",args:[this.getRpcTransaction(t.transaction),t.blockTag]};case"estimateGas":return{method:"eth_estimateGas",args:[this.getRpcTransaction(t.transaction)]};case"getLogs":return t.filter&&t.filter.address!=null&&(Array.isArray(t.filter.address)?t.filter.address=t.filter.address.map(Gi):t.filter.address=Gi(t.filter.address)),{method:"eth_getLogs",args:[t.filter]}}return null}getRpcError(t,n){const{method:s}=t,{error:i}=n;if(s==="eth_estimateGas"&&i.message){const c=i.message;if(!c.match(/revert/i)&&c.match(/insufficient funds/i))return Le("insufficient funds","INSUFFICIENT_FUNDS",{transaction:t.params[0],info:{payload:t,error:i}});if(c.match(/nonce/i)&&c.match(/too low/i))return Le("nonce has already been used","NONCE_EXPIRED",{transaction:t.params[0],info:{payload:t,error:i}})}if(s==="eth_call"||s==="eth_estimateGas"){const c=Uf(i),l=Ja.getBuiltinCallException(s==="eth_call"?"call":"estimateGas",t.params[0],c?c.data:null);return l.info={error:i,payload:t},l}const o=JSON.stringify(V2(i));if(typeof i.message=="string"&&i.message.match(/user denied|ethers-user-denied/i))return Le("user rejected action","ACTION_REJECTED",{action:{eth_sign:"signMessage",personal_sign:"signMessage",eth_signTypedData_v4:"signTypedData",eth_signTransaction:"signTransaction",eth_sendTransaction:"sendTransaction",eth_requestAccounts:"requestAccess",wallet_requestAccounts:"requestAccess"}[s]||"unknown",reason:"rejected",info:{payload:t,error:i}});if(s==="eth_sendRawTransaction"||s==="eth_sendTransaction"){const c=t.params[0];if(o.match(/insufficient funds|base fee exceeds gas limit/i))return Le("insufficient funds for intrinsic transaction cost","INSUFFICIENT_FUNDS",{transaction:c,info:{error:i}});if(o.match(/nonce/i)&&o.match(/too low/i))return Le("nonce has already been used","NONCE_EXPIRED",{transaction:c,info:{error:i}});if(o.match(/replacement transaction/i)&&o.match(/underpriced/i))return Le("replacement fee too low","REPLACEMENT_UNDERPRICED",{transaction:c,info:{error:i}});if(o.match(/only replay-protected/i))return Le("legacy pre-eip-155 transactions not supported","UNSUPPORTED_OPERATION",{operation:s,info:{transaction:c,info:{error:i}}})}let a=!!o.match(/the method .* does not exist/i);return a||i&&i.details&&i.details.startsWith("Unauthorized method:")&&(a=!0),a?Le("unsupported operation","UNSUPPORTED_OPERATION",{operation:t.method,info:{error:i,payload:t}}):Le("could not coalesce error","UNKNOWN_ERROR",{error:i,payload:t})}send(t,n){if(this.destroyed)return Promise.reject(Le("provider destroyed; cancelled request","UNSUPPORTED_OPERATION",{operation:t}));const s=aa(this,Mo)._++,i=new Promise((o,a)=>{y(this,Un).push({resolve:o,reject:a,payload:{method:t,params:n,id:s,jsonrpc:"2.0"}})});return K(this,mc,kf).call(this),i}async getSigner(t){t==null&&(t=0);const n=this.send("eth_accounts",[]);if(typeof t=="number"){const i=await n;if(t>=i.length)throw new Error("no such account");return new eh(this,i[t])}const{accounts:s}=await Ir({network:this.getNetwork(),accounts:n});t=ze(t);for(const i of s)if(ze(i)===t)return new eh(this,t);throw new Error("invalid account")}async listAccounts(){return(await this.send("eth_accounts",[])).map(n=>new eh(this,n))}destroy(){y(this,en)&&(clearTimeout(y(this,en)),P(this,en,null));for(const{payload:t,reject:n}of y(this,Un))n(Le("provider destroyed; cancelled request","UNSUPPORTED_OPERATION",{operation:t.method}));P(this,Un,[]),super.destroy()}}Oi=new WeakMap,Mo=new WeakMap,Un=new WeakMap,en=new WeakMap,Br=new WeakMap,gr=new WeakMap,$t=new WeakMap,mc=new WeakSet,kf=function(){if(y(this,en))return;const t=this._getOption("batchMaxCount")===1?0:this._getOption("batchStallTime");P(this,en,setTimeout(()=>{P(this,en,null);const n=y(this,Un);for(P(this,Un,[]);n.length;){const s=[n.shift()];for(;n.length&&s.length!==y(this,Oi).batchMaxCount;)if(s.push(n.shift()),JSON.stringify(s.map(o=>o.payload)).length>y(this,Oi).batchMaxSize){n.unshift(s.pop());break}(async()=>{const i=s.length===1?s[0].payload:s.map(o=>o.payload);this.emit("debug",{action:"sendRpcPayload",payload:i});try{const o=await this._send(i);this.emit("debug",{action:"receiveRpcResult",result:o});for(const{resolve:a,reject:c,payload:l}of s){if(this.destroyed){c(Le("provider destroyed; cancelled request","UNSUPPORTED_OPERATION",{operation:l.method}));continue}const u=o.filter(h=>h.id===l.id)[0];if(u==null){const h=Le("missing response for request","BAD_DATA",{value:o,info:{payload:l}});this.emit("error",h),c(h);continue}if("error"in u){c(this.getRpcError(l,u));continue}a(u.result)}}catch(o){this.emit("debug",{action:"receiveRpcError",error:o});for(const{reject:a}of s)a(o)}})()}},t))};var Ds;class q2 extends z2{constructor(t,n){super(t,n);z(this,Ds);let s=this._getOption("pollingInterval");s==null&&(s=_w.pollingInterval),P(this,Ds,s)}_getSubscriber(t){const n=super._getSubscriber(t);return xg(n)&&(n.pollingInterval=y(this,Ds)),n}get pollingInterval(){return y(this,Ds)}set pollingInterval(t){if(!Number.isInteger(t)||t<0)throw new Error("invalid interval");P(this,Ds,t),this._forEachSubscriber(n=>{xg(n)&&(n.pollingInterval=y(this,Ds))})}}Ds=new WeakMap;var zo;class vg extends q2{constructor(t,n,s){t==null&&(t="http://localhost:8545");super(n,s);z(this,zo);typeof t=="string"?P(this,zo,new qn(t)):P(this,zo,t.clone())}_getConnection(){return y(this,zo).clone()}async send(t,n){return await this._start(),await super.send(t,n)}async _send(t){const n=this._getConnection();n.body=JSON.stringify(t),n.setHeader("content-type","application/json");const s=await n.send();s.assertOk();let i=s.bodyJson;return Array.isArray(i)||(i=[i]),i}}zo=new WeakMap;function Uf(r){if(r==null)return null;if(typeof r.message=="string"&&r.message.match(/revert/i)&&vt(r.data))return{message:r.message,data:r.data};if(typeof r=="object"){for(const e in r){const t=Uf(r[e]);if(t)return t}return null}if(typeof r=="string")try{return Uf(JSON.parse(r))}catch{}return null}function $f(r,e){if(r!=null){if(typeof r.message=="string"&&e.push(r.message),typeof r=="object")for(const t in r)$f(r[t],e);if(typeof r=="string")try{return $f(JSON.parse(r),e)}catch{}}}function V2(r){const e=[];return $f(r,e),e}var Kc={exports:{}},Eg;function K2(){if(Eg)return Kc.exports;Eg=1;var r=typeof Reflect=="object"?Reflect:null,e=r&&typeof r.apply=="function"?r.apply:function(v,S,D){return Function.prototype.apply.call(v,S,D)},t;r&&typeof r.ownKeys=="function"?t=r.ownKeys:Object.getOwnPropertySymbols?t=function(v){return Object.getOwnPropertyNames(v).concat(Object.getOwnPropertySymbols(v))}:t=function(v){return Object.getOwnPropertyNames(v)};function n(b){console&&console.warn&&console.warn(b)}var s=Number.isNaN||function(v){return v!==v};function i(){i.init.call(this)}Kc.exports=i,Kc.exports.once=E,i.EventEmitter=i,i.prototype._events=void 0,i.prototype._eventsCount=0,i.prototype._maxListeners=void 0;var o=10;function a(b){if(typeof b!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof b)}Object.defineProperty(i,"defaultMaxListeners",{enumerable:!0,get:function(){return o},set:function(b){if(typeof b!="number"||b<0||s(b))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+b+".");o=b}}),i.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},i.prototype.setMaxListeners=function(v){if(typeof v!="number"||v<0||s(v))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+v+".");return this._maxListeners=v,this};function c(b){return b._maxListeners===void 0?i.defaultMaxListeners:b._maxListeners}i.prototype.getMaxListeners=function(){return c(this)},i.prototype.emit=function(v){for(var S=[],D=1;D<arguments.length;D++)S.push(arguments[D]);var R=v==="error",_=this._events;if(_!==void 0)R=R&&_.error===void 0;else if(!R)return!1;if(R){var F;if(S.length>0&&(F=S[0]),F instanceof Error)throw F;var j=new Error("Unhandled error."+(F?" ("+F.message+")":""));throw j.context=F,j}var $=_[v];if($===void 0)return!1;if(typeof $=="function")e($,this,S);else for(var C=$.length,k=p($,C),D=0;D<C;++D)e(k[D],this,S);return!0};function l(b,v,S,D){var R,_,F;if(a(S),_=b._events,_===void 0?(_=b._events=Object.create(null),b._eventsCount=0):(_.newListener!==void 0&&(b.emit("newListener",v,S.listener?S.listener:S),_=b._events),F=_[v]),F===void 0)F=_[v]=S,++b._eventsCount;else if(typeof F=="function"?F=_[v]=D?[S,F]:[F,S]:D?F.unshift(S):F.push(S),R=c(b),R>0&&F.length>R&&!F.warned){F.warned=!0;var j=new Error("Possible EventEmitter memory leak detected. "+F.length+" "+String(v)+" listeners added. Use emitter.setMaxListeners() to increase limit");j.name="MaxListenersExceededWarning",j.emitter=b,j.type=v,j.count=F.length,n(j)}return b}i.prototype.addListener=function(v,S){return l(this,v,S,!1)},i.prototype.on=i.prototype.addListener,i.prototype.prependListener=function(v,S){return l(this,v,S,!0)};function u(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function h(b,v,S){var D={fired:!1,wrapFn:void 0,target:b,type:v,listener:S},R=u.bind(D);return R.listener=S,D.wrapFn=R,R}i.prototype.once=function(v,S){return a(S),this.on(v,h(this,v,S)),this},i.prototype.prependOnceListener=function(v,S){return a(S),this.prependListener(v,h(this,v,S)),this},i.prototype.removeListener=function(v,S){var D,R,_,F,j;if(a(S),R=this._events,R===void 0)return this;if(D=R[v],D===void 0)return this;if(D===S||D.listener===S)--this._eventsCount===0?this._events=Object.create(null):(delete R[v],R.removeListener&&this.emit("removeListener",v,D.listener||S));else if(typeof D!="function"){for(_=-1,F=D.length-1;F>=0;F--)if(D[F]===S||D[F].listener===S){j=D[F].listener,_=F;break}if(_<0)return this;_===0?D.shift():g(D,_),D.length===1&&(R[v]=D[0]),R.removeListener!==void 0&&this.emit("removeListener",v,j||S)}return this},i.prototype.off=i.prototype.removeListener,i.prototype.removeAllListeners=function(v){var S,D,R;if(D=this._events,D===void 0)return this;if(D.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):D[v]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete D[v]),this;if(arguments.length===0){var _=Object.keys(D),F;for(R=0;R<_.length;++R)F=_[R],F!=="removeListener"&&this.removeAllListeners(F);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(S=D[v],typeof S=="function")this.removeListener(v,S);else if(S!==void 0)for(R=S.length-1;R>=0;R--)this.removeListener(v,S[R]);return this};function f(b,v,S){var D=b._events;if(D===void 0)return[];var R=D[v];return R===void 0?[]:typeof R=="function"?S?[R.listener||R]:[R]:S?m(R):p(R,R.length)}i.prototype.listeners=function(v){return f(this,v,!0)},i.prototype.rawListeners=function(v){return f(this,v,!1)},i.listenerCount=function(b,v){return typeof b.listenerCount=="function"?b.listenerCount(v):d.call(b,v)},i.prototype.listenerCount=d;function d(b){var v=this._events;if(v!==void 0){var S=v[b];if(typeof S=="function")return 1;if(S!==void 0)return S.length}return 0}i.prototype.eventNames=function(){return this._eventsCount>0?t(this._events):[]};function p(b,v){for(var S=new Array(v),D=0;D<v;++D)S[D]=b[D];return S}function g(b,v){for(;v+1<b.length;v++)b[v]=b[v+1];b.pop()}function m(b){for(var v=new Array(b.length),S=0;S<v.length;++S)v[S]=b[S].listener||b[S];return v}function E(b,v){return new Promise(function(S,D){function R(F){b.removeListener(v,_),D(F)}function _(){typeof b.removeListener=="function"&&b.removeListener("error",R),S([].slice.call(arguments))}x(b,v,_,{once:!0}),v!=="error"&&O(b,R,{once:!0})})}function O(b,v,S){typeof b.on=="function"&&x(b,"error",v,S)}function x(b,v,S,D){if(typeof b.on=="function")D.once?b.once(v,S):b.on(v,S);else if(typeof b.addEventListener=="function")b.addEventListener(v,function R(_){D.once&&b.removeEventListener(v,R),S(_)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof b)}return Kc.exports}var Ur=K2();const Nw=Jx(Ur);var th={};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var Ff=function(r,e){return Ff=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var s in n)n.hasOwnProperty(s)&&(t[s]=n[s])},Ff(r,e)};function H2(r,e){Ff(r,e);function t(){this.constructor=r}r.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var Lf=function(){return Lf=Object.assign||function(e){for(var t,n=1,s=arguments.length;n<s;n++){t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e},Lf.apply(this,arguments)};function G2(r,e){var t={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&e.indexOf(n)<0&&(t[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(r);s<n.length;s++)e.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(r,n[s])&&(t[n[s]]=r[n[s]]);return t}function Q2(r,e,t,n){var s=arguments.length,i=s<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,t):n,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")i=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(o=r[a])&&(i=(s<3?o(i):s>3?o(e,t,i):o(e,t))||i);return s>3&&i&&Object.defineProperty(e,t,i),i}function W2(r,e){return function(t,n){e(t,n,r)}}function J2(r,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,e)}function Y2(r,e,t,n){function s(i){return i instanceof t?i:new t(function(o){o(i)})}return new(t||(t=Promise))(function(i,o){function a(u){try{l(n.next(u))}catch(h){o(h)}}function c(u){try{l(n.throw(u))}catch(h){o(h)}}function l(u){u.done?i(u.value):s(u.value).then(a,c)}l((n=n.apply(r,e||[])).next())})}function Z2(r,e){var t={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,s,i,o;return o={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function a(l){return function(u){return c([l,u])}}function c(l){if(n)throw new TypeError("Generator is already executing.");for(;t;)try{if(n=1,s&&(i=l[0]&2?s.return:l[0]?s.throw||((i=s.return)&&i.call(s),0):s.next)&&!(i=i.call(s,l[1])).done)return i;switch(s=0,i&&(l=[l[0]&2,i.value]),l[0]){case 0:case 1:i=l;break;case 4:return t.label++,{value:l[1],done:!1};case 5:t.label++,s=l[1],l=[0];continue;case 7:l=t.ops.pop(),t.trys.pop();continue;default:if(i=t.trys,!(i=i.length>0&&i[i.length-1])&&(l[0]===6||l[0]===2)){t=0;continue}if(l[0]===3&&(!i||l[1]>i[0]&&l[1]<i[3])){t.label=l[1];break}if(l[0]===6&&t.label<i[1]){t.label=i[1],i=l;break}if(i&&t.label<i[2]){t.label=i[2],t.ops.push(l);break}i[2]&&t.ops.pop(),t.trys.pop();continue}l=e.call(r,t)}catch(u){l=[6,u],s=0}finally{n=i=0}if(l[0]&5)throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}}function X2(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}function eA(r,e){for(var t in r)t!=="default"&&!e.hasOwnProperty(t)&&(e[t]=r[t])}function jf(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],n=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Cw(r,e){var t=typeof Symbol=="function"&&r[Symbol.iterator];if(!t)return r;var n=t.call(r),s,i=[],o;try{for(;(e===void 0||e-- >0)&&!(s=n.next()).done;)i.push(s.value)}catch(a){o={error:a}}finally{try{s&&!s.done&&(t=n.return)&&t.call(n)}finally{if(o)throw o.error}}return i}function tA(){for(var r=[],e=0;e<arguments.length;e++)r=r.concat(Cw(arguments[e]));return r}function rA(){for(var r=0,e=0,t=arguments.length;e<t;e++)r+=arguments[e].length;for(var n=Array(r),s=0,e=0;e<t;e++)for(var i=arguments[e],o=0,a=i.length;o<a;o++,s++)n[s]=i[o];return n}function Za(r){return this instanceof Za?(this.v=r,this):new Za(r)}function nA(r,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=t.apply(r,e||[]),s,i=[];return s={},o("next"),o("throw"),o("return"),s[Symbol.asyncIterator]=function(){return this},s;function o(f){n[f]&&(s[f]=function(d){return new Promise(function(p,g){i.push([f,d,p,g])>1||a(f,d)})})}function a(f,d){try{c(n[f](d))}catch(p){h(i[0][3],p)}}function c(f){f.value instanceof Za?Promise.resolve(f.value.v).then(l,u):h(i[0][2],f)}function l(f){a("next",f)}function u(f){a("throw",f)}function h(f,d){f(d),i.shift(),i.length&&a(i[0][0],i[0][1])}}function sA(r){var e,t;return e={},n("next"),n("throw",function(s){throw s}),n("return"),e[Symbol.iterator]=function(){return this},e;function n(s,i){e[s]=r[s]?function(o){return(t=!t)?{value:Za(r[s](o)),done:s==="return"}:i?i(o):o}:i}}function iA(r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=r[Symbol.asyncIterator],t;return e?e.call(r):(r=typeof jf=="function"?jf(r):r[Symbol.iterator](),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(i){t[i]=r[i]&&function(o){return new Promise(function(a,c){o=r[i](o),s(a,c,o.done,o.value)})}}function s(i,o,a,c){Promise.resolve(c).then(function(l){i({value:l,done:a})},o)}}function oA(r,e){return Object.defineProperty?Object.defineProperty(r,"raw",{value:e}):r.raw=e,r}function aA(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)Object.hasOwnProperty.call(r,t)&&(e[t]=r[t]);return e.default=r,e}function cA(r){return r&&r.__esModule?r:{default:r}}function lA(r,e){if(!e.has(r))throw new TypeError("attempted to get private field on non-instance");return e.get(r)}function uA(r,e,t){if(!e.has(r))throw new TypeError("attempted to set private field on non-instance");return e.set(r,t),t}const hA=Object.freeze(Object.defineProperty({__proto__:null,get __assign(){return Lf},__asyncDelegator:sA,__asyncGenerator:nA,__asyncValues:iA,__await:Za,__awaiter:Y2,__classPrivateFieldGet:lA,__classPrivateFieldSet:uA,__createBinding:X2,__decorate:Q2,__exportStar:eA,__extends:H2,__generator:Z2,__importDefault:cA,__importStar:aA,__makeTemplateObject:oA,__metadata:J2,__param:W2,__read:Cw,__rest:G2,__spread:tA,__spreadArrays:rA,__values:jf},Symbol.toStringTag,{value:"Module"})),Eu=Em(hA);var rh={},ua={},Ag;function fA(){if(Ag)return ua;Ag=1,Object.defineProperty(ua,"__esModule",{value:!0}),ua.delay=void 0;function r(e){return new Promise(t=>{setTimeout(()=>{t(!0)},e)})}return ua.delay=r,ua}var qs={},nh={},Vs={},Ig;function dA(){return Ig||(Ig=1,Object.defineProperty(Vs,"__esModule",{value:!0}),Vs.ONE_THOUSAND=Vs.ONE_HUNDRED=void 0,Vs.ONE_HUNDRED=100,Vs.ONE_THOUSAND=1e3),Vs}var sh={},Sg;function pA(){return Sg||(Sg=1,(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.ONE_YEAR=r.FOUR_WEEKS=r.THREE_WEEKS=r.TWO_WEEKS=r.ONE_WEEK=r.THIRTY_DAYS=r.SEVEN_DAYS=r.FIVE_DAYS=r.THREE_DAYS=r.ONE_DAY=r.TWENTY_FOUR_HOURS=r.TWELVE_HOURS=r.SIX_HOURS=r.THREE_HOURS=r.ONE_HOUR=r.SIXTY_MINUTES=r.THIRTY_MINUTES=r.TEN_MINUTES=r.FIVE_MINUTES=r.ONE_MINUTE=r.SIXTY_SECONDS=r.THIRTY_SECONDS=r.TEN_SECONDS=r.FIVE_SECONDS=r.ONE_SECOND=void 0,r.ONE_SECOND=1,r.FIVE_SECONDS=5,r.TEN_SECONDS=10,r.THIRTY_SECONDS=30,r.SIXTY_SECONDS=60,r.ONE_MINUTE=r.SIXTY_SECONDS,r.FIVE_MINUTES=r.ONE_MINUTE*5,r.TEN_MINUTES=r.ONE_MINUTE*10,r.THIRTY_MINUTES=r.ONE_MINUTE*30,r.SIXTY_MINUTES=r.ONE_MINUTE*60,r.ONE_HOUR=r.SIXTY_MINUTES,r.THREE_HOURS=r.ONE_HOUR*3,r.SIX_HOURS=r.ONE_HOUR*6,r.TWELVE_HOURS=r.ONE_HOUR*12,r.TWENTY_FOUR_HOURS=r.ONE_HOUR*24,r.ONE_DAY=r.TWENTY_FOUR_HOURS,r.THREE_DAYS=r.ONE_DAY*3,r.FIVE_DAYS=r.ONE_DAY*5,r.SEVEN_DAYS=r.ONE_DAY*7,r.THIRTY_DAYS=r.ONE_DAY*30,r.ONE_WEEK=r.SEVEN_DAYS,r.TWO_WEEKS=r.ONE_WEEK*2,r.THREE_WEEKS=r.ONE_WEEK*3,r.FOUR_WEEKS=r.ONE_WEEK*4,r.ONE_YEAR=r.ONE_DAY*365})(sh)),sh}var Og;function Bw(){return Og||(Og=1,(function(r){Object.defineProperty(r,"__esModule",{value:!0});const e=Eu;e.__exportStar(dA(),r),e.__exportStar(pA(),r)})(nh)),nh}var Dg;function gA(){if(Dg)return qs;Dg=1,Object.defineProperty(qs,"__esModule",{value:!0}),qs.fromMiliseconds=qs.toMiliseconds=void 0;const r=Bw();function e(n){return n*r.ONE_THOUSAND}qs.toMiliseconds=e;function t(n){return Math.floor(n/r.ONE_THOUSAND)}return qs.fromMiliseconds=t,qs}var _g;function yA(){return _g||(_g=1,(function(r){Object.defineProperty(r,"__esModule",{value:!0});const e=Eu;e.__exportStar(fA(),r),e.__exportStar(gA(),r)})(rh)),rh}var Qi={},Ng;function mA(){if(Ng)return Qi;Ng=1,Object.defineProperty(Qi,"__esModule",{value:!0}),Qi.Watch=void 0;class r{constructor(){this.timestamps=new Map}start(t){if(this.timestamps.has(t))throw new Error(`Watch already started for label: ${t}`);this.timestamps.set(t,{started:Date.now()})}stop(t){const n=this.get(t);if(typeof n.elapsed<"u")throw new Error(`Watch already stopped for label: ${t}`);const s=Date.now()-n.started;this.timestamps.set(t,{started:n.started,elapsed:s})}get(t){const n=this.timestamps.get(t);if(typeof n>"u")throw new Error(`No timestamp found for label: ${t}`);return n}elapsed(t){const n=this.get(t);return n.elapsed||Date.now()-n.started}}return Qi.Watch=r,Qi.default=r,Qi}var ih={},ha={},Cg;function wA(){if(Cg)return ha;Cg=1,Object.defineProperty(ha,"__esModule",{value:!0}),ha.IWatch=void 0;class r{}return ha.IWatch=r,ha}var Bg;function bA(){return Bg||(Bg=1,(function(r){Object.defineProperty(r,"__esModule",{value:!0}),Eu.__exportStar(wA(),r)})(ih)),ih}var Rg;function xA(){return Rg||(Rg=1,(function(r){Object.defineProperty(r,"__esModule",{value:!0});const e=Eu;e.__exportStar(yA(),r),e.__exportStar(mA(),r),e.__exportStar(bA(),r),e.__exportStar(Bw(),r)})(th)),th}var G=xA();class Li{}let vA=class extends Li{constructor(e){super()}};const Pg=G.FIVE_SECONDS,ji={pulse:"heartbeat_pulse"};let EA=class Rw extends vA{constructor(e){super(e),this.events=new Ur.EventEmitter,this.interval=Pg,this.interval=(e==null?void 0:e.interval)||Pg}static async init(e){const t=new Rw(e);return await t.init(),t}async init(){await this.initialize()}stop(){clearInterval(this.intervalRef)}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}off(e,t){this.events.off(e,t)}removeListener(e,t){this.events.removeListener(e,t)}async initialize(){this.intervalRef=setInterval(()=>this.pulse(),G.toMiliseconds(this.interval))}pulse(){this.events.emit(ji.pulse)}};const AA=/"(?:_|\\u0{2}5[Ff]){2}(?:p|\\u0{2}70)(?:r|\\u0{2}72)(?:o|\\u0{2}6[Ff])(?:t|\\u0{2}74)(?:o|\\u0{2}6[Ff])(?:_|\\u0{2}5[Ff]){2}"\s*:/,IA=/"(?:c|\\u0063)(?:o|\\u006[Ff])(?:n|\\u006[Ee])(?:s|\\u0073)(?:t|\\u0074)(?:r|\\u0072)(?:u|\\u0075)(?:c|\\u0063)(?:t|\\u0074)(?:o|\\u006[Ff])(?:r|\\u0072)"\s*:/,SA=/^\s*["[{]|^\s*-?\d{1,16}(\.\d{1,17})?([Ee][+-]?\d+)?\s*$/;function OA(r,e){if(r==="__proto__"||r==="constructor"&&e&&typeof e=="object"&&"prototype"in e){DA(r);return}return e}function DA(r){console.warn(`[destr] Dropping "${r}" key to prevent prototype pollution.`)}function Hc(r,e={}){if(typeof r!="string")return r;if(r[0]==='"'&&r[r.length-1]==='"'&&r.indexOf("\\")===-1)return r.slice(1,-1);const t=r.trim();if(t.length<=9)switch(t.toLowerCase()){case"true":return!0;case"false":return!1;case"undefined":return;case"null":return null;case"nan":return Number.NaN;case"infinity":return Number.POSITIVE_INFINITY;case"-infinity":return Number.NEGATIVE_INFINITY}if(!SA.test(r)){if(e.strict)throw new SyntaxError("[destr] Invalid JSON");return r}try{if(AA.test(r)||IA.test(r)){if(e.strict)throw new Error("[destr] Possible prototype pollution");return JSON.parse(r,OA)}return JSON.parse(r)}catch(n){if(e.strict)throw n;return r}}function _A(r){return!r||typeof r.then!="function"?Promise.resolve(r):r}function Je(r,...e){try{return _A(r(...e))}catch(t){return Promise.reject(t)}}function NA(r){const e=typeof r;return r===null||e!=="object"&&e!=="function"}function CA(r){const e=Object.getPrototypeOf(r);return!e||e.isPrototypeOf(Object)}function bl(r){if(NA(r))return String(r);if(CA(r)||Array.isArray(r))return JSON.stringify(r);if(typeof r.toJSON=="function")return bl(r.toJSON());throw new Error("[unstorage] Cannot stringify value!")}const Mf="base64:";function BA(r){return typeof r=="string"?r:Mf+TA(r)}function RA(r){return typeof r!="string"||!r.startsWith(Mf)?r:PA(r.slice(Mf.length))}function PA(r){return globalThis.Buffer?Buffer.from(r,"base64"):Uint8Array.from(globalThis.atob(r),e=>e.codePointAt(0))}function TA(r){return globalThis.Buffer?Buffer.from(r).toString("base64"):globalThis.btoa(String.fromCodePoint(...r))}function Tt(r){var e;return r&&((e=r.split("?")[0])==null?void 0:e.replace(/[/\\]/g,":").replace(/:+/g,":").replace(/^:|:$/g,""))||""}function kA(...r){return Tt(r.join(":"))}function Gc(r){return r=Tt(r),r?r+":":""}function UA(r,e){if(e===void 0)return!0;let t=0,n=r.indexOf(":");for(;n>-1;)t++,n=r.indexOf(":",n+1);return t<=e}function $A(r,e){return e?r.startsWith(e)&&r[r.length-1]!=="$":r[r.length-1]!=="$"}const FA="memory",LA=()=>{const r=new Map;return{name:FA,getInstance:()=>r,hasItem(e){return r.has(e)},getItem(e){return r.get(e)??null},getItemRaw(e){return r.get(e)??null},setItem(e,t){r.set(e,t)},setItemRaw(e,t){r.set(e,t)},removeItem(e){r.delete(e)},getKeys(){return[...r.keys()]},clear(){r.clear()},dispose(){r.clear()}}};function jA(r={}){const e={mounts:{"":r.driver||LA()},mountpoints:[""],watching:!1,watchListeners:[],unwatch:{}},t=l=>{for(const u of e.mountpoints)if(l.startsWith(u))return{base:u,relativeKey:l.slice(u.length),driver:e.mounts[u]};return{base:"",relativeKey:l,driver:e.mounts[""]}},n=(l,u)=>e.mountpoints.filter(h=>h.startsWith(l)||u&&l.startsWith(h)).map(h=>({relativeBase:l.length>h.length?l.slice(h.length):void 0,mountpoint:h,driver:e.mounts[h]})),s=(l,u)=>{if(e.watching){u=Tt(u);for(const h of e.watchListeners)h(l,u)}},i=async()=>{if(!e.watching){e.watching=!0;for(const l in e.mounts)e.unwatch[l]=await Tg(e.mounts[l],s,l)}},o=async()=>{if(e.watching){for(const l in e.unwatch)await e.unwatch[l]();e.unwatch={},e.watching=!1}},a=(l,u,h)=>{const f=new Map,d=p=>{let g=f.get(p.base);return g||(g={driver:p.driver,base:p.base,items:[]},f.set(p.base,g)),g};for(const p of l){const g=typeof p=="string",m=Tt(g?p:p.key),E=g?void 0:p.value,O=g||!p.options?u:{...u,...p.options},x=t(m);d(x).items.push({key:m,value:E,relativeKey:x.relativeKey,options:O})}return Promise.all([...f.values()].map(p=>h(p))).then(p=>p.flat())},c={hasItem(l,u={}){l=Tt(l);const{relativeKey:h,driver:f}=t(l);return Je(f.hasItem,h,u)},getItem(l,u={}){l=Tt(l);const{relativeKey:h,driver:f}=t(l);return Je(f.getItem,h,u).then(d=>Hc(d))},getItems(l,u={}){return a(l,u,h=>h.driver.getItems?Je(h.driver.getItems,h.items.map(f=>({key:f.relativeKey,options:f.options})),u).then(f=>f.map(d=>({key:kA(h.base,d.key),value:Hc(d.value)}))):Promise.all(h.items.map(f=>Je(h.driver.getItem,f.relativeKey,f.options).then(d=>({key:f.key,value:Hc(d)})))))},getItemRaw(l,u={}){l=Tt(l);const{relativeKey:h,driver:f}=t(l);return f.getItemRaw?Je(f.getItemRaw,h,u):Je(f.getItem,h,u).then(d=>RA(d))},async setItem(l,u,h={}){if(u===void 0)return c.removeItem(l);l=Tt(l);const{relativeKey:f,driver:d}=t(l);d.setItem&&(await Je(d.setItem,f,bl(u),h),d.watch||s("update",l))},async setItems(l,u){await a(l,u,async h=>{if(h.driver.setItems)return Je(h.driver.setItems,h.items.map(f=>({key:f.relativeKey,value:bl(f.value),options:f.options})),u);h.driver.setItem&&await Promise.all(h.items.map(f=>Je(h.driver.setItem,f.relativeKey,bl(f.value),f.options)))})},async setItemRaw(l,u,h={}){if(u===void 0)return c.removeItem(l,h);l=Tt(l);const{relativeKey:f,driver:d}=t(l);if(d.setItemRaw)await Je(d.setItemRaw,f,u,h);else if(d.setItem)await Je(d.setItem,f,BA(u),h);else return;d.watch||s("update",l)},async removeItem(l,u={}){typeof u=="boolean"&&(u={removeMeta:u}),l=Tt(l);const{relativeKey:h,driver:f}=t(l);f.removeItem&&(await Je(f.removeItem,h,u),(u.removeMeta||u.removeMata)&&await Je(f.removeItem,h+"$",u),f.watch||s("remove",l))},async getMeta(l,u={}){typeof u=="boolean"&&(u={nativeOnly:u}),l=Tt(l);const{relativeKey:h,driver:f}=t(l),d=Object.create(null);if(f.getMeta&&Object.assign(d,await Je(f.getMeta,h,u)),!u.nativeOnly){const p=await Je(f.getItem,h+"$",u).then(g=>Hc(g));p&&typeof p=="object"&&(typeof p.atime=="string"&&(p.atime=new Date(p.atime)),typeof p.mtime=="string"&&(p.mtime=new Date(p.mtime)),Object.assign(d,p))}return d},setMeta(l,u,h={}){return this.setItem(l+"$",u,h)},removeMeta(l,u={}){return this.removeItem(l+"$",u)},async getKeys(l,u={}){var m;l=Gc(l);const h=n(l,!0);let f=[];const d=[];let p=!0;for(const E of h){(m=E.driver.flags)!=null&&m.maxDepth||(p=!1);const O=await Je(E.driver.getKeys,E.relativeBase,u);for(const x of O){const b=E.mountpoint+Tt(x);f.some(v=>b.startsWith(v))||d.push(b)}f=[E.mountpoint,...f.filter(x=>!x.startsWith(E.mountpoint))]}const g=u.maxDepth!==void 0&&!p;return d.filter(E=>(!g||UA(E,u.maxDepth))&&$A(E,l))},async clear(l,u={}){l=Gc(l),await Promise.all(n(l,!1).map(async h=>{if(h.driver.clear)return Je(h.driver.clear,h.relativeBase,u);if(h.driver.removeItem){const f=await h.driver.getKeys(h.relativeBase||"",u);return Promise.all(f.map(d=>h.driver.removeItem(d,u)))}}))},async dispose(){await Promise.all(Object.values(e.mounts).map(l=>kg(l)))},async watch(l){return await i(),e.watchListeners.push(l),async()=>{e.watchListeners=e.watchListeners.filter(u=>u!==l),e.watchListeners.length===0&&await o()}},async unwatch(){e.watchListeners=[],await o()},mount(l,u){if(l=Gc(l),l&&e.mounts[l])throw new Error(`already mounted at ${l}`);return l&&(e.mountpoints.push(l),e.mountpoints.sort((h,f)=>f.length-h.length)),e.mounts[l]=u,e.watching&&Promise.resolve(Tg(u,s,l)).then(h=>{e.unwatch[l]=h}).catch(console.error),c},async unmount(l,u=!0){var h,f;l=Gc(l),!(!l||!e.mounts[l])&&(e.watching&&l in e.unwatch&&((f=(h=e.unwatch)[l])==null||f.call(h),delete e.unwatch[l]),u&&await kg(e.mounts[l]),e.mountpoints=e.mountpoints.filter(d=>d!==l),delete e.mounts[l])},getMount(l=""){l=Tt(l)+":";const u=t(l);return{driver:u.driver,base:u.base}},getMounts(l="",u={}){return l=Tt(l),n(l,u.parents).map(f=>({driver:f.driver,base:f.mountpoint}))},keys:(l,u={})=>c.getKeys(l,u),get:(l,u={})=>c.getItem(l,u),set:(l,u,h={})=>c.setItem(l,u,h),has:(l,u={})=>c.hasItem(l,u),del:(l,u={})=>c.removeItem(l,u),remove:(l,u={})=>c.removeItem(l,u)};return c}function Tg(r,e,t){return r.watch?r.watch((n,s)=>e(n,t+s)):()=>{}}async function kg(r){typeof r.dispose=="function"&&await Je(r.dispose)}function Mi(r){return new Promise((e,t)=>{r.oncomplete=r.onsuccess=()=>e(r.result),r.onabort=r.onerror=()=>t(r.error)})}function Pw(r,e){let t;const n=()=>{if(t)return t;const s=indexedDB.open(r);return s.onupgradeneeded=()=>s.result.createObjectStore(e),t=Mi(s),t.then(i=>{i.onclose=()=>t=void 0},()=>{}),t};return(s,i)=>n().then(o=>i(o.transaction(e,s).objectStore(e)))}let oh;function xc(){return oh||(oh=Pw("keyval-store","keyval")),oh}function Ug(r,e=xc()){return e("readonly",t=>Mi(t.get(r)))}function MA(r,e,t=xc()){return t("readwrite",n=>(n.put(e,r),Mi(n.transaction)))}function zA(r,e=xc()){return e("readwrite",t=>(t.delete(r),Mi(t.transaction)))}function qA(r=xc()){return r("readwrite",e=>(e.clear(),Mi(e.transaction)))}function VA(r,e){return r.openCursor().onsuccess=function(){this.result&&(e(this.result),this.result.continue())},Mi(r.transaction)}function KA(r=xc()){return r("readonly",e=>{if(e.getAllKeys)return Mi(e.getAllKeys());const t=[];return VA(e,n=>t.push(n.key)).then(()=>t)})}const HA=r=>JSON.stringify(r,(e,t)=>typeof t=="bigint"?t.toString()+"n":t),GA=r=>{const e=/([\[:])?(\d{17,}|(?:[9](?:[1-9]07199254740991|0[1-9]7199254740991|00[8-9]199254740991|007[2-9]99254740991|007199[3-9]54740991|0071992[6-9]4740991|00719925[5-9]740991|007199254[8-9]40991|0071992547[5-9]0991|00719925474[1-9]991|00719925474099[2-9])))([,\}\]])/g,t=r.replace(e,'$1"$2n"$3');return JSON.parse(t,(n,s)=>typeof s=="string"&&s.match(/^\d+n$/)?BigInt(s.substring(0,s.length-1)):s)};function Wo(r){if(typeof r!="string")throw new Error(`Cannot safe json parse value of type ${typeof r}`);try{return GA(r)}catch{return r}}function vc(r){return typeof r=="string"?r:HA(r)||""}const QA="idb-keyval";var WA=(r={})=>{const e=r.base&&r.base.length>0?`${r.base}:`:"",t=s=>e+s;let n;return r.dbName&&r.storeName&&(n=Pw(r.dbName,r.storeName)),{name:QA,options:r,async hasItem(s){return!(typeof await Ug(t(s),n)>"u")},async getItem(s){return await Ug(t(s),n)??null},setItem(s,i){return MA(t(s),i,n)},removeItem(s){return zA(t(s),n)},getKeys(){return KA(n)},clear(){return qA(n)}}};const JA="WALLET_CONNECT_V2_INDEXED_DB",YA="keyvaluestorage";let ZA=class{constructor(){this.indexedDb=jA({driver:WA({dbName:JA,storeName:YA})})}async getKeys(){return this.indexedDb.getKeys()}async getEntries(){return(await this.indexedDb.getItems(await this.indexedDb.getKeys())).map(e=>[e.key,e.value])}async getItem(e){const t=await this.indexedDb.getItem(e);if(t!==null)return t}async setItem(e,t){await this.indexedDb.setItem(e,vc(t))}async removeItem(e){await this.indexedDb.removeItem(e)}};var ah=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},xl={exports:{}};(function(){let r;function e(){}r=e,r.prototype.getItem=function(t){return this.hasOwnProperty(t)?String(this[t]):null},r.prototype.setItem=function(t,n){this[t]=String(n)},r.prototype.removeItem=function(t){delete this[t]},r.prototype.clear=function(){const t=this;Object.keys(t).forEach(function(n){t[n]=void 0,delete t[n]})},r.prototype.key=function(t){return t=t||0,Object.keys(this)[t]},r.prototype.__defineGetter__("length",function(){return Object.keys(this).length}),typeof ah<"u"&&ah.localStorage?xl.exports=ah.localStorage:typeof window<"u"&&window.localStorage?xl.exports=window.localStorage:xl.exports=new e})();function XA(r){var e;return[r[0],Wo((e=r[1])!=null?e:"")]}let eI=class{constructor(){this.localStorage=xl.exports}async getKeys(){return Object.keys(this.localStorage)}async getEntries(){return Object.entries(this.localStorage).map(XA)}async getItem(e){const t=this.localStorage.getItem(e);if(t!==null)return Wo(t)}async setItem(e,t){this.localStorage.setItem(e,vc(t))}async removeItem(e){this.localStorage.removeItem(e)}};const tI="wc_storage_version",$g=1,rI=async(r,e,t)=>{const n=tI,s=await e.getItem(n);if(s&&s>=$g){t(e);return}const i=await r.getKeys();if(!i.length){t(e);return}const o=[];for(;i.length;){const a=i.shift();if(!a)continue;const c=a.toLowerCase();if(c.includes("wc@")||c.includes("walletconnect")||c.includes("wc_")||c.includes("wallet_connect")){const l=await r.getItem(a);await e.setItem(a,l),o.push(a)}}await e.setItem(n,$g),t(e),nI(r,o)},nI=async(r,e)=>{e.length&&e.forEach(async t=>{await r.removeItem(t)})};let sI=class{constructor(){this.initialized=!1,this.setInitialized=t=>{this.storage=t,this.initialized=!0};const e=new eI;this.storage=e;try{const t=new ZA;rI(e,t,this.setInitialized)}catch{this.initialized=!0}}async getKeys(){return await this.initialize(),this.storage.getKeys()}async getEntries(){return await this.initialize(),this.storage.getEntries()}async getItem(e){return await this.initialize(),this.storage.getItem(e)}async setItem(e,t){return await this.initialize(),this.storage.setItem(e,t)}async removeItem(e){return await this.initialize(),this.storage.removeItem(e)}async initialize(){this.initialized||await new Promise(e=>{const t=setInterval(()=>{this.initialized&&(clearInterval(t),e())},20)})}};var sn={exports:{}};function iI(r){try{return JSON.stringify(r)}catch{return'"[Circular]"'}}var oI=aI;function aI(r,e,t){var n=t&&t.stringify||iI,s=1;if(typeof r=="object"&&r!==null){var i=e.length+s;if(i===1)return r;var o=new Array(i);o[0]=n(r);for(var a=1;a<i;a++)o[a]=n(e[a]);return o.join(" ")}if(typeof r!="string")return r;var c=e.length;if(c===0)return r;for(var l="",u=1-s,h=-1,f=r&&r.length||0,d=0;d<f;){if(r.charCodeAt(d)===37&&d+1<f){switch(h=h>-1?h:0,r.charCodeAt(d+1)){case 100:case 102:if(u>=c||e[u]==null)break;h<d&&(l+=r.slice(h,d)),l+=Number(e[u]),h=d+2,d++;break;case 105:if(u>=c||e[u]==null)break;h<d&&(l+=r.slice(h,d)),l+=Math.floor(Number(e[u])),h=d+2,d++;break;case 79:case 111:case 106:if(u>=c||e[u]===void 0)break;h<d&&(l+=r.slice(h,d));var p=typeof e[u];if(p==="string"){l+="'"+e[u]+"'",h=d+2,d++;break}if(p==="function"){l+=e[u].name||"<anonymous>",h=d+2,d++;break}l+=n(e[u]),h=d+2,d++;break;case 115:if(u>=c)break;h<d&&(l+=r.slice(h,d)),l+=String(e[u]),h=d+2,d++;break;case 37:h<d&&(l+=r.slice(h,d)),l+="%",h=d+2,d++,u--;break}++u}++d}return h===-1?r:(h<f&&(l+=r.slice(h)),l)}const Fg=oI;sn.exports=Mn;const Xa=EI().console||{},cI={mapHttpRequest:Qc,mapHttpResponse:Qc,wrapRequestSerializer:ch,wrapResponseSerializer:ch,wrapErrorSerializer:ch,req:Qc,res:Qc,err:jg,errWithCause:jg};function Ns(r,e){return r==="silent"?1/0:e.levels.values[r]}const Gd=Symbol("pino.logFuncs"),zf=Symbol("pino.hierarchy"),lI={error:"log",fatal:"error",warn:"error",info:"log",debug:"log",trace:"log"};function Lg(r,e){const t={logger:e,parent:r[zf]};e[zf]=t}function uI(r,e,t){const n={};e.forEach(s=>{n[s]=t[s]?t[s]:Xa[s]||Xa[lI[s]||"log"]||yo}),r[Gd]=n}function hI(r,e){return Array.isArray(r)?r.filter(function(t){return t!=="!stdSerializers.err"}):r===!0?Object.keys(e):!1}function Mn(r){r=r||{},r.browser=r.browser||{};const e=r.browser.transmit;if(e&&typeof e.send!="function")throw Error("pino: transmit option must have a send function");const t=r.browser.write||Xa;r.browser.write&&(r.browser.asObject=!0);const n=r.serializers||{},s=hI(r.browser.serialize,n);let i=r.browser.serialize;Array.isArray(r.browser.serialize)&&r.browser.serialize.indexOf("!stdSerializers.err")>-1&&(i=!1);const o=Object.keys(r.customLevels||{}),a=["error","fatal","warn","info","debug","trace"].concat(o);typeof t=="function"&&a.forEach(function(g){t[g]=t}),(r.enabled===!1||r.browser.disabled)&&(r.level="silent");const c=r.level||"info",l=Object.create(t);l.log||(l.log=yo),uI(l,a,t),Lg({},l),Object.defineProperty(l,"levelVal",{get:h}),Object.defineProperty(l,"level",{get:f,set:d});const u={transmit:e,serialize:s,asObject:r.browser.asObject,asObjectBindingsOnly:r.browser.asObjectBindingsOnly,formatters:r.browser.formatters,levels:a,timestamp:bI(r),messageKey:r.messageKey||"msg",onChild:r.onChild||yo};l.levels=fI(r),l.level=c,l.isLevelEnabled=function(g){return this.levels.values[g]?this.levels.values[g]>=this.levels.values[this.level]:!1},l.setMaxListeners=l.getMaxListeners=l.emit=l.addListener=l.on=l.prependListener=l.once=l.prependOnceListener=l.removeListener=l.removeAllListeners=l.listeners=l.listenerCount=l.eventNames=l.write=l.flush=yo,l.serializers=n,l._serialize=s,l._stdErrSerialize=i,l.child=function(...g){return p.call(this,u,...g)},e&&(l._logEvent=qf());function h(){return Ns(this.level,this)}function f(){return this._level}function d(g){if(g!=="silent"&&!this.levels.values[g])throw Error("unknown level "+g);this._level=g,Ks(this,u,l,"error"),Ks(this,u,l,"fatal"),Ks(this,u,l,"warn"),Ks(this,u,l,"info"),Ks(this,u,l,"debug"),Ks(this,u,l,"trace"),o.forEach(m=>{Ks(this,u,l,m)})}function p(g,m,E){if(!m)throw new Error("missing bindings for child Pino");E=E||{},s&&m.serializers&&(E.serializers=m.serializers);const O=E.serializers;if(s&&O){var x=Object.assign({},n,O),b=r.browser.serialize===!0?Object.keys(x):s;delete m.serializers,Qd([m],b,x,this._stdErrSerialize)}function v(D){this._childLevel=(D._childLevel|0)+1,this.bindings=m,x&&(this.serializers=x,this._serialize=b),e&&(this._logEvent=qf([].concat(D._logEvent.bindings,m)))}v.prototype=this;const S=new v(this);return Lg(this,S),S.child=function(...D){return p.call(this,g,...D)},S.level=E.level||this.level,g.onChild(S),S}return l}function fI(r){const e=r.customLevels||{},t=Object.assign({},Mn.levels.values,e),n=Object.assign({},Mn.levels.labels,dI(e));return{values:t,labels:n}}function dI(r){const e={};return Object.keys(r).forEach(function(t){e[r[t]]=t}),e}Mn.levels={values:{fatal:60,error:50,warn:40,info:30,debug:20,trace:10},labels:{10:"trace",20:"debug",30:"info",40:"warn",50:"error",60:"fatal"}},Mn.stdSerializers=cI,Mn.stdTimeFunctions=Object.assign({},{nullTime:Tw,epochTime:kw,unixTime:xI,isoTime:vI});function pI(r){const e=[];r.bindings&&e.push(r.bindings);let t=r[zf];for(;t.parent;)t=t.parent,t.logger.bindings&&e.push(t.logger.bindings);return e.reverse()}function Ks(r,e,t,n){if(Object.defineProperty(r,n,{value:Ns(r.level,t)>Ns(n,t)?yo:t[Gd][n],writable:!0,enumerable:!0,configurable:!0}),r[n]===yo){if(!e.transmit)return;const i=e.transmit.level||r.level,o=Ns(i,t);if(Ns(n,t)<o)return}r[n]=yI(r,e,t,n);const s=pI(r);s.length!==0&&(r[n]=gI(s,r[n]))}function gI(r,e){return function(){return e.apply(this,[...r,...arguments])}}function yI(r,e,t,n){return(function(s){return function(){const i=e.timestamp(),o=new Array(arguments.length),a=Object.getPrototypeOf&&Object.getPrototypeOf(this)===Xa?Xa:this;for(var c=0;c<o.length;c++)o[c]=arguments[c];var l=!1;if(e.serialize&&(Qd(o,this._serialize,this.serializers,this._stdErrSerialize),l=!0),e.asObject||e.formatters?s.call(a,...mI(this,n,o,i,e)):s.apply(a,o),e.transmit){const u=e.transmit.level||r._level,h=Ns(u,t),f=Ns(n,t);if(f<h)return;wI(this,{ts:i,methodLevel:n,methodValue:f,transmitValue:t.levels.values[e.transmit.level||r._level],send:e.transmit.send,val:Ns(r._level,t)},o,l)}}})(r[Gd][n])}function mI(r,e,t,n,s){const{level:i,log:o=h=>h}=s.formatters||{},a=t.slice();let c=a[0];const l={};let u=(r._childLevel|0)+1;if(u<1&&(u=1),n&&(l.time=n),i){const h=i(e,r.levels.values[e]);Object.assign(l,h)}else l.level=r.levels.values[e];if(s.asObjectBindingsOnly){if(c!==null&&typeof c=="object")for(;u--&&typeof a[0]=="object";)Object.assign(l,a.shift());return[o(l),...a]}else{if(c!==null&&typeof c=="object"){for(;u--&&typeof a[0]=="object";)Object.assign(l,a.shift());c=a.length?Fg(a.shift(),a):void 0}else typeof c=="string"&&(c=Fg(a.shift(),a));return c!==void 0&&(l[s.messageKey]=c),[o(l)]}}function Qd(r,e,t,n){for(const s in r)if(n&&r[s]instanceof Error)r[s]=Mn.stdSerializers.err(r[s]);else if(typeof r[s]=="object"&&!Array.isArray(r[s])&&e)for(const i in r[s])e.indexOf(i)>-1&&i in t&&(r[s][i]=t[i](r[s][i]))}function wI(r,e,t,n=!1){const s=e.send,i=e.ts,o=e.methodLevel,a=e.methodValue,c=e.val,l=r._logEvent.bindings;n||Qd(t,r._serialize||Object.keys(r.serializers),r.serializers,r._stdErrSerialize===void 0?!0:r._stdErrSerialize),r._logEvent.ts=i,r._logEvent.messages=t.filter(function(u){return l.indexOf(u)===-1}),r._logEvent.level.label=o,r._logEvent.level.value=a,s(o,r._logEvent,c),r._logEvent=qf(l)}function qf(r){return{ts:0,messages:[],bindings:r||[],level:{label:"",value:0}}}function jg(r){const e={type:r.constructor.name,msg:r.message,stack:r.stack};for(const t in r)e[t]===void 0&&(e[t]=r[t]);return e}function bI(r){return typeof r.timestamp=="function"?r.timestamp:r.timestamp===!1?Tw:kw}function Qc(){return{}}function ch(r){return r}function yo(){}function Tw(){return!1}function kw(){return Date.now()}function xI(){return Math.round(Date.now()/1e3)}function vI(){return new Date(Date.now()).toISOString()}function EI(){function r(e){return typeof e<"u"&&e}try{return typeof globalThis<"u"||Object.defineProperty(Object.prototype,"globalThis",{get:function(){return delete Object.prototype.globalThis,this.globalThis=this},configurable:!0}),globalThis}catch{return r(self)||r(window)||r(this)||{}}}sn.exports.default=Mn;sn.exports.pino=Mn;const AI={level:"info"},Au="custom_context",Wd=1e3*1024;var II=Object.defineProperty,SI=(r,e,t)=>e in r?II(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,us=(r,e,t)=>SI(r,typeof e!="symbol"?e+"":e,t);let OI=class{constructor(e){us(this,"nodeValue"),us(this,"sizeInBytes"),us(this,"next"),this.nodeValue=e,this.sizeInBytes=new TextEncoder().encode(this.nodeValue).length,this.next=null}get value(){return this.nodeValue}get size(){return this.sizeInBytes}},Mg=class{constructor(e){us(this,"lengthInNodes"),us(this,"sizeInBytes"),us(this,"head"),us(this,"tail"),us(this,"maxSizeInBytes"),this.head=null,this.tail=null,this.lengthInNodes=0,this.maxSizeInBytes=e,this.sizeInBytes=0}append(e){const t=new OI(e);if(t.size>this.maxSizeInBytes)throw new Error(`[LinkedList] Value too big to insert into list: ${e} with size ${t.size}`);for(;this.size+t.size>this.maxSizeInBytes;)this.shift();this.head?(this.tail&&(this.tail.next=t),this.tail=t):(this.head=t,this.tail=t),this.lengthInNodes++,this.sizeInBytes+=t.size}shift(){if(!this.head)return;const e=this.head;this.head=this.head.next,this.head||(this.tail=null),this.lengthInNodes--,this.sizeInBytes-=e.size}toArray(){const e=[];let t=this.head;for(;t!==null;)e.push(t.value),t=t.next;return e}get length(){return this.lengthInNodes}get size(){return this.sizeInBytes}toOrderedArray(){return Array.from(this)}[Symbol.iterator](){let e=this.head;return{next:()=>{if(!e)return{done:!0,value:null};const t=e.value;return e=e.next,{done:!1,value:t}}}}};const DI=r=>JSON.stringify(r,(e,t)=>typeof t=="bigint"?t.toString()+"n":t);function zg(r){return typeof r=="string"?r:DI(r)||""}var _I=Object.defineProperty,NI=(r,e,t)=>e in r?_I(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,Wc=(r,e,t)=>NI(r,typeof e!="symbol"?e+"":e,t);let Uw=class{constructor(e,t=Wd){Wc(this,"logs"),Wc(this,"level"),Wc(this,"levelValue"),Wc(this,"MAX_LOG_SIZE_IN_BYTES"),this.level=e??"error",this.levelValue=sn.exports.levels.values[this.level],this.MAX_LOG_SIZE_IN_BYTES=t,this.logs=new Mg(this.MAX_LOG_SIZE_IN_BYTES)}forwardToConsole(e,t){t===sn.exports.levels.values.error?console.error(e):t===sn.exports.levels.values.warn?console.warn(e):t===sn.exports.levels.values.debug?console.debug(e):t===sn.exports.levels.values.trace?console.trace(e):console.log(e)}appendToLogs(e){this.logs.append(zg({timestamp:new Date().toISOString(),log:e}));const t=typeof e=="string"?JSON.parse(e).level:e.level;t>=this.levelValue&&this.forwardToConsole(e,t)}getLogs(){return this.logs}clearLogs(){this.logs=new Mg(this.MAX_LOG_SIZE_IN_BYTES)}getLogArray(){return Array.from(this.logs)}logsToBlob(e){const t=this.getLogArray();return t.push(zg({extraMetadata:e})),new Blob(t,{type:"application/json"})}};var CI=Object.defineProperty,BI=(r,e,t)=>e in r?CI(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,RI=(r,e,t)=>BI(r,e+"",t);let PI=class{constructor(e,t=Wd){RI(this,"baseChunkLogger"),this.baseChunkLogger=new Uw(e,t)}write(e){this.baseChunkLogger.appendToLogs(e)}getLogs(){return this.baseChunkLogger.getLogs()}clearLogs(){this.baseChunkLogger.clearLogs()}getLogArray(){return this.baseChunkLogger.getLogArray()}logsToBlob(e){return this.baseChunkLogger.logsToBlob(e)}downloadLogsBlobInBrowser(e){const t=URL.createObjectURL(this.logsToBlob(e)),n=document.createElement("a");n.href=t,n.download=`walletconnect-logs-${new Date().toISOString()}.txt`,document.body.appendChild(n),n.click(),document.body.removeChild(n),URL.revokeObjectURL(t)}};var TI=Object.defineProperty,kI=(r,e,t)=>e in r?TI(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,UI=(r,e,t)=>kI(r,e+"",t);let $I=class{constructor(e,t=Wd){UI(this,"baseChunkLogger"),this.baseChunkLogger=new Uw(e,t)}write(e){this.baseChunkLogger.appendToLogs(e)}getLogs(){return this.baseChunkLogger.getLogs()}clearLogs(){this.baseChunkLogger.clearLogs()}getLogArray(){return this.baseChunkLogger.getLogArray()}logsToBlob(e){return this.baseChunkLogger.logsToBlob(e)}};var FI=Object.defineProperty,LI=Object.defineProperties,jI=Object.getOwnPropertyDescriptors,qg=Object.getOwnPropertySymbols,MI=Object.prototype.hasOwnProperty,zI=Object.prototype.propertyIsEnumerable,Vg=(r,e,t)=>e in r?FI(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,Ps=(r,e)=>{for(var t in e||(e={}))MI.call(e,t)&&Vg(r,t,e[t]);if(qg)for(var t of qg(e))zI.call(e,t)&&Vg(r,t,e[t]);return r},Ts=(r,e)=>LI(r,jI(e));function qI(r){return Ts(Ps({},r),{level:(r==null?void 0:r.level)||AI.level})}function VI(r,e,t=Au){return r[t]=e,r}function Ht(r,e=Au){return r[e]||""}function KI(r,e,t=Au){const n=Ht(r,t);return n.trim()?`${n}/${e}`:e}function ir(r,e,t=Au){const n=KI(r,e,t),s=r.child({context:n});return VI(s,n,t)}function HI(r){var e,t;const n=new PI((e=r.opts)==null?void 0:e.level,r.maxSizeInBytes);return{logger:sn.exports(Ts(Ps({},r.opts),{level:"trace",browser:Ts(Ps({},(t=r.opts)==null?void 0:t.browser),{write:s=>n.write(s)})})),chunkLoggerController:n}}function GI(r){var e,t;const n=new $I((e=r.opts)==null?void 0:e.level,r.maxSizeInBytes);return{logger:sn.exports(Ts(Ps({},r.opts),{level:"trace",browser:Ts(Ps({},(t=r.opts)==null?void 0:t.browser),{write:s=>n.write(s)})}),n),chunkLoggerController:n}}function $w(r){var e;if(typeof r.loggerOverride<"u"&&typeof r.loggerOverride!="string")return{logger:r.loggerOverride,chunkLoggerController:null};const t=Ts(Ps({},r.opts),{level:typeof r.loggerOverride=="string"?r.loggerOverride:(e=r.opts)==null?void 0:e.level});return typeof window<"u"?HI(Ts(Ps({},r),{opts:t})):GI(Ts(Ps({},r),{opts:t}))}var QI=Object.defineProperty,WI=(r,e,t)=>e in r?QI(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,Kg=(r,e,t)=>WI(r,typeof e!="symbol"?e+"":e,t);let JI=class extends Li{constructor(e){super(),this.opts=e,Kg(this,"protocol","wc"),Kg(this,"version",2)}};var YI=Object.defineProperty,ZI=(r,e,t)=>e in r?YI(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,XI=(r,e,t)=>ZI(r,e+"",t);class e3 extends Li{constructor(e,t){super(),this.core=e,this.logger=t,XI(this,"records",new Map)}}class t3{constructor(e,t){this.logger=e,this.core=t}}class r3 extends Li{constructor(e,t){super(),this.relayer=e,this.logger=t}}let n3=class extends Li{constructor(e){super()}},s3=class{constructor(e,t,n,s){this.core=e,this.logger=t,this.name=n}},i3=class extends Li{constructor(e,t){super(),this.relayer=e,this.logger=t}},o3=class extends Li{constructor(e,t){super(),this.core=e,this.logger=t}},a3=class{constructor(e,t,n){this.core=e,this.logger=t,this.store=n}};class c3{constructor(e,t){this.projectId=e,this.logger=t}}class l3{constructor(e,t,n){this.core=e,this.logger=t,this.telemetryEnabled=n}}var u3=Object.defineProperty,h3=(r,e,t)=>e in r?u3(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,Hg=(r,e,t)=>h3(r,typeof e!="symbol"?e+"":e,t);let f3=class{constructor(e){this.opts=e,Hg(this,"protocol","wc"),Hg(this,"version",2)}},d3=class{constructor(e){this.client=e}};function p3(r){return r instanceof Uint8Array||ArrayBuffer.isView(r)&&r.constructor.name==="Uint8Array"}function Fw(r,...e){if(!p3(r))throw new Error("Uint8Array expected");if(e.length>0&&!e.includes(r.length))throw new Error("Uint8Array expected of length "+e+", got length="+r.length)}function Gg(r,e=!0){if(r.destroyed)throw new Error("Hash instance has been destroyed");if(e&&r.finished)throw new Error("Hash#digest() has already been called")}function g3(r,e){Fw(r);const t=e.outputLen;if(r.length<t)throw new Error("digestInto() expects output buffer of length at least "+t)}const Wi=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */const lh=r=>new DataView(r.buffer,r.byteOffset,r.byteLength);function y3(r){if(typeof r!="string")throw new Error("utf8ToBytes expected string, got "+typeof r);return new Uint8Array(new TextEncoder().encode(r))}function Lw(r){return typeof r=="string"&&(r=y3(r)),Fw(r),r}let m3=class{clone(){return this._cloneInto()}};function w3(r){const e=n=>r().update(Lw(n)).digest(),t=r();return e.outputLen=t.outputLen,e.blockLen=t.blockLen,e.create=()=>r(),e}function jw(r=32){if(Wi&&typeof Wi.getRandomValues=="function")return Wi.getRandomValues(new Uint8Array(r));if(Wi&&typeof Wi.randomBytes=="function")return Wi.randomBytes(r);throw new Error("crypto.getRandomValues must be defined")}function b3(r,e,t,n){if(typeof r.setBigUint64=="function")return r.setBigUint64(e,t,n);const s=BigInt(32),i=BigInt(4294967295),o=Number(t>>s&i),a=Number(t&i),c=n?4:0,l=n?0:4;r.setUint32(e+c,o,n),r.setUint32(e+l,a,n)}let x3=class extends m3{constructor(e,t,n,s){super(),this.blockLen=e,this.outputLen=t,this.padOffset=n,this.isLE=s,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(e),this.view=lh(this.buffer)}update(e){Gg(this);const{view:t,buffer:n,blockLen:s}=this;e=Lw(e);const i=e.length;for(let o=0;o<i;){const a=Math.min(s-this.pos,i-o);if(a===s){const c=lh(e);for(;s<=i-o;o+=s)this.process(c,o);continue}n.set(e.subarray(o,o+a),this.pos),this.pos+=a,o+=a,this.pos===s&&(this.process(t,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){Gg(this),g3(e,this),this.finished=!0;const{buffer:t,view:n,blockLen:s,isLE:i}=this;let{pos:o}=this;t[o++]=128,this.buffer.subarray(o).fill(0),this.padOffset>s-o&&(this.process(n,0),o=0);for(let h=o;h<s;h++)t[h]=0;b3(n,s-8,BigInt(this.length*8),i),this.process(n,0);const a=lh(e),c=this.outputLen;if(c%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const l=c/4,u=this.get();if(l>u.length)throw new Error("_sha2: outputLen bigger than state");for(let h=0;h<l;h++)a.setUint32(4*h,u[h],i)}digest(){const{buffer:e,outputLen:t}=this;this.digestInto(e);const n=e.slice(0,t);return this.destroy(),n}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());const{blockLen:t,buffer:n,length:s,finished:i,destroyed:o,pos:a}=this;return e.length=s,e.pos=a,e.finished=i,e.destroyed=o,s%t&&e.buffer.set(n),e}};const Jc=BigInt(2**32-1),Vf=BigInt(32);function Mw(r,e=!1){return e?{h:Number(r&Jc),l:Number(r>>Vf&Jc)}:{h:Number(r>>Vf&Jc)|0,l:Number(r&Jc)|0}}function v3(r,e=!1){let t=new Uint32Array(r.length),n=new Uint32Array(r.length);for(let s=0;s<r.length;s++){const{h:i,l:o}=Mw(r[s],e);[t[s],n[s]]=[i,o]}return[t,n]}const E3=(r,e)=>BigInt(r>>>0)<<Vf|BigInt(e>>>0),A3=(r,e,t)=>r>>>t,I3=(r,e,t)=>r<<32-t|e>>>t,S3=(r,e,t)=>r>>>t|e<<32-t,O3=(r,e,t)=>r<<32-t|e>>>t,D3=(r,e,t)=>r<<64-t|e>>>t-32,_3=(r,e,t)=>r>>>t-32|e<<64-t,N3=(r,e)=>e,C3=(r,e)=>r,B3=(r,e,t)=>r<<t|e>>>32-t,R3=(r,e,t)=>e<<t|r>>>32-t,P3=(r,e,t)=>e<<t-32|r>>>64-t,T3=(r,e,t)=>r<<t-32|e>>>64-t;function k3(r,e,t,n){const s=(e>>>0)+(n>>>0);return{h:r+t+(s/2**32|0)|0,l:s|0}}const U3=(r,e,t)=>(r>>>0)+(e>>>0)+(t>>>0),$3=(r,e,t,n)=>e+t+n+(r/2**32|0)|0,F3=(r,e,t,n)=>(r>>>0)+(e>>>0)+(t>>>0)+(n>>>0),L3=(r,e,t,n,s)=>e+t+n+s+(r/2**32|0)|0,j3=(r,e,t,n,s)=>(r>>>0)+(e>>>0)+(t>>>0)+(n>>>0)+(s>>>0),M3=(r,e,t,n,s,i)=>e+t+n+s+i+(r/2**32|0)|0,le={fromBig:Mw,split:v3,toBig:E3,shrSH:A3,shrSL:I3,rotrSH:S3,rotrSL:O3,rotrBH:D3,rotrBL:_3,rotr32H:N3,rotr32L:C3,rotlSH:B3,rotlSL:R3,rotlBH:P3,rotlBL:T3,add:k3,add3L:U3,add3H:$3,add4L:F3,add4H:L3,add5H:M3,add5L:j3},[z3,q3]=le.split(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(r=>BigInt(r))),Wn=new Uint32Array(80),Jn=new Uint32Array(80);let V3=class extends x3{constructor(){super(128,64,16,!1),this.Ah=1779033703,this.Al=-205731576,this.Bh=-1150833019,this.Bl=-2067093701,this.Ch=1013904242,this.Cl=-23791573,this.Dh=-1521486534,this.Dl=1595750129,this.Eh=1359893119,this.El=-1377402159,this.Fh=-1694144372,this.Fl=725511199,this.Gh=528734635,this.Gl=-79577749,this.Hh=1541459225,this.Hl=327033209}get(){const{Ah:e,Al:t,Bh:n,Bl:s,Ch:i,Cl:o,Dh:a,Dl:c,Eh:l,El:u,Fh:h,Fl:f,Gh:d,Gl:p,Hh:g,Hl:m}=this;return[e,t,n,s,i,o,a,c,l,u,h,f,d,p,g,m]}set(e,t,n,s,i,o,a,c,l,u,h,f,d,p,g,m){this.Ah=e|0,this.Al=t|0,this.Bh=n|0,this.Bl=s|0,this.Ch=i|0,this.Cl=o|0,this.Dh=a|0,this.Dl=c|0,this.Eh=l|0,this.El=u|0,this.Fh=h|0,this.Fl=f|0,this.Gh=d|0,this.Gl=p|0,this.Hh=g|0,this.Hl=m|0}process(e,t){for(let x=0;x<16;x++,t+=4)Wn[x]=e.getUint32(t),Jn[x]=e.getUint32(t+=4);for(let x=16;x<80;x++){const b=Wn[x-15]|0,v=Jn[x-15]|0,S=le.rotrSH(b,v,1)^le.rotrSH(b,v,8)^le.shrSH(b,v,7),D=le.rotrSL(b,v,1)^le.rotrSL(b,v,8)^le.shrSL(b,v,7),R=Wn[x-2]|0,_=Jn[x-2]|0,F=le.rotrSH(R,_,19)^le.rotrBH(R,_,61)^le.shrSH(R,_,6),j=le.rotrSL(R,_,19)^le.rotrBL(R,_,61)^le.shrSL(R,_,6),$=le.add4L(D,j,Jn[x-7],Jn[x-16]),C=le.add4H($,S,F,Wn[x-7],Wn[x-16]);Wn[x]=C|0,Jn[x]=$|0}let{Ah:n,Al:s,Bh:i,Bl:o,Ch:a,Cl:c,Dh:l,Dl:u,Eh:h,El:f,Fh:d,Fl:p,Gh:g,Gl:m,Hh:E,Hl:O}=this;for(let x=0;x<80;x++){const b=le.rotrSH(h,f,14)^le.rotrSH(h,f,18)^le.rotrBH(h,f,41),v=le.rotrSL(h,f,14)^le.rotrSL(h,f,18)^le.rotrBL(h,f,41),S=h&d^~h&g,D=f&p^~f&m,R=le.add5L(O,v,D,q3[x],Jn[x]),_=le.add5H(R,E,b,S,z3[x],Wn[x]),F=R|0,j=le.rotrSH(n,s,28)^le.rotrBH(n,s,34)^le.rotrBH(n,s,39),$=le.rotrSL(n,s,28)^le.rotrBL(n,s,34)^le.rotrBL(n,s,39),C=n&i^n&a^i&a,k=s&o^s&c^o&c;E=g|0,O=m|0,g=d|0,m=p|0,d=h|0,p=f|0,{h,l:f}=le.add(l|0,u|0,_|0,F|0),l=a|0,u=c|0,a=i|0,c=o|0,i=n|0,o=s|0;const I=le.add3L(F,$,k);n=le.add3H(I,_,j,C),s=I|0}({h:n,l:s}=le.add(this.Ah|0,this.Al|0,n|0,s|0)),{h:i,l:o}=le.add(this.Bh|0,this.Bl|0,i|0,o|0),{h:a,l:c}=le.add(this.Ch|0,this.Cl|0,a|0,c|0),{h:l,l:u}=le.add(this.Dh|0,this.Dl|0,l|0,u|0),{h,l:f}=le.add(this.Eh|0,this.El|0,h|0,f|0),{h:d,l:p}=le.add(this.Fh|0,this.Fl|0,d|0,p|0),{h:g,l:m}=le.add(this.Gh|0,this.Gl|0,g|0,m|0),{h:E,l:O}=le.add(this.Hh|0,this.Hl|0,E|0,O|0),this.set(n,s,i,o,a,c,l,u,h,f,d,p,g,m,E,O)}roundClean(){Wn.fill(0),Jn.fill(0)}destroy(){this.buffer.fill(0),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}};const K3=w3(()=>new V3);/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const Jd=BigInt(0),zw=BigInt(1),H3=BigInt(2);function Yd(r){return r instanceof Uint8Array||ArrayBuffer.isView(r)&&r.constructor.name==="Uint8Array"}function Zd(r){if(!Yd(r))throw new Error("Uint8Array expected")}function uh(r,e){if(typeof e!="boolean")throw new Error(r+" boolean expected, got "+e)}const G3=Array.from({length:256},(r,e)=>e.toString(16).padStart(2,"0"));function Xd(r){Zd(r);let e="";for(let t=0;t<r.length;t++)e+=G3[r[t]];return e}function qw(r){if(typeof r!="string")throw new Error("hex string expected, got "+typeof r);return r===""?Jd:BigInt("0x"+r)}const fn={_0:48,_9:57,A:65,F:70,a:97,f:102};function Qg(r){if(r>=fn._0&&r<=fn._9)return r-fn._0;if(r>=fn.A&&r<=fn.F)return r-(fn.A-10);if(r>=fn.a&&r<=fn.f)return r-(fn.a-10)}function Vw(r){if(typeof r!="string")throw new Error("hex string expected, got "+typeof r);const e=r.length,t=e/2;if(e%2)throw new Error("hex string expected, got unpadded hex of length "+e);const n=new Uint8Array(t);for(let s=0,i=0;s<t;s++,i+=2){const o=Qg(r.charCodeAt(i)),a=Qg(r.charCodeAt(i+1));if(o===void 0||a===void 0){const c=r[i]+r[i+1];throw new Error('hex string expected, got non-hex character "'+c+'" at index '+i)}n[s]=o*16+a}return n}function Q3(r){return qw(Xd(r))}function vl(r){return Zd(r),qw(Xd(Uint8Array.from(r).reverse()))}function Kw(r,e){return Vw(r.toString(16).padStart(e*2,"0"))}function Kf(r,e){return Kw(r,e).reverse()}function dn(r,e,t){let n;if(typeof e=="string")try{n=Vw(e)}catch(i){throw new Error(r+" must be hex string or Uint8Array, cause: "+i)}else if(Yd(e))n=Uint8Array.from(e);else throw new Error(r+" must be hex string or Uint8Array");const s=n.length;if(typeof t=="number"&&s!==t)throw new Error(r+" of length "+t+" expected, got "+s);return n}function Wg(...r){let e=0;for(let n=0;n<r.length;n++){const s=r[n];Zd(s),e+=s.length}const t=new Uint8Array(e);for(let n=0,s=0;n<r.length;n++){const i=r[n];t.set(i,s),s+=i.length}return t}const hh=r=>typeof r=="bigint"&&Jd<=r;function W3(r,e,t){return hh(r)&&hh(e)&&hh(t)&&e<=r&&r<t}function fa(r,e,t,n){if(!W3(e,t,n))throw new Error("expected valid "+r+": "+t+" <= n < "+n+", got "+e)}function J3(r){let e;for(e=0;r>Jd;r>>=zw,e+=1);return e}const Y3=r=>(H3<<BigInt(r-1))-zw,Z3={bigint:r=>typeof r=="bigint",function:r=>typeof r=="function",boolean:r=>typeof r=="boolean",string:r=>typeof r=="string",stringOrUint8Array:r=>typeof r=="string"||Yd(r),isSafeInteger:r=>Number.isSafeInteger(r),array:r=>Array.isArray(r),field:(r,e)=>e.Fp.isValid(r),hash:r=>typeof r=="function"&&Number.isSafeInteger(r.outputLen)};function ep(r,e,t={}){const n=(s,i,o)=>{const a=Z3[i];if(typeof a!="function")throw new Error("invalid validator function");const c=r[s];if(!(o&&c===void 0)&&!a(c,r))throw new Error("param "+String(s)+" is invalid. Expected "+i+", got "+c)};for(const[s,i]of Object.entries(e))n(s,i,!1);for(const[s,i]of Object.entries(t))n(s,i,!0);return r}function Jg(r){const e=new WeakMap;return(t,...n)=>{const s=e.get(t);if(s!==void 0)return s;const i=r(t,...n);return e.set(t,i),i}}const tt=BigInt(0),Me=BigInt(1),Xs=BigInt(2),X3=BigInt(3),Hf=BigInt(4),Yg=BigInt(5),Zg=BigInt(8);function Ge(r,e){const t=r%e;return t>=tt?t:e+t}function eS(r,e,t){if(e<tt)throw new Error("invalid exponent, negatives unsupported");if(t<=tt)throw new Error("invalid modulus");if(t===Me)return tt;let n=Me;for(;e>tt;)e&Me&&(n=n*r%t),r=r*r%t,e>>=Me;return n}function Fr(r,e,t){let n=r;for(;e-- >tt;)n*=n,n%=t;return n}function Xg(r,e){if(r===tt)throw new Error("invert: expected non-zero number");if(e<=tt)throw new Error("invert: expected positive modulus, got "+e);let t=Ge(r,e),n=e,s=tt,i=Me;for(;t!==tt;){const o=n/t,a=n%t,c=s-i*o;n=t,t=a,s=i,i=c}if(n!==Me)throw new Error("invert: does not exist");return Ge(s,e)}function tS(r){const e=(r-Me)/Xs;let t,n,s;for(t=r-Me,n=0;t%Xs===tt;t/=Xs,n++);for(s=Xs;s<r&&eS(s,e,r)!==r-Me;s++)if(s>1e3)throw new Error("Cannot find square root: likely non-prime P");if(n===1){const o=(r+Me)/Hf;return function(a,c){const l=a.pow(c,o);if(!a.eql(a.sqr(l),c))throw new Error("Cannot find square root");return l}}const i=(t+Me)/Xs;return function(o,a){if(o.pow(a,e)===o.neg(o.ONE))throw new Error("Cannot find square root");let c=n,l=o.pow(o.mul(o.ONE,s),t),u=o.pow(a,i),h=o.pow(a,t);for(;!o.eql(h,o.ONE);){if(o.eql(h,o.ZERO))return o.ZERO;let f=1;for(let p=o.sqr(h);f<c&&!o.eql(p,o.ONE);f++)p=o.sqr(p);const d=o.pow(l,Me<<BigInt(c-f-1));l=o.sqr(d),u=o.mul(u,d),h=o.mul(h,l),c=f}return u}}function rS(r){if(r%Hf===X3){const e=(r+Me)/Hf;return function(t,n){const s=t.pow(n,e);if(!t.eql(t.sqr(s),n))throw new Error("Cannot find square root");return s}}if(r%Zg===Yg){const e=(r-Yg)/Zg;return function(t,n){const s=t.mul(n,Xs),i=t.pow(s,e),o=t.mul(n,i),a=t.mul(t.mul(o,Xs),i),c=t.mul(o,t.sub(a,t.ONE));if(!t.eql(t.sqr(c),n))throw new Error("Cannot find square root");return c}}return tS(r)}const nS=(r,e)=>(Ge(r,e)&Me)===Me,sS=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function iS(r){const e={ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"},t=sS.reduce((n,s)=>(n[s]="function",n),e);return ep(r,t)}function oS(r,e,t){if(t<tt)throw new Error("invalid exponent, negatives unsupported");if(t===tt)return r.ONE;if(t===Me)return e;let n=r.ONE,s=e;for(;t>tt;)t&Me&&(n=r.mul(n,s)),s=r.sqr(s),t>>=Me;return n}function aS(r,e){const t=new Array(e.length),n=e.reduce((i,o,a)=>r.is0(o)?i:(t[a]=i,r.mul(i,o)),r.ONE),s=r.inv(n);return e.reduceRight((i,o,a)=>r.is0(o)?i:(t[a]=r.mul(i,t[a]),r.mul(i,o)),s),t}function Hw(r,e){const t=e!==void 0?e:r.toString(2).length,n=Math.ceil(t/8);return{nBitLength:t,nByteLength:n}}function Gw(r,e,t=!1,n={}){if(r<=tt)throw new Error("invalid field: expected ORDER > 0, got "+r);const{nBitLength:s,nByteLength:i}=Hw(r,e);if(i>2048)throw new Error("invalid field: expected ORDER of <= 2048 bytes");let o;const a=Object.freeze({ORDER:r,isLE:t,BITS:s,BYTES:i,MASK:Y3(s),ZERO:tt,ONE:Me,create:c=>Ge(c,r),isValid:c=>{if(typeof c!="bigint")throw new Error("invalid field element: expected bigint, got "+typeof c);return tt<=c&&c<r},is0:c=>c===tt,isOdd:c=>(c&Me)===Me,neg:c=>Ge(-c,r),eql:(c,l)=>c===l,sqr:c=>Ge(c*c,r),add:(c,l)=>Ge(c+l,r),sub:(c,l)=>Ge(c-l,r),mul:(c,l)=>Ge(c*l,r),pow:(c,l)=>oS(a,c,l),div:(c,l)=>Ge(c*Xg(l,r),r),sqrN:c=>c*c,addN:(c,l)=>c+l,subN:(c,l)=>c-l,mulN:(c,l)=>c*l,inv:c=>Xg(c,r),sqrt:n.sqrt||(c=>(o||(o=rS(r)),o(a,c))),invertBatch:c=>aS(a,c),cmov:(c,l,u)=>u?l:c,toBytes:c=>t?Kf(c,i):Kw(c,i),fromBytes:c=>{if(c.length!==i)throw new Error("Field.fromBytes: expected "+i+" bytes, got "+c.length);return t?vl(c):Q3(c)}});return Object.freeze(a)}const ey=BigInt(0),Yc=BigInt(1);function fh(r,e){const t=e.negate();return r?t:e}function Qw(r,e){if(!Number.isSafeInteger(r)||r<=0||r>e)throw new Error("invalid window size, expected [1.."+e+"], got W="+r)}function dh(r,e){Qw(r,e);const t=Math.ceil(e/r)+1,n=2**(r-1);return{windows:t,windowSize:n}}function cS(r,e){if(!Array.isArray(r))throw new Error("array expected");r.forEach((t,n)=>{if(!(t instanceof e))throw new Error("invalid point at index "+n)})}function lS(r,e){if(!Array.isArray(r))throw new Error("array of scalars expected");r.forEach((t,n)=>{if(!e.isValid(t))throw new Error("invalid scalar at index "+n)})}const ph=new WeakMap,Ww=new WeakMap;function gh(r){return Ww.get(r)||1}function uS(r,e){return{constTimeNegate:fh,hasPrecomputes(t){return gh(t)!==1},unsafeLadder(t,n,s=r.ZERO){let i=t;for(;n>ey;)n&Yc&&(s=s.add(i)),i=i.double(),n>>=Yc;return s},precomputeWindow(t,n){const{windows:s,windowSize:i}=dh(n,e),o=[];let a=t,c=a;for(let l=0;l<s;l++){c=a,o.push(c);for(let u=1;u<i;u++)c=c.add(a),o.push(c);a=c.double()}return o},wNAF(t,n,s){const{windows:i,windowSize:o}=dh(t,e);let a=r.ZERO,c=r.BASE;const l=BigInt(2**t-1),u=2**t,h=BigInt(t);for(let f=0;f<i;f++){const d=f*o;let p=Number(s&l);s>>=h,p>o&&(p-=u,s+=Yc);const g=d,m=d+Math.abs(p)-1,E=f%2!==0,O=p<0;p===0?c=c.add(fh(E,n[g])):a=a.add(fh(O,n[m]))}return{p:a,f:c}},wNAFUnsafe(t,n,s,i=r.ZERO){const{windows:o,windowSize:a}=dh(t,e),c=BigInt(2**t-1),l=2**t,u=BigInt(t);for(let h=0;h<o;h++){const f=h*a;if(s===ey)break;let d=Number(s&c);if(s>>=u,d>a&&(d-=l,s+=Yc),d===0)continue;let p=n[f+Math.abs(d)-1];d<0&&(p=p.negate()),i=i.add(p)}return i},getPrecomputes(t,n,s){let i=ph.get(n);return i||(i=this.precomputeWindow(n,t),t!==1&&ph.set(n,s(i))),i},wNAFCached(t,n,s){const i=gh(t);return this.wNAF(i,this.getPrecomputes(i,t,s),n)},wNAFCachedUnsafe(t,n,s,i){const o=gh(t);return o===1?this.unsafeLadder(t,n,i):this.wNAFUnsafe(o,this.getPrecomputes(o,t,s),n,i)},setWindowSize(t,n){Qw(n,e),Ww.set(t,n),ph.delete(t)}}}function hS(r,e,t,n){if(cS(t,r),lS(n,e),t.length!==n.length)throw new Error("arrays of points and scalars must have equal length");const s=r.ZERO,i=J3(BigInt(t.length)),o=i>12?i-3:i>4?i-2:i?2:1,a=(1<<o)-1,c=new Array(a+1).fill(s),l=Math.floor((e.BITS-1)/o)*o;let u=s;for(let h=l;h>=0;h-=o){c.fill(s);for(let d=0;d<n.length;d++){const p=n[d],g=Number(p>>BigInt(h)&BigInt(a));c[g]=c[g].add(t[d])}let f=s;for(let d=c.length-1,p=s;d>0;d--)p=p.add(c[d]),f=f.add(p);if(u=u.add(f),h!==0)for(let d=0;d<o;d++)u=u.double()}return u}function fS(r){return iS(r.Fp),ep(r,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...Hw(r.n,r.nBitLength),...r,p:r.Fp.ORDER})}const xr=BigInt(0),Rt=BigInt(1),Zc=BigInt(2),dS=BigInt(8),pS={zip215:!0};function gS(r){const e=fS(r);return ep(r,{hash:"function",a:"bigint",d:"bigint",randomBytes:"function"},{adjustScalarBytes:"function",domain:"function",uvRatio:"function",mapToCurve:"function"}),Object.freeze({...e})}function yS(r){const e=gS(r),{Fp:t,n,prehash:s,hash:i,randomBytes:o,nByteLength:a,h:c}=e,l=Zc<<BigInt(a*8)-Rt,u=t.create,h=Gw(e.n,e.nBitLength),f=e.uvRatio||((I,A)=>{try{return{isValid:!0,value:t.sqrt(I*t.inv(A))}}catch{return{isValid:!1,value:xr}}}),d=e.adjustScalarBytes||(I=>I),p=e.domain||((I,A,B)=>{if(uh("phflag",B),A.length||B)throw new Error("Contexts/pre-hash are not supported");return I});function g(I,A){fa("coordinate "+I,A,xr,l)}function m(I){if(!(I instanceof x))throw new Error("ExtendedPoint expected")}const E=Jg((I,A)=>{const{ex:B,ey:U,ez:N}=I,T=I.is0();A==null&&(A=T?dS:t.inv(N));const M=u(B*A),q=u(U*A),Y=u(N*A);if(T)return{x:xr,y:Rt};if(Y!==Rt)throw new Error("invZ was invalid");return{x:M,y:q}}),O=Jg(I=>{const{a:A,d:B}=e;if(I.is0())throw new Error("bad point: ZERO");const{ex:U,ey:N,ez:T,et:M}=I,q=u(U*U),Y=u(N*N),J=u(T*T),Q=u(J*J),re=u(q*A),ne=u(J*u(re+Y)),ae=u(Q+u(B*u(q*Y)));if(ne!==ae)throw new Error("bad point: equation left != right (1)");const te=u(U*N),ue=u(T*M);if(te!==ue)throw new Error("bad point: equation left != right (2)");return!0});class x{constructor(A,B,U,N){this.ex=A,this.ey=B,this.ez=U,this.et=N,g("x",A),g("y",B),g("z",U),g("t",N),Object.freeze(this)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static fromAffine(A){if(A instanceof x)throw new Error("extended point not allowed");const{x:B,y:U}=A||{};return g("x",B),g("y",U),new x(B,U,Rt,u(B*U))}static normalizeZ(A){const B=t.invertBatch(A.map(U=>U.ez));return A.map((U,N)=>U.toAffine(B[N])).map(x.fromAffine)}static msm(A,B){return hS(x,h,A,B)}_setWindowSize(A){S.setWindowSize(this,A)}assertValidity(){O(this)}equals(A){m(A);const{ex:B,ey:U,ez:N}=this,{ex:T,ey:M,ez:q}=A,Y=u(B*q),J=u(T*N),Q=u(U*q),re=u(M*N);return Y===J&&Q===re}is0(){return this.equals(x.ZERO)}negate(){return new x(u(-this.ex),this.ey,this.ez,u(-this.et))}double(){const{a:A}=e,{ex:B,ey:U,ez:N}=this,T=u(B*B),M=u(U*U),q=u(Zc*u(N*N)),Y=u(A*T),J=B+U,Q=u(u(J*J)-T-M),re=Y+M,ne=re-q,ae=Y-M,te=u(Q*ne),ue=u(re*ae),Ae=u(Q*ae),Ne=u(ne*re);return new x(te,ue,Ne,Ae)}add(A){m(A);const{a:B,d:U}=e,{ex:N,ey:T,ez:M,et:q}=this,{ex:Y,ey:J,ez:Q,et:re}=A;if(B===BigInt(-1)){const Uc=u((T-N)*(J+Y)),sa=u((T+N)*(J-Y)),Vi=u(sa-Uc);if(Vi===xr)return this.double();const $c=u(M*Zc*re),ia=u(q*Zc*Q),oa=ia+$c,se=sa+Uc,Be=ia-$c,be=u(oa*Vi),ft=u(se*Be),Qn=u(oa*Be),Fc=u(Vi*se);return new x(be,ft,Fc,Qn)}const ne=u(N*Y),ae=u(T*J),te=u(q*U*re),ue=u(M*Q),Ae=u((N+T)*(Y+J)-ne-ae),Ne=ue-te,Ue=ue+te,Pe=u(ae-B*ne),Bt=u(Ae*Ne),$r=u(Ue*Pe),Tc=u(Ae*Pe),kc=u(Ne*Ue);return new x(Bt,$r,kc,Tc)}subtract(A){return this.add(A.negate())}wNAF(A){return S.wNAFCached(this,A,x.normalizeZ)}multiply(A){const B=A;fa("scalar",B,Rt,n);const{p:U,f:N}=this.wNAF(B);return x.normalizeZ([U,N])[0]}multiplyUnsafe(A,B=x.ZERO){const U=A;return fa("scalar",U,xr,n),U===xr?v:this.is0()||U===Rt?this:S.wNAFCachedUnsafe(this,U,x.normalizeZ,B)}isSmallOrder(){return this.multiplyUnsafe(c).is0()}isTorsionFree(){return S.unsafeLadder(this,n).is0()}toAffine(A){return E(this,A)}clearCofactor(){const{h:A}=e;return A===Rt?this:this.multiplyUnsafe(A)}static fromHex(A,B=!1){const{d:U,a:N}=e,T=t.BYTES;A=dn("pointHex",A,T),uh("zip215",B);const M=A.slice(),q=A[T-1];M[T-1]=q&-129;const Y=vl(M),J=B?l:t.ORDER;fa("pointHex.y",Y,xr,J);const Q=u(Y*Y),re=u(Q-Rt),ne=u(U*Q-N);let{isValid:ae,value:te}=f(re,ne);if(!ae)throw new Error("Point.fromHex: invalid y coordinate");const ue=(te&Rt)===Rt,Ae=(q&128)!==0;if(!B&&te===xr&&Ae)throw new Error("Point.fromHex: x=0 and x_0=1");return Ae!==ue&&(te=u(-te)),x.fromAffine({x:te,y:Y})}static fromPrivateKey(A){return _(A).point}toRawBytes(){const{x:A,y:B}=this.toAffine(),U=Kf(B,t.BYTES);return U[U.length-1]|=A&Rt?128:0,U}toHex(){return Xd(this.toRawBytes())}}x.BASE=new x(e.Gx,e.Gy,Rt,u(e.Gx*e.Gy)),x.ZERO=new x(xr,Rt,Rt,xr);const{BASE:b,ZERO:v}=x,S=uS(x,a*8);function D(I){return Ge(I,n)}function R(I){return D(vl(I))}function _(I){const A=t.BYTES;I=dn("private key",I,A);const B=dn("hashed private key",i(I),2*A),U=d(B.slice(0,A)),N=B.slice(A,2*A),T=R(U),M=b.multiply(T),q=M.toRawBytes();return{head:U,prefix:N,scalar:T,point:M,pointBytes:q}}function F(I){return _(I).pointBytes}function j(I=new Uint8Array,...A){const B=Wg(...A);return R(i(p(B,dn("context",I),!!s)))}function $(I,A,B={}){I=dn("message",I),s&&(I=s(I));const{prefix:U,scalar:N,pointBytes:T}=_(A),M=j(B.context,U,I),q=b.multiply(M).toRawBytes(),Y=j(B.context,q,T,I),J=D(M+Y*N);fa("signature.s",J,xr,n);const Q=Wg(q,Kf(J,t.BYTES));return dn("result",Q,t.BYTES*2)}const C=pS;function k(I,A,B,U=C){const{context:N,zip215:T}=U,M=t.BYTES;I=dn("signature",I,2*M),A=dn("message",A),B=dn("publicKey",B,M),T!==void 0&&uh("zip215",T),s&&(A=s(A));const q=vl(I.slice(M,2*M));let Y,J,Q;try{Y=x.fromHex(B,T),J=x.fromHex(I.slice(0,M),T),Q=b.multiplyUnsafe(q)}catch{return!1}if(!T&&Y.isSmallOrder())return!1;const re=j(N,J.toRawBytes(),Y.toRawBytes(),A);return J.add(Y.multiplyUnsafe(re)).subtract(Q).clearCofactor().equals(x.ZERO)}return b._setWindowSize(8),{CURVE:e,getPublicKey:F,sign:$,verify:k,ExtendedPoint:x,utils:{getExtendedPublicKey:_,randomPrivateKey:()=>o(t.BYTES),precompute(I=8,A=x.BASE){return A._setWindowSize(I),A.multiply(BigInt(3)),A}}}}BigInt(0),BigInt(1);const tp=BigInt("57896044618658097711785492504343953926634992332820282019728792003956564819949"),ty=BigInt("19681161376707505956807079304988542015446066515923890162744021073123829784752");BigInt(0);const mS=BigInt(1),ry=BigInt(2);BigInt(3);const wS=BigInt(5),bS=BigInt(8);function xS(r){const e=BigInt(10),t=BigInt(20),n=BigInt(40),s=BigInt(80),i=tp,o=r*r%i*r%i,a=Fr(o,ry,i)*o%i,c=Fr(a,mS,i)*r%i,l=Fr(c,wS,i)*c%i,u=Fr(l,e,i)*l%i,h=Fr(u,t,i)*u%i,f=Fr(h,n,i)*h%i,d=Fr(f,s,i)*f%i,p=Fr(d,s,i)*f%i,g=Fr(p,e,i)*l%i;return{pow_p_5_8:Fr(g,ry,i)*r%i,b2:o}}function vS(r){return r[0]&=248,r[31]&=127,r[31]|=64,r}function ES(r,e){const t=tp,n=Ge(e*e*e,t),s=Ge(n*n*e,t),i=xS(r*s).pow_p_5_8;let o=Ge(r*n*i,t);const a=Ge(e*o*o,t),c=o,l=Ge(o*ty,t),u=a===r,h=a===Ge(-r,t),f=a===Ge(-r*ty,t);return u&&(o=c),(h||f)&&(o=l),nS(o,t)&&(o=Ge(-o,t)),{isValid:u||h,value:o}}const AS=Gw(tp,void 0,!0),IS={a:BigInt(-1),d:BigInt("37095705934669439343138083508754565189542113879843219016388785533085940283555"),Fp:AS,n:BigInt("7237005577332262213973186563042994240857116359379907606001950938285454250989"),h:bS,Gx:BigInt("15112221349535400772501151409588531511454012693041857206046113283949847762202"),Gy:BigInt("46316835694926478169428394003475163141307993866256225615783033603165251855960"),hash:K3,randomBytes:jw,adjustScalarBytes:vS,uvRatio:ES},Jw=yS(IS),SS="EdDSA",OS="JWT",Ml=".",Iu="base64url",Yw="utf8",Zw="utf8",DS=":",_S="did",NS="key",ny="base58btc",CS="z",BS="K36",RS=32;function rp(r){return globalThis.Buffer!=null?new Uint8Array(r.buffer,r.byteOffset,r.byteLength):r}function Xw(r=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?rp(globalThis.Buffer.allocUnsafe(r)):new Uint8Array(r)}function eb(r,e){e||(e=r.reduce((s,i)=>s+i.length,0));const t=Xw(e);let n=0;for(const s of r)t.set(s,n),n+=s.length;return rp(t)}function PS(r,e){if(r.length>=255)throw new TypeError("Alphabet too long");for(var t=new Uint8Array(256),n=0;n<t.length;n++)t[n]=255;for(var s=0;s<r.length;s++){var i=r.charAt(s),o=i.charCodeAt(0);if(t[o]!==255)throw new TypeError(i+" is ambiguous");t[o]=s}var a=r.length,c=r.charAt(0),l=Math.log(a)/Math.log(256),u=Math.log(256)/Math.log(a);function h(p){if(p instanceof Uint8Array||(ArrayBuffer.isView(p)?p=new Uint8Array(p.buffer,p.byteOffset,p.byteLength):Array.isArray(p)&&(p=Uint8Array.from(p))),!(p instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(p.length===0)return"";for(var g=0,m=0,E=0,O=p.length;E!==O&&p[E]===0;)E++,g++;for(var x=(O-E)*u+1>>>0,b=new Uint8Array(x);E!==O;){for(var v=p[E],S=0,D=x-1;(v!==0||S<m)&&D!==-1;D--,S++)v+=256*b[D]>>>0,b[D]=v%a>>>0,v=v/a>>>0;if(v!==0)throw new Error("Non-zero carry");m=S,E++}for(var R=x-m;R!==x&&b[R]===0;)R++;for(var _=c.repeat(g);R<x;++R)_+=r.charAt(b[R]);return _}function f(p){if(typeof p!="string")throw new TypeError("Expected String");if(p.length===0)return new Uint8Array;var g=0;if(p[g]!==" "){for(var m=0,E=0;p[g]===c;)m++,g++;for(var O=(p.length-g)*l+1>>>0,x=new Uint8Array(O);p[g];){var b=t[p.charCodeAt(g)];if(b===255)return;for(var v=0,S=O-1;(b!==0||v<E)&&S!==-1;S--,v++)b+=a*x[S]>>>0,x[S]=b%256>>>0,b=b/256>>>0;if(b!==0)throw new Error("Non-zero carry");E=v,g++}if(p[g]!==" "){for(var D=O-E;D!==O&&x[D]===0;)D++;for(var R=new Uint8Array(m+(O-D)),_=m;D!==O;)R[_++]=x[D++];return R}}}function d(p){var g=f(p);if(g)return g;throw new Error(`Non-${e} character`)}return{encode:h,decodeUnsafe:f,decode:d}}var TS=PS,kS=TS;const tb=r=>{if(r instanceof Uint8Array&&r.constructor.name==="Uint8Array")return r;if(r instanceof ArrayBuffer)return new Uint8Array(r);if(ArrayBuffer.isView(r))return new Uint8Array(r.buffer,r.byteOffset,r.byteLength);throw new Error("Unknown type, must be binary type")},US=r=>new TextEncoder().encode(r),$S=r=>new TextDecoder().decode(r);let FS=class{constructor(e,t,n){this.name=e,this.prefix=t,this.baseEncode=n}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}},LS=class{constructor(e,t,n){if(this.name=e,this.prefix=t,t.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=n}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return rb(this,e)}},jS=class{constructor(e){this.decoders=e}or(e){return rb(this,e)}decode(e){const t=e[0],n=this.decoders[t];if(n)return n.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}};const rb=(r,e)=>new jS({...r.decoders||{[r.prefix]:r},...e.decoders||{[e.prefix]:e}});let MS=class{constructor(e,t,n,s){this.name=e,this.prefix=t,this.baseEncode=n,this.baseDecode=s,this.encoder=new FS(e,t,n),this.decoder=new LS(e,t,s)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}};const Su=({name:r,prefix:e,encode:t,decode:n})=>new MS(r,e,t,n),Ec=({prefix:r,name:e,alphabet:t})=>{const{encode:n,decode:s}=kS(t,e);return Su({prefix:r,name:e,encode:n,decode:i=>tb(s(i))})},zS=(r,e,t,n)=>{const s={};for(let u=0;u<e.length;++u)s[e[u]]=u;let i=r.length;for(;r[i-1]==="=";)--i;const o=new Uint8Array(i*t/8|0);let a=0,c=0,l=0;for(let u=0;u<i;++u){const h=s[r[u]];if(h===void 0)throw new SyntaxError(`Non-${n} character`);c=c<<t|h,a+=t,a>=8&&(a-=8,o[l++]=255&c>>a)}if(a>=t||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return o},qS=(r,e,t)=>{const n=e[e.length-1]==="=",s=(1<<t)-1;let i="",o=0,a=0;for(let c=0;c<r.length;++c)for(a=a<<8|r[c],o+=8;o>t;)o-=t,i+=e[s&a>>o];if(o&&(i+=e[s&a<<t-o]),n)for(;i.length*t&7;)i+="=";return i},lt=({name:r,prefix:e,bitsPerChar:t,alphabet:n})=>Su({prefix:e,name:r,encode(s){return qS(s,n,t)},decode(s){return zS(s,n,t,r)}}),VS=Su({prefix:"\0",name:"identity",encode:r=>$S(r),decode:r=>US(r)});var KS=Object.freeze({__proto__:null,identity:VS});const HS=lt({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var GS=Object.freeze({__proto__:null,base2:HS});const QS=lt({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var WS=Object.freeze({__proto__:null,base8:QS});const JS=Ec({prefix:"9",name:"base10",alphabet:"0123456789"});var YS=Object.freeze({__proto__:null,base10:JS});const ZS=lt({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),XS=lt({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var e8=Object.freeze({__proto__:null,base16:ZS,base16upper:XS});const t8=lt({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),r8=lt({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),n8=lt({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),s8=lt({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),i8=lt({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),o8=lt({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),a8=lt({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),c8=lt({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),l8=lt({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var u8=Object.freeze({__proto__:null,base32:t8,base32upper:r8,base32pad:n8,base32padupper:s8,base32hex:i8,base32hexupper:o8,base32hexpad:a8,base32hexpadupper:c8,base32z:l8});const h8=Ec({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),f8=Ec({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var d8=Object.freeze({__proto__:null,base36:h8,base36upper:f8});const p8=Ec({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),g8=Ec({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var y8=Object.freeze({__proto__:null,base58btc:p8,base58flickr:g8});const m8=lt({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),w8=lt({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),b8=lt({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),x8=lt({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var v8=Object.freeze({__proto__:null,base64:m8,base64pad:w8,base64url:b8,base64urlpad:x8});const nb=Array.from(""),E8=nb.reduce((r,e,t)=>(r[t]=e,r),[]),A8=nb.reduce((r,e,t)=>(r[e.codePointAt(0)]=t,r),[]);function I8(r){return r.reduce((e,t)=>(e+=E8[t],e),"")}function S8(r){const e=[];for(const t of r){const n=A8[t.codePointAt(0)];if(n===void 0)throw new Error(`Non-base256emoji character: ${t}`);e.push(n)}return new Uint8Array(e)}const O8=Su({prefix:"",name:"base256emoji",encode:I8,decode:S8});var D8=Object.freeze({__proto__:null,base256emoji:O8}),_8=sb,sy=128,N8=-128,C8=Math.pow(2,31);function sb(r,e,t){e=e||[],t=t||0;for(var n=t;r>=C8;)e[t++]=r&255|sy,r/=128;for(;r&N8;)e[t++]=r&255|sy,r>>>=7;return e[t]=r|0,sb.bytes=t-n+1,e}var B8=Gf,R8=128,iy=127;function Gf(r,n){var t=0,n=n||0,s=0,i=n,o,a=r.length;do{if(i>=a)throw Gf.bytes=0,new RangeError("Could not decode varint");o=r[i++],t+=s<28?(o&iy)<<s:(o&iy)*Math.pow(2,s),s+=7}while(o>=R8);return Gf.bytes=i-n,t}var P8=Math.pow(2,7),T8=Math.pow(2,14),k8=Math.pow(2,21),U8=Math.pow(2,28),$8=Math.pow(2,35),F8=Math.pow(2,42),L8=Math.pow(2,49),j8=Math.pow(2,56),M8=Math.pow(2,63),z8=function(r){return r<P8?1:r<T8?2:r<k8?3:r<U8?4:r<$8?5:r<F8?6:r<L8?7:r<j8?8:r<M8?9:10},q8={encode:_8,decode:B8,encodingLength:z8},ib=q8;const oy=(r,e,t=0)=>(ib.encode(r,e,t),e),ay=r=>ib.encodingLength(r),Qf=(r,e)=>{const t=e.byteLength,n=ay(r),s=n+ay(t),i=new Uint8Array(s+t);return oy(r,i,0),oy(t,i,n),i.set(e,s),new V8(r,t,e,i)};let V8=class{constructor(e,t,n,s){this.code=e,this.size=t,this.digest=n,this.bytes=s}};const ob=({name:r,code:e,encode:t})=>new K8(r,e,t);let K8=class{constructor(e,t,n){this.name=e,this.code=t,this.encode=n}digest(e){if(e instanceof Uint8Array){const t=this.encode(e);return t instanceof Uint8Array?Qf(this.code,t):t.then(n=>Qf(this.code,n))}else throw Error("Unknown type, must be binary type")}};const ab=r=>async e=>new Uint8Array(await crypto.subtle.digest(r,e)),H8=ob({name:"sha2-256",code:18,encode:ab("SHA-256")}),G8=ob({name:"sha2-512",code:19,encode:ab("SHA-512")});var Q8=Object.freeze({__proto__:null,sha256:H8,sha512:G8});const cb=0,W8="identity",lb=tb,J8=r=>Qf(cb,lb(r)),Y8={code:cb,name:W8,encode:lb,digest:J8};var Z8=Object.freeze({__proto__:null,identity:Y8});new TextEncoder,new TextDecoder;const cy={...KS,...GS,...WS,...YS,...e8,...u8,...d8,...y8,...v8,...D8};({...Q8,...Z8});function ub(r,e,t,n){return{name:r,prefix:e,encoder:{name:r,prefix:e,encode:t},decoder:{decode:n}}}const ly=ub("utf8","u",r=>"u"+new TextDecoder("utf8").decode(r),r=>new TextEncoder().encode(r.substring(1))),yh=ub("ascii","a",r=>{let e="a";for(let t=0;t<r.length;t++)e+=String.fromCharCode(r[t]);return e},r=>{r=r.substring(1);const e=Xw(r.length);for(let t=0;t<r.length;t++)e[t]=r.charCodeAt(t);return e}),hb={utf8:ly,"utf-8":ly,hex:cy.base16,latin1:yh,ascii:yh,binary:yh,...cy};function Ou(r,e="utf8"){const t=hb[e];if(!t)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(r.buffer,r.byteOffset,r.byteLength).toString("utf8"):t.encoder.encode(r).substring(1)}function ta(r,e="utf8"){const t=hb[e];if(!t)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?rp(globalThis.Buffer.from(r,"utf-8")):t.decoder.decode(`${t.prefix}${r}`)}function uy(r){return Wo(Ou(ta(r,Iu),Yw))}function zl(r){return Ou(ta(vc(r),Yw),Iu)}function fb(r){const e=ta(BS,ny),t=CS+Ou(eb([e,r]),ny);return[_S,NS,t].join(DS)}function X8(r){return Ou(r,Iu)}function eO(r){return ta(r,Iu)}function tO(r){return ta([zl(r.header),zl(r.payload)].join(Ml),Zw)}function rO(r){return[zl(r.header),zl(r.payload),X8(r.signature)].join(Ml)}function Wf(r){const e=r.split(Ml),t=uy(e[0]),n=uy(e[1]),s=eO(e[2]),i=ta(e.slice(0,2).join(Ml),Zw);return{header:t,payload:n,signature:s,data:i}}function hy(r=jw(RS)){const e=Jw.getPublicKey(r);return{secretKey:eb([r,e]),publicKey:e}}async function nO(r,e,t,n,s=G.fromMiliseconds(Date.now())){const i={alg:SS,typ:OS},o=fb(n.publicKey),a=s+t,c={iss:o,sub:r,aud:e,iat:s,exp:a},l=tO({header:i,payload:c}),u=Jw.sign(l,n.secretKey.slice(0,32));return rO({header:i,payload:c,signature:u})}var fy=function(r,e,t){if(t||arguments.length===2)for(var n=0,s=e.length,i;n<s;n++)(i||!(n in e))&&(i||(i=Array.prototype.slice.call(e,0,n)),i[n]=e[n]);return r.concat(i||Array.prototype.slice.call(e))},sO=(function(){function r(e,t,n){this.name=e,this.version=t,this.os=n,this.type="browser"}return r})(),iO=(function(){function r(e){this.version=e,this.type="node",this.name="node",this.os=process.platform}return r})(),oO=(function(){function r(e,t,n,s){this.name=e,this.version=t,this.os=n,this.bot=s,this.type="bot-device"}return r})(),aO=(function(){function r(){this.type="bot",this.bot=!0,this.name="bot",this.version=null,this.os=null}return r})(),cO=(function(){function r(){this.type="react-native",this.name="react-native",this.version=null,this.os=null}return r})(),lO=/alexa|bot|crawl(er|ing)|facebookexternalhit|feedburner|google web preview|nagios|postrank|pingdom|slurp|spider|yahoo!|yandex/,uO=/(nuhk|curl|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask\ Jeeves\/Teoma|ia_archiver)/,dy=3,hO=[["aol",/AOLShield\/([0-9\._]+)/],["edge",/Edge\/([0-9\._]+)/],["edge-ios",/EdgiOS\/([0-9\._]+)/],["yandexbrowser",/YaBrowser\/([0-9\._]+)/],["kakaotalk",/KAKAOTALK\s([0-9\.]+)/],["samsung",/SamsungBrowser\/([0-9\.]+)/],["silk",/\bSilk\/([0-9._-]+)\b/],["miui",/MiuiBrowser\/([0-9\.]+)$/],["beaker",/BeakerBrowser\/([0-9\.]+)/],["edge-chromium",/EdgA?\/([0-9\.]+)/],["chromium-webview",/(?!Chrom.*OPR)wv\).*Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["chrome",/(?!Chrom.*OPR)Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["phantomjs",/PhantomJS\/([0-9\.]+)(:?\s|$)/],["crios",/CriOS\/([0-9\.]+)(:?\s|$)/],["firefox",/Firefox\/([0-9\.]+)(?:\s|$)/],["fxios",/FxiOS\/([0-9\.]+)/],["opera-mini",/Opera Mini.*Version\/([0-9\.]+)/],["opera",/Opera\/([0-9\.]+)(?:\s|$)/],["opera",/OPR\/([0-9\.]+)(:?\s|$)/],["pie",/^Microsoft Pocket Internet Explorer\/(\d+\.\d+)$/],["pie",/^Mozilla\/\d\.\d+\s\(compatible;\s(?:MSP?IE|MSInternet Explorer) (\d+\.\d+);.*Windows CE.*\)$/],["netfront",/^Mozilla\/\d\.\d+.*NetFront\/(\d.\d)/],["ie",/Trident\/7\.0.*rv\:([0-9\.]+).*\).*Gecko$/],["ie",/MSIE\s([0-9\.]+);.*Trident\/[4-7].0/],["ie",/MSIE\s(7\.0)/],["bb10",/BB10;\sTouch.*Version\/([0-9\.]+)/],["android",/Android\s([0-9\.]+)/],["ios",/Version\/([0-9\._]+).*Mobile.*Safari.*/],["safari",/Version\/([0-9\._]+).*Safari/],["facebook",/FB[AS]V\/([0-9\.]+)/],["instagram",/Instagram\s([0-9\.]+)/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Mobile/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Gecko\)$/],["curl",/^curl\/([0-9\.]+)$/],["searchbot",lO]],py=[["iOS",/iP(hone|od|ad)/],["Android OS",/Android/],["BlackBerry OS",/BlackBerry|BB10/],["Windows Mobile",/IEMobile/],["Amazon OS",/Kindle/],["Windows 3.11",/Win16/],["Windows 95",/(Windows 95)|(Win95)|(Windows_95)/],["Windows 98",/(Windows 98)|(Win98)/],["Windows 2000",/(Windows NT 5.0)|(Windows 2000)/],["Windows XP",/(Windows NT 5.1)|(Windows XP)/],["Windows Server 2003",/(Windows NT 5.2)/],["Windows Vista",/(Windows NT 6.0)/],["Windows 7",/(Windows NT 6.1)/],["Windows 8",/(Windows NT 6.2)/],["Windows 8.1",/(Windows NT 6.3)/],["Windows 10",/(Windows NT 10.0)/],["Windows ME",/Windows ME/],["Windows CE",/Windows CE|WinCE|Microsoft Pocket Internet Explorer/],["Open BSD",/OpenBSD/],["Sun OS",/SunOS/],["Chrome OS",/CrOS/],["Linux",/(Linux)|(X11)/],["Mac OS",/(Mac_PowerPC)|(Macintosh)/],["QNX",/QNX/],["BeOS",/BeOS/],["OS/2",/OS\/2/]];function fO(r){return typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"?new cO:typeof navigator<"u"?pO(navigator.userAgent):yO()}function dO(r){return r!==""&&hO.reduce(function(e,t){var n=t[0],s=t[1];if(e)return e;var i=s.exec(r);return!!i&&[n,i]},!1)}function pO(r){var e=dO(r);if(!e)return null;var t=e[0],n=e[1];if(t==="searchbot")return new aO;var s=n[1]&&n[1].split(".").join("_").split("_").slice(0,3);s?s.length<dy&&(s=fy(fy([],s,!0),mO(dy-s.length),!0)):s=[];var i=s.join("."),o=gO(r),a=uO.exec(r);return a&&a[1]?new oO(t,i,o,a[1]):new sO(t,i,o)}function gO(r){for(var e=0,t=py.length;e<t;e++){var n=py[e],s=n[0],i=n[1],o=i.exec(r);if(o)return s}return null}function yO(){var r=typeof process<"u"&&process.version;return r?new iO(process.version.slice(1)):null}function mO(r){for(var e=[],t=0;t<r;t++)e.push("0");return e}var Se={},gy;function db(){if(gy)return Se;gy=1,Object.defineProperty(Se,"__esModule",{value:!0}),Se.getLocalStorage=Se.getLocalStorageOrThrow=Se.getCrypto=Se.getCryptoOrThrow=Se.getLocation=Se.getLocationOrThrow=Se.getNavigator=Se.getNavigatorOrThrow=Se.getDocument=Se.getDocumentOrThrow=Se.getFromWindowOrThrow=Se.getFromWindow=void 0;function r(f){let d;return typeof window<"u"&&typeof window[f]<"u"&&(d=window[f]),d}Se.getFromWindow=r;function e(f){const d=r(f);if(!d)throw new Error(`${f} is not defined in Window`);return d}Se.getFromWindowOrThrow=e;function t(){return e("document")}Se.getDocumentOrThrow=t;function n(){return r("document")}Se.getDocument=n;function s(){return e("navigator")}Se.getNavigatorOrThrow=s;function i(){return r("navigator")}Se.getNavigator=i;function o(){return e("location")}Se.getLocationOrThrow=o;function a(){return r("location")}Se.getLocation=a;function c(){return e("crypto")}Se.getCryptoOrThrow=c;function l(){return r("crypto")}Se.getCrypto=l;function u(){return e("localStorage")}Se.getLocalStorageOrThrow=u;function h(){return r("localStorage")}return Se.getLocalStorage=h,Se}var Kn=db(),da={},yy;function wO(){if(yy)return da;yy=1,Object.defineProperty(da,"__esModule",{value:!0}),da.getWindowMetadata=void 0;const r=db();function e(){let t,n;try{t=r.getDocumentOrThrow(),n=r.getLocationOrThrow()}catch{return null}function s(){const d=t.getElementsByTagName("link"),p=[];for(let g=0;g<d.length;g++){const m=d[g],E=m.getAttribute("rel");if(E&&E.toLowerCase().indexOf("icon")>-1){const O=m.getAttribute("href");if(O)if(O.toLowerCase().indexOf("https:")===-1&&O.toLowerCase().indexOf("http:")===-1&&O.indexOf("//")!==0){let x=n.protocol+"//"+n.host;if(O.indexOf("/")===0)x+=O;else{const b=n.pathname.split("/");b.pop();const v=b.join("/");x+=v+"/"+O}p.push(x)}else if(O.indexOf("//")===0){const x=n.protocol+O;p.push(x)}else p.push(O)}}return p}function i(...d){const p=t.getElementsByTagName("meta");for(let g=0;g<p.length;g++){const m=p[g],E=["itemprop","property","name"].map(O=>m.getAttribute(O)).filter(O=>O?d.includes(O):!1);if(E.length&&E){const O=m.getAttribute("content");if(O)return O}}return""}function o(){let d=i("name","og:site_name","og:title","twitter:title");return d||(d=t.title),d}function a(){return i("description","og:description","twitter:description","keywords")}const c=o(),l=a(),u=n.origin,h=s();return{description:l,url:u,icons:h,name:c}}return da.getWindowMetadata=e,da}var bO=wO();const xO="0.1.1";function vO(){return xO}class Re extends Error{constructor(e,t={}){const n=(()=>{var c;if(t.cause instanceof Re){if(t.cause.details)return t.cause.details;if(t.cause.shortMessage)return t.cause.shortMessage}return t.cause&&"details"in t.cause&&typeof t.cause.details=="string"?t.cause.details:(c=t.cause)!=null&&c.message?t.cause.message:t.details})(),s=t.cause instanceof Re&&t.cause.docsPath||t.docsPath,o=`https://oxlib.sh${s??""}`,a=[e||"An error occurred.",...t.metaMessages?["",...t.metaMessages]:[],...n||s?["",n?`Details: ${n}`:void 0,s?`See: ${o}`:void 0]:[]].filter(c=>typeof c=="string").join(`
`);super(a,t.cause?{cause:t.cause}:void 0),Object.defineProperty(this,"details",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"docs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"docsPath",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"shortMessage",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"cause",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"BaseError"}),Object.defineProperty(this,"version",{enumerable:!0,configurable:!0,writable:!0,value:`ox@${vO()}`}),this.cause=t.cause,this.details=n,this.docs=o,this.docsPath=s,this.shortMessage=e}walk(e){return pb(this,e)}}function pb(r,e){return e!=null&&e(r)?r:r&&typeof r=="object"&&"cause"in r&&r.cause?pb(r.cause,e):e?null:r}const Ji=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */function EO(r){return r instanceof Uint8Array||ArrayBuffer.isView(r)&&r.constructor.name==="Uint8Array"}function ec(r){if(!Number.isSafeInteger(r)||r<0)throw new Error("positive integer expected, got "+r)}function ki(r,...e){if(!EO(r))throw new Error("Uint8Array expected");if(e.length>0&&!e.includes(r.length))throw new Error("Uint8Array expected of length "+e+", got length="+r.length)}function AO(r){if(typeof r!="function"||typeof r.create!="function")throw new Error("Hash should be wrapped by utils.createHasher");ec(r.outputLen),ec(r.blockLen)}function Jo(r,e=!0){if(r.destroyed)throw new Error("Hash instance has been destroyed");if(e&&r.finished)throw new Error("Hash#digest() has already been called")}function gb(r,e){ki(r);const t=e.outputLen;if(r.length<t)throw new Error("digestInto() expects output buffer of length at least "+t)}function IO(r){return new Uint32Array(r.buffer,r.byteOffset,Math.floor(r.byteLength/4))}function Yo(...r){for(let e=0;e<r.length;e++)r[e].fill(0)}function mh(r){return new DataView(r.buffer,r.byteOffset,r.byteLength)}function Lr(r,e){return r<<32-e|r>>>e}const SO=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;function OO(r){return r<<24&4278190080|r<<8&16711680|r>>>8&65280|r>>>24&255}function DO(r){for(let e=0;e<r.length;e++)r[e]=OO(r[e]);return r}const my=SO?r=>r:DO;function _O(r){if(typeof r!="string")throw new Error("string expected");return new Uint8Array(new TextEncoder().encode(r))}function Du(r){return typeof r=="string"&&(r=_O(r)),ki(r),r}function NO(...r){let e=0;for(let n=0;n<r.length;n++){const s=r[n];ki(s),e+=s.length}const t=new Uint8Array(e);for(let n=0,s=0;n<r.length;n++){const i=r[n];t.set(i,s),s+=i.length}return t}class np{}function yb(r){const e=n=>r().update(Du(n)).digest(),t=r();return e.outputLen=t.outputLen,e.blockLen=t.blockLen,e.create=()=>r(),e}function CO(r=32){if(Ji&&typeof Ji.getRandomValues=="function")return Ji.getRandomValues(new Uint8Array(r));if(Ji&&typeof Ji.randomBytes=="function")return Uint8Array.from(Ji.randomBytes(r));throw new Error("crypto.getRandomValues must be defined")}function BO(r,e,t,n){if(typeof r.setBigUint64=="function")return r.setBigUint64(e,t,n);const s=BigInt(32),i=BigInt(4294967295),o=Number(t>>s&i),a=Number(t&i),c=n?4:0,l=n?0:4;r.setUint32(e+c,o,n),r.setUint32(e+l,a,n)}function RO(r,e,t){return r&e^~r&t}function PO(r,e,t){return r&e^r&t^e&t}class TO extends np{constructor(e,t,n,s){super(),this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.blockLen=e,this.outputLen=t,this.padOffset=n,this.isLE=s,this.buffer=new Uint8Array(e),this.view=mh(this.buffer)}update(e){Jo(this),e=Du(e),ki(e);const{view:t,buffer:n,blockLen:s}=this,i=e.length;for(let o=0;o<i;){const a=Math.min(s-this.pos,i-o);if(a===s){const c=mh(e);for(;s<=i-o;o+=s)this.process(c,o);continue}n.set(e.subarray(o,o+a),this.pos),this.pos+=a,o+=a,this.pos===s&&(this.process(t,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){Jo(this),gb(e,this),this.finished=!0;const{buffer:t,view:n,blockLen:s,isLE:i}=this;let{pos:o}=this;t[o++]=128,Yo(this.buffer.subarray(o)),this.padOffset>s-o&&(this.process(n,0),o=0);for(let h=o;h<s;h++)t[h]=0;BO(n,s-8,BigInt(this.length*8),i),this.process(n,0);const a=mh(e),c=this.outputLen;if(c%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const l=c/4,u=this.get();if(l>u.length)throw new Error("_sha2: outputLen bigger than state");for(let h=0;h<l;h++)a.setUint32(4*h,u[h],i)}digest(){const{buffer:e,outputLen:t}=this;this.digestInto(e);const n=e.slice(0,t);return this.destroy(),n}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());const{blockLen:t,buffer:n,length:s,finished:i,destroyed:o,pos:a}=this;return e.destroyed=o,e.finished=i,e.length=s,e.pos=a,s%t&&e.buffer.set(n),e}clone(){return this._cloneInto()}}const Yn=Uint32Array.from([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),Xc=BigInt(2**32-1),wy=BigInt(32);function kO(r,e=!1){return e?{h:Number(r&Xc),l:Number(r>>wy&Xc)}:{h:Number(r>>wy&Xc)|0,l:Number(r&Xc)|0}}function UO(r,e=!1){const t=r.length;let n=new Uint32Array(t),s=new Uint32Array(t);for(let i=0;i<t;i++){const{h:o,l:a}=kO(r[i],e);[n[i],s[i]]=[o,a]}return[n,s]}const $O=(r,e,t)=>r<<t|e>>>32-t,FO=(r,e,t)=>e<<t|r>>>32-t,LO=(r,e,t)=>e<<t-32|r>>>64-t,jO=(r,e,t)=>r<<t-32|e>>>64-t,MO=BigInt(0),pa=BigInt(1),zO=BigInt(2),qO=BigInt(7),VO=BigInt(256),KO=BigInt(113),mb=[],wb=[],bb=[];for(let r=0,e=pa,t=1,n=0;r<24;r++){[t,n]=[n,(2*t+3*n)%5],mb.push(2*(5*n+t)),wb.push((r+1)*(r+2)/2%64);let s=MO;for(let i=0;i<7;i++)e=(e<<pa^(e>>qO)*KO)%VO,e&zO&&(s^=pa<<(pa<<BigInt(i))-pa);bb.push(s)}const xb=UO(bb,!0),HO=xb[0],GO=xb[1],by=(r,e,t)=>t>32?LO(r,e,t):$O(r,e,t),xy=(r,e,t)=>t>32?jO(r,e,t):FO(r,e,t);function QO(r,e=24){const t=new Uint32Array(10);for(let n=24-e;n<24;n++){for(let o=0;o<10;o++)t[o]=r[o]^r[o+10]^r[o+20]^r[o+30]^r[o+40];for(let o=0;o<10;o+=2){const a=(o+8)%10,c=(o+2)%10,l=t[c],u=t[c+1],h=by(l,u,1)^t[a],f=xy(l,u,1)^t[a+1];for(let d=0;d<50;d+=10)r[o+d]^=h,r[o+d+1]^=f}let s=r[2],i=r[3];for(let o=0;o<24;o++){const a=wb[o],c=by(s,i,a),l=xy(s,i,a),u=mb[o];s=r[u],i=r[u+1],r[u]=c,r[u+1]=l}for(let o=0;o<50;o+=10){for(let a=0;a<10;a++)t[a]=r[o+a];for(let a=0;a<10;a++)r[o+a]^=~t[(a+2)%10]&t[(a+4)%10]}r[0]^=HO[n],r[1]^=GO[n]}Yo(t)}class sp extends np{constructor(e,t,n,s=!1,i=24){if(super(),this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,this.enableXOF=!1,this.blockLen=e,this.suffix=t,this.outputLen=n,this.enableXOF=s,this.rounds=i,ec(n),!(0<e&&e<200))throw new Error("only keccak-f1600 function is supported");this.state=new Uint8Array(200),this.state32=IO(this.state)}clone(){return this._cloneInto()}keccak(){my(this.state32),QO(this.state32,this.rounds),my(this.state32),this.posOut=0,this.pos=0}update(e){Jo(this),e=Du(e),ki(e);const{blockLen:t,state:n}=this,s=e.length;for(let i=0;i<s;){const o=Math.min(t-this.pos,s-i);for(let a=0;a<o;a++)n[this.pos++]^=e[i++];this.pos===t&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;const{state:e,suffix:t,pos:n,blockLen:s}=this;e[n]^=t,(t&128)!==0&&n===s-1&&this.keccak(),e[s-1]^=128,this.keccak()}writeInto(e){Jo(this,!1),ki(e),this.finish();const t=this.state,{blockLen:n}=this;for(let s=0,i=e.length;s<i;){this.posOut>=n&&this.keccak();const o=Math.min(n-this.posOut,i-s);e.set(t.subarray(this.posOut,this.posOut+o),s),this.posOut+=o,s+=o}return e}xofInto(e){if(!this.enableXOF)throw new Error("XOF is not possible for this instance");return this.writeInto(e)}xof(e){return ec(e),this.xofInto(new Uint8Array(e))}digestInto(e){if(gb(e,this),this.finished)throw new Error("digest() was already called");return this.writeInto(e),this.destroy(),e}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,Yo(this.state)}_cloneInto(e){const{blockLen:t,suffix:n,outputLen:s,rounds:i,enableXOF:o}=this;return e||(e=new sp(t,n,s,o,i)),e.state32.set(this.state32),e.pos=this.pos,e.posOut=this.posOut,e.finished=this.finished,e.rounds=i,e.suffix=n,e.outputLen=s,e.enableXOF=o,e.destroyed=this.destroyed,e}}const WO=(r,e,t)=>yb(()=>new sp(e,r,t)),JO=WO(1,136,256/8),YO=Uint32Array.from([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),Zn=new Uint32Array(64);class ZO extends TO{constructor(e=32){super(64,e,8,!1),this.A=Yn[0]|0,this.B=Yn[1]|0,this.C=Yn[2]|0,this.D=Yn[3]|0,this.E=Yn[4]|0,this.F=Yn[5]|0,this.G=Yn[6]|0,this.H=Yn[7]|0}get(){const{A:e,B:t,C:n,D:s,E:i,F:o,G:a,H:c}=this;return[e,t,n,s,i,o,a,c]}set(e,t,n,s,i,o,a,c){this.A=e|0,this.B=t|0,this.C=n|0,this.D=s|0,this.E=i|0,this.F=o|0,this.G=a|0,this.H=c|0}process(e,t){for(let h=0;h<16;h++,t+=4)Zn[h]=e.getUint32(t,!1);for(let h=16;h<64;h++){const f=Zn[h-15],d=Zn[h-2],p=Lr(f,7)^Lr(f,18)^f>>>3,g=Lr(d,17)^Lr(d,19)^d>>>10;Zn[h]=g+Zn[h-7]+p+Zn[h-16]|0}let{A:n,B:s,C:i,D:o,E:a,F:c,G:l,H:u}=this;for(let h=0;h<64;h++){const f=Lr(a,6)^Lr(a,11)^Lr(a,25),d=u+f+RO(a,c,l)+YO[h]+Zn[h]|0,g=(Lr(n,2)^Lr(n,13)^Lr(n,22))+PO(n,s,i)|0;u=l,l=c,c=a,a=o+d|0,o=i,i=s,s=n,n=d+g|0}n=n+this.A|0,s=s+this.B|0,i=i+this.C|0,o=o+this.D|0,a=a+this.E|0,c=c+this.F|0,l=l+this.G|0,u=u+this.H|0,this.set(n,s,i,o,a,c,l,u)}roundClean(){Yo(Zn)}destroy(){this.set(0,0,0,0,0,0,0,0),Yo(this.buffer)}}const XO=yb(()=>new ZO);/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const ip=BigInt(0),Jf=BigInt(1);function Ac(r){return r instanceof Uint8Array||ArrayBuffer.isView(r)&&r.constructor.name==="Uint8Array"}function op(r){if(!Ac(r))throw new Error("Uint8Array expected")}function tc(r,e){if(typeof e!="boolean")throw new Error(r+" boolean expected, got "+e)}function el(r){const e=r.toString(16);return e.length&1?"0"+e:e}function vb(r){if(typeof r!="string")throw new Error("hex string expected, got "+typeof r);return r===""?ip:BigInt("0x"+r)}const Eb=typeof Uint8Array.from([]).toHex=="function"&&typeof Uint8Array.fromHex=="function",eD=Array.from({length:256},(r,e)=>e.toString(16).padStart(2,"0"));function rc(r){if(op(r),Eb)return r.toHex();let e="";for(let t=0;t<r.length;t++)e+=eD[r[t]];return e}const pn={_0:48,_9:57,A:65,F:70,a:97,f:102};function vy(r){if(r>=pn._0&&r<=pn._9)return r-pn._0;if(r>=pn.A&&r<=pn.F)return r-(pn.A-10);if(r>=pn.a&&r<=pn.f)return r-(pn.a-10)}function ql(r){if(typeof r!="string")throw new Error("hex string expected, got "+typeof r);if(Eb)return Uint8Array.fromHex(r);const e=r.length,t=e/2;if(e%2)throw new Error("hex string expected, got unpadded hex of length "+e);const n=new Uint8Array(t);for(let s=0,i=0;s<t;s++,i+=2){const o=vy(r.charCodeAt(i)),a=vy(r.charCodeAt(i+1));if(o===void 0||a===void 0){const c=r[i]+r[i+1];throw new Error('hex string expected, got non-hex character "'+c+'" at index '+i)}n[s]=o*16+a}return n}function Ni(r){return vb(rc(r))}function Ab(r){return op(r),vb(rc(Uint8Array.from(r).reverse()))}function Ic(r,e){return ql(r.toString(16).padStart(e*2,"0"))}function Ib(r,e){return Ic(r,e).reverse()}function hr(r,e,t){let n;if(typeof e=="string")try{n=ql(e)}catch(i){throw new Error(r+" must be hex string or Uint8Array, cause: "+i)}else if(Ac(e))n=Uint8Array.from(e);else throw new Error(r+" must be hex string or Uint8Array");const s=n.length;if(typeof t=="number"&&s!==t)throw new Error(r+" of length "+t+" expected, got "+s);return n}function Vl(...r){let e=0;for(let n=0;n<r.length;n++){const s=r[n];op(s),e+=s.length}const t=new Uint8Array(e);for(let n=0,s=0;n<r.length;n++){const i=r[n];t.set(i,s),s+=i.length}return t}const wh=r=>typeof r=="bigint"&&ip<=r;function ap(r,e,t){return wh(r)&&wh(e)&&wh(t)&&e<=r&&r<t}function mo(r,e,t,n){if(!ap(e,t,n))throw new Error("expected valid "+r+": "+t+" <= n < "+n+", got "+e)}function tD(r){let e;for(e=0;r>ip;r>>=Jf,e+=1);return e}const _u=r=>(Jf<<BigInt(r))-Jf,bh=r=>new Uint8Array(r),Ey=r=>Uint8Array.from(r);function rD(r,e,t){if(typeof r!="number"||r<2)throw new Error("hashLen must be a number");if(typeof e!="number"||e<2)throw new Error("qByteLen must be a number");if(typeof t!="function")throw new Error("hmacFn must be a function");let n=bh(r),s=bh(r),i=0;const o=()=>{n.fill(1),s.fill(0),i=0},a=(...h)=>t(s,n,...h),c=(h=bh(0))=>{s=a(Ey([0]),h),n=a(),h.length!==0&&(s=a(Ey([1]),h),n=a())},l=()=>{if(i++>=1e3)throw new Error("drbg: tried 1000 values");let h=0;const f=[];for(;h<e;){n=a();const d=n.slice();f.push(d),h+=n.length}return Vl(...f)};return(h,f)=>{o(),c(h);let d;for(;!(d=f(l()));)c();return o(),d}}const nD={bigint:r=>typeof r=="bigint",function:r=>typeof r=="function",boolean:r=>typeof r=="boolean",string:r=>typeof r=="string",stringOrUint8Array:r=>typeof r=="string"||Ac(r),isSafeInteger:r=>Number.isSafeInteger(r),array:r=>Array.isArray(r),field:(r,e)=>e.Fp.isValid(r),hash:r=>typeof r=="function"&&Number.isSafeInteger(r.outputLen)};function Nu(r,e,t={}){const n=(s,i,o)=>{const a=nD[i];if(typeof a!="function")throw new Error("invalid validator function");const c=r[s];if(!(o&&c===void 0)&&!a(c,r))throw new Error("param "+String(s)+" is invalid. Expected "+i+", got "+c)};for(const[s,i]of Object.entries(e))n(s,i,!1);for(const[s,i]of Object.entries(t))n(s,i,!0);return r}function Ay(r){const e=new WeakMap;return(t,...n)=>{const s=e.get(t);if(s!==void 0)return s;const i=r(t,...n);return e.set(t,i),i}}function sD(r,e){if(Dy(r)>e)throw new SD({givenSize:Dy(r),maxSize:e})}const gn={zero:48,nine:57,A:65,F:70,a:97,f:102};function Iy(r){if(r>=gn.zero&&r<=gn.nine)return r-gn.zero;if(r>=gn.A&&r<=gn.F)return r-(gn.A-10);if(r>=gn.a&&r<=gn.f)return r-(gn.a-10)}function iD(r,e={}){const{dir:t,size:n=32}=e;if(n===0)return r;if(r.length>n)throw new OD({size:r.length,targetSize:n,type:"Bytes"});const s=new Uint8Array(n);for(let i=0;i<n;i++){const o=t==="right";s[o?i:n-i-1]=r[o?i:r.length-i-1]}return s}function Sb(r,e){if(Us(r)>e)throw new gD({givenSize:Us(r),maxSize:e})}function oD(r,e){if(typeof e=="number"&&e>0&&e>Us(r)-1)throw new _b({offset:e,position:"start",size:Us(r)})}function aD(r,e,t){if(typeof e=="number"&&typeof t=="number"&&Us(r)!==t-e)throw new _b({offset:t,position:"end",size:Us(r)})}function Ob(r,e={}){const{dir:t,size:n=32}=e;if(n===0)return r;const s=r.replace("0x","");if(s.length>n*2)throw new yD({size:Math.ceil(s.length/2),targetSize:n,type:"Hex"});return`0x${s[t==="right"?"padEnd":"padStart"](n*2,"0")}`}const cD="#__bigint";function cp(r,e,t){return JSON.stringify(r,(n,s)=>typeof s=="bigint"?s.toString()+cD:s,t)}const lD=Array.from({length:256},(r,e)=>e.toString(16).padStart(2,"0"));function uD(r,e={}){const{strict:t=!1}=e;if(!r)throw new Sy(r);if(typeof r!="string")throw new Sy(r);if(t&&!/^0x[0-9a-fA-F]*$/.test(r))throw new Oy(r);if(!r.startsWith("0x"))throw new Oy(r)}function hD(...r){return`0x${r.reduce((e,t)=>e+t.replace("0x",""),"")}`}function lp(r){return r instanceof Uint8Array?Kl(r):Array.isArray(r)?Kl(new Uint8Array(r)):r}function Kl(r,e={}){let t="";for(let s=0;s<r.length;s++)t+=lD[r[s]];const n=`0x${t}`;return typeof e.size=="number"?(Sb(n,e.size),Db(n,e.size)):n}function xh(r,e={}){const{signed:t,size:n}=e,s=BigInt(r);let i;n?t?i=(1n<<BigInt(n)*8n-1n)-1n:i=2n**(BigInt(n)*8n)-1n:typeof r=="number"&&(i=BigInt(Number.MAX_SAFE_INTEGER));const o=typeof i=="bigint"&&t?-i-1n:0;if(i&&s>i||s<o){const l=typeof r=="bigint"?"n":"";throw new pD({max:i?`${i}${l}`:void 0,min:`${o}${l}`,signed:t,size:n,value:`${r}${l}`})}const c=`0x${(t&&s<0?(1n<<BigInt(n*8))+BigInt(s):s).toString(16)}`;return n?fD(c,n):c}function fD(r,e){return Ob(r,{dir:"left",size:e})}function Db(r,e){return Ob(r,{dir:"right",size:e})}function An(r,e,t,n={}){const{strict:s}=n;oD(r,e);const i=`0x${r.replace("0x","").slice((e??0)*2,(t??r.length)*2)}`;return s&&aD(i,e,t),i}function Us(r){return Math.ceil((r.length-2)/2)}function dD(r,e={}){const{strict:t=!1}=e;try{return uD(r,{strict:t}),!0}catch{return!1}}class pD extends Re{constructor({max:e,min:t,signed:n,size:s,value:i}){super(`Number \`${i}\` is not in safe${s?` ${s*8}-bit`:""}${n?" signed":" unsigned"} integer range ${e?`(\`${t}\` to \`${e}\`)`:`(above \`${t}\`)`}`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Hex.IntegerOutOfRangeError"})}}class Sy extends Re{constructor(e){super(`Value \`${typeof e=="object"?cp(e):e}\` of type \`${typeof e}\` is an invalid hex type.`,{metaMessages:['Hex types must be represented as `"0x${string}"`.']}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Hex.InvalidHexTypeError"})}}class Oy extends Re{constructor(e){super(`Value \`${e}\` is an invalid hex value.`,{metaMessages:['Hex values must start with `"0x"` and contain only hexadecimal characters (0-9, a-f, A-F).']}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Hex.InvalidHexValueError"})}}let gD=class extends Re{constructor({givenSize:e,maxSize:t}){super(`Size cannot exceed \`${t}\` bytes. Given size: \`${e}\` bytes.`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Hex.SizeOverflowError"})}};class _b extends Re{constructor({offset:e,position:t,size:n}){super(`Slice ${t==="start"?"starting":"ending"} at offset \`${e}\` is out-of-bounds (size: \`${n}\`).`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Hex.SliceOffsetOutOfBoundsError"})}}let yD=class extends Re{constructor({size:e,targetSize:t,type:n}){super(`${n.charAt(0).toUpperCase()}${n.slice(1).toLowerCase()} size (\`${e}\`) exceeds padding size (\`${t}\`).`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Hex.SizeExceedsPaddingSizeError"})}};const mD=new TextEncoder;function wD(r){if(!(r instanceof Uint8Array)){if(!r)throw new tl(r);if(typeof r!="object")throw new tl(r);if(!("BYTES_PER_ELEMENT"in r))throw new tl(r);if(r.BYTES_PER_ELEMENT!==1||r.constructor.name!=="Uint8Array")throw new tl(r)}}function bD(r){return r instanceof Uint8Array?r:typeof r=="string"?vD(r):xD(r)}function xD(r){return r instanceof Uint8Array?r:new Uint8Array(r)}function vD(r,e={}){const{size:t}=e;let n=r;t&&(Sb(r,t),n=Db(r,t));let s=n.slice(2);s.length%2&&(s=`0${s}`);const i=s.length/2,o=new Uint8Array(i);for(let a=0,c=0;a<i;a++){const l=Iy(s.charCodeAt(c++)),u=Iy(s.charCodeAt(c++));if(l===void 0||u===void 0)throw new Re(`Invalid byte sequence ("${s[c-2]}${s[c-1]}" in "${s}").`);o[a]=l*16+u}return o}function ED(r,e={}){const{size:t}=e,n=mD.encode(r);return typeof t=="number"?(sD(n,t),AD(n,t)):n}function AD(r,e){return iD(r,{dir:"right",size:e})}function Dy(r){return r.length}function ID(r){try{return wD(r),!0}catch{return!1}}class tl extends Re{constructor(e){super(`Value \`${typeof e=="object"?cp(e):e}\` of type \`${typeof e}\` is an invalid Bytes value.`,{metaMessages:["Bytes values must be of type `Bytes`."]}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Bytes.InvalidBytesTypeError"})}}class SD extends Re{constructor({givenSize:e,maxSize:t}){super(`Size cannot exceed \`${t}\` bytes. Given size: \`${e}\` bytes.`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Bytes.SizeOverflowError"})}}class OD extends Re{constructor({size:e,targetSize:t,type:n}){super(`${n.charAt(0).toUpperCase()}${n.slice(1).toLowerCase()} size (\`${e}\`) exceeds padding size (\`${t}\`).`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Bytes.SizeExceedsPaddingSizeError"})}}function Nb(r,e={}){const{as:t=typeof r=="string"?"Hex":"Bytes"}=e,n=JO(bD(r));return t==="Bytes"?n:Kl(n)}class DD extends Map{constructor(e){super(),Object.defineProperty(this,"maxSize",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.maxSize=e}get(e){const t=super.get(e);return super.has(e)&&t!==void 0&&(this.delete(e),super.set(e,t)),t}set(e,t){if(super.set(e,t),this.maxSize&&this.size>this.maxSize){const n=this.keys().next().value;n&&this.delete(n)}return this}}const _D={checksum:new DD(8192)},vh=_D.checksum;function Cb(r,e={}){const{compressed:t}=e,{prefix:n,x:s,y:i}=r;if(t===!1||typeof s=="bigint"&&typeof i=="bigint"){if(n!==4)throw new _y({prefix:n,cause:new TD});return}if(t===!0||typeof s=="bigint"&&typeof i>"u"){if(n!==3&&n!==2)throw new _y({prefix:n,cause:new PD});return}throw new RD({publicKey:r})}function ND(r){const e=(()=>{if(dD(r))return Bb(r);if(ID(r))return CD(r);const{prefix:t,x:n,y:s}=r;return typeof n=="bigint"&&typeof s=="bigint"?{prefix:t??4,x:n,y:s}:{prefix:t,x:n}})();return Cb(e),e}function CD(r){return Bb(Kl(r))}function Bb(r){if(r.length!==132&&r.length!==130&&r.length!==68)throw new kD({publicKey:r});if(r.length===130){const n=BigInt(An(r,0,32)),s=BigInt(An(r,32,64));return{prefix:4,x:n,y:s}}if(r.length===132){const n=Number(An(r,0,1)),s=BigInt(An(r,1,33)),i=BigInt(An(r,33,65));return{prefix:n,x:s,y:i}}const e=Number(An(r,0,1)),t=BigInt(An(r,1,33));return{prefix:e,x:t}}function BD(r,e={}){Cb(r);const{prefix:t,x:n,y:s}=r,{includePrefix:i=!0}=e;return hD(i?xh(t,{size:1}):"0x",xh(n,{size:32}),typeof s=="bigint"?xh(s,{size:32}):"0x")}class RD extends Re{constructor({publicKey:e}){super(`Value \`${cp(e)}\` is not a valid public key.`,{metaMessages:["Public key must contain:","- an `x` and `prefix` value (compressed)","- an `x`, `y`, and `prefix` value (uncompressed)"]}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"PublicKey.InvalidError"})}}class _y extends Re{constructor({prefix:e,cause:t}){super(`Prefix "${e}" is invalid.`,{cause:t}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"PublicKey.InvalidPrefixError"})}}class PD extends Re{constructor(){super("Prefix must be 2 or 3 for compressed public keys."),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"PublicKey.InvalidCompressedPrefixError"})}}class TD extends Re{constructor(){super("Prefix must be 4 for uncompressed public keys."),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"PublicKey.InvalidUncompressedPrefixError"})}}let kD=class extends Re{constructor({publicKey:e}){super(`Value \`${e}\` is an invalid public key size.`,{metaMessages:["Expected: 33 bytes (compressed + prefix), 64 bytes (uncompressed) or 65 bytes (uncompressed + prefix).",`Received ${Us(lp(e))} bytes.`]}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"PublicKey.InvalidSerializedSizeError"})}};const UD=/^0x[a-fA-F0-9]{40}$/;function Rb(r,e={}){const{strict:t=!0}=e;if(!UD.test(r))throw new Ny({address:r,cause:new LD});if(t){if(r.toLowerCase()===r)return;if(Pb(r)!==r)throw new Ny({address:r,cause:new jD})}}function Pb(r){if(vh.has(r))return vh.get(r);Rb(r,{strict:!1});const e=r.substring(2).toLowerCase(),t=Nb(ED(e),{as:"Bytes"}),n=e.split("");for(let i=0;i<40;i+=2)t[i>>1]>>4>=8&&n[i]&&(n[i]=n[i].toUpperCase()),(t[i>>1]&15)>=8&&n[i+1]&&(n[i+1]=n[i+1].toUpperCase());const s=`0x${n.join("")}`;return vh.set(r,s),s}function $D(r,e={}){const{checksum:t=!1}=e;return Rb(r),t?Pb(r):r}function FD(r,e={}){const t=Nb(`0x${BD(r).slice(4)}`).substring(26);return $D(`0x${t}`,e)}class Ny extends Re{constructor({address:e,cause:t}){super(`Address "${e}" is invalid.`,{cause:t}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Address.InvalidAddressError"})}}class LD extends Re{constructor(){super("Address is not a 20 byte (40 hexadecimal character) value."),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Address.InvalidInputError"})}}class jD extends Re{constructor(){super("Address does not match its checksum counterpart."),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Address.InvalidChecksumError"})}}class Tb extends np{constructor(e,t){super(),this.finished=!1,this.destroyed=!1,AO(e);const n=Du(t);if(this.iHash=e.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const s=this.blockLen,i=new Uint8Array(s);i.set(n.length>s?e.create().update(n).digest():n);for(let o=0;o<i.length;o++)i[o]^=54;this.iHash.update(i),this.oHash=e.create();for(let o=0;o<i.length;o++)i[o]^=106;this.oHash.update(i),Yo(i)}update(e){return Jo(this),this.iHash.update(e),this}digestInto(e){Jo(this),ki(e,this.outputLen),this.finished=!0,this.iHash.digestInto(e),this.oHash.update(e),this.oHash.digestInto(e),this.destroy()}digest(){const e=new Uint8Array(this.oHash.outputLen);return this.digestInto(e),e}_cloneInto(e){e||(e=Object.create(Object.getPrototypeOf(this),{}));const{oHash:t,iHash:n,finished:s,destroyed:i,blockLen:o,outputLen:a}=this;return e=e,e.finished=s,e.destroyed=i,e.blockLen=o,e.outputLen=a,e.oHash=t._cloneInto(e.oHash),e.iHash=n._cloneInto(e.iHash),e}clone(){return this._cloneInto()}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}}const kb=(r,e,t)=>new Tb(r,e).update(t).digest();kb.create=(r,e)=>new Tb(r,e);/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const zt=BigInt(0),_t=BigInt(1),si=BigInt(2),MD=BigInt(3),Ub=BigInt(4),$b=BigInt(5),Fb=BigInt(8);function Ft(r,e){const t=r%e;return t>=zt?t:e+t}function or(r,e,t){let n=r;for(;e-- >zt;)n*=n,n%=t;return n}function Yf(r,e){if(r===zt)throw new Error("invert: expected non-zero number");if(e<=zt)throw new Error("invert: expected positive modulus, got "+e);let t=Ft(r,e),n=e,s=zt,i=_t;for(;t!==zt;){const a=n/t,c=n%t,l=s-i*a;n=t,t=c,s=i,i=l}if(n!==_t)throw new Error("invert: does not exist");return Ft(s,e)}function Lb(r,e){const t=(r.ORDER+_t)/Ub,n=r.pow(e,t);if(!r.eql(r.sqr(n),e))throw new Error("Cannot find square root");return n}function zD(r,e){const t=(r.ORDER-$b)/Fb,n=r.mul(e,si),s=r.pow(n,t),i=r.mul(e,s),o=r.mul(r.mul(i,si),s),a=r.mul(i,r.sub(o,r.ONE));if(!r.eql(r.sqr(a),e))throw new Error("Cannot find square root");return a}function qD(r){if(r<BigInt(3))throw new Error("sqrt is not defined for small field");let e=r-_t,t=0;for(;e%si===zt;)e/=si,t++;let n=si;const s=up(r);for(;Cy(s,n)===1;)if(n++>1e3)throw new Error("Cannot find square root: probably non-prime P");if(t===1)return Lb;let i=s.pow(n,e);const o=(e+_t)/si;return function(c,l){if(c.is0(l))return l;if(Cy(c,l)!==1)throw new Error("Cannot find square root");let u=t,h=c.mul(c.ONE,i),f=c.pow(l,e),d=c.pow(l,o);for(;!c.eql(f,c.ONE);){if(c.is0(f))return c.ZERO;let p=1,g=c.sqr(f);for(;!c.eql(g,c.ONE);)if(p++,g=c.sqr(g),p===u)throw new Error("Cannot find square root");const m=_t<<BigInt(u-p-1),E=c.pow(h,m);u=p,h=c.sqr(E),f=c.mul(f,h),d=c.mul(d,E)}return d}}function VD(r){return r%Ub===MD?Lb:r%Fb===$b?zD:qD(r)}const KD=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function HD(r){const e={ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"},t=KD.reduce((n,s)=>(n[s]="function",n),e);return Nu(r,t)}function GD(r,e,t){if(t<zt)throw new Error("invalid exponent, negatives unsupported");if(t===zt)return r.ONE;if(t===_t)return e;let n=r.ONE,s=e;for(;t>zt;)t&_t&&(n=r.mul(n,s)),s=r.sqr(s),t>>=_t;return n}function jb(r,e,t=!1){const n=new Array(e.length).fill(t?r.ZERO:void 0),s=e.reduce((o,a,c)=>r.is0(a)?o:(n[c]=o,r.mul(o,a)),r.ONE),i=r.inv(s);return e.reduceRight((o,a,c)=>r.is0(a)?o:(n[c]=r.mul(o,n[c]),r.mul(o,a)),i),n}function Cy(r,e){const t=(r.ORDER-_t)/si,n=r.pow(e,t),s=r.eql(n,r.ONE),i=r.eql(n,r.ZERO),o=r.eql(n,r.neg(r.ONE));if(!s&&!i&&!o)throw new Error("invalid Legendre symbol result");return s?1:i?0:-1}function Mb(r,e){e!==void 0&&ec(e);const t=e!==void 0?e:r.toString(2).length,n=Math.ceil(t/8);return{nBitLength:t,nByteLength:n}}function up(r,e,t=!1,n={}){if(r<=zt)throw new Error("invalid field: expected ORDER > 0, got "+r);const{nBitLength:s,nByteLength:i}=Mb(r,e);if(i>2048)throw new Error("invalid field: expected ORDER of <= 2048 bytes");let o;const a=Object.freeze({ORDER:r,isLE:t,BITS:s,BYTES:i,MASK:_u(s),ZERO:zt,ONE:_t,create:c=>Ft(c,r),isValid:c=>{if(typeof c!="bigint")throw new Error("invalid field element: expected bigint, got "+typeof c);return zt<=c&&c<r},is0:c=>c===zt,isOdd:c=>(c&_t)===_t,neg:c=>Ft(-c,r),eql:(c,l)=>c===l,sqr:c=>Ft(c*c,r),add:(c,l)=>Ft(c+l,r),sub:(c,l)=>Ft(c-l,r),mul:(c,l)=>Ft(c*l,r),pow:(c,l)=>GD(a,c,l),div:(c,l)=>Ft(c*Yf(l,r),r),sqrN:c=>c*c,addN:(c,l)=>c+l,subN:(c,l)=>c-l,mulN:(c,l)=>c*l,inv:c=>Yf(c,r),sqrt:n.sqrt||(c=>(o||(o=VD(r)),o(a,c))),toBytes:c=>t?Ib(c,i):Ic(c,i),fromBytes:c=>{if(c.length!==i)throw new Error("Field.fromBytes: expected "+i+" bytes, got "+c.length);return t?Ab(c):Ni(c)},invertBatch:c=>jb(a,c),cmov:(c,l,u)=>u?l:c});return Object.freeze(a)}function zb(r){if(typeof r!="bigint")throw new Error("field order must be bigint");const e=r.toString(2).length;return Math.ceil(e/8)}function qb(r){const e=zb(r);return e+Math.ceil(e/2)}function QD(r,e,t=!1){const n=r.length,s=zb(e),i=qb(e);if(n<16||n<i||n>1024)throw new Error("expected "+i+"-1024 bytes of input, got "+n);const o=t?Ab(r):Ni(r),a=Ft(o,e-_t)+_t;return t?Ib(a,s):Ic(a,s)}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const By=BigInt(0),Zf=BigInt(1);function Eh(r,e){const t=e.negate();return r?t:e}function Vb(r,e){if(!Number.isSafeInteger(r)||r<=0||r>e)throw new Error("invalid window size, expected [1.."+e+"], got W="+r)}function Ah(r,e){Vb(r,e);const t=Math.ceil(e/r)+1,n=2**(r-1),s=2**r,i=_u(r),o=BigInt(r);return{windows:t,windowSize:n,mask:i,maxNumber:s,shiftBy:o}}function Ry(r,e,t){const{windowSize:n,mask:s,maxNumber:i,shiftBy:o}=t;let a=Number(r&s),c=r>>o;a>n&&(a-=i,c+=Zf);const l=e*n,u=l+Math.abs(a)-1,h=a===0,f=a<0,d=e%2!==0;return{nextN:c,offset:u,isZero:h,isNeg:f,isNegF:d,offsetF:l}}function WD(r,e){if(!Array.isArray(r))throw new Error("array expected");r.forEach((t,n)=>{if(!(t instanceof e))throw new Error("invalid point at index "+n)})}function JD(r,e){if(!Array.isArray(r))throw new Error("array of scalars expected");r.forEach((t,n)=>{if(!e.isValid(t))throw new Error("invalid scalar at index "+n)})}const Ih=new WeakMap,Kb=new WeakMap;function Sh(r){return Kb.get(r)||1}function YD(r,e){return{constTimeNegate:Eh,hasPrecomputes(t){return Sh(t)!==1},unsafeLadder(t,n,s=r.ZERO){let i=t;for(;n>By;)n&Zf&&(s=s.add(i)),i=i.double(),n>>=Zf;return s},precomputeWindow(t,n){const{windows:s,windowSize:i}=Ah(n,e),o=[];let a=t,c=a;for(let l=0;l<s;l++){c=a,o.push(c);for(let u=1;u<i;u++)c=c.add(a),o.push(c);a=c.double()}return o},wNAF(t,n,s){let i=r.ZERO,o=r.BASE;const a=Ah(t,e);for(let c=0;c<a.windows;c++){const{nextN:l,offset:u,isZero:h,isNeg:f,isNegF:d,offsetF:p}=Ry(s,c,a);s=l,h?o=o.add(Eh(d,n[p])):i=i.add(Eh(f,n[u]))}return{p:i,f:o}},wNAFUnsafe(t,n,s,i=r.ZERO){const o=Ah(t,e);for(let a=0;a<o.windows&&s!==By;a++){const{nextN:c,offset:l,isZero:u,isNeg:h}=Ry(s,a,o);if(s=c,!u){const f=n[l];i=i.add(h?f.negate():f)}}return i},getPrecomputes(t,n,s){let i=Ih.get(n);return i||(i=this.precomputeWindow(n,t),t!==1&&Ih.set(n,s(i))),i},wNAFCached(t,n,s){const i=Sh(t);return this.wNAF(i,this.getPrecomputes(i,t,s),n)},wNAFCachedUnsafe(t,n,s,i){const o=Sh(t);return o===1?this.unsafeLadder(t,n,i):this.wNAFUnsafe(o,this.getPrecomputes(o,t,s),n,i)},setWindowSize(t,n){Vb(n,e),Kb.set(t,n),Ih.delete(t)}}}function ZD(r,e,t,n){WD(t,r),JD(n,e);const s=t.length,i=n.length;if(s!==i)throw new Error("arrays of points and scalars must have equal length");const o=r.ZERO,a=tD(BigInt(s));let c=1;a>12?c=a-3:a>4?c=a-2:a>0&&(c=2);const l=_u(c),u=new Array(Number(l)+1).fill(o),h=Math.floor((e.BITS-1)/c)*c;let f=o;for(let d=h;d>=0;d-=c){u.fill(o);for(let g=0;g<i;g++){const m=n[g],E=Number(m>>BigInt(d)&l);u[E]=u[E].add(t[g])}let p=o;for(let g=u.length-1,m=o;g>0;g--)m=m.add(u[g]),p=p.add(m);if(f=f.add(p),d!==0)for(let g=0;g<c;g++)f=f.double()}return f}function Hb(r){return HD(r.Fp),Nu(r,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...Mb(r.n,r.nBitLength),...r,p:r.Fp.ORDER})}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */function Py(r){r.lowS!==void 0&&tc("lowS",r.lowS),r.prehash!==void 0&&tc("prehash",r.prehash)}function XD(r){const e=Hb(r);Nu(e,{a:"field",b:"field"},{allowInfinityPoint:"boolean",allowedPrivateKeyLengths:"array",clearCofactor:"function",fromBytes:"function",isTorsionFree:"function",toBytes:"function",wrapPrivateKey:"boolean"});const{endo:t,Fp:n,a:s}=e;if(t){if(!n.eql(s,n.ZERO))throw new Error("invalid endo: CURVE.a must be 0");if(typeof t!="object"||typeof t.beta!="bigint"||typeof t.splitScalar!="function")throw new Error('invalid endo: expected "beta": bigint and "splitScalar": function')}return Object.freeze({...e})}class e_ extends Error{constructor(e=""){super(e)}}const On={Err:e_,_tlv:{encode:(r,e)=>{const{Err:t}=On;if(r<0||r>256)throw new t("tlv.encode: wrong tag");if(e.length&1)throw new t("tlv.encode: unpadded data");const n=e.length/2,s=el(n);if(s.length/2&128)throw new t("tlv.encode: long form length too big");const i=n>127?el(s.length/2|128):"";return el(r)+i+s+e},decode(r,e){const{Err:t}=On;let n=0;if(r<0||r>256)throw new t("tlv.encode: wrong tag");if(e.length<2||e[n++]!==r)throw new t("tlv.decode: wrong tlv");const s=e[n++],i=!!(s&128);let o=0;if(!i)o=s;else{const c=s&127;if(!c)throw new t("tlv.decode(long): indefinite length not supported");if(c>4)throw new t("tlv.decode(long): byte length is too big");const l=e.subarray(n,n+c);if(l.length!==c)throw new t("tlv.decode: length bytes not complete");if(l[0]===0)throw new t("tlv.decode(long): zero leftmost byte");for(const u of l)o=o<<8|u;if(n+=c,o<128)throw new t("tlv.decode(long): not minimal encoding")}const a=e.subarray(n,n+o);if(a.length!==o)throw new t("tlv.decode: wrong value length");return{v:a,l:e.subarray(n+o)}}},_int:{encode(r){const{Err:e}=On;if(r<$n)throw new e("integer: negative integers are not allowed");let t=el(r);if(Number.parseInt(t[0],16)&8&&(t="00"+t),t.length&1)throw new e("unexpected DER parsing assertion: unpadded hex");return t},decode(r){const{Err:e}=On;if(r[0]&128)throw new e("invalid signature integer: negative");if(r[0]===0&&!(r[1]&128))throw new e("invalid signature integer: unnecessary leading zero");return Ni(r)}},toSig(r){const{Err:e,_int:t,_tlv:n}=On,s=hr("signature",r),{v:i,l:o}=n.decode(48,s);if(o.length)throw new e("invalid signature: left bytes after parsing");const{v:a,l:c}=n.decode(2,i),{v:l,l:u}=n.decode(2,c);if(u.length)throw new e("invalid signature: left bytes after parsing");return{r:t.decode(a),s:t.decode(l)}},hexFromSig(r){const{_tlv:e,_int:t}=On,n=e.encode(2,t.encode(r.r)),s=e.encode(2,t.encode(r.s)),i=n+s;return e.encode(48,i)}};function Oh(r,e){return rc(Ic(r,e))}const $n=BigInt(0),Ze=BigInt(1);BigInt(2);const Dh=BigInt(3),t_=BigInt(4);function r_(r){const e=XD(r),{Fp:t}=e,n=up(e.n,e.nBitLength),s=e.toBytes||((x,b,v)=>{const S=b.toAffine();return Vl(Uint8Array.from([4]),t.toBytes(S.x),t.toBytes(S.y))}),i=e.fromBytes||(x=>{const b=x.subarray(1),v=t.fromBytes(b.subarray(0,t.BYTES)),S=t.fromBytes(b.subarray(t.BYTES,2*t.BYTES));return{x:v,y:S}});function o(x){const{a:b,b:v}=e,S=t.sqr(x),D=t.mul(S,x);return t.add(t.add(D,t.mul(x,b)),v)}function a(x,b){const v=t.sqr(b),S=o(x);return t.eql(v,S)}if(!a(e.Gx,e.Gy))throw new Error("bad curve params: generator point");const c=t.mul(t.pow(e.a,Dh),t_),l=t.mul(t.sqr(e.b),BigInt(27));if(t.is0(t.add(c,l)))throw new Error("bad curve params: a or b");function u(x){return ap(x,Ze,e.n)}function h(x){const{allowedPrivateKeyLengths:b,nByteLength:v,wrapPrivateKey:S,n:D}=e;if(b&&typeof x!="bigint"){if(Ac(x)&&(x=rc(x)),typeof x!="string"||!b.includes(x.length))throw new Error("invalid private key");x=x.padStart(v*2,"0")}let R;try{R=typeof x=="bigint"?x:Ni(hr("private key",x,v))}catch{throw new Error("invalid private key, expected hex or "+v+" bytes, got "+typeof x)}return S&&(R=Ft(R,D)),mo("private key",R,Ze,D),R}function f(x){if(!(x instanceof g))throw new Error("ProjectivePoint expected")}const d=Ay((x,b)=>{const{px:v,py:S,pz:D}=x;if(t.eql(D,t.ONE))return{x:v,y:S};const R=x.is0();b==null&&(b=R?t.ONE:t.inv(D));const _=t.mul(v,b),F=t.mul(S,b),j=t.mul(D,b);if(R)return{x:t.ZERO,y:t.ZERO};if(!t.eql(j,t.ONE))throw new Error("invZ was invalid");return{x:_,y:F}}),p=Ay(x=>{if(x.is0()){if(e.allowInfinityPoint&&!t.is0(x.py))return;throw new Error("bad point: ZERO")}const{x:b,y:v}=x.toAffine();if(!t.isValid(b)||!t.isValid(v))throw new Error("bad point: x or y not FE");if(!a(b,v))throw new Error("bad point: equation left != right");if(!x.isTorsionFree())throw new Error("bad point: not in prime-order subgroup");return!0});class g{constructor(b,v,S){if(b==null||!t.isValid(b))throw new Error("x required");if(v==null||!t.isValid(v)||t.is0(v))throw new Error("y required");if(S==null||!t.isValid(S))throw new Error("z required");this.px=b,this.py=v,this.pz=S,Object.freeze(this)}static fromAffine(b){const{x:v,y:S}=b||{};if(!b||!t.isValid(v)||!t.isValid(S))throw new Error("invalid affine point");if(b instanceof g)throw new Error("projective point not allowed");const D=R=>t.eql(R,t.ZERO);return D(v)&&D(S)?g.ZERO:new g(v,S,t.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(b){const v=jb(t,b.map(S=>S.pz));return b.map((S,D)=>S.toAffine(v[D])).map(g.fromAffine)}static fromHex(b){const v=g.fromAffine(i(hr("pointHex",b)));return v.assertValidity(),v}static fromPrivateKey(b){return g.BASE.multiply(h(b))}static msm(b,v){return ZD(g,n,b,v)}_setWindowSize(b){O.setWindowSize(this,b)}assertValidity(){p(this)}hasEvenY(){const{y:b}=this.toAffine();if(t.isOdd)return!t.isOdd(b);throw new Error("Field doesn't support isOdd")}equals(b){f(b);const{px:v,py:S,pz:D}=this,{px:R,py:_,pz:F}=b,j=t.eql(t.mul(v,F),t.mul(R,D)),$=t.eql(t.mul(S,F),t.mul(_,D));return j&&$}negate(){return new g(this.px,t.neg(this.py),this.pz)}double(){const{a:b,b:v}=e,S=t.mul(v,Dh),{px:D,py:R,pz:_}=this;let F=t.ZERO,j=t.ZERO,$=t.ZERO,C=t.mul(D,D),k=t.mul(R,R),I=t.mul(_,_),A=t.mul(D,R);return A=t.add(A,A),$=t.mul(D,_),$=t.add($,$),F=t.mul(b,$),j=t.mul(S,I),j=t.add(F,j),F=t.sub(k,j),j=t.add(k,j),j=t.mul(F,j),F=t.mul(A,F),$=t.mul(S,$),I=t.mul(b,I),A=t.sub(C,I),A=t.mul(b,A),A=t.add(A,$),$=t.add(C,C),C=t.add($,C),C=t.add(C,I),C=t.mul(C,A),j=t.add(j,C),I=t.mul(R,_),I=t.add(I,I),C=t.mul(I,A),F=t.sub(F,C),$=t.mul(I,k),$=t.add($,$),$=t.add($,$),new g(F,j,$)}add(b){f(b);const{px:v,py:S,pz:D}=this,{px:R,py:_,pz:F}=b;let j=t.ZERO,$=t.ZERO,C=t.ZERO;const k=e.a,I=t.mul(e.b,Dh);let A=t.mul(v,R),B=t.mul(S,_),U=t.mul(D,F),N=t.add(v,S),T=t.add(R,_);N=t.mul(N,T),T=t.add(A,B),N=t.sub(N,T),T=t.add(v,D);let M=t.add(R,F);return T=t.mul(T,M),M=t.add(A,U),T=t.sub(T,M),M=t.add(S,D),j=t.add(_,F),M=t.mul(M,j),j=t.add(B,U),M=t.sub(M,j),C=t.mul(k,T),j=t.mul(I,U),C=t.add(j,C),j=t.sub(B,C),C=t.add(B,C),$=t.mul(j,C),B=t.add(A,A),B=t.add(B,A),U=t.mul(k,U),T=t.mul(I,T),B=t.add(B,U),U=t.sub(A,U),U=t.mul(k,U),T=t.add(T,U),A=t.mul(B,T),$=t.add($,A),A=t.mul(M,T),j=t.mul(N,j),j=t.sub(j,A),A=t.mul(N,B),C=t.mul(M,C),C=t.add(C,A),new g(j,$,C)}subtract(b){return this.add(b.negate())}is0(){return this.equals(g.ZERO)}wNAF(b){return O.wNAFCached(this,b,g.normalizeZ)}multiplyUnsafe(b){const{endo:v,n:S}=e;mo("scalar",b,$n,S);const D=g.ZERO;if(b===$n)return D;if(this.is0()||b===Ze)return this;if(!v||O.hasPrecomputes(this))return O.wNAFCachedUnsafe(this,b,g.normalizeZ);let{k1neg:R,k1:_,k2neg:F,k2:j}=v.splitScalar(b),$=D,C=D,k=this;for(;_>$n||j>$n;)_&Ze&&($=$.add(k)),j&Ze&&(C=C.add(k)),k=k.double(),_>>=Ze,j>>=Ze;return R&&($=$.negate()),F&&(C=C.negate()),C=new g(t.mul(C.px,v.beta),C.py,C.pz),$.add(C)}multiply(b){const{endo:v,n:S}=e;mo("scalar",b,Ze,S);let D,R;if(v){const{k1neg:_,k1:F,k2neg:j,k2:$}=v.splitScalar(b);let{p:C,f:k}=this.wNAF(F),{p:I,f:A}=this.wNAF($);C=O.constTimeNegate(_,C),I=O.constTimeNegate(j,I),I=new g(t.mul(I.px,v.beta),I.py,I.pz),D=C.add(I),R=k.add(A)}else{const{p:_,f:F}=this.wNAF(b);D=_,R=F}return g.normalizeZ([D,R])[0]}multiplyAndAddUnsafe(b,v,S){const D=g.BASE,R=(F,j)=>j===$n||j===Ze||!F.equals(D)?F.multiplyUnsafe(j):F.multiply(j),_=R(this,v).add(R(b,S));return _.is0()?void 0:_}toAffine(b){return d(this,b)}isTorsionFree(){const{h:b,isTorsionFree:v}=e;if(b===Ze)return!0;if(v)return v(g,this);throw new Error("isTorsionFree() has not been declared for the elliptic curve")}clearCofactor(){const{h:b,clearCofactor:v}=e;return b===Ze?this:v?v(g,this):this.multiplyUnsafe(e.h)}toRawBytes(b=!0){return tc("isCompressed",b),this.assertValidity(),s(g,this,b)}toHex(b=!0){return tc("isCompressed",b),rc(this.toRawBytes(b))}}g.BASE=new g(e.Gx,e.Gy,t.ONE),g.ZERO=new g(t.ZERO,t.ONE,t.ZERO);const{endo:m,nBitLength:E}=e,O=YD(g,m?Math.ceil(E/2):E);return{CURVE:e,ProjectivePoint:g,normPrivateKeyToScalar:h,weierstrassEquation:o,isWithinCurveOrder:u}}function n_(r){const e=Hb(r);return Nu(e,{hash:"hash",hmac:"function",randomBytes:"function"},{bits2int:"function",bits2int_modN:"function",lowS:"boolean"}),Object.freeze({lowS:!0,...e})}function s_(r){const e=n_(r),{Fp:t,n,nByteLength:s,nBitLength:i}=e,o=t.BYTES+1,a=2*t.BYTES+1;function c(I){return Ft(I,n)}function l(I){return Yf(I,n)}const{ProjectivePoint:u,normPrivateKeyToScalar:h,weierstrassEquation:f,isWithinCurveOrder:d}=r_({...e,toBytes(I,A,B){const U=A.toAffine(),N=t.toBytes(U.x),T=Vl;return tc("isCompressed",B),B?T(Uint8Array.from([A.hasEvenY()?2:3]),N):T(Uint8Array.from([4]),N,t.toBytes(U.y))},fromBytes(I){const A=I.length,B=I[0],U=I.subarray(1);if(A===o&&(B===2||B===3)){const N=Ni(U);if(!ap(N,Ze,t.ORDER))throw new Error("Point is not on curve");const T=f(N);let M;try{M=t.sqrt(T)}catch(J){const Q=J instanceof Error?": "+J.message:"";throw new Error("Point is not on curve"+Q)}const q=(M&Ze)===Ze;return(B&1)===1!==q&&(M=t.neg(M)),{x:N,y:M}}else if(A===a&&B===4){const N=t.fromBytes(U.subarray(0,t.BYTES)),T=t.fromBytes(U.subarray(t.BYTES,2*t.BYTES));return{x:N,y:T}}else{const N=o,T=a;throw new Error("invalid Point, expected length of "+N+", or uncompressed "+T+", got "+A)}}});function p(I){const A=n>>Ze;return I>A}function g(I){return p(I)?c(-I):I}const m=(I,A,B)=>Ni(I.slice(A,B));class E{constructor(A,B,U){mo("r",A,Ze,n),mo("s",B,Ze,n),this.r=A,this.s=B,U!=null&&(this.recovery=U),Object.freeze(this)}static fromCompact(A){const B=s;return A=hr("compactSignature",A,B*2),new E(m(A,0,B),m(A,B,2*B))}static fromDER(A){const{r:B,s:U}=On.toSig(hr("DER",A));return new E(B,U)}assertValidity(){}addRecoveryBit(A){return new E(this.r,this.s,A)}recoverPublicKey(A){const{r:B,s:U,recovery:N}=this,T=D(hr("msgHash",A));if(N==null||![0,1,2,3].includes(N))throw new Error("recovery id invalid");const M=N===2||N===3?B+e.n:B;if(M>=t.ORDER)throw new Error("recovery id 2 or 3 invalid");const q=(N&1)===0?"02":"03",Y=u.fromHex(q+Oh(M,t.BYTES)),J=l(M),Q=c(-T*J),re=c(U*J),ne=u.BASE.multiplyAndAddUnsafe(Y,Q,re);if(!ne)throw new Error("point at infinify");return ne.assertValidity(),ne}hasHighS(){return p(this.s)}normalizeS(){return this.hasHighS()?new E(this.r,c(-this.s),this.recovery):this}toDERRawBytes(){return ql(this.toDERHex())}toDERHex(){return On.hexFromSig(this)}toCompactRawBytes(){return ql(this.toCompactHex())}toCompactHex(){const A=s;return Oh(this.r,A)+Oh(this.s,A)}}const O={isValidPrivateKey(I){try{return h(I),!0}catch{return!1}},normPrivateKeyToScalar:h,randomPrivateKey:()=>{const I=qb(e.n);return QD(e.randomBytes(I),e.n)},precompute(I=8,A=u.BASE){return A._setWindowSize(I),A.multiply(BigInt(3)),A}};function x(I,A=!0){return u.fromPrivateKey(I).toRawBytes(A)}function b(I){if(typeof I=="bigint")return!1;if(I instanceof u)return!0;const B=hr("key",I).length,U=t.BYTES,N=U+1,T=2*U+1;if(!(e.allowedPrivateKeyLengths||s===N))return B===N||B===T}function v(I,A,B=!0){if(b(I)===!0)throw new Error("first arg must be private key");if(b(A)===!1)throw new Error("second arg must be public key");return u.fromHex(A).multiply(h(I)).toRawBytes(B)}const S=e.bits2int||function(I){if(I.length>8192)throw new Error("input is too large");const A=Ni(I),B=I.length*8-i;return B>0?A>>BigInt(B):A},D=e.bits2int_modN||function(I){return c(S(I))},R=_u(i);function _(I){return mo("num < 2^"+i,I,$n,R),Ic(I,s)}function F(I,A,B=j){if(["recovered","canonical"].some(te=>te in B))throw new Error("sign() legacy options not supported");const{hash:U,randomBytes:N}=e;let{lowS:T,prehash:M,extraEntropy:q}=B;T==null&&(T=!0),I=hr("msgHash",I),Py(B),M&&(I=hr("prehashed msgHash",U(I)));const Y=D(I),J=h(A),Q=[_(J),_(Y)];if(q!=null&&q!==!1){const te=q===!0?N(t.BYTES):q;Q.push(hr("extraEntropy",te))}const re=Vl(...Q),ne=Y;function ae(te){const ue=S(te);if(!d(ue))return;const Ae=l(ue),Ne=u.BASE.multiply(ue).toAffine(),Ue=c(Ne.x);if(Ue===$n)return;const Pe=c(Ae*c(ne+Ue*J));if(Pe===$n)return;let Bt=(Ne.x===Ue?0:2)|Number(Ne.y&Ze),$r=Pe;return T&&p(Pe)&&($r=g(Pe),Bt^=1),new E(Ue,$r,Bt)}return{seed:re,k2sig:ae}}const j={lowS:e.lowS,prehash:!1},$={lowS:e.lowS,prehash:!1};function C(I,A,B=j){const{seed:U,k2sig:N}=F(I,A,B),T=e;return rD(T.hash.outputLen,T.nByteLength,T.hmac)(U,N)}u.BASE._setWindowSize(8);function k(I,A,B,U=$){var Bt;const N=I;A=hr("msgHash",A),B=hr("publicKey",B);const{lowS:T,prehash:M,format:q}=U;if(Py(U),"strict"in U)throw new Error("options.strict was renamed to lowS");if(q!==void 0&&q!=="compact"&&q!=="der")throw new Error("format must be compact or der");const Y=typeof N=="string"||Ac(N),J=!Y&&!q&&typeof N=="object"&&N!==null&&typeof N.r=="bigint"&&typeof N.s=="bigint";if(!Y&&!J)throw new Error("invalid signature, expected Uint8Array, hex string or Signature instance");let Q,re;try{if(J&&(Q=new E(N.r,N.s)),Y){try{q!=="compact"&&(Q=E.fromDER(N))}catch($r){if(!($r instanceof On.Err))throw $r}!Q&&q!=="der"&&(Q=E.fromCompact(N))}re=u.fromHex(B)}catch{return!1}if(!Q||T&&Q.hasHighS())return!1;M&&(A=e.hash(A));const{r:ne,s:ae}=Q,te=D(A),ue=l(ae),Ae=c(te*ue),Ne=c(ne*ue),Ue=(Bt=u.BASE.multiplyAndAddUnsafe(re,Ae,Ne))==null?void 0:Bt.toAffine();return Ue?c(Ue.x)===ne:!1}return{CURVE:e,getPublicKey:x,getSharedSecret:v,sign:C,verify:k,ProjectivePoint:u,Signature:E,utils:O}}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */function i_(r){return{hash:r,hmac:(e,...t)=>kb(r,e,NO(...t)),randomBytes:CO}}function o_(r,e){const t=n=>s_({...r,...i_(n)});return{...t(e),create:t}}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const Gb=BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),Ty=BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),a_=BigInt(0),c_=BigInt(1),Xf=BigInt(2),ky=(r,e)=>(r+e/Xf)/e;function l_(r){const e=Gb,t=BigInt(3),n=BigInt(6),s=BigInt(11),i=BigInt(22),o=BigInt(23),a=BigInt(44),c=BigInt(88),l=r*r*r%e,u=l*l*r%e,h=or(u,t,e)*u%e,f=or(h,t,e)*u%e,d=or(f,Xf,e)*l%e,p=or(d,s,e)*d%e,g=or(p,i,e)*p%e,m=or(g,a,e)*g%e,E=or(m,c,e)*m%e,O=or(E,a,e)*g%e,x=or(O,t,e)*u%e,b=or(x,o,e)*p%e,v=or(b,n,e)*l%e,S=or(v,Xf,e);if(!ed.eql(ed.sqr(S),r))throw new Error("Cannot find square root");return S}const ed=up(Gb,void 0,void 0,{sqrt:l_}),u_=o_({a:a_,b:BigInt(7),Fp:ed,n:Ty,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),h:BigInt(1),lowS:!0,endo:{beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),splitScalar:r=>{const e=Ty,t=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),n=-c_*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),s=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),i=t,o=BigInt("0x100000000000000000000000000000000"),a=ky(i*r,e),c=ky(-n*r,e);let l=Ft(r-a*t-c*s,e),u=Ft(-a*n-c*i,e);const h=l>o,f=u>o;if(h&&(l=e-l),f&&(u=e-u),l>o||u>o)throw new Error("splitScalar: Endomorphism failed, k="+r);return{k1neg:h,k1:l,k2neg:f,k2:u}}}},XO);function h_(r){if(r.length!==130&&r.length!==132)throw new d_({signature:r});const e=BigInt(An(r,0,32)),t=BigInt(An(r,32,64)),n=(()=>{const s=+`0x${r.slice(130)}`;if(!Number.isNaN(s))try{return f_(s)}catch{throw new p_({value:s})}})();return typeof n>"u"?{r:e,s:t}:{r:e,s:t,yParity:n}}function f_(r){if(r===0||r===27)return 0;if(r===1||r===28)return 1;if(r>=35)return r%2===0?1:0;throw new g_({value:r})}class d_ extends Re{constructor({signature:e}){super(`Value \`${e}\` is an invalid signature size.`,{metaMessages:["Expected: 64 bytes or 65 bytes.",`Received ${Us(lp(e))} bytes.`]}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Signature.InvalidSerializedSizeError"})}}class p_ extends Re{constructor({value:e}){super(`Value \`${e}\` is an invalid y-parity value. Y-parity must be 0 or 1.`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Signature.InvalidYParityError"})}}class g_ extends Re{constructor({value:e}){super(`Value \`${e}\` is an invalid v value. v must be 27, 28 or >=35.`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Signature.InvalidVError"})}}/*! scure-base - MIT License (c) 2022 Paul Miller (paulmillr.com) */function Qb(r){return r instanceof Uint8Array||ArrayBuffer.isView(r)&&r.constructor.name==="Uint8Array"}function Wb(r,e){return Array.isArray(e)?e.length===0?!0:r?e.every(t=>typeof t=="string"):e.every(t=>Number.isSafeInteger(t)):!1}function Hl(r,e){if(typeof e!="string")throw new Error(`${r}: string expected`);return!0}function Sc(r){if(!Number.isSafeInteger(r))throw new Error(`invalid integer: ${r}`)}function Gl(r){if(!Array.isArray(r))throw new Error("array expected")}function Ql(r,e){if(!Wb(!0,e))throw new Error(`${r}: array of strings expected`)}function Jb(r,e){if(!Wb(!1,e))throw new Error(`${r}: array of numbers expected`)}function Yb(...r){const e=i=>i,t=(i,o)=>a=>i(o(a)),n=r.map(i=>i.encode).reduceRight(t,e),s=r.map(i=>i.decode).reduce(t,e);return{encode:n,decode:s}}function Zb(r){const e=typeof r=="string"?r.split(""):r,t=e.length;Ql("alphabet",e);const n=new Map(e.map((s,i)=>[s,i]));return{encode:s=>(Gl(s),s.map(i=>{if(!Number.isSafeInteger(i)||i<0||i>=t)throw new Error(`alphabet.encode: digit index outside alphabet "${i}". Allowed: ${r}`);return e[i]})),decode:s=>(Gl(s),s.map(i=>{Hl("alphabet.decode",i);const o=n.get(i);if(o===void 0)throw new Error(`Unknown letter: "${i}". Allowed: ${r}`);return o}))}}function Xb(r=""){return Hl("join",r),{encode:e=>(Ql("join.decode",e),e.join(r)),decode:e=>(Hl("join.decode",e),e.split(r))}}function y_(r,e="="){return Sc(r),Hl("padding",e),{encode(t){for(Ql("padding.encode",t);t.length*r%8;)t.push(e);return t},decode(t){Ql("padding.decode",t);let n=t.length;if(n*r%8)throw new Error("padding: invalid, string should have whole number of bytes");for(;n>0&&t[n-1]===e;n--)if((n-1)*r%8===0)throw new Error("padding: invalid, string has too much padding");return t.slice(0,n)}}}function Uy(r,e,t){if(e<2)throw new Error(`convertRadix: invalid from=${e}, base cannot be less than 2`);if(t<2)throw new Error(`convertRadix: invalid to=${t}, base cannot be less than 2`);if(Gl(r),!r.length)return[];let n=0;const s=[],i=Array.from(r,a=>{if(Sc(a),a<0||a>=e)throw new Error(`invalid integer: ${a}`);return a}),o=i.length;for(;;){let a=0,c=!0;for(let l=n;l<o;l++){const u=i[l],h=e*a,f=h+u;if(!Number.isSafeInteger(f)||h/e!==a||f-u!==h)throw new Error("convertRadix: carry overflow");const d=f/t;a=f%t;const p=Math.floor(d);if(i[l]=p,!Number.isSafeInteger(p)||p*t+a!==f)throw new Error("convertRadix: carry overflow");if(c)p?c=!1:n=l;else continue}if(s.push(a),c)break}for(let a=0;a<r.length-1&&r[a]===0;a++)s.push(0);return s.reverse()}const e1=(r,e)=>e===0?r:e1(e,r%e),Wl=(r,e)=>r+(e-e1(r,e)),_h=(()=>{let r=[];for(let e=0;e<40;e++)r.push(2**e);return r})();function $y(r,e,t,n){if(Gl(r),e<=0||e>32)throw new Error(`convertRadix2: wrong from=${e}`);if(t<=0||t>32)throw new Error(`convertRadix2: wrong to=${t}`);if(Wl(e,t)>32)throw new Error(`convertRadix2: carry overflow from=${e} to=${t} carryBits=${Wl(e,t)}`);let s=0,i=0;const o=_h[e],a=_h[t]-1,c=[];for(const l of r){if(Sc(l),l>=o)throw new Error(`convertRadix2: invalid data word=${l} from=${e}`);if(s=s<<e|l,i+e>32)throw new Error(`convertRadix2: carry overflow pos=${i} from=${e}`);for(i+=e;i>=t;i-=t)c.push((s>>i-t&a)>>>0);const u=_h[i];if(u===void 0)throw new Error("invalid carry");s&=u-1}if(s=s<<t-i&a,!n&&i>=e)throw new Error("Excess padding");if(!n&&s>0)throw new Error(`Non-zero padding: ${s}`);return n&&i>0&&c.push(s>>>0),c}function m_(r){Sc(r);const e=2**8;return{encode:t=>{if(!Qb(t))throw new Error("radix.encode input should be Uint8Array");return Uy(Array.from(t),e,r)},decode:t=>(Jb("radix.decode",t),Uint8Array.from(Uy(t,r,e)))}}function w_(r,e=!1){if(Sc(r),r<=0||r>32)throw new Error("radix2: bits should be in (0..32]");if(Wl(8,r)>32||Wl(r,8)>32)throw new Error("radix2: carry overflow");return{encode:t=>{if(!Qb(t))throw new Error("radix2.encode input should be Uint8Array");return $y(Array.from(t),8,r,!e)},decode:t=>(Jb("radix2.decode",t),Uint8Array.from($y(t,r,8,e)))}}const b_=Yb(w_(5),Zb("ABCDEFGHIJKLMNOPQRSTUVWXYZ234567"),y_(5),Xb("")),x_=r=>Yb(m_(58),Zb(r),Xb("")),Oc=x_("123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz");function v_(r){return FD(E_(r))}function E_(r){const{payload:e,signature:t}=r,{r:n,s,yParity:i}=t,a=new u_.Signature(BigInt(n),BigInt(s)).addRecoveryBit(i).recoverPublicKey(lp(e).substring(2));return ND(a)}function A_(r){const e=r.length;let t=0,n=0;for(;n<e;){let s=r.charCodeAt(n++);if((s&4294967168)===0){t++;continue}else if((s&4294965248)===0)t+=2;else{if(s>=55296&&s<=56319&&n<e){const i=r.charCodeAt(n);(i&64512)===56320&&(++n,s=((s&1023)<<10)+(i&1023)+65536)}(s&4294901760)===0?t+=3:t+=4}}return t}function I_(r,e,t){const n=r.length;let s=t,i=0;for(;i<n;){let o=r.charCodeAt(i++);if((o&4294967168)===0){e[s++]=o;continue}else if((o&4294965248)===0)e[s++]=o>>6&31|192;else{if(o>=55296&&o<=56319&&i<n){const a=r.charCodeAt(i);(a&64512)===56320&&(++i,o=((o&1023)<<10)+(a&1023)+65536)}(o&4294901760)===0?(e[s++]=o>>12&15|224,e[s++]=o>>6&63|128):(e[s++]=o>>18&7|240,e[s++]=o>>12&63|128,e[s++]=o>>6&63|128)}e[s++]=o&63|128}}const S_=new TextEncoder,O_=50;function D_(r,e,t){S_.encodeInto(r,e.subarray(t))}function __(r,e,t){r.length>O_?D_(r,e,t):I_(r,e,t)}const N_=4096;function t1(r,e,t){let n=e;const s=n+t,i=[];let o="";for(;n<s;){const a=r[n++];if((a&128)===0)i.push(a);else if((a&224)===192){const c=r[n++]&63;i.push((a&31)<<6|c)}else if((a&240)===224){const c=r[n++]&63,l=r[n++]&63;i.push((a&31)<<12|c<<6|l)}else if((a&248)===240){const c=r[n++]&63,l=r[n++]&63,u=r[n++]&63;let h=(a&7)<<18|c<<12|l<<6|u;h>65535&&(h-=65536,i.push(h>>>10&1023|55296),h=56320|h&1023),i.push(h)}else i.push(a);i.length>=N_&&(o+=String.fromCharCode(...i),i.length=0)}return i.length>0&&(o+=String.fromCharCode(...i)),o}const C_=new TextDecoder,B_=200;function R_(r,e,t){const n=r.subarray(e,e+t);return C_.decode(n)}function P_(r,e,t){return t>B_?R_(r,e,t):t1(r,e,t)}class rl{constructor(e,t){L(this,"type");L(this,"data");this.type=e,this.data=t}}class tr extends Error{constructor(e){super(e);const t=Object.create(tr.prototype);Object.setPrototypeOf(this,t),Object.defineProperty(this,"name",{configurable:!0,enumerable:!1,value:tr.name})}}const ga=4294967295;function T_(r,e,t){const n=t/4294967296,s=t;r.setUint32(e,n),r.setUint32(e+4,s)}function r1(r,e,t){const n=Math.floor(t/4294967296),s=t;r.setUint32(e,n),r.setUint32(e+4,s)}function n1(r,e){const t=r.getInt32(e),n=r.getUint32(e+4);return t*4294967296+n}function k_(r,e){const t=r.getUint32(e),n=r.getUint32(e+4);return t*4294967296+n}const U_=-1,$_=4294967296-1,F_=17179869184-1;function L_({sec:r,nsec:e}){if(r>=0&&e>=0&&r<=F_)if(e===0&&r<=$_){const t=new Uint8Array(4);return new DataView(t.buffer).setUint32(0,r),t}else{const t=r/4294967296,n=r&4294967295,s=new Uint8Array(8),i=new DataView(s.buffer);return i.setUint32(0,e<<2|t&3),i.setUint32(4,n),s}else{const t=new Uint8Array(12),n=new DataView(t.buffer);return n.setUint32(0,e),r1(n,4,r),t}}function j_(r){const e=r.getTime(),t=Math.floor(e/1e3),n=(e-t*1e3)*1e6,s=Math.floor(n/1e9);return{sec:t+s,nsec:n-s*1e9}}function M_(r){if(r instanceof Date){const e=j_(r);return L_(e)}else return null}function z_(r){const e=new DataView(r.buffer,r.byteOffset,r.byteLength);switch(r.byteLength){case 4:return{sec:e.getUint32(0),nsec:0};case 8:{const t=e.getUint32(0),n=e.getUint32(4),s=(t&3)*4294967296+n,i=t>>>2;return{sec:s,nsec:i}}case 12:{const t=n1(e,4),n=e.getUint32(0);return{sec:t,nsec:n}}default:throw new tr(`Unrecognized data size for timestamp (expected 4, 8, or 12): ${r.length}`)}}function q_(r){const e=z_(r);return new Date(e.sec*1e3+e.nsec/1e6)}const V_={type:U_,encode:M_,decode:q_},fu=class fu{constructor(){L(this,"__brand");L(this,"builtInEncoders",[]);L(this,"builtInDecoders",[]);L(this,"encoders",[]);L(this,"decoders",[]);this.register(V_)}register({type:e,encode:t,decode:n}){if(e>=0)this.encoders[e]=t,this.decoders[e]=n;else{const s=-1-e;this.builtInEncoders[s]=t,this.builtInDecoders[s]=n}}tryToEncode(e,t){for(let n=0;n<this.builtInEncoders.length;n++){const s=this.builtInEncoders[n];if(s!=null){const i=s(e,t);if(i!=null){const o=-1-n;return new rl(o,i)}}}for(let n=0;n<this.encoders.length;n++){const s=this.encoders[n];if(s!=null){const i=s(e,t);if(i!=null){const o=n;return new rl(o,i)}}}return e instanceof rl?e:null}decode(e,t,n){const s=t<0?this.builtInDecoders[-1-t]:this.decoders[t];return s?s(e,t,n):new rl(t,e)}};L(fu,"defaultCodec",new fu);let Jl=fu;function K_(r){return r instanceof ArrayBuffer||typeof SharedArrayBuffer<"u"&&r instanceof SharedArrayBuffer}function td(r){return r instanceof Uint8Array?r:ArrayBuffer.isView(r)?new Uint8Array(r.buffer,r.byteOffset,r.byteLength):K_(r)?new Uint8Array(r):Uint8Array.from(r)}const H_=100,G_=2048;let Q_=class s1{constructor(e){L(this,"extensionCodec");L(this,"context");L(this,"useBigInt64");L(this,"maxDepth");L(this,"initialBufferSize");L(this,"sortKeys");L(this,"forceFloat32");L(this,"ignoreUndefined");L(this,"forceIntegerToFloat");L(this,"pos");L(this,"view");L(this,"bytes");L(this,"entered",!1);this.extensionCodec=(e==null?void 0:e.extensionCodec)??Jl.defaultCodec,this.context=e==null?void 0:e.context,this.useBigInt64=(e==null?void 0:e.useBigInt64)??!1,this.maxDepth=(e==null?void 0:e.maxDepth)??H_,this.initialBufferSize=(e==null?void 0:e.initialBufferSize)??G_,this.sortKeys=(e==null?void 0:e.sortKeys)??!1,this.forceFloat32=(e==null?void 0:e.forceFloat32)??!1,this.ignoreUndefined=(e==null?void 0:e.ignoreUndefined)??!1,this.forceIntegerToFloat=(e==null?void 0:e.forceIntegerToFloat)??!1,this.pos=0,this.view=new DataView(new ArrayBuffer(this.initialBufferSize)),this.bytes=new Uint8Array(this.view.buffer)}clone(){return new s1({extensionCodec:this.extensionCodec,context:this.context,useBigInt64:this.useBigInt64,maxDepth:this.maxDepth,initialBufferSize:this.initialBufferSize,sortKeys:this.sortKeys,forceFloat32:this.forceFloat32,ignoreUndefined:this.ignoreUndefined,forceIntegerToFloat:this.forceIntegerToFloat})}reinitializeState(){this.pos=0}encodeSharedRef(e){if(this.entered)return this.clone().encodeSharedRef(e);try{return this.entered=!0,this.reinitializeState(),this.doEncode(e,1),this.bytes.subarray(0,this.pos)}finally{this.entered=!1}}encode(e){if(this.entered)return this.clone().encode(e);try{return this.entered=!0,this.reinitializeState(),this.doEncode(e,1),this.bytes.slice(0,this.pos)}finally{this.entered=!1}}doEncode(e,t){if(t>this.maxDepth)throw new Error(`Too deep objects in depth ${t}`);e==null?this.encodeNil():typeof e=="boolean"?this.encodeBoolean(e):typeof e=="number"?this.forceIntegerToFloat?this.encodeNumberAsFloat(e):this.encodeNumber(e):typeof e=="string"?this.encodeString(e):this.useBigInt64&&typeof e=="bigint"?this.encodeBigInt64(e):this.encodeObject(e,t)}ensureBufferSizeToWrite(e){const t=this.pos+e;this.view.byteLength<t&&this.resizeBuffer(t*2)}resizeBuffer(e){const t=new ArrayBuffer(e),n=new Uint8Array(t),s=new DataView(t);n.set(this.bytes),this.view=s,this.bytes=n}encodeNil(){this.writeU8(192)}encodeBoolean(e){e===!1?this.writeU8(194):this.writeU8(195)}encodeNumber(e){!this.forceIntegerToFloat&&Number.isSafeInteger(e)?e>=0?e<128?this.writeU8(e):e<256?(this.writeU8(204),this.writeU8(e)):e<65536?(this.writeU8(205),this.writeU16(e)):e<4294967296?(this.writeU8(206),this.writeU32(e)):this.useBigInt64?this.encodeNumberAsFloat(e):(this.writeU8(207),this.writeU64(e)):e>=-32?this.writeU8(224|e+32):e>=-128?(this.writeU8(208),this.writeI8(e)):e>=-32768?(this.writeU8(209),this.writeI16(e)):e>=-2147483648?(this.writeU8(210),this.writeI32(e)):this.useBigInt64?this.encodeNumberAsFloat(e):(this.writeU8(211),this.writeI64(e)):this.encodeNumberAsFloat(e)}encodeNumberAsFloat(e){this.forceFloat32?(this.writeU8(202),this.writeF32(e)):(this.writeU8(203),this.writeF64(e))}encodeBigInt64(e){e>=BigInt(0)?(this.writeU8(207),this.writeBigUint64(e)):(this.writeU8(211),this.writeBigInt64(e))}writeStringHeader(e){if(e<32)this.writeU8(160+e);else if(e<256)this.writeU8(217),this.writeU8(e);else if(e<65536)this.writeU8(218),this.writeU16(e);else if(e<4294967296)this.writeU8(219),this.writeU32(e);else throw new Error(`Too long string: ${e} bytes in UTF-8`)}encodeString(e){const n=A_(e);this.ensureBufferSizeToWrite(5+n),this.writeStringHeader(n),__(e,this.bytes,this.pos),this.pos+=n}encodeObject(e,t){const n=this.extensionCodec.tryToEncode(e,this.context);if(n!=null)this.encodeExtension(n);else if(Array.isArray(e))this.encodeArray(e,t);else if(ArrayBuffer.isView(e))this.encodeBinary(e);else if(typeof e=="object")this.encodeMap(e,t);else throw new Error(`Unrecognized object: ${Object.prototype.toString.apply(e)}`)}encodeBinary(e){const t=e.byteLength;if(t<256)this.writeU8(196),this.writeU8(t);else if(t<65536)this.writeU8(197),this.writeU16(t);else if(t<4294967296)this.writeU8(198),this.writeU32(t);else throw new Error(`Too large binary: ${t}`);const n=td(e);this.writeU8a(n)}encodeArray(e,t){const n=e.length;if(n<16)this.writeU8(144+n);else if(n<65536)this.writeU8(220),this.writeU16(n);else if(n<4294967296)this.writeU8(221),this.writeU32(n);else throw new Error(`Too large array: ${n}`);for(const s of e)this.doEncode(s,t+1)}countWithoutUndefined(e,t){let n=0;for(const s of t)e[s]!==void 0&&n++;return n}encodeMap(e,t){const n=Object.keys(e);this.sortKeys&&n.sort();const s=this.ignoreUndefined?this.countWithoutUndefined(e,n):n.length;if(s<16)this.writeU8(128+s);else if(s<65536)this.writeU8(222),this.writeU16(s);else if(s<4294967296)this.writeU8(223),this.writeU32(s);else throw new Error(`Too large map object: ${s}`);for(const i of n){const o=e[i];this.ignoreUndefined&&o===void 0||(this.encodeString(i),this.doEncode(o,t+1))}}encodeExtension(e){if(typeof e.data=="function"){const n=e.data(this.pos+6),s=n.length;if(s>=4294967296)throw new Error(`Too large extension object: ${s}`);this.writeU8(201),this.writeU32(s),this.writeI8(e.type),this.writeU8a(n);return}const t=e.data.length;if(t===1)this.writeU8(212);else if(t===2)this.writeU8(213);else if(t===4)this.writeU8(214);else if(t===8)this.writeU8(215);else if(t===16)this.writeU8(216);else if(t<256)this.writeU8(199),this.writeU8(t);else if(t<65536)this.writeU8(200),this.writeU16(t);else if(t<4294967296)this.writeU8(201),this.writeU32(t);else throw new Error(`Too large extension object: ${t}`);this.writeI8(e.type),this.writeU8a(e.data)}writeU8(e){this.ensureBufferSizeToWrite(1),this.view.setUint8(this.pos,e),this.pos++}writeU8a(e){const t=e.length;this.ensureBufferSizeToWrite(t),this.bytes.set(e,this.pos),this.pos+=t}writeI8(e){this.ensureBufferSizeToWrite(1),this.view.setInt8(this.pos,e),this.pos++}writeU16(e){this.ensureBufferSizeToWrite(2),this.view.setUint16(this.pos,e),this.pos+=2}writeI16(e){this.ensureBufferSizeToWrite(2),this.view.setInt16(this.pos,e),this.pos+=2}writeU32(e){this.ensureBufferSizeToWrite(4),this.view.setUint32(this.pos,e),this.pos+=4}writeI32(e){this.ensureBufferSizeToWrite(4),this.view.setInt32(this.pos,e),this.pos+=4}writeF32(e){this.ensureBufferSizeToWrite(4),this.view.setFloat32(this.pos,e),this.pos+=4}writeF64(e){this.ensureBufferSizeToWrite(8),this.view.setFloat64(this.pos,e),this.pos+=8}writeU64(e){this.ensureBufferSizeToWrite(8),T_(this.view,this.pos,e),this.pos+=8}writeI64(e){this.ensureBufferSizeToWrite(8),r1(this.view,this.pos,e),this.pos+=8}writeBigUint64(e){this.ensureBufferSizeToWrite(8),this.view.setBigUint64(this.pos,e),this.pos+=8}writeBigInt64(e){this.ensureBufferSizeToWrite(8),this.view.setBigInt64(this.pos,e),this.pos+=8}};function W_(r,e){return new Q_(e).encodeSharedRef(r)}function Nh(r){return`${r<0?"-":""}0x${Math.abs(r).toString(16).padStart(2,"0")}`}const J_=16,Y_=16;class Z_{constructor(e=J_,t=Y_){L(this,"hit",0);L(this,"miss",0);L(this,"caches");L(this,"maxKeyLength");L(this,"maxLengthPerKey");this.maxKeyLength=e,this.maxLengthPerKey=t,this.caches=[];for(let n=0;n<this.maxKeyLength;n++)this.caches.push([])}canBeCached(e){return e>0&&e<=this.maxKeyLength}find(e,t,n){const s=this.caches[n-1];e:for(const i of s){const o=i.bytes;for(let a=0;a<n;a++)if(o[a]!==e[t+a])continue e;return i.str}return null}store(e,t){const n=this.caches[e.length-1],s={bytes:e,str:t};n.length>=this.maxLengthPerKey?n[Math.random()*n.length|0]=s:n.push(s)}decode(e,t,n){const s=this.find(e,t,n);if(s!=null)return this.hit++,s;this.miss++;const i=t1(e,t,n),o=Uint8Array.prototype.slice.call(e,t,t+n);return this.store(o,i),i}}const rd="array",ka="map_key",i1="map_value",X_=r=>{if(typeof r=="string"||typeof r=="number")return r;throw new tr("The type of key must be string or number but "+typeof r)};class eN{constructor(){L(this,"stack",[]);L(this,"stackHeadPosition",-1)}get length(){return this.stackHeadPosition+1}top(){return this.stack[this.stackHeadPosition]}pushArrayState(e){const t=this.getUninitializedStateFromPool();t.type=rd,t.position=0,t.size=e,t.array=new Array(e)}pushMapState(e){const t=this.getUninitializedStateFromPool();t.type=ka,t.readCount=0,t.size=e,t.map={}}getUninitializedStateFromPool(){if(this.stackHeadPosition++,this.stackHeadPosition===this.stack.length){const e={type:void 0,size:0,array:void 0,position:0,readCount:0,map:void 0,key:null};this.stack.push(e)}return this.stack[this.stackHeadPosition]}release(e){if(this.stack[this.stackHeadPosition]!==e)throw new Error("Invalid stack state. Released state is not on top of the stack.");if(e.type===rd){const n=e;n.size=0,n.array=void 0,n.position=0,n.type=void 0}if(e.type===ka||e.type===i1){const n=e;n.size=0,n.map=void 0,n.readCount=0,n.type=void 0}this.stackHeadPosition--}reset(){this.stack.length=0,this.stackHeadPosition=-1}}const ya=-1,hp=new DataView(new ArrayBuffer(0)),tN=new Uint8Array(hp.buffer);try{hp.getInt8(0)}catch(r){if(!(r instanceof RangeError))throw new Error("This module is not supported in the current JavaScript engine because DataView does not throw RangeError on out-of-bounds access")}const Fy=new RangeError("Insufficient data"),rN=new Z_;let nN=class o1{constructor(e){L(this,"extensionCodec");L(this,"context");L(this,"useBigInt64");L(this,"rawStrings");L(this,"maxStrLength");L(this,"maxBinLength");L(this,"maxArrayLength");L(this,"maxMapLength");L(this,"maxExtLength");L(this,"keyDecoder");L(this,"mapKeyConverter");L(this,"totalPos",0);L(this,"pos",0);L(this,"view",hp);L(this,"bytes",tN);L(this,"headByte",ya);L(this,"stack",new eN);L(this,"entered",!1);this.extensionCodec=(e==null?void 0:e.extensionCodec)??Jl.defaultCodec,this.context=e==null?void 0:e.context,this.useBigInt64=(e==null?void 0:e.useBigInt64)??!1,this.rawStrings=(e==null?void 0:e.rawStrings)??!1,this.maxStrLength=(e==null?void 0:e.maxStrLength)??ga,this.maxBinLength=(e==null?void 0:e.maxBinLength)??ga,this.maxArrayLength=(e==null?void 0:e.maxArrayLength)??ga,this.maxMapLength=(e==null?void 0:e.maxMapLength)??ga,this.maxExtLength=(e==null?void 0:e.maxExtLength)??ga,this.keyDecoder=(e==null?void 0:e.keyDecoder)!==void 0?e.keyDecoder:rN,this.mapKeyConverter=(e==null?void 0:e.mapKeyConverter)??X_}clone(){return new o1({extensionCodec:this.extensionCodec,context:this.context,useBigInt64:this.useBigInt64,rawStrings:this.rawStrings,maxStrLength:this.maxStrLength,maxBinLength:this.maxBinLength,maxArrayLength:this.maxArrayLength,maxMapLength:this.maxMapLength,maxExtLength:this.maxExtLength,keyDecoder:this.keyDecoder})}reinitializeState(){this.totalPos=0,this.headByte=ya,this.stack.reset()}setBuffer(e){const t=td(e);this.bytes=t,this.view=new DataView(t.buffer,t.byteOffset,t.byteLength),this.pos=0}appendBuffer(e){if(this.headByte===ya&&!this.hasRemaining(1))this.setBuffer(e);else{const t=this.bytes.subarray(this.pos),n=td(e),s=new Uint8Array(t.length+n.length);s.set(t),s.set(n,t.length),this.setBuffer(s)}}hasRemaining(e){return this.view.byteLength-this.pos>=e}createExtraByteError(e){const{view:t,pos:n}=this;return new RangeError(`Extra ${t.byteLength-n} of ${t.byteLength} byte(s) found at buffer[${e}]`)}decode(e){if(this.entered)return this.clone().decode(e);try{this.entered=!0,this.reinitializeState(),this.setBuffer(e);const t=this.doDecodeSync();if(this.hasRemaining(1))throw this.createExtraByteError(this.pos);return t}finally{this.entered=!1}}*decodeMulti(e){if(this.entered){yield*this.clone().decodeMulti(e);return}try{for(this.entered=!0,this.reinitializeState(),this.setBuffer(e);this.hasRemaining(1);)yield this.doDecodeSync()}finally{this.entered=!1}}async decodeAsync(e){if(this.entered)return this.clone().decodeAsync(e);try{this.entered=!0;let t=!1,n;for await(const a of e){if(t)throw this.entered=!1,this.createExtraByteError(this.totalPos);this.appendBuffer(a);try{n=this.doDecodeSync(),t=!0}catch(c){if(!(c instanceof RangeError))throw c}this.totalPos+=this.pos}if(t){if(this.hasRemaining(1))throw this.createExtraByteError(this.totalPos);return n}const{headByte:s,pos:i,totalPos:o}=this;throw new RangeError(`Insufficient data in parsing ${Nh(s)} at ${o} (${i} in the current buffer)`)}finally{this.entered=!1}}decodeArrayStream(e){return this.decodeMultiAsync(e,!0)}decodeStream(e){return this.decodeMultiAsync(e,!1)}async*decodeMultiAsync(e,t){if(this.entered){yield*this.clone().decodeMultiAsync(e,t);return}try{this.entered=!0;let n=t,s=-1;for await(const i of e){if(t&&s===0)throw this.createExtraByteError(this.totalPos);this.appendBuffer(i),n&&(s=this.readArraySize(),n=!1,this.complete());try{for(;yield this.doDecodeSync(),--s!==0;);}catch(o){if(!(o instanceof RangeError))throw o}this.totalPos+=this.pos}}finally{this.entered=!1}}doDecodeSync(){e:for(;;){const e=this.readHeadByte();let t;if(e>=224)t=e-256;else if(e<192)if(e<128)t=e;else if(e<144){const s=e-128;if(s!==0){this.pushMapState(s),this.complete();continue e}else t={}}else if(e<160){const s=e-144;if(s!==0){this.pushArrayState(s),this.complete();continue e}else t=[]}else{const s=e-160;t=this.decodeString(s,0)}else if(e===192)t=null;else if(e===194)t=!1;else if(e===195)t=!0;else if(e===202)t=this.readF32();else if(e===203)t=this.readF64();else if(e===204)t=this.readU8();else if(e===205)t=this.readU16();else if(e===206)t=this.readU32();else if(e===207)this.useBigInt64?t=this.readU64AsBigInt():t=this.readU64();else if(e===208)t=this.readI8();else if(e===209)t=this.readI16();else if(e===210)t=this.readI32();else if(e===211)this.useBigInt64?t=this.readI64AsBigInt():t=this.readI64();else if(e===217){const s=this.lookU8();t=this.decodeString(s,1)}else if(e===218){const s=this.lookU16();t=this.decodeString(s,2)}else if(e===219){const s=this.lookU32();t=this.decodeString(s,4)}else if(e===220){const s=this.readU16();if(s!==0){this.pushArrayState(s),this.complete();continue e}else t=[]}else if(e===221){const s=this.readU32();if(s!==0){this.pushArrayState(s),this.complete();continue e}else t=[]}else if(e===222){const s=this.readU16();if(s!==0){this.pushMapState(s),this.complete();continue e}else t={}}else if(e===223){const s=this.readU32();if(s!==0){this.pushMapState(s),this.complete();continue e}else t={}}else if(e===196){const s=this.lookU8();t=this.decodeBinary(s,1)}else if(e===197){const s=this.lookU16();t=this.decodeBinary(s,2)}else if(e===198){const s=this.lookU32();t=this.decodeBinary(s,4)}else if(e===212)t=this.decodeExtension(1,0);else if(e===213)t=this.decodeExtension(2,0);else if(e===214)t=this.decodeExtension(4,0);else if(e===215)t=this.decodeExtension(8,0);else if(e===216)t=this.decodeExtension(16,0);else if(e===199){const s=this.lookU8();t=this.decodeExtension(s,1)}else if(e===200){const s=this.lookU16();t=this.decodeExtension(s,2)}else if(e===201){const s=this.lookU32();t=this.decodeExtension(s,4)}else throw new tr(`Unrecognized type byte: ${Nh(e)}`);this.complete();const n=this.stack;for(;n.length>0;){const s=n.top();if(s.type===rd)if(s.array[s.position]=t,s.position++,s.position===s.size)t=s.array,n.release(s);else continue e;else if(s.type===ka){if(t==="__proto__")throw new tr("The key __proto__ is not allowed");s.key=this.mapKeyConverter(t),s.type=i1;continue e}else if(s.map[s.key]=t,s.readCount++,s.readCount===s.size)t=s.map,n.release(s);else{s.key=null,s.type=ka;continue e}}return t}}readHeadByte(){return this.headByte===ya&&(this.headByte=this.readU8()),this.headByte}complete(){this.headByte=ya}readArraySize(){const e=this.readHeadByte();switch(e){case 220:return this.readU16();case 221:return this.readU32();default:{if(e<160)return e-144;throw new tr(`Unrecognized array type byte: ${Nh(e)}`)}}}pushMapState(e){if(e>this.maxMapLength)throw new tr(`Max length exceeded: map length (${e}) > maxMapLengthLength (${this.maxMapLength})`);this.stack.pushMapState(e)}pushArrayState(e){if(e>this.maxArrayLength)throw new tr(`Max length exceeded: array length (${e}) > maxArrayLength (${this.maxArrayLength})`);this.stack.pushArrayState(e)}decodeString(e,t){return!this.rawStrings||this.stateIsMapKey()?this.decodeUtf8String(e,t):this.decodeBinary(e,t)}decodeUtf8String(e,t){var i;if(e>this.maxStrLength)throw new tr(`Max length exceeded: UTF-8 byte length (${e}) > maxStrLength (${this.maxStrLength})`);if(this.bytes.byteLength<this.pos+t+e)throw Fy;const n=this.pos+t;let s;return this.stateIsMapKey()&&((i=this.keyDecoder)!=null&&i.canBeCached(e))?s=this.keyDecoder.decode(this.bytes,n,e):s=P_(this.bytes,n,e),this.pos+=t+e,s}stateIsMapKey(){return this.stack.length>0?this.stack.top().type===ka:!1}decodeBinary(e,t){if(e>this.maxBinLength)throw new tr(`Max length exceeded: bin length (${e}) > maxBinLength (${this.maxBinLength})`);if(!this.hasRemaining(e+t))throw Fy;const n=this.pos+t,s=this.bytes.subarray(n,n+e);return this.pos+=t+e,s}decodeExtension(e,t){if(e>this.maxExtLength)throw new tr(`Max length exceeded: ext length (${e}) > maxExtLength (${this.maxExtLength})`);const n=this.view.getInt8(this.pos+t),s=this.decodeBinary(e,t+1);return this.extensionCodec.decode(s,n,this.context)}lookU8(){return this.view.getUint8(this.pos)}lookU16(){return this.view.getUint16(this.pos)}lookU32(){return this.view.getUint32(this.pos)}readU8(){const e=this.view.getUint8(this.pos);return this.pos++,e}readI8(){const e=this.view.getInt8(this.pos);return this.pos++,e}readU16(){const e=this.view.getUint16(this.pos);return this.pos+=2,e}readI16(){const e=this.view.getInt16(this.pos);return this.pos+=2,e}readU32(){const e=this.view.getUint32(this.pos);return this.pos+=4,e}readI32(){const e=this.view.getInt32(this.pos);return this.pos+=4,e}readU64(){const e=k_(this.view,this.pos);return this.pos+=8,e}readI64(){const e=n1(this.view,this.pos);return this.pos+=8,e}readU64AsBigInt(){const e=this.view.getBigUint64(this.pos);return this.pos+=8,e}readI64AsBigInt(){const e=this.view.getBigInt64(this.pos);return this.pos+=8,e}readF32(){const e=this.view.getFloat32(this.pos);return this.pos+=4,e}readF64(){const e=this.view.getFloat64(this.pos);return this.pos+=8,e}};function sN(r,e){return new nN(e).decode(r)}function fp(r){return globalThis.Buffer!=null?new Uint8Array(r.buffer,r.byteOffset,r.byteLength):r}function a1(r=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?fp(globalThis.Buffer.allocUnsafe(r)):new Uint8Array(r)}function Ua(r,e){e||(e=r.reduce((s,i)=>s+i.length,0));const t=a1(e);let n=0;for(const s of r)t.set(s,n),n+=s.length;return fp(t)}function iN(r,e){if(r.length>=255)throw new TypeError("Alphabet too long");for(var t=new Uint8Array(256),n=0;n<t.length;n++)t[n]=255;for(var s=0;s<r.length;s++){var i=r.charAt(s),o=i.charCodeAt(0);if(t[o]!==255)throw new TypeError(i+" is ambiguous");t[o]=s}var a=r.length,c=r.charAt(0),l=Math.log(a)/Math.log(256),u=Math.log(256)/Math.log(a);function h(p){if(p instanceof Uint8Array||(ArrayBuffer.isView(p)?p=new Uint8Array(p.buffer,p.byteOffset,p.byteLength):Array.isArray(p)&&(p=Uint8Array.from(p))),!(p instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(p.length===0)return"";for(var g=0,m=0,E=0,O=p.length;E!==O&&p[E]===0;)E++,g++;for(var x=(O-E)*u+1>>>0,b=new Uint8Array(x);E!==O;){for(var v=p[E],S=0,D=x-1;(v!==0||S<m)&&D!==-1;D--,S++)v+=256*b[D]>>>0,b[D]=v%a>>>0,v=v/a>>>0;if(v!==0)throw new Error("Non-zero carry");m=S,E++}for(var R=x-m;R!==x&&b[R]===0;)R++;for(var _=c.repeat(g);R<x;++R)_+=r.charAt(b[R]);return _}function f(p){if(typeof p!="string")throw new TypeError("Expected String");if(p.length===0)return new Uint8Array;var g=0;if(p[g]!==" "){for(var m=0,E=0;p[g]===c;)m++,g++;for(var O=(p.length-g)*l+1>>>0,x=new Uint8Array(O);p[g];){var b=t[p.charCodeAt(g)];if(b===255)return;for(var v=0,S=O-1;(b!==0||v<E)&&S!==-1;S--,v++)b+=a*x[S]>>>0,x[S]=b%256>>>0,b=b/256>>>0;if(b!==0)throw new Error("Non-zero carry");E=v,g++}if(p[g]!==" "){for(var D=O-E;D!==O&&x[D]===0;)D++;for(var R=new Uint8Array(m+(O-D)),_=m;D!==O;)R[_++]=x[D++];return R}}}function d(p){var g=f(p);if(g)return g;throw new Error(`Non-${e} character`)}return{encode:h,decodeUnsafe:f,decode:d}}var oN=iN,aN=oN;const cN=r=>{if(r instanceof Uint8Array&&r.constructor.name==="Uint8Array")return r;if(r instanceof ArrayBuffer)return new Uint8Array(r);if(ArrayBuffer.isView(r))return new Uint8Array(r.buffer,r.byteOffset,r.byteLength);throw new Error("Unknown type, must be binary type")},lN=r=>new TextEncoder().encode(r),uN=r=>new TextDecoder().decode(r);class hN{constructor(e,t,n){this.name=e,this.prefix=t,this.baseEncode=n}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class fN{constructor(e,t,n){if(this.name=e,this.prefix=t,t.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=n}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return c1(this,e)}}class dN{constructor(e){this.decoders=e}or(e){return c1(this,e)}decode(e){const t=e[0],n=this.decoders[t];if(n)return n.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const c1=(r,e)=>new dN({...r.decoders||{[r.prefix]:r},...e.decoders||{[e.prefix]:e}});class pN{constructor(e,t,n,s){this.name=e,this.prefix=t,this.baseEncode=n,this.baseDecode=s,this.encoder=new hN(e,t,n),this.decoder=new fN(e,t,s)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const Cu=({name:r,prefix:e,encode:t,decode:n})=>new pN(r,e,t,n),Dc=({prefix:r,name:e,alphabet:t})=>{const{encode:n,decode:s}=aN(t,e);return Cu({prefix:r,name:e,encode:n,decode:i=>cN(s(i))})},gN=(r,e,t,n)=>{const s={};for(let u=0;u<e.length;++u)s[e[u]]=u;let i=r.length;for(;r[i-1]==="=";)--i;const o=new Uint8Array(i*t/8|0);let a=0,c=0,l=0;for(let u=0;u<i;++u){const h=s[r[u]];if(h===void 0)throw new SyntaxError(`Non-${n} character`);c=c<<t|h,a+=t,a>=8&&(a-=8,o[l++]=255&c>>a)}if(a>=t||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return o},yN=(r,e,t)=>{const n=e[e.length-1]==="=",s=(1<<t)-1;let i="",o=0,a=0;for(let c=0;c<r.length;++c)for(a=a<<8|r[c],o+=8;o>t;)o-=t,i+=e[s&a>>o];if(o&&(i+=e[s&a<<t-o]),n)for(;i.length*t&7;)i+="=";return i},ut=({name:r,prefix:e,bitsPerChar:t,alphabet:n})=>Cu({prefix:e,name:r,encode(s){return yN(s,n,t)},decode(s){return gN(s,n,t,r)}}),mN=Cu({prefix:"\0",name:"identity",encode:r=>uN(r),decode:r=>lN(r)}),wN=Object.freeze(Object.defineProperty({__proto__:null,identity:mN},Symbol.toStringTag,{value:"Module"})),bN=ut({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1}),xN=Object.freeze(Object.defineProperty({__proto__:null,base2:bN},Symbol.toStringTag,{value:"Module"})),vN=ut({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3}),EN=Object.freeze(Object.defineProperty({__proto__:null,base8:vN},Symbol.toStringTag,{value:"Module"})),AN=Dc({prefix:"9",name:"base10",alphabet:"0123456789"}),IN=Object.freeze(Object.defineProperty({__proto__:null,base10:AN},Symbol.toStringTag,{value:"Module"})),SN=ut({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),ON=ut({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4}),DN=Object.freeze(Object.defineProperty({__proto__:null,base16:SN,base16upper:ON},Symbol.toStringTag,{value:"Module"})),_N=ut({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),NN=ut({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),CN=ut({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),BN=ut({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),RN=ut({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),PN=ut({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),TN=ut({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),kN=ut({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),UN=ut({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),$N=Object.freeze(Object.defineProperty({__proto__:null,base32:_N,base32hex:RN,base32hexpad:TN,base32hexpadupper:kN,base32hexupper:PN,base32pad:CN,base32padupper:BN,base32upper:NN,base32z:UN},Symbol.toStringTag,{value:"Module"})),FN=Dc({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),LN=Dc({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"}),jN=Object.freeze(Object.defineProperty({__proto__:null,base36:FN,base36upper:LN},Symbol.toStringTag,{value:"Module"})),MN=Dc({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),zN=Dc({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),qN=Object.freeze(Object.defineProperty({__proto__:null,base58btc:MN,base58flickr:zN},Symbol.toStringTag,{value:"Module"})),VN=ut({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),KN=ut({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),HN=ut({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),GN=ut({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6}),QN=Object.freeze(Object.defineProperty({__proto__:null,base64:VN,base64pad:KN,base64url:HN,base64urlpad:GN},Symbol.toStringTag,{value:"Module"})),l1=Array.from(""),WN=l1.reduce((r,e,t)=>(r[t]=e,r),[]),JN=l1.reduce((r,e,t)=>(r[e.codePointAt(0)]=t,r),[]);function YN(r){return r.reduce((e,t)=>(e+=WN[t],e),"")}function ZN(r){const e=[];for(const t of r){const n=JN[t.codePointAt(0)];if(n===void 0)throw new Error(`Non-base256emoji character: ${t}`);e.push(n)}return new Uint8Array(e)}const XN=Cu({prefix:"",name:"base256emoji",encode:YN,decode:ZN}),e4=Object.freeze(Object.defineProperty({__proto__:null,base256emoji:XN},Symbol.toStringTag,{value:"Module"}));new TextEncoder;new TextDecoder;const Ly={...wN,...xN,...EN,...IN,...DN,...$N,...jN,...qN,...QN,...e4};function u1(r,e,t,n){return{name:r,prefix:e,encoder:{name:r,prefix:e,encode:t},decoder:{decode:n}}}const jy=u1("utf8","u",r=>"u"+new TextDecoder("utf8").decode(r),r=>new TextEncoder().encode(r.substring(1))),Ch=u1("ascii","a",r=>{let e="a";for(let t=0;t<r.length;t++)e+=String.fromCharCode(r[t]);return e},r=>{r=r.substring(1);const e=a1(r.length);for(let t=0;t<r.length;t++)e[t]=r.charCodeAt(t);return e}),h1={utf8:jy,"utf-8":jy,hex:Ly.base16,latin1:Ch,ascii:Ch,binary:Ch,...Ly};function wr(r,e="utf8"){const t=h1[e];if(!t)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?fp(globalThis.Buffer.from(r,"utf-8")):t.decoder.decode(`${t.prefix}${r}`)}function Vt(r,e="utf8"){const t=h1[e];if(!t)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(r.buffer,r.byteOffset,r.byteLength).toString("utf8"):t.encoder.encode(r).substring(1)}const t4={waku:{publish:"waku_publish",batchPublish:"waku_batchPublish",subscribe:"waku_subscribe",batchSubscribe:"waku_batchSubscribe",subscription:"waku_subscription",unsubscribe:"waku_unsubscribe",batchUnsubscribe:"waku_batchUnsubscribe",batchFetchMessages:"waku_batchFetchMessages"},irn:{publish:"irn_publish",batchPublish:"irn_batchPublish",subscribe:"irn_subscribe",batchSubscribe:"irn_batchSubscribe",subscription:"irn_subscription",unsubscribe:"irn_unsubscribe",batchUnsubscribe:"irn_batchUnsubscribe",batchFetchMessages:"irn_batchFetchMessages"},iridium:{publish:"iridium_publish",batchPublish:"iridium_batchPublish",subscribe:"iridium_subscribe",batchSubscribe:"iridium_batchSubscribe",subscription:"iridium_subscription",unsubscribe:"iridium_unsubscribe",batchUnsubscribe:"iridium_batchUnsubscribe",batchFetchMessages:"iridium_batchFetchMessages"}};var Bh,My;function f1(){if(My)return Bh;My=1;const r="Input must be an string, Buffer or Uint8Array";function e(o){let a;if(o instanceof Uint8Array)a=o;else if(typeof o=="string")a=new TextEncoder().encode(o);else throw new Error(r);return a}function t(o){return Array.prototype.map.call(o,function(a){return(a<16?"0":"")+a.toString(16)}).join("")}function n(o){return(4294967296+o).toString(16).substring(1)}function s(o,a,c){let l=`
`+o+" = ";for(let u=0;u<a.length;u+=2){if(c===32)l+=n(a[u]).toUpperCase(),l+=" ",l+=n(a[u+1]).toUpperCase();else if(c===64)l+=n(a[u+1]).toUpperCase(),l+=n(a[u]).toUpperCase();else throw new Error("Invalid size "+c);u%6===4?l+=`
`+new Array(o.length+4).join(" "):u<a.length-2&&(l+=" ")}console.log(l)}function i(o,a,c){let l=new Date().getTime();const u=new Uint8Array(a);for(let f=0;f<a;f++)u[f]=f%256;const h=new Date().getTime();console.log("Generated random input in "+(h-l)+"ms"),l=h;for(let f=0;f<c;f++){const d=o(u),p=new Date().getTime(),g=p-l;l=p,console.log("Hashed in "+g+"ms: "+d.substring(0,20)+"..."),console.log(Math.round(a/(1<<20)/(g/1e3)*100)/100+" MB PER SECOND")}}return Bh={normalizeInput:e,toHex:t,debugPrint:s,testSpeed:i},Bh}var Rh,zy;function r4(){if(zy)return Rh;zy=1;const r=f1();function e(E,O,x){const b=E[O]+E[x];let v=E[O+1]+E[x+1];b>=4294967296&&v++,E[O]=b,E[O+1]=v}function t(E,O,x,b){let v=E[O]+x;x<0&&(v+=4294967296);let S=E[O+1]+b;v>=4294967296&&S++,E[O]=v,E[O+1]=S}function n(E,O){return E[O]^E[O+1]<<8^E[O+2]<<16^E[O+3]<<24}function s(E,O,x,b,v,S){const D=l[v],R=l[v+1],_=l[S],F=l[S+1];e(c,E,O),t(c,E,D,R);let j=c[b]^c[E],$=c[b+1]^c[E+1];c[b]=$,c[b+1]=j,e(c,x,b),j=c[O]^c[x],$=c[O+1]^c[x+1],c[O]=j>>>24^$<<8,c[O+1]=$>>>24^j<<8,e(c,E,O),t(c,E,_,F),j=c[b]^c[E],$=c[b+1]^c[E+1],c[b]=j>>>16^$<<16,c[b+1]=$>>>16^j<<16,e(c,x,b),j=c[O]^c[x],$=c[O+1]^c[x+1],c[O]=$>>>31^j<<1,c[O+1]=j>>>31^$<<1}const i=new Uint32Array([4089235720,1779033703,2227873595,3144134277,4271175723,1013904242,1595750129,2773480762,2917565137,1359893119,725511199,2600822924,4215389547,528734635,327033209,1541459225]),o=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3,11,8,12,0,5,2,15,13,10,14,3,6,7,1,9,4,7,9,3,1,13,12,11,14,2,6,5,10,4,0,15,8,9,0,5,7,2,4,10,15,14,1,11,12,6,8,3,13,2,12,6,10,0,11,8,3,4,13,7,5,15,14,1,9,12,5,1,15,14,13,4,10,0,7,6,3,9,2,8,11,13,11,7,14,12,1,3,9,5,0,15,4,8,6,2,10,6,15,14,9,11,3,0,8,12,2,13,7,1,4,10,5,10,2,8,4,7,6,1,5,15,11,9,14,3,12,13,0,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3],a=new Uint8Array(o.map(function(E){return E*2})),c=new Uint32Array(32),l=new Uint32Array(32);function u(E,O){let x=0;for(x=0;x<16;x++)c[x]=E.h[x],c[x+16]=i[x];for(c[24]=c[24]^E.t,c[25]=c[25]^E.t/4294967296,O&&(c[28]=~c[28],c[29]=~c[29]),x=0;x<32;x++)l[x]=n(E.b,4*x);for(x=0;x<12;x++)s(0,8,16,24,a[x*16+0],a[x*16+1]),s(2,10,18,26,a[x*16+2],a[x*16+3]),s(4,12,20,28,a[x*16+4],a[x*16+5]),s(6,14,22,30,a[x*16+6],a[x*16+7]),s(0,10,20,30,a[x*16+8],a[x*16+9]),s(2,12,22,24,a[x*16+10],a[x*16+11]),s(4,14,16,26,a[x*16+12],a[x*16+13]),s(6,8,18,28,a[x*16+14],a[x*16+15]);for(x=0;x<16;x++)E.h[x]=E.h[x]^c[x]^c[x+16]}const h=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]);function f(E,O,x,b){if(E===0||E>64)throw new Error("Illegal output length, expected 0 < length <= 64");if(O&&O.length>64)throw new Error("Illegal key, expected Uint8Array with 0 < length <= 64");if(x&&x.length!==16)throw new Error("Illegal salt, expected Uint8Array with length is 16");if(b&&b.length!==16)throw new Error("Illegal personal, expected Uint8Array with length is 16");const v={b:new Uint8Array(128),h:new Uint32Array(16),t:0,c:0,outlen:E};h.fill(0),h[0]=E,O&&(h[1]=O.length),h[2]=1,h[3]=1,x&&h.set(x,32),b&&h.set(b,48);for(let S=0;S<16;S++)v.h[S]=i[S]^n(h,S*4);return O&&(d(v,O),v.c=128),v}function d(E,O){for(let x=0;x<O.length;x++)E.c===128&&(E.t+=E.c,u(E,!1),E.c=0),E.b[E.c++]=O[x]}function p(E){for(E.t+=E.c;E.c<128;)E.b[E.c++]=0;u(E,!0);const O=new Uint8Array(E.outlen);for(let x=0;x<E.outlen;x++)O[x]=E.h[x>>2]>>8*(x&3);return O}function g(E,O,x,b,v){x=x||64,E=r.normalizeInput(E),b&&(b=r.normalizeInput(b)),v&&(v=r.normalizeInput(v));const S=f(x,O,b,v);return d(S,E),p(S)}function m(E,O,x,b,v){const S=g(E,O,x,b,v);return r.toHex(S)}return Rh={blake2b:g,blake2bHex:m,blake2bInit:f,blake2bUpdate:d,blake2bFinal:p},Rh}var Ph,qy;function n4(){if(qy)return Ph;qy=1;const r=f1();function e(p,g){return p[g]^p[g+1]<<8^p[g+2]<<16^p[g+3]<<24}function t(p,g,m,E,O,x){o[p]=o[p]+o[g]+O,o[E]=n(o[E]^o[p],16),o[m]=o[m]+o[E],o[g]=n(o[g]^o[m],12),o[p]=o[p]+o[g]+x,o[E]=n(o[E]^o[p],8),o[m]=o[m]+o[E],o[g]=n(o[g]^o[m],7)}function n(p,g){return p>>>g^p<<32-g}const s=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),i=new Uint8Array([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3,11,8,12,0,5,2,15,13,10,14,3,6,7,1,9,4,7,9,3,1,13,12,11,14,2,6,5,10,4,0,15,8,9,0,5,7,2,4,10,15,14,1,11,12,6,8,3,13,2,12,6,10,0,11,8,3,4,13,7,5,15,14,1,9,12,5,1,15,14,13,4,10,0,7,6,3,9,2,8,11,13,11,7,14,12,1,3,9,5,0,15,4,8,6,2,10,6,15,14,9,11,3,0,8,12,2,13,7,1,4,10,5,10,2,8,4,7,6,1,5,15,11,9,14,3,12,13,0]),o=new Uint32Array(16),a=new Uint32Array(16);function c(p,g){let m=0;for(m=0;m<8;m++)o[m]=p.h[m],o[m+8]=s[m];for(o[12]^=p.t,o[13]^=p.t/4294967296,g&&(o[14]=~o[14]),m=0;m<16;m++)a[m]=e(p.b,4*m);for(m=0;m<10;m++)t(0,4,8,12,a[i[m*16+0]],a[i[m*16+1]]),t(1,5,9,13,a[i[m*16+2]],a[i[m*16+3]]),t(2,6,10,14,a[i[m*16+4]],a[i[m*16+5]]),t(3,7,11,15,a[i[m*16+6]],a[i[m*16+7]]),t(0,5,10,15,a[i[m*16+8]],a[i[m*16+9]]),t(1,6,11,12,a[i[m*16+10]],a[i[m*16+11]]),t(2,7,8,13,a[i[m*16+12]],a[i[m*16+13]]),t(3,4,9,14,a[i[m*16+14]],a[i[m*16+15]]);for(m=0;m<8;m++)p.h[m]^=o[m]^o[m+8]}function l(p,g){if(!(p>0&&p<=32))throw new Error("Incorrect output length, should be in [1, 32]");const m=g?g.length:0;if(g&&!(m>0&&m<=32))throw new Error("Incorrect key length, should be in [1, 32]");const E={h:new Uint32Array(s),b:new Uint8Array(64),c:0,t:0,outlen:p};return E.h[0]^=16842752^m<<8^p,m>0&&(u(E,g),E.c=64),E}function u(p,g){for(let m=0;m<g.length;m++)p.c===64&&(p.t+=p.c,c(p,!1),p.c=0),p.b[p.c++]=g[m]}function h(p){for(p.t+=p.c;p.c<64;)p.b[p.c++]=0;c(p,!0);const g=new Uint8Array(p.outlen);for(let m=0;m<p.outlen;m++)g[m]=p.h[m>>2]>>8*(m&3)&255;return g}function f(p,g,m){m=m||32,p=r.normalizeInput(p);const E=l(m,g);return u(E,p),h(E)}function d(p,g,m){const E=f(p,g,m);return r.toHex(E)}return Ph={blake2s:f,blake2sHex:d,blake2sInit:l,blake2sUpdate:u,blake2sFinal:h},Ph}var Th,Vy;function s4(){if(Vy)return Th;Vy=1;const r=r4(),e=n4();return Th={blake2b:r.blake2b,blake2bHex:r.blake2bHex,blake2bInit:r.blake2bInit,blake2bUpdate:r.blake2bUpdate,blake2bFinal:r.blake2bFinal,blake2s:e.blake2s,blake2sHex:e.blake2sHex,blake2sInit:e.blake2sInit,blake2sUpdate:e.blake2sUpdate,blake2sFinal:e.blake2sFinal},Th}var i4=s4(),o4={};const a4=":";function El(r){const[e,t]=r.split(a4);return{namespace:e,reference:t}}function d1(r,e){return r.includes(":")?[r]:e.chains||[]}var c4=Object.defineProperty,l4=Object.defineProperties,u4=Object.getOwnPropertyDescriptors,Ky=Object.getOwnPropertySymbols,h4=Object.prototype.hasOwnProperty,f4=Object.prototype.propertyIsEnumerable,nd=(r,e,t)=>e in r?c4(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,Hy=(r,e)=>{for(var t in e||(e={}))h4.call(e,t)&&nd(r,t,e[t]);if(Ky)for(var t of Ky(e))f4.call(e,t)&&nd(r,t,e[t]);return r},d4=(r,e)=>l4(r,u4(e)),Gy=(r,e,t)=>nd(r,typeof e!="symbol"?e+"":e,t);const p4="ReactNative",sr={reactNative:"react-native",node:"node",browser:"browser",unknown:"unknown"},g4="js";function Yl(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}function js(){return!Kn.getDocument()&&!!Kn.getNavigator()&&navigator.product===p4}function y4(){return js()&&typeof global<"u"&&typeof(global==null?void 0:global.Platform)<"u"&&(global==null?void 0:global.Platform.OS)==="android"}function m4(){return js()&&typeof global<"u"&&typeof(global==null?void 0:global.Platform)<"u"&&(global==null?void 0:global.Platform.OS)==="ios"}function ra(){return!Yl()&&!!Kn.getNavigator()&&!!Kn.getDocument()}function _c(){return js()?sr.reactNative:Yl()?sr.node:ra()?sr.browser:sr.unknown}function Qy(){var r;try{return js()&&typeof global<"u"&&typeof(global==null?void 0:global.Application)<"u"?(r=global.Application)==null?void 0:r.applicationId:void 0}catch{return}}function w4(r,e){const t=new URLSearchParams(r);return Object.entries(e).sort(([n],[s])=>n.localeCompare(s)).forEach(([n,s])=>{s!=null&&t.set(n,String(s))}),t.toString()}function b4(r){var e,t;const n=p1();try{return r!=null&&r.url&&n.url&&new URL(r.url).host!==new URL(n.url).host&&(console.warn(`The configured WalletConnect 'metadata.url':${r.url} differs from the actual page url:${n.url}. This is probably unintended and can lead to issues.`),r.url=n.url),(e=r==null?void 0:r.icons)!=null&&e.length&&r.icons.length>0&&(r.icons=r.icons.filter(s=>s!=="")),d4(Hy(Hy({},n),r),{url:(r==null?void 0:r.url)||n.url,name:(r==null?void 0:r.name)||n.name,description:(r==null?void 0:r.description)||n.description,icons:(t=r==null?void 0:r.icons)!=null&&t.length&&r.icons.length>0?r.icons:n.icons})}catch(s){return console.warn("Error populating app metadata",s),r||n}}function p1(){return bO.getWindowMetadata()||{name:"",description:"",url:"",icons:[""]}}function x4(){if(_c()===sr.reactNative&&typeof global<"u"&&typeof(global==null?void 0:global.Platform)<"u"){const{OS:t,Version:n}=global.Platform;return[t,n].join("-")}const r=fO();if(r===null)return"unknown";const e=r.os?r.os.replace(" ","").toLowerCase():"unknown";return r.type==="browser"?[e,r.name,r.version].join("-"):[e,r.version].join("-")}function v4(){var r;const e=_c();return e===sr.browser?[e,((r=Kn.getLocation())==null?void 0:r.host)||"unknown"].join(":"):e}function g1(r,e,t){const n=x4(),s=v4();return[[r,e].join("-"),[g4,t].join("-"),n,s].join("/")}function E4({protocol:r,version:e,relayUrl:t,sdkVersion:n,auth:s,projectId:i,useOnCloseEvent:o,bundleId:a,packageName:c}){const l=t.split("?"),u=g1(r,e,n),h={auth:s,ua:u,projectId:i,useOnCloseEvent:o,packageName:c||void 0,bundleId:a||void 0},f=w4(l[1]||"",h);return l[0]+"?"+f}function ii(r,e){return r.filter(t=>e.includes(t)).length===r.length}function sd(r){return Object.fromEntries(r.entries())}function id(r){return new Map(Object.entries(r))}function Js(r=G.FIVE_MINUTES,e){const t=G.toMiliseconds(r||G.FIVE_MINUTES);let n,s,i,o;return{resolve:a=>{i&&n&&(clearTimeout(i),n(a),o=Promise.resolve(a))},reject:a=>{i&&s&&(clearTimeout(i),s(a))},done:()=>new Promise((a,c)=>{if(o)return a(o);i=setTimeout(()=>{const l=new Error(e);o=Promise.reject(l),c(l)},t),n=a,s=c})}}function an(r,e,t){return new Promise(async(n,s)=>{const i=setTimeout(()=>s(new Error(t)),e);try{const o=await r;n(o)}catch(o){s(o)}clearTimeout(i)})}function y1(r,e){if(typeof e=="string"&&e.startsWith(`${r}:`))return e;if(r.toLowerCase()==="topic"){if(typeof e!="string")throw new Error('Value must be "string" for expirer target type: topic');return`topic:${e}`}else if(r.toLowerCase()==="id"){if(typeof e!="number")throw new Error('Value must be "number" for expirer target type: id');return`id:${e}`}throw new Error(`Unknown expirer target type: ${r}`)}function A4(r){return y1("topic",r)}function I4(r){return y1("id",r)}function m1(r){const[e,t]=r.split(":"),n={id:void 0,topic:void 0};if(e==="topic"&&typeof t=="string")n.topic=t;else if(e==="id"&&Number.isInteger(Number(t)))n.id=Number(t);else throw new Error(`Invalid target, expected id:number or topic:string, got ${e}:${t}`);return n}function He(r,e){return G.fromMiliseconds(Date.now()+G.toMiliseconds(r))}function is(r){return Date.now()>=G.toMiliseconds(r)}function ve(r,e){return`${r}${e?`:${e}`:""}`}function Ci(r=[],e=[]){return[...new Set([...r,...e])]}async function S4({id:r,topic:e,wcDeepLink:t}){var n;try{if(!t)return;const s=typeof t=="string"?JSON.parse(t):t,i=s==null?void 0:s.href;if(typeof i!="string")return;const o=O4(i,r,e),a=_c();if(a===sr.browser){if(!((n=Kn.getDocument())!=null&&n.hasFocus())){console.warn("Document does not have focus, skipping deeplink.");return}D4(o)}else a===sr.reactNative&&typeof(global==null?void 0:global.Linking)<"u"&&await global.Linking.openURL(o)}catch(s){console.error(s)}}function O4(r,e,t){const n=`requestId=${e}&sessionTopic=${t}`;r.endsWith("/")&&(r=r.slice(0,-1));let s=`${r}`;if(r.startsWith("https://t.me")){const i=r.includes("?")?"&startapp=":"?startapp=";s=`${s}${i}${B4(n,!0)}`}else s=`${s}/wc?${n}`;return s}function D4(r){let e="_self";C4()?e="_top":(N4()||r.startsWith("https://")||r.startsWith("http://"))&&(e="_blank"),window.open(r,e,"noreferrer noopener")}async function _4(r,e){let t="";try{if(ra()&&(t=localStorage.getItem(e),t))return t;t=await r.getItem(e)}catch(n){console.error(n)}return t}function Wy(r,e){if(!r.includes(e))return null;const t=r.split(/([&,?,=])/),n=t.indexOf(e);return t[n+2]}function Jy(){return typeof crypto<"u"&&crypto!=null&&crypto.randomUUID?crypto.randomUUID():"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/gu,r=>{const e=Math.random()*16|0;return(r==="x"?e:e&3|8).toString(16)})}function dp(){return typeof process<"u"&&o4.IS_VITEST==="true"}function N4(){return typeof window<"u"&&(!!window.TelegramWebviewProxy||!!window.Telegram||!!window.TelegramWebviewProxyProto)}function C4(){try{return window.self!==window.top}catch{return!1}}function B4(r,e=!1){const t=Buffer.from(r).toString("base64");return e?t.replace(/[=]/g,""):t}function w1(r){return Buffer.from(r,"base64").toString("utf-8")}function R4(r){return new Promise(e=>setTimeout(e,r))}let P4=class{constructor({limit:e}){Gy(this,"limit"),Gy(this,"set"),this.limit=e,this.set=new Set}add(e){if(!this.set.has(e)){if(this.set.size>=this.limit){const t=this.set.values().next().value;t&&this.set.delete(t)}this.set.add(e)}}has(e){return this.set.has(e)}};const nl=BigInt(2**32-1),Yy=BigInt(32);function b1(r,e=!1){return e?{h:Number(r&nl),l:Number(r>>Yy&nl)}:{h:Number(r>>Yy&nl)|0,l:Number(r&nl)|0}}function x1(r,e=!1){const t=r.length;let n=new Uint32Array(t),s=new Uint32Array(t);for(let i=0;i<t;i++){const{h:o,l:a}=b1(r[i],e);[n[i],s[i]]=[o,a]}return[n,s]}const Zy=(r,e,t)=>r>>>t,Xy=(r,e,t)=>r<<32-t|e>>>t,os=(r,e,t)=>r>>>t|e<<32-t,as=(r,e,t)=>r<<32-t|e>>>t,Ca=(r,e,t)=>r<<64-t|e>>>t-32,Ba=(r,e,t)=>r>>>t-32|e<<64-t,T4=(r,e)=>e,k4=(r,e)=>r,U4=(r,e,t)=>r<<t|e>>>32-t,$4=(r,e,t)=>e<<t|r>>>32-t,F4=(r,e,t)=>e<<t-32|r>>>64-t,L4=(r,e,t)=>r<<t-32|e>>>64-t;function Or(r,e,t,n){const s=(e>>>0)+(n>>>0);return{h:r+t+(s/2**32|0)|0,l:s|0}}const pp=(r,e,t)=>(r>>>0)+(e>>>0)+(t>>>0),gp=(r,e,t,n)=>e+t+n+(r/2**32|0)|0,j4=(r,e,t,n)=>(r>>>0)+(e>>>0)+(t>>>0)+(n>>>0),M4=(r,e,t,n,s)=>e+t+n+s+(r/2**32|0)|0,z4=(r,e,t,n,s)=>(r>>>0)+(e>>>0)+(t>>>0)+(n>>>0)+(s>>>0),q4=(r,e,t,n,s,i)=>e+t+n+s+i+(r/2**32|0)|0,Yi=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;function Bu(r){return r instanceof Uint8Array||ArrayBuffer.isView(r)&&r.constructor.name==="Uint8Array"}function Hn(r){if(!Number.isSafeInteger(r)||r<0)throw new Error("positive integer expected, got "+r)}function Tr(r,...e){if(!Bu(r))throw new Error("Uint8Array expected");if(e.length>0&&!e.includes(r.length))throw new Error("Uint8Array expected of length "+e+", got length="+r.length)}function Ru(r){if(typeof r!="function"||typeof r.create!="function")throw new Error("Hash should be wrapped by utils.createHasher");Hn(r.outputLen),Hn(r.blockLen)}function $s(r,e=!0){if(r.destroyed)throw new Error("Hash instance has been destroyed");if(e&&r.finished)throw new Error("Hash#digest() has already been called")}function yp(r,e){Tr(r);const t=e.outputLen;if(r.length<t)throw new Error("digestInto() expects output buffer of length at least "+t)}function nc(r){return new Uint32Array(r.buffer,r.byteOffset,Math.floor(r.byteLength/4))}function br(...r){for(let e=0;e<r.length;e++)r[e].fill(0)}function kh(r){return new DataView(r.buffer,r.byteOffset,r.byteLength)}function jr(r,e){return r<<32-e|r>>>e}const v1=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;function E1(r){return r<<24&4278190080|r<<8&16711680|r>>>8&65280|r>>>24&255}const xn=v1?r=>r:r=>E1(r);function V4(r){for(let e=0;e<r.length;e++)r[e]=E1(r[e]);return r}const cs=v1?r=>r:V4,A1=typeof Uint8Array.from([]).toHex=="function"&&typeof Uint8Array.fromHex=="function",K4=Array.from({length:256},(r,e)=>e.toString(16).padStart(2,"0"));function wo(r){if(Tr(r),A1)return r.toHex();let e="";for(let t=0;t<r.length;t++)e+=K4[r[t]];return e}const yn={_0:48,_9:57,A:65,F:70,a:97,f:102};function e0(r){if(r>=yn._0&&r<=yn._9)return r-yn._0;if(r>=yn.A&&r<=yn.F)return r-(yn.A-10);if(r>=yn.a&&r<=yn.f)return r-(yn.a-10)}function Zl(r){if(typeof r!="string")throw new Error("hex string expected, got "+typeof r);if(A1)return Uint8Array.fromHex(r);const e=r.length,t=e/2;if(e%2)throw new Error("hex string expected, got unpadded hex of length "+e);const n=new Uint8Array(t);for(let s=0,i=0;s<t;s++,i+=2){const o=e0(r.charCodeAt(i)),a=e0(r.charCodeAt(i+1));if(o===void 0||a===void 0){const c=r[i]+r[i+1];throw new Error('hex string expected, got non-hex character "'+c+'" at index '+i)}n[s]=o*16+a}return n}function I1(r){if(typeof r!="string")throw new Error("string expected");return new Uint8Array(new TextEncoder().encode(r))}function Rr(r){return typeof r=="string"&&(r=I1(r)),Tr(r),r}function hs(...r){let e=0;for(let n=0;n<r.length;n++){const s=r[n];Tr(s),e+=s.length}const t=new Uint8Array(e);for(let n=0,s=0;n<r.length;n++){const i=r[n];t.set(i,s),s+=i.length}return t}let Pu=class{};function Nc(r){const e=n=>r().update(Rr(n)).digest(),t=r();return e.outputLen=t.outputLen,e.blockLen=t.blockLen,e.create=()=>r(),e}function H4(r){const e=(n,s)=>r(s).update(Rr(n)).digest(),t=r({});return e.outputLen=t.outputLen,e.blockLen=t.blockLen,e.create=n=>r(n),e}function zi(r=32){if(Yi&&typeof Yi.getRandomValues=="function")return Yi.getRandomValues(new Uint8Array(r));if(Yi&&typeof Yi.randomBytes=="function")return Uint8Array.from(Yi.randomBytes(r));throw new Error("crypto.getRandomValues must be defined")}const G4=BigInt(0),ma=BigInt(1),Q4=BigInt(2),W4=BigInt(7),J4=BigInt(256),Y4=BigInt(113),S1=[],O1=[],D1=[];for(let r=0,e=ma,t=1,n=0;r<24;r++){[t,n]=[n,(2*t+3*n)%5],S1.push(2*(5*n+t)),O1.push((r+1)*(r+2)/2%64);let s=G4;for(let i=0;i<7;i++)e=(e<<ma^(e>>W4)*Y4)%J4,e&Q4&&(s^=ma<<(ma<<BigInt(i))-ma);D1.push(s)}const _1=x1(D1,!0),Z4=_1[0],X4=_1[1],t0=(r,e,t)=>t>32?F4(r,e,t):U4(r,e,t),r0=(r,e,t)=>t>32?L4(r,e,t):$4(r,e,t);function eC(r,e=24){const t=new Uint32Array(10);for(let n=24-e;n<24;n++){for(let o=0;o<10;o++)t[o]=r[o]^r[o+10]^r[o+20]^r[o+30]^r[o+40];for(let o=0;o<10;o+=2){const a=(o+8)%10,c=(o+2)%10,l=t[c],u=t[c+1],h=t0(l,u,1)^t[a],f=r0(l,u,1)^t[a+1];for(let d=0;d<50;d+=10)r[o+d]^=h,r[o+d+1]^=f}let s=r[2],i=r[3];for(let o=0;o<24;o++){const a=O1[o],c=t0(s,i,a),l=r0(s,i,a),u=S1[o];s=r[u],i=r[u+1],r[u]=c,r[u+1]=l}for(let o=0;o<50;o+=10){for(let a=0;a<10;a++)t[a]=r[o+a];for(let a=0;a<10;a++)r[o+a]^=~t[(a+2)%10]&t[(a+4)%10]}r[0]^=Z4[n],r[1]^=X4[n]}br(t)}let tC=class N1 extends Pu{constructor(e,t,n,s=!1,i=24){if(super(),this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,this.enableXOF=!1,this.blockLen=e,this.suffix=t,this.outputLen=n,this.enableXOF=s,this.rounds=i,Hn(n),!(0<e&&e<200))throw new Error("only keccak-f1600 function is supported");this.state=new Uint8Array(200),this.state32=nc(this.state)}clone(){return this._cloneInto()}keccak(){cs(this.state32),eC(this.state32,this.rounds),cs(this.state32),this.posOut=0,this.pos=0}update(e){$s(this),e=Rr(e),Tr(e);const{blockLen:t,state:n}=this,s=e.length;for(let i=0;i<s;){const o=Math.min(t-this.pos,s-i);for(let a=0;a<o;a++)n[this.pos++]^=e[i++];this.pos===t&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;const{state:e,suffix:t,pos:n,blockLen:s}=this;e[n]^=t,(t&128)!==0&&n===s-1&&this.keccak(),e[s-1]^=128,this.keccak()}writeInto(e){$s(this,!1),Tr(e),this.finish();const t=this.state,{blockLen:n}=this;for(let s=0,i=e.length;s<i;){this.posOut>=n&&this.keccak();const o=Math.min(n-this.posOut,i-s);e.set(t.subarray(this.posOut,this.posOut+o),s),this.posOut+=o,s+=o}return e}xofInto(e){if(!this.enableXOF)throw new Error("XOF is not possible for this instance");return this.writeInto(e)}xof(e){return Hn(e),this.xofInto(new Uint8Array(e))}digestInto(e){if(yp(e,this),this.finished)throw new Error("digest() was already called");return this.writeInto(e),this.destroy(),e}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,br(this.state)}_cloneInto(e){const{blockLen:t,suffix:n,outputLen:s,rounds:i,enableXOF:o}=this;return e||(e=new N1(t,n,s,o,i)),e.state32.set(this.state32),e.pos=this.pos,e.posOut=this.posOut,e.finished=this.finished,e.rounds=i,e.suffix=n,e.outputLen=s,e.enableXOF=o,e.destroyed=this.destroyed,e}};const rC=(r,e,t)=>Nc(()=>new tC(e,r,t)),nC=rC(1,136,256/8);function sC(r,e,t,n){if(typeof r.setBigUint64=="function")return r.setBigUint64(e,t,n);const s=BigInt(32),i=BigInt(4294967295),o=Number(t>>s&i),a=Number(t&i),c=n?4:0,l=n?0:4;r.setUint32(e+c,o,n),r.setUint32(e+l,a,n)}function iC(r,e,t){return r&e^~r&t}function oC(r,e,t){return r&e^r&t^e&t}let C1=class extends Pu{constructor(e,t,n,s){super(),this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.blockLen=e,this.outputLen=t,this.padOffset=n,this.isLE=s,this.buffer=new Uint8Array(e),this.view=kh(this.buffer)}update(e){$s(this),e=Rr(e),Tr(e);const{view:t,buffer:n,blockLen:s}=this,i=e.length;for(let o=0;o<i;){const a=Math.min(s-this.pos,i-o);if(a===s){const c=kh(e);for(;s<=i-o;o+=s)this.process(c,o);continue}n.set(e.subarray(o,o+a),this.pos),this.pos+=a,o+=a,this.pos===s&&(this.process(t,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){$s(this),yp(e,this),this.finished=!0;const{buffer:t,view:n,blockLen:s,isLE:i}=this;let{pos:o}=this;t[o++]=128,br(this.buffer.subarray(o)),this.padOffset>s-o&&(this.process(n,0),o=0);for(let h=o;h<s;h++)t[h]=0;sC(n,s-8,BigInt(this.length*8),i),this.process(n,0);const a=kh(e),c=this.outputLen;if(c%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const l=c/4,u=this.get();if(l>u.length)throw new Error("_sha2: outputLen bigger than state");for(let h=0;h<l;h++)a.setUint32(4*h,u[h],i)}digest(){const{buffer:e,outputLen:t}=this;this.digestInto(e);const n=e.slice(0,t);return this.destroy(),n}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());const{blockLen:t,buffer:n,length:s,finished:i,destroyed:o,pos:a}=this;return e.destroyed=o,e.finished=i,e.length=s,e.pos=a,s%t&&e.buffer.set(n),e}clone(){return this._cloneInto()}};const Xn=Uint32Array.from([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),dt=Uint32Array.from([3418070365,3238371032,1654270250,914150663,2438529370,812702999,355462360,4144912697,1731405415,4290775857,2394180231,1750603025,3675008525,1694076839,1203062813,3204075428]),pt=Uint32Array.from([1779033703,4089235720,3144134277,2227873595,1013904242,4271175723,2773480762,1595750129,1359893119,2917565137,2600822924,725511199,528734635,4215389547,1541459225,327033209]),aC=Uint32Array.from([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),es=new Uint32Array(64);class cC extends C1{constructor(e=32){super(64,e,8,!1),this.A=Xn[0]|0,this.B=Xn[1]|0,this.C=Xn[2]|0,this.D=Xn[3]|0,this.E=Xn[4]|0,this.F=Xn[5]|0,this.G=Xn[6]|0,this.H=Xn[7]|0}get(){const{A:e,B:t,C:n,D:s,E:i,F:o,G:a,H:c}=this;return[e,t,n,s,i,o,a,c]}set(e,t,n,s,i,o,a,c){this.A=e|0,this.B=t|0,this.C=n|0,this.D=s|0,this.E=i|0,this.F=o|0,this.G=a|0,this.H=c|0}process(e,t){for(let h=0;h<16;h++,t+=4)es[h]=e.getUint32(t,!1);for(let h=16;h<64;h++){const f=es[h-15],d=es[h-2],p=jr(f,7)^jr(f,18)^f>>>3,g=jr(d,17)^jr(d,19)^d>>>10;es[h]=g+es[h-7]+p+es[h-16]|0}let{A:n,B:s,C:i,D:o,E:a,F:c,G:l,H:u}=this;for(let h=0;h<64;h++){const f=jr(a,6)^jr(a,11)^jr(a,25),d=u+f+iC(a,c,l)+aC[h]+es[h]|0,p=(jr(n,2)^jr(n,13)^jr(n,22))+oC(n,s,i)|0;u=l,l=c,c=a,a=o+d|0,o=i,i=s,s=n,n=d+p|0}n=n+this.A|0,s=s+this.B|0,i=i+this.C|0,o=o+this.D|0,a=a+this.E|0,c=c+this.F|0,l=l+this.G|0,u=u+this.H|0,this.set(n,s,i,o,a,c,l,u)}roundClean(){br(es)}destroy(){this.set(0,0,0,0,0,0,0,0),br(this.buffer)}}const B1=x1(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(r=>BigInt(r))),lC=B1[0],uC=B1[1],ts=new Uint32Array(80),rs=new Uint32Array(80);let mp=class extends C1{constructor(e=64){super(128,e,16,!1),this.Ah=pt[0]|0,this.Al=pt[1]|0,this.Bh=pt[2]|0,this.Bl=pt[3]|0,this.Ch=pt[4]|0,this.Cl=pt[5]|0,this.Dh=pt[6]|0,this.Dl=pt[7]|0,this.Eh=pt[8]|0,this.El=pt[9]|0,this.Fh=pt[10]|0,this.Fl=pt[11]|0,this.Gh=pt[12]|0,this.Gl=pt[13]|0,this.Hh=pt[14]|0,this.Hl=pt[15]|0}get(){const{Ah:e,Al:t,Bh:n,Bl:s,Ch:i,Cl:o,Dh:a,Dl:c,Eh:l,El:u,Fh:h,Fl:f,Gh:d,Gl:p,Hh:g,Hl:m}=this;return[e,t,n,s,i,o,a,c,l,u,h,f,d,p,g,m]}set(e,t,n,s,i,o,a,c,l,u,h,f,d,p,g,m){this.Ah=e|0,this.Al=t|0,this.Bh=n|0,this.Bl=s|0,this.Ch=i|0,this.Cl=o|0,this.Dh=a|0,this.Dl=c|0,this.Eh=l|0,this.El=u|0,this.Fh=h|0,this.Fl=f|0,this.Gh=d|0,this.Gl=p|0,this.Hh=g|0,this.Hl=m|0}process(e,t){for(let x=0;x<16;x++,t+=4)ts[x]=e.getUint32(t),rs[x]=e.getUint32(t+=4);for(let x=16;x<80;x++){const b=ts[x-15]|0,v=rs[x-15]|0,S=os(b,v,1)^os(b,v,8)^Zy(b,v,7),D=as(b,v,1)^as(b,v,8)^Xy(b,v,7),R=ts[x-2]|0,_=rs[x-2]|0,F=os(R,_,19)^Ca(R,_,61)^Zy(R,_,6),j=as(R,_,19)^Ba(R,_,61)^Xy(R,_,6),$=j4(D,j,rs[x-7],rs[x-16]),C=M4($,S,F,ts[x-7],ts[x-16]);ts[x]=C|0,rs[x]=$|0}let{Ah:n,Al:s,Bh:i,Bl:o,Ch:a,Cl:c,Dh:l,Dl:u,Eh:h,El:f,Fh:d,Fl:p,Gh:g,Gl:m,Hh:E,Hl:O}=this;for(let x=0;x<80;x++){const b=os(h,f,14)^os(h,f,18)^Ca(h,f,41),v=as(h,f,14)^as(h,f,18)^Ba(h,f,41),S=h&d^~h&g,D=f&p^~f&m,R=z4(O,v,D,uC[x],rs[x]),_=q4(R,E,b,S,lC[x],ts[x]),F=R|0,j=os(n,s,28)^Ca(n,s,34)^Ca(n,s,39),$=as(n,s,28)^Ba(n,s,34)^Ba(n,s,39),C=n&i^n&a^i&a,k=s&o^s&c^o&c;E=g|0,O=m|0,g=d|0,m=p|0,d=h|0,p=f|0,{h,l:f}=Or(l|0,u|0,_|0,F|0),l=a|0,u=c|0,a=i|0,c=o|0,i=n|0,o=s|0;const I=pp(F,$,k);n=gp(I,_,j,C),s=I|0}({h:n,l:s}=Or(this.Ah|0,this.Al|0,n|0,s|0)),{h:i,l:o}=Or(this.Bh|0,this.Bl|0,i|0,o|0),{h:a,l:c}=Or(this.Ch|0,this.Cl|0,a|0,c|0),{h:l,l:u}=Or(this.Dh|0,this.Dl|0,l|0,u|0),{h,l:f}=Or(this.Eh|0,this.El|0,h|0,f|0),{h:d,l:p}=Or(this.Fh|0,this.Fl|0,d|0,p|0),{h:g,l:m}=Or(this.Gh|0,this.Gl|0,g|0,m|0),{h:E,l:O}=Or(this.Hh|0,this.Hl|0,E|0,O|0),this.set(n,s,i,o,a,c,l,u,h,f,d,p,g,m,E,O)}roundClean(){br(ts,rs)}destroy(){br(this.buffer),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}};class hC extends mp{constructor(){super(48),this.Ah=dt[0]|0,this.Al=dt[1]|0,this.Bh=dt[2]|0,this.Bl=dt[3]|0,this.Ch=dt[4]|0,this.Cl=dt[5]|0,this.Dh=dt[6]|0,this.Dl=dt[7]|0,this.Eh=dt[8]|0,this.El=dt[9]|0,this.Fh=dt[10]|0,this.Fl=dt[11]|0,this.Gh=dt[12]|0,this.Gl=dt[13]|0,this.Hh=dt[14]|0,this.Hl=dt[15]|0}}const gt=Uint32Array.from([573645204,4230739756,2673172387,3360449730,596883563,1867755857,2520282905,1497426621,2519219938,2827943907,3193839141,1401305490,721525244,746961066,246885852,2177182882]);class fC extends mp{constructor(){super(32),this.Ah=gt[0]|0,this.Al=gt[1]|0,this.Bh=gt[2]|0,this.Bl=gt[3]|0,this.Ch=gt[4]|0,this.Cl=gt[5]|0,this.Dh=gt[6]|0,this.Dl=gt[7]|0,this.Eh=gt[8]|0,this.El=gt[9]|0,this.Fh=gt[10]|0,this.Fl=gt[11]|0,this.Gh=gt[12]|0,this.Gl=gt[13]|0,this.Hh=gt[14]|0,this.Hl=gt[15]|0}}const Tu=Nc(()=>new cC),dC=Nc(()=>new mp),pC=Nc(()=>new hC),gC=Nc(()=>new fC),yC=Uint8Array.from([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3,11,8,12,0,5,2,15,13,10,14,3,6,7,1,9,4,7,9,3,1,13,12,11,14,2,6,5,10,4,0,15,8,9,0,5,7,2,4,10,15,14,1,11,12,6,8,3,13,2,12,6,10,0,11,8,3,4,13,7,5,15,14,1,9,12,5,1,15,14,13,4,10,0,7,6,3,9,2,8,11,13,11,7,14,12,1,3,9,5,0,15,4,8,6,2,10,6,15,14,9,11,3,0,8,12,2,13,7,1,4,10,5,10,2,8,4,7,6,1,5,15,11,9,14,3,12,13,0,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3,11,8,12,0,5,2,15,13,10,14,3,6,7,1,9,4,7,9,3,1,13,12,11,14,2,6,5,10,4,0,15,8,9,0,5,7,2,4,10,15,14,1,11,12,6,8,3,13,2,12,6,10,0,11,8,3,4,13,7,5,15,14,1,9]),Ke=Uint32Array.from([4089235720,1779033703,2227873595,3144134277,4271175723,1013904242,1595750129,2773480762,2917565137,1359893119,725511199,2600822924,4215389547,528734635,327033209,1541459225]),Z=new Uint32Array(32);function ns(r,e,t,n,s,i){const o=s[i],a=s[i+1];let c=Z[2*r],l=Z[2*r+1],u=Z[2*e],h=Z[2*e+1],f=Z[2*t],d=Z[2*t+1],p=Z[2*n],g=Z[2*n+1],m=pp(c,u,o);l=gp(m,l,h,a),c=m|0,{Dh:g,Dl:p}={Dh:g^l,Dl:p^c},{Dh:g,Dl:p}={Dh:T4(g,p),Dl:k4(g)},{h:d,l:f}=Or(d,f,g,p),{Bh:h,Bl:u}={Bh:h^d,Bl:u^f},{Bh:h,Bl:u}={Bh:os(h,u,24),Bl:as(h,u,24)},Z[2*r]=c,Z[2*r+1]=l,Z[2*e]=u,Z[2*e+1]=h,Z[2*t]=f,Z[2*t+1]=d,Z[2*n]=p,Z[2*n+1]=g}function ss(r,e,t,n,s,i){const o=s[i],a=s[i+1];let c=Z[2*r],l=Z[2*r+1],u=Z[2*e],h=Z[2*e+1],f=Z[2*t],d=Z[2*t+1],p=Z[2*n],g=Z[2*n+1],m=pp(c,u,o);l=gp(m,l,h,a),c=m|0,{Dh:g,Dl:p}={Dh:g^l,Dl:p^c},{Dh:g,Dl:p}={Dh:os(g,p,16),Dl:as(g,p,16)},{h:d,l:f}=Or(d,f,g,p),{Bh:h,Bl:u}={Bh:h^d,Bl:u^f},{Bh:h,Bl:u}={Bh:Ca(h,u,63),Bl:Ba(h,u,63)},Z[2*r]=c,Z[2*r+1]=l,Z[2*e]=u,Z[2*e+1]=h,Z[2*t]=f,Z[2*t+1]=d,Z[2*n]=p,Z[2*n+1]=g}function mC(r,e={},t,n,s){if(Hn(t),r<0||r>t)throw new Error("outputLen bigger than keyLen");const{key:i,salt:o,personalization:a}=e;if(i!==void 0&&(i.length<1||i.length>t))throw new Error("key length must be undefined or 1.."+t);if(o!==void 0&&o.length!==n)throw new Error("salt must be undefined or "+n);if(a!==void 0&&a.length!==s)throw new Error("personalization must be undefined or "+s)}class wC extends Pu{constructor(e,t){super(),this.finished=!1,this.destroyed=!1,this.length=0,this.pos=0,Hn(e),Hn(t),this.blockLen=e,this.outputLen=t,this.buffer=new Uint8Array(e),this.buffer32=nc(this.buffer)}update(e){$s(this),e=Rr(e),Tr(e);const{blockLen:t,buffer:n,buffer32:s}=this,i=e.length,o=e.byteOffset,a=e.buffer;for(let c=0;c<i;){this.pos===t&&(cs(s),this.compress(s,0,!1),cs(s),this.pos=0);const l=Math.min(t-this.pos,i-c),u=o+c;if(l===t&&!(u%4)&&c+l<i){const h=new Uint32Array(a,u,Math.floor((i-c)/4));cs(h);for(let f=0;c+t<i;f+=s.length,c+=t)this.length+=t,this.compress(h,f,!1);cs(h);continue}n.set(e.subarray(c,c+l),this.pos),this.pos+=l,this.length+=l,c+=l}return this}digestInto(e){$s(this),yp(e,this);const{pos:t,buffer32:n}=this;this.finished=!0,br(this.buffer.subarray(t)),cs(n),this.compress(n,0,!0),cs(n);const s=nc(e);this.get().forEach((i,o)=>s[o]=xn(i))}digest(){const{buffer:e,outputLen:t}=this;this.digestInto(e);const n=e.slice(0,t);return this.destroy(),n}_cloneInto(e){const{buffer:t,length:n,finished:s,destroyed:i,outputLen:o,pos:a}=this;return e||(e=new this.constructor({dkLen:o})),e.set(...this.get()),e.buffer.set(t),e.destroyed=i,e.finished=s,e.length=n,e.pos=a,e.outputLen=o,e}clone(){return this._cloneInto()}}class bC extends wC{constructor(e={}){const t=e.dkLen===void 0?64:e.dkLen;super(128,t),this.v0l=Ke[0]|0,this.v0h=Ke[1]|0,this.v1l=Ke[2]|0,this.v1h=Ke[3]|0,this.v2l=Ke[4]|0,this.v2h=Ke[5]|0,this.v3l=Ke[6]|0,this.v3h=Ke[7]|0,this.v4l=Ke[8]|0,this.v4h=Ke[9]|0,this.v5l=Ke[10]|0,this.v5h=Ke[11]|0,this.v6l=Ke[12]|0,this.v6h=Ke[13]|0,this.v7l=Ke[14]|0,this.v7h=Ke[15]|0,mC(t,e,64,16,16);let{key:n,personalization:s,salt:i}=e,o=0;if(n!==void 0&&(n=Rr(n),o=n.length),this.v0l^=this.outputLen|o<<8|65536|1<<24,i!==void 0){i=Rr(i);const a=nc(i);this.v4l^=xn(a[0]),this.v4h^=xn(a[1]),this.v5l^=xn(a[2]),this.v5h^=xn(a[3])}if(s!==void 0){s=Rr(s);const a=nc(s);this.v6l^=xn(a[0]),this.v6h^=xn(a[1]),this.v7l^=xn(a[2]),this.v7h^=xn(a[3])}if(n!==void 0){const a=new Uint8Array(this.blockLen);a.set(n),this.update(a)}}get(){let{v0l:e,v0h:t,v1l:n,v1h:s,v2l:i,v2h:o,v3l:a,v3h:c,v4l:l,v4h:u,v5l:h,v5h:f,v6l:d,v6h:p,v7l:g,v7h:m}=this;return[e,t,n,s,i,o,a,c,l,u,h,f,d,p,g,m]}set(e,t,n,s,i,o,a,c,l,u,h,f,d,p,g,m){this.v0l=e|0,this.v0h=t|0,this.v1l=n|0,this.v1h=s|0,this.v2l=i|0,this.v2h=o|0,this.v3l=a|0,this.v3h=c|0,this.v4l=l|0,this.v4h=u|0,this.v5l=h|0,this.v5h=f|0,this.v6l=d|0,this.v6h=p|0,this.v7l=g|0,this.v7h=m|0}compress(e,t,n){this.get().forEach((c,l)=>Z[l]=c),Z.set(Ke,16);let{h:s,l:i}=b1(BigInt(this.length));Z[24]=Ke[8]^i,Z[25]=Ke[9]^s,n&&(Z[28]=~Z[28],Z[29]=~Z[29]);let o=0;const a=yC;for(let c=0;c<12;c++)ns(0,4,8,12,e,t+2*a[o++]),ss(0,4,8,12,e,t+2*a[o++]),ns(1,5,9,13,e,t+2*a[o++]),ss(1,5,9,13,e,t+2*a[o++]),ns(2,6,10,14,e,t+2*a[o++]),ss(2,6,10,14,e,t+2*a[o++]),ns(3,7,11,15,e,t+2*a[o++]),ss(3,7,11,15,e,t+2*a[o++]),ns(0,5,10,15,e,t+2*a[o++]),ss(0,5,10,15,e,t+2*a[o++]),ns(1,6,11,12,e,t+2*a[o++]),ss(1,6,11,12,e,t+2*a[o++]),ns(2,7,8,13,e,t+2*a[o++]),ss(2,7,8,13,e,t+2*a[o++]),ns(3,4,9,14,e,t+2*a[o++]),ss(3,4,9,14,e,t+2*a[o++]);this.v0l^=Z[0]^Z[16],this.v0h^=Z[1]^Z[17],this.v1l^=Z[2]^Z[18],this.v1h^=Z[3]^Z[19],this.v2l^=Z[4]^Z[20],this.v2h^=Z[5]^Z[21],this.v3l^=Z[6]^Z[22],this.v3h^=Z[7]^Z[23],this.v4l^=Z[8]^Z[24],this.v4h^=Z[9]^Z[25],this.v5l^=Z[10]^Z[26],this.v5h^=Z[11]^Z[27],this.v6l^=Z[12]^Z[28],this.v6h^=Z[13]^Z[29],this.v7l^=Z[14]^Z[30],this.v7h^=Z[15]^Z[31],br(Z)}destroy(){this.destroyed=!0,br(this.buffer32),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}}const xC=H4(r=>new bC(r)),vC="https://rpc.walletconnect.org/v1";function R1(r){const e=`Ethereum Signed Message:
${r.length}`,t=new TextEncoder().encode(e+r);return"0x"+Buffer.from(nC(t)).toString("hex")}async function EC(r,e,t,n,s,i){switch(t.t){case"eip191":return await AC(r,e,t.s);case"eip1271":return await IC(r,e,t.s,n,s,i);default:throw new Error(`verifySignature failed: Attempted to verify CacaoSignature with unknown type: ${t.t}`)}}function AC(r,e,t){const n=h_(t);return v_({payload:R1(e),signature:n}).toLowerCase()===r.toLowerCase()}async function IC(r,e,t,n,s,i){const o=El(n);if(!o.namespace||!o.reference)throw new Error(`isValidEip1271Signature failed: chainId must be in CAIP-2 format, received: ${n}`);try{const a="0x1626ba7e",c="0000000000000000000000000000000000000000000000000000000000000040",l=t.substring(2),u=(l.length/2).toString(16).padStart(64,"0"),h=(e.startsWith("0x")?e:R1(e)).substring(2),f=a+h+c+u+l,d=await fetch(`${i||vC}/?chainId=${n}&projectId=${s}`,{headers:{"Content-Type":"application/json"},method:"POST",body:JSON.stringify({id:SC(),jsonrpc:"2.0",method:"eth_call",params:[{to:r,data:f},"latest"]})}),{result:p}=await d.json();return p?p.slice(0,a.length).toLowerCase()===a.toLowerCase():!1}catch(a){return console.error("isValidEip1271Signature: ",a),!1}}function SC(){return Date.now()+Math.floor(Math.random()*1e3)}function OC(r){const e=atob(r),t=new Uint8Array(e.length);for(let o=0;o<e.length;o++)t[o]=e.charCodeAt(o);const n=t[0];if(n===0)throw new Error("No signatures found");const s=1+n*64;if(t.length<s)throw new Error("Transaction data too short for claimed signature count");if(t.length<100)throw new Error("Transaction too short");const i=Buffer.from(r,"base64").slice(1,65);return Oc.encode(i)}function DC(r){const e=new Uint8Array(Buffer.from(r,"base64")),t=Array.from("TransactionData::").map(i=>i.charCodeAt(0)),n=new Uint8Array(t.length+e.length);n.set(t),n.set(e,t.length);const s=xC(n,{dkLen:32});return Oc.encode(s)}function n0(r){const e=new Uint8Array(Tu(_C(r)));return Oc.encode(e)}function _C(r){if(r instanceof Uint8Array)return r;if(Array.isArray(r))return new Uint8Array(r);if(typeof r=="object"&&r!=null&&r.data)return new Uint8Array(Object.values(r.data));if(typeof r=="object"&&r)return new Uint8Array(Object.values(r));throw new Error("getNearUint8ArrayFromBytes: Unexpected result type from bytes array")}function s0(r){const e=Buffer.from(r,"base64"),t=sN(e).txn;if(!t)throw new Error("Invalid signed transaction: missing 'txn' field");const n=W_(t),s=Buffer.from("TX"),i=Buffer.concat([s,Buffer.from(n)]),o=gC(i);return b_.encode(o).replace(/=+$/,"")}function Uh(r){const e=[];let t=BigInt(r);for(;t>=BigInt(128);)e.push(Number(t&BigInt(127)|BigInt(128))),t>>=BigInt(7);return e.push(Number(t)),Buffer.from(e)}function NC(r){const e=Buffer.from(r.signed.bodyBytes,"base64"),t=Buffer.from(r.signed.authInfoBytes,"base64"),n=Buffer.from(r.signature.signature,"base64"),s=[];s.push(Buffer.from([10])),s.push(Uh(e.length)),s.push(e),s.push(Buffer.from([18])),s.push(Uh(t.length)),s.push(t),s.push(Buffer.from([26])),s.push(Uh(n.length)),s.push(n);const i=Buffer.concat(s),o=Tu(i);return Buffer.from(o).toString("hex").toUpperCase()}function CC(r){var e,t;const n=[];try{if(typeof r=="string")return n.push(r),n;if(typeof r!="object")return n;r!=null&&r.id&&n.push(r.id);const s=(t=(e=r==null?void 0:r.capabilities)==null?void 0:e.caip345)==null?void 0:t.transactionHashes;s&&n.push(...s)}catch(s){console.warn("getWalletSendCallsHashes failed: ",s)}return n}var BC=Object.defineProperty,RC=Object.defineProperties,PC=Object.getOwnPropertyDescriptors,i0=Object.getOwnPropertySymbols,TC=Object.prototype.hasOwnProperty,kC=Object.prototype.propertyIsEnumerable,o0=(r,e,t)=>e in r?BC(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,UC=(r,e)=>{for(var t in e||(e={}))TC.call(e,t)&&o0(r,t,e[t]);if(i0)for(var t of i0(e))kC.call(e,t)&&o0(r,t,e[t]);return r},$C=(r,e)=>RC(r,PC(e));const P1="did:pkh:",FC={eip155:"Ethereum",solana:"Solana",bip122:"Bitcoin"},LC=r=>r?FC[r]||r:"",ku=r=>r==null?void 0:r.split(":"),jC=r=>{const e=r&&ku(r);if(e)return r.includes(P1)?e[3]:e[1]},MC=r=>{const e=r&&ku(r);if(e)return r.includes(P1)?e[2]:e[0]},od=r=>{const e=r&&ku(r);if(e)return e[2]+":"+e[3]},Xl=r=>{const e=r&&ku(r);if(e)return e.pop()};async function a0(r){const{cacao:e,projectId:t}=r,{s:n,p:s}=e,i=T1(s,s.iss),o=Xl(s.iss);return await EC(o,i,n,od(s.iss),t)}const T1=(r,e)=>{const t=MC(e);if(!t)throw new Error("Invalid issuer: "+e);const n=`${r.domain} wants you to sign in with your ${LC(t)} account:`,s=Xl(e);if(!r.aud&&!r.uri)throw new Error("Either `aud` or `uri` is required to construct the message");let i=r.statement||void 0;const o=`URI: ${r.aud||r.uri}`,a=`Version: ${r.version}`,c=`Chain ID: ${jC(e)}`,l=`Nonce: ${r.nonce}`,u=`Issued At: ${r.iat}`,h=r.exp?`Expiration Time: ${r.exp}`:void 0,f=r.nbf?`Not Before: ${r.nbf}`:void 0,d=r.requestId?`Request ID: ${r.requestId}`:void 0,p=r.resources?`Resources:${r.resources.map(m=>`
- ${m}`).join("")}`:void 0,g=Al(r.resources);if(g){const m=sc(g);i=JC(i,m)}return[n,s,"",i,"",o,a,c,l,u,h,f,d,p].filter(m=>m!=null).join(`
`)};function zC(r){return Buffer.from(JSON.stringify(r)).toString("base64")}function qC(r){return JSON.parse(Buffer.from(r,"base64").toString("utf-8"))}function Ui(r){if(!r)throw new Error("No recap provided, value is undefined");if(!r.att)throw new Error("No `att` property found");const e=Object.keys(r.att);if(!(e!=null&&e.length))throw new Error("No resources found in `att` property");e.forEach(t=>{const n=r.att[t];if(Array.isArray(n))throw new Error(`Resource must be an object: ${t}`);if(typeof n!="object")throw new Error(`Resource must be an object: ${t}`);if(!Object.keys(n).length)throw new Error(`Resource object is empty: ${t}`);Object.keys(n).forEach(s=>{const i=n[s];if(!Array.isArray(i))throw new Error(`Ability limits ${s} must be an array of objects, found: ${i}`);if(!i.length)throw new Error(`Value of ${s} is empty array, must be an array with objects`);i.forEach(o=>{if(typeof o!="object")throw new Error(`Ability limits (${s}) must be an array of objects, found: ${o}`)})})})}function VC(r,e,t,n={}){return t==null||t.sort((s,i)=>s.localeCompare(i)),{att:{[r]:KC(e,t,n)}}}function KC(r,e,t={}){e=e==null?void 0:e.sort((s,i)=>s.localeCompare(i));const n=e.map(s=>({[`${r}/${s}`]:[t]}));return Object.assign({},...n)}function k1(r){return Ui(r),`urn:recap:${zC(r).replace(/=/g,"")}`}function sc(r){const e=qC(r.replace("urn:recap:",""));return Ui(e),e}function HC(r,e,t){const n=VC(r,e,t);return k1(n)}function GC(r){return r&&r.includes("urn:recap:")}function QC(r,e){const t=sc(r),n=sc(e),s=WC(t,n);return k1(s)}function WC(r,e){Ui(r),Ui(e);const t=Object.keys(r.att).concat(Object.keys(e.att)).sort((s,i)=>s.localeCompare(i)),n={att:{}};return t.forEach(s=>{var i,o;Object.keys(((i=r.att)==null?void 0:i[s])||{}).concat(Object.keys(((o=e.att)==null?void 0:o[s])||{})).sort((a,c)=>a.localeCompare(c)).forEach(a=>{var c,l;n.att[s]=$C(UC({},n.att[s]),{[a]:((c=r.att[s])==null?void 0:c[a])||((l=e.att[s])==null?void 0:l[a])})})}),n}function JC(r="",e){Ui(e);const t="I further authorize the stated URI to perform the following actions on my behalf: ";if(r.includes(t))return r;const n=[];let s=0;Object.keys(e.att).forEach(a=>{const c=Object.keys(e.att[a]).map(h=>({ability:h.split("/")[0],action:h.split("/")[1]}));c.sort((h,f)=>h.action.localeCompare(f.action));const l={};c.forEach(h=>{l[h.ability]||(l[h.ability]=[]),l[h.ability].push(h.action)});const u=Object.keys(l).map(h=>(s++,`(${s}) '${h}': '${l[h].join("', '")}' for '${a}'.`));n.push(u.join(", ").replace(".,","."))});const i=n.join(" "),o=`${t}${i}`;return`${r?r+" ":""}${o}`}function c0(r){var e;const t=sc(r);Ui(t);const n=(e=t.att)==null?void 0:e.eip155;return n?Object.keys(n).map(s=>s.split("/")[1]):[]}function l0(r){const e=sc(r);Ui(e);const t=[];return Object.values(e.att).forEach(n=>{Object.values(n).forEach(s=>{var i;(i=s==null?void 0:s[0])!=null&&i.chains&&t.push(s[0].chains)})}),[...new Set(t.flat())]}function Al(r){if(!r)return;const e=r==null?void 0:r[r.length-1];return GC(e)?e:void 0}/*! noble-ciphers - MIT License (c) 2023 Paul Miller (paulmillr.com) */function U1(r){return r instanceof Uint8Array||ArrayBuffer.isView(r)&&r.constructor.name==="Uint8Array"}function ad(r){if(typeof r!="boolean")throw new Error(`boolean expected, not ${r}`)}function $h(r){if(!Number.isSafeInteger(r)||r<0)throw new Error("positive integer expected, got "+r)}function Lt(r,...e){if(!U1(r))throw new Error("Uint8Array expected");if(e.length>0&&!e.includes(r.length))throw new Error("Uint8Array expected of length "+e+", got length="+r.length)}function u0(r,e=!0){if(r.destroyed)throw new Error("Hash instance has been destroyed");if(e&&r.finished)throw new Error("Hash#digest() has already been called")}function YC(r,e){Lt(r);const t=e.outputLen;if(r.length<t)throw new Error("digestInto() expects output buffer of length at least "+t)}function ks(r){return new Uint32Array(r.buffer,r.byteOffset,Math.floor(r.byteLength/4))}function Zo(...r){for(let e=0;e<r.length;e++)r[e].fill(0)}function ZC(r){return new DataView(r.buffer,r.byteOffset,r.byteLength)}const XC=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;function eB(r){if(typeof r!="string")throw new Error("string expected");return new Uint8Array(new TextEncoder().encode(r))}function cd(r){if(typeof r=="string")r=eB(r);else if(U1(r))r=ld(r);else throw new Error("Uint8Array expected, got "+typeof r);return r}function tB(r,e){if(e==null||typeof e!="object")throw new Error("options must be defined");return Object.assign(r,e)}function rB(r,e){if(r.length!==e.length)return!1;let t=0;for(let n=0;n<r.length;n++)t|=r[n]^e[n];return t===0}const nB=(r,e)=>{function t(n,...s){if(Lt(n),!XC)throw new Error("Non little-endian hardware is not yet supported");if(r.nonceLength!==void 0){const l=s[0];if(!l)throw new Error("nonce / iv required");r.varSizeNonce?Lt(l):Lt(l,r.nonceLength)}const i=r.tagLength;i&&s[1]!==void 0&&Lt(s[1]);const o=e(n,...s),a=(l,u)=>{if(u!==void 0){if(l!==2)throw new Error("cipher output not supported");Lt(u)}};let c=!1;return{encrypt(l,u){if(c)throw new Error("cannot encrypt() twice with same key + nonce");return c=!0,Lt(l),a(o.encrypt.length,u),o.encrypt(l,u)},decrypt(l,u){if(Lt(l),i&&l.length<i)throw new Error("invalid ciphertext length: smaller than tagLength="+i);return a(o.decrypt.length,u),o.decrypt(l,u)}}}return Object.assign(t,r),t};function h0(r,e,t=!0){if(e===void 0)return new Uint8Array(r);if(e.length!==r)throw new Error("invalid output length, expected "+r+", got: "+e.length);if(t&&!iB(e))throw new Error("invalid output, must be aligned");return e}function f0(r,e,t,n){if(typeof r.setBigUint64=="function")return r.setBigUint64(e,t,n);const s=BigInt(32),i=BigInt(4294967295),o=Number(t>>s&i),a=Number(t&i);r.setUint32(e+4,o,n),r.setUint32(e+0,a,n)}function sB(r,e,t){ad(t);const n=new Uint8Array(16),s=ZC(n);return f0(s,0,BigInt(e),t),f0(s,8,BigInt(r),t),n}function iB(r){return r.byteOffset%4===0}function ld(r){return Uint8Array.from(r)}const $1=r=>Uint8Array.from(r.split("").map(e=>e.charCodeAt(0))),oB=$1("expand 16-byte k"),aB=$1("expand 32-byte k"),cB=ks(oB),lB=ks(aB);function me(r,e){return r<<e|r>>>32-e}function ud(r){return r.byteOffset%4===0}const sl=64,uB=16,F1=2**32-1,d0=new Uint32Array;function hB(r,e,t,n,s,i,o,a){const c=s.length,l=new Uint8Array(sl),u=ks(l),h=ud(s)&&ud(i),f=h?ks(s):d0,d=h?ks(i):d0;for(let p=0;p<c;o++){if(r(e,t,n,u,o,a),o>=F1)throw new Error("arx: counter overflow");const g=Math.min(sl,c-p);if(h&&g===sl){const m=p/4;if(p%4!==0)throw new Error("arx: invalid block position");for(let E=0,O;E<uB;E++)O=m+E,d[O]=f[O]^u[E];p+=sl;continue}for(let m=0,E;m<g;m++)E=p+m,i[E]=s[E]^l[m];p+=g}}function fB(r,e){const{allowShortKeys:t,extendNonceFn:n,counterLength:s,counterRight:i,rounds:o}=tB({allowShortKeys:!1,counterLength:8,counterRight:!1,rounds:20},e);if(typeof r!="function")throw new Error("core must be a function");return $h(s),$h(o),ad(i),ad(t),(a,c,l,u,h=0)=>{Lt(a),Lt(c),Lt(l);const f=l.length;if(u===void 0&&(u=new Uint8Array(f)),Lt(u),$h(h),h<0||h>=F1)throw new Error("arx: counter overflow");if(u.length<f)throw new Error(`arx: output (${u.length}) is shorter than data (${f})`);const d=[];let p=a.length,g,m;if(p===32)d.push(g=ld(a)),m=lB;else if(p===16&&t)g=new Uint8Array(32),g.set(a),g.set(a,16),m=cB,d.push(g);else throw new Error(`arx: invalid 32-byte key, got length=${p}`);ud(c)||d.push(c=ld(c));const E=ks(g);if(n){if(c.length!==24)throw new Error("arx: extended nonce must be 24 bytes");n(m,E,ks(c.subarray(0,16)),E),c=c.subarray(16)}const O=16-s;if(O!==c.length)throw new Error(`arx: nonce must be ${O} or 16 bytes`);if(O!==12){const b=new Uint8Array(12);b.set(c,i?0:12-c.length),c=b,d.push(c)}const x=ks(c);return hB(r,m,E,x,l,u,h,o),Zo(...d),u}}const rt=(r,e)=>r[e++]&255|(r[e++]&255)<<8;class dB{constructor(e){this.blockLen=16,this.outputLen=16,this.buffer=new Uint8Array(16),this.r=new Uint16Array(10),this.h=new Uint16Array(10),this.pad=new Uint16Array(8),this.pos=0,this.finished=!1,e=cd(e),Lt(e,32);const t=rt(e,0),n=rt(e,2),s=rt(e,4),i=rt(e,6),o=rt(e,8),a=rt(e,10),c=rt(e,12),l=rt(e,14);this.r[0]=t&8191,this.r[1]=(t>>>13|n<<3)&8191,this.r[2]=(n>>>10|s<<6)&7939,this.r[3]=(s>>>7|i<<9)&8191,this.r[4]=(i>>>4|o<<12)&255,this.r[5]=o>>>1&8190,this.r[6]=(o>>>14|a<<2)&8191,this.r[7]=(a>>>11|c<<5)&8065,this.r[8]=(c>>>8|l<<8)&8191,this.r[9]=l>>>5&127;for(let u=0;u<8;u++)this.pad[u]=rt(e,16+2*u)}process(e,t,n=!1){const s=n?0:2048,{h:i,r:o}=this,a=o[0],c=o[1],l=o[2],u=o[3],h=o[4],f=o[5],d=o[6],p=o[7],g=o[8],m=o[9],E=rt(e,t+0),O=rt(e,t+2),x=rt(e,t+4),b=rt(e,t+6),v=rt(e,t+8),S=rt(e,t+10),D=rt(e,t+12),R=rt(e,t+14);let _=i[0]+(E&8191),F=i[1]+((E>>>13|O<<3)&8191),j=i[2]+((O>>>10|x<<6)&8191),$=i[3]+((x>>>7|b<<9)&8191),C=i[4]+((b>>>4|v<<12)&8191),k=i[5]+(v>>>1&8191),I=i[6]+((v>>>14|S<<2)&8191),A=i[7]+((S>>>11|D<<5)&8191),B=i[8]+((D>>>8|R<<8)&8191),U=i[9]+(R>>>5|s),N=0,T=N+_*a+F*(5*m)+j*(5*g)+$*(5*p)+C*(5*d);N=T>>>13,T&=8191,T+=k*(5*f)+I*(5*h)+A*(5*u)+B*(5*l)+U*(5*c),N+=T>>>13,T&=8191;let M=N+_*c+F*a+j*(5*m)+$*(5*g)+C*(5*p);N=M>>>13,M&=8191,M+=k*(5*d)+I*(5*f)+A*(5*h)+B*(5*u)+U*(5*l),N+=M>>>13,M&=8191;let q=N+_*l+F*c+j*a+$*(5*m)+C*(5*g);N=q>>>13,q&=8191,q+=k*(5*p)+I*(5*d)+A*(5*f)+B*(5*h)+U*(5*u),N+=q>>>13,q&=8191;let Y=N+_*u+F*l+j*c+$*a+C*(5*m);N=Y>>>13,Y&=8191,Y+=k*(5*g)+I*(5*p)+A*(5*d)+B*(5*f)+U*(5*h),N+=Y>>>13,Y&=8191;let J=N+_*h+F*u+j*l+$*c+C*a;N=J>>>13,J&=8191,J+=k*(5*m)+I*(5*g)+A*(5*p)+B*(5*d)+U*(5*f),N+=J>>>13,J&=8191;let Q=N+_*f+F*h+j*u+$*l+C*c;N=Q>>>13,Q&=8191,Q+=k*a+I*(5*m)+A*(5*g)+B*(5*p)+U*(5*d),N+=Q>>>13,Q&=8191;let re=N+_*d+F*f+j*h+$*u+C*l;N=re>>>13,re&=8191,re+=k*c+I*a+A*(5*m)+B*(5*g)+U*(5*p),N+=re>>>13,re&=8191;let ne=N+_*p+F*d+j*f+$*h+C*u;N=ne>>>13,ne&=8191,ne+=k*l+I*c+A*a+B*(5*m)+U*(5*g),N+=ne>>>13,ne&=8191;let ae=N+_*g+F*p+j*d+$*f+C*h;N=ae>>>13,ae&=8191,ae+=k*u+I*l+A*c+B*a+U*(5*m),N+=ae>>>13,ae&=8191;let te=N+_*m+F*g+j*p+$*d+C*f;N=te>>>13,te&=8191,te+=k*h+I*u+A*l+B*c+U*a,N+=te>>>13,te&=8191,N=(N<<2)+N|0,N=N+T|0,T=N&8191,N=N>>>13,M+=N,i[0]=T,i[1]=M,i[2]=q,i[3]=Y,i[4]=J,i[5]=Q,i[6]=re,i[7]=ne,i[8]=ae,i[9]=te}finalize(){const{h:e,pad:t}=this,n=new Uint16Array(10);let s=e[1]>>>13;e[1]&=8191;for(let a=2;a<10;a++)e[a]+=s,s=e[a]>>>13,e[a]&=8191;e[0]+=s*5,s=e[0]>>>13,e[0]&=8191,e[1]+=s,s=e[1]>>>13,e[1]&=8191,e[2]+=s,n[0]=e[0]+5,s=n[0]>>>13,n[0]&=8191;for(let a=1;a<10;a++)n[a]=e[a]+s,s=n[a]>>>13,n[a]&=8191;n[9]-=8192;let i=(s^1)-1;for(let a=0;a<10;a++)n[a]&=i;i=~i;for(let a=0;a<10;a++)e[a]=e[a]&i|n[a];e[0]=(e[0]|e[1]<<13)&65535,e[1]=(e[1]>>>3|e[2]<<10)&65535,e[2]=(e[2]>>>6|e[3]<<7)&65535,e[3]=(e[3]>>>9|e[4]<<4)&65535,e[4]=(e[4]>>>12|e[5]<<1|e[6]<<14)&65535,e[5]=(e[6]>>>2|e[7]<<11)&65535,e[6]=(e[7]>>>5|e[8]<<8)&65535,e[7]=(e[8]>>>8|e[9]<<5)&65535;let o=e[0]+t[0];e[0]=o&65535;for(let a=1;a<8;a++)o=(e[a]+t[a]|0)+(o>>>16)|0,e[a]=o&65535;Zo(n)}update(e){u0(this),e=cd(e),Lt(e);const{buffer:t,blockLen:n}=this,s=e.length;for(let i=0;i<s;){const o=Math.min(n-this.pos,s-i);if(o===n){for(;n<=s-i;i+=n)this.process(e,i);continue}t.set(e.subarray(i,i+o),this.pos),this.pos+=o,i+=o,this.pos===n&&(this.process(t,0,!1),this.pos=0)}return this}destroy(){Zo(this.h,this.r,this.buffer,this.pad)}digestInto(e){u0(this),YC(e,this),this.finished=!0;const{buffer:t,h:n}=this;let{pos:s}=this;if(s){for(t[s++]=1;s<16;s++)t[s]=0;this.process(t,0,!0)}this.finalize();let i=0;for(let o=0;o<8;o++)e[i++]=n[o]>>>0,e[i++]=n[o]>>>8;return e}digest(){const{buffer:e,outputLen:t}=this;this.digestInto(e);const n=e.slice(0,t);return this.destroy(),n}}function pB(r){const e=(n,s)=>r(s).update(cd(n)).digest(),t=r(new Uint8Array(32));return e.outputLen=t.outputLen,e.blockLen=t.blockLen,e.create=n=>r(n),e}const gB=pB(r=>new dB(r));function yB(r,e,t,n,s,i=20){let o=r[0],a=r[1],c=r[2],l=r[3],u=e[0],h=e[1],f=e[2],d=e[3],p=e[4],g=e[5],m=e[6],E=e[7],O=s,x=t[0],b=t[1],v=t[2],S=o,D=a,R=c,_=l,F=u,j=h,$=f,C=d,k=p,I=g,A=m,B=E,U=O,N=x,T=b,M=v;for(let Y=0;Y<i;Y+=2)S=S+F|0,U=me(U^S,16),k=k+U|0,F=me(F^k,12),S=S+F|0,U=me(U^S,8),k=k+U|0,F=me(F^k,7),D=D+j|0,N=me(N^D,16),I=I+N|0,j=me(j^I,12),D=D+j|0,N=me(N^D,8),I=I+N|0,j=me(j^I,7),R=R+$|0,T=me(T^R,16),A=A+T|0,$=me($^A,12),R=R+$|0,T=me(T^R,8),A=A+T|0,$=me($^A,7),_=_+C|0,M=me(M^_,16),B=B+M|0,C=me(C^B,12),_=_+C|0,M=me(M^_,8),B=B+M|0,C=me(C^B,7),S=S+j|0,M=me(M^S,16),A=A+M|0,j=me(j^A,12),S=S+j|0,M=me(M^S,8),A=A+M|0,j=me(j^A,7),D=D+$|0,U=me(U^D,16),B=B+U|0,$=me($^B,12),D=D+$|0,U=me(U^D,8),B=B+U|0,$=me($^B,7),R=R+C|0,N=me(N^R,16),k=k+N|0,C=me(C^k,12),R=R+C|0,N=me(N^R,8),k=k+N|0,C=me(C^k,7),_=_+F|0,T=me(T^_,16),I=I+T|0,F=me(F^I,12),_=_+F|0,T=me(T^_,8),I=I+T|0,F=me(F^I,7);let q=0;n[q++]=o+S|0,n[q++]=a+D|0,n[q++]=c+R|0,n[q++]=l+_|0,n[q++]=u+F|0,n[q++]=h+j|0,n[q++]=f+$|0,n[q++]=d+C|0,n[q++]=p+k|0,n[q++]=g+I|0,n[q++]=m+A|0,n[q++]=E+B|0,n[q++]=O+U|0,n[q++]=x+N|0,n[q++]=b+T|0,n[q++]=v+M|0}const mB=fB(yB,{counterRight:!1,counterLength:4,allowShortKeys:!1}),wB=new Uint8Array(16),p0=(r,e)=>{r.update(e);const t=e.length%16;t&&r.update(wB.subarray(t))},bB=new Uint8Array(32);function g0(r,e,t,n,s){const i=r(e,t,bB),o=gB.create(i);s&&p0(o,s),p0(o,n);const a=sB(n.length,s?s.length:0,!0);o.update(a);const c=o.digest();return Zo(i,a),c}const xB=r=>(e,t,n)=>({encrypt(s,i){const o=s.length;i=h0(o+16,i,!1),i.set(s);const a=i.subarray(0,-16);r(e,t,a,a,1);const c=g0(r,e,t,a,n);return i.set(c,o),Zo(c),i},decrypt(s,i){i=h0(s.length-16,i,!1);const o=s.subarray(0,-16),a=s.subarray(-16),c=g0(r,e,t,o,n);if(!rB(a,c))throw new Error("invalid tag");return i.set(s.subarray(0,-16)),r(e,t,i,i,1),Zo(c),i}}),L1=nB({blockSize:64,nonceLength:12,tagLength:16},xB(mB));let j1=class extends Pu{constructor(e,t){super(),this.finished=!1,this.destroyed=!1,Ru(e);const n=Rr(t);if(this.iHash=e.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const s=this.blockLen,i=new Uint8Array(s);i.set(n.length>s?e.create().update(n).digest():n);for(let o=0;o<i.length;o++)i[o]^=54;this.iHash.update(i),this.oHash=e.create();for(let o=0;o<i.length;o++)i[o]^=106;this.oHash.update(i),br(i)}update(e){return $s(this),this.iHash.update(e),this}digestInto(e){$s(this),Tr(e,this.outputLen),this.finished=!0,this.iHash.digestInto(e),this.oHash.update(e),this.oHash.digestInto(e),this.destroy()}digest(){const e=new Uint8Array(this.oHash.outputLen);return this.digestInto(e),e}_cloneInto(e){e||(e=Object.create(Object.getPrototypeOf(this),{}));const{oHash:t,iHash:n,finished:s,destroyed:i,blockLen:o,outputLen:a}=this;return e=e,e.finished=s,e.destroyed=i,e.blockLen=o,e.outputLen=a,e.oHash=t._cloneInto(e.oHash),e.iHash=n._cloneInto(e.iHash),e}clone(){return this._cloneInto()}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}};const Uu=(r,e,t)=>new j1(r,e).update(t).digest();Uu.create=(r,e)=>new j1(r,e);function vB(r,e,t){return Ru(r),t===void 0&&(t=new Uint8Array(r.outputLen)),Uu(r,Rr(t),Rr(e))}const Fh=Uint8Array.from([0]),y0=Uint8Array.of();function EB(r,e,t,n=32){Ru(r),Hn(n);const s=r.outputLen;if(n>255*s)throw new Error("Length should be <= 255*HashLen");const i=Math.ceil(n/s);t===void 0&&(t=y0);const o=new Uint8Array(i*s),a=Uu.create(r,e),c=a._cloneInto(),l=new Uint8Array(a.outputLen);for(let u=0;u<i;u++)Fh[0]=u+1,c.update(u===0?y0:l).update(t).update(Fh).digestInto(l),o.set(l,s*u),a._cloneInto(c);return a.destroy(),c.destroy(),br(l,Fh),o.slice(0,n)}const AB=(r,e,t,n,s)=>EB(r,vB(r,e,t),n,s),$u=Tu,wp=BigInt(0),hd=BigInt(1);function eu(r,e=""){if(typeof r!="boolean"){const t=e&&`"${e}"`;throw new Error(t+"expected boolean, got type="+typeof r)}return r}function oi(r,e,t=""){const n=Bu(r),s=r==null?void 0:r.length,i=e!==void 0;if(!n||i&&s!==e){const o=t&&`"${t}" `,a=i?` of length ${e}`:"",c=n?`length=${s}`:`type=${typeof r}`;throw new Error(o+"expected Uint8Array"+a+", got "+c)}return r}function il(r){const e=r.toString(16);return e.length&1?"0"+e:e}function M1(r){if(typeof r!="string")throw new Error("hex string expected, got "+typeof r);return r===""?wp:BigInt("0x"+r)}function Fu(r){return M1(wo(r))}function tu(r){return Tr(r),M1(wo(Uint8Array.from(r).reverse()))}function bp(r,e){return Zl(r.toString(16).padStart(e*2,"0"))}function xp(r,e){return bp(r,e).reverse()}function xt(r,e,t){let n;if(typeof e=="string")try{n=Zl(e)}catch(i){throw new Error(r+" must be hex string or Uint8Array, cause: "+i)}else if(Bu(e))n=Uint8Array.from(e);else throw new Error(r+" must be hex string or Uint8Array");const s=n.length;if(typeof t=="number"&&s!==t)throw new Error(r+" of length "+t+" expected, got "+s);return n}const Lh=r=>typeof r=="bigint"&&wp<=r;function IB(r,e,t){return Lh(r)&&Lh(e)&&Lh(t)&&e<=r&&r<t}function fd(r,e,t,n){if(!IB(e,t,n))throw new Error("expected valid "+r+": "+t+" <= n < "+n+", got "+e)}function z1(r){let e;for(e=0;r>wp;r>>=hd,e+=1);return e}const Cc=r=>(hd<<BigInt(r))-hd;function SB(r,e,t){if(typeof r!="number"||r<2)throw new Error("hashLen must be a number");if(typeof e!="number"||e<2)throw new Error("qByteLen must be a number");if(typeof t!="function")throw new Error("hmacFn must be a function");const n=f=>new Uint8Array(f),s=f=>Uint8Array.of(f);let i=n(r),o=n(r),a=0;const c=()=>{i.fill(1),o.fill(0),a=0},l=(...f)=>t(o,i,...f),u=(f=n(0))=>{o=l(s(0),f),i=l(),f.length!==0&&(o=l(s(1),f),i=l())},h=()=>{if(a++>=1e3)throw new Error("drbg: tried 1000 values");let f=0;const d=[];for(;f<e;){i=l();const p=i.slice();d.push(p),f+=i.length}return hs(...d)};return(f,d)=>{c(),u(f);let p;for(;!(p=d(h()));)u();return c(),p}}function Lu(r,e,t={}){if(!r||typeof r!="object")throw new Error("expected valid options object");function n(s,i,o){const a=r[s];if(o&&a===void 0)return;const c=typeof a;if(c!==i||a===null)throw new Error(`param "${s}" is invalid: expected ${i}, got ${c}`)}Object.entries(e).forEach(([s,i])=>n(s,i,!1)),Object.entries(t).forEach(([s,i])=>n(s,i,!0))}function m0(r){const e=new WeakMap;return(t,...n)=>{const s=e.get(t);if(s!==void 0)return s;const i=r(t,...n);return e.set(t,i),i}}const qt=BigInt(0),Nt=BigInt(1),ai=BigInt(2),q1=BigInt(3),V1=BigInt(4),K1=BigInt(5),OB=BigInt(7),H1=BigInt(8),DB=BigInt(9),G1=BigInt(16);function rr(r,e){const t=r%e;return t>=qt?t:e+t}function Ar(r,e,t){let n=r;for(;e-- >qt;)n*=n,n%=t;return n}function w0(r,e){if(r===qt)throw new Error("invert: expected non-zero number");if(e<=qt)throw new Error("invert: expected positive modulus, got "+e);let t=rr(r,e),n=e,s=qt,i=Nt;for(;t!==qt;){const o=n/t,a=n%t,c=s-i*o;n=t,t=a,s=i,i=c}if(n!==Nt)throw new Error("invert: does not exist");return rr(s,e)}function vp(r,e,t){if(!r.eql(r.sqr(e),t))throw new Error("Cannot find square root")}function Q1(r,e){const t=(r.ORDER+Nt)/V1,n=r.pow(e,t);return vp(r,n,e),n}function _B(r,e){const t=(r.ORDER-K1)/H1,n=r.mul(e,ai),s=r.pow(n,t),i=r.mul(e,s),o=r.mul(r.mul(i,ai),s),a=r.mul(i,r.sub(o,r.ONE));return vp(r,a,e),a}function NB(r){const e=Ms(r),t=W1(r),n=t(e,e.neg(e.ONE)),s=t(e,n),i=t(e,e.neg(n)),o=(r+OB)/G1;return(a,c)=>{let l=a.pow(c,o),u=a.mul(l,n);const h=a.mul(l,s),f=a.mul(l,i),d=a.eql(a.sqr(u),c),p=a.eql(a.sqr(h),c);l=a.cmov(l,u,d),u=a.cmov(f,h,p);const g=a.eql(a.sqr(u),c),m=a.cmov(l,u,g);return vp(a,m,c),m}}function W1(r){if(r<q1)throw new Error("sqrt is not defined for small field");let e=r-Nt,t=0;for(;e%ai===qt;)e/=ai,t++;let n=ai;const s=Ms(r);for(;b0(s,n)===1;)if(n++>1e3)throw new Error("Cannot find square root: probably non-prime P");if(t===1)return Q1;let i=s.pow(n,e);const o=(e+Nt)/ai;return function(a,c){if(a.is0(c))return c;if(b0(a,c)!==1)throw new Error("Cannot find square root");let l=t,u=a.mul(a.ONE,i),h=a.pow(c,e),f=a.pow(c,o);for(;!a.eql(h,a.ONE);){if(a.is0(h))return a.ZERO;let d=1,p=a.sqr(h);for(;!a.eql(p,a.ONE);)if(d++,p=a.sqr(p),d===l)throw new Error("Cannot find square root");const g=Nt<<BigInt(l-d-1),m=a.pow(u,g);l=d,u=a.sqr(m),h=a.mul(h,u),f=a.mul(f,m)}return f}}function CB(r){return r%V1===q1?Q1:r%H1===K1?_B:r%G1===DB?NB(r):W1(r)}const BB=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function RB(r){const e={ORDER:"bigint",MASK:"bigint",BYTES:"number",BITS:"number"},t=BB.reduce((n,s)=>(n[s]="function",n),e);return Lu(r,t),r}function PB(r,e,t){if(t<qt)throw new Error("invalid exponent, negatives unsupported");if(t===qt)return r.ONE;if(t===Nt)return e;let n=r.ONE,s=e;for(;t>qt;)t&Nt&&(n=r.mul(n,s)),s=r.sqr(s),t>>=Nt;return n}function J1(r,e,t=!1){const n=new Array(e.length).fill(t?r.ZERO:void 0),s=e.reduce((o,a,c)=>r.is0(a)?o:(n[c]=o,r.mul(o,a)),r.ONE),i=r.inv(s);return e.reduceRight((o,a,c)=>r.is0(a)?o:(n[c]=r.mul(o,n[c]),r.mul(o,a)),i),n}function b0(r,e){const t=(r.ORDER-Nt)/ai,n=r.pow(e,t),s=r.eql(n,r.ONE),i=r.eql(n,r.ZERO),o=r.eql(n,r.neg(r.ONE));if(!s&&!i&&!o)throw new Error("invalid Legendre symbol result");return s?1:i?0:-1}function Y1(r,e){e!==void 0&&Hn(e);const t=e!==void 0?e:r.toString(2).length,n=Math.ceil(t/8);return{nBitLength:t,nByteLength:n}}function Ms(r,e,t=!1,n={}){if(r<=qt)throw new Error("invalid field: expected ORDER > 0, got "+r);let s,i,o=!1,a;if(typeof e=="object"&&e!=null){if(n.sqrt||t)throw new Error("cannot specify opts in two arguments");const f=e;f.BITS&&(s=f.BITS),f.sqrt&&(i=f.sqrt),typeof f.isLE=="boolean"&&(t=f.isLE),typeof f.modFromBytes=="boolean"&&(o=f.modFromBytes),a=f.allowedLengths}else typeof e=="number"&&(s=e),n.sqrt&&(i=n.sqrt);const{nBitLength:c,nByteLength:l}=Y1(r,s);if(l>2048)throw new Error("invalid field: expected ORDER of <= 2048 bytes");let u;const h=Object.freeze({ORDER:r,isLE:t,BITS:c,BYTES:l,MASK:Cc(c),ZERO:qt,ONE:Nt,allowedLengths:a,create:f=>rr(f,r),isValid:f=>{if(typeof f!="bigint")throw new Error("invalid field element: expected bigint, got "+typeof f);return qt<=f&&f<r},is0:f=>f===qt,isValidNot0:f=>!h.is0(f)&&h.isValid(f),isOdd:f=>(f&Nt)===Nt,neg:f=>rr(-f,r),eql:(f,d)=>f===d,sqr:f=>rr(f*f,r),add:(f,d)=>rr(f+d,r),sub:(f,d)=>rr(f-d,r),mul:(f,d)=>rr(f*d,r),pow:(f,d)=>PB(h,f,d),div:(f,d)=>rr(f*w0(d,r),r),sqrN:f=>f*f,addN:(f,d)=>f+d,subN:(f,d)=>f-d,mulN:(f,d)=>f*d,inv:f=>w0(f,r),sqrt:i||(f=>(u||(u=CB(r)),u(h,f))),toBytes:f=>t?xp(f,l):bp(f,l),fromBytes:(f,d=!0)=>{if(a){if(!a.includes(f.length)||f.length>l)throw new Error("Field.fromBytes: expected "+a+" bytes, got "+f.length);const g=new Uint8Array(l);g.set(f,t?0:g.length-f.length),f=g}if(f.length!==l)throw new Error("Field.fromBytes: expected "+l+" bytes, got "+f.length);let p=t?tu(f):Fu(f);if(o&&(p=rr(p,r)),!d&&!h.isValid(p))throw new Error("invalid field element: outside of range 0..ORDER");return p},invertBatch:f=>J1(h,f),cmov:(f,d,p)=>p?d:f});return Object.freeze(h)}function Z1(r){if(typeof r!="bigint")throw new Error("field order must be bigint");const e=r.toString(2).length;return Math.ceil(e/8)}function X1(r){const e=Z1(r);return e+Math.ceil(e/2)}function TB(r,e,t=!1){const n=r.length,s=Z1(e),i=X1(e);if(n<16||n<i||n>1024)throw new Error("expected "+i+"-1024 bytes of input, got "+n);const o=t?tu(r):Fu(r),a=rr(o,e-Nt)+Nt;return t?xp(a,s):bp(a,s)}const Xo=BigInt(0),ci=BigInt(1);function ru(r,e){const t=e.negate();return r?t:e}function jh(r,e){const t=J1(r.Fp,e.map(n=>n.Z));return e.map((n,s)=>r.fromAffine(n.toAffine(t[s])))}function ex(r,e){if(!Number.isSafeInteger(r)||r<=0||r>e)throw new Error("invalid window size, expected [1.."+e+"], got W="+r)}function Mh(r,e){ex(r,e);const t=Math.ceil(e/r)+1,n=2**(r-1),s=2**r,i=Cc(r),o=BigInt(r);return{windows:t,windowSize:n,mask:i,maxNumber:s,shiftBy:o}}function x0(r,e,t){const{windowSize:n,mask:s,maxNumber:i,shiftBy:o}=t;let a=Number(r&s),c=r>>o;a>n&&(a-=i,c+=ci);const l=e*n,u=l+Math.abs(a)-1,h=a===0,f=a<0,d=e%2!==0;return{nextN:c,offset:u,isZero:h,isNeg:f,isNegF:d,offsetF:l}}function kB(r,e){if(!Array.isArray(r))throw new Error("array expected");r.forEach((t,n)=>{if(!(t instanceof e))throw new Error("invalid point at index "+n)})}function UB(r,e){if(!Array.isArray(r))throw new Error("array of scalars expected");r.forEach((t,n)=>{if(!e.isValid(t))throw new Error("invalid scalar at index "+n)})}const zh=new WeakMap,tx=new WeakMap;function qh(r){return tx.get(r)||1}function v0(r){if(r!==Xo)throw new Error("invalid wNAF")}class $B{constructor(e,t){this.BASE=e.BASE,this.ZERO=e.ZERO,this.Fn=e.Fn,this.bits=t}_unsafeLadder(e,t,n=this.ZERO){let s=e;for(;t>Xo;)t&ci&&(n=n.add(s)),s=s.double(),t>>=ci;return n}precomputeWindow(e,t){const{windows:n,windowSize:s}=Mh(t,this.bits),i=[];let o=e,a=o;for(let c=0;c<n;c++){a=o,i.push(a);for(let l=1;l<s;l++)a=a.add(o),i.push(a);o=a.double()}return i}wNAF(e,t,n){if(!this.Fn.isValid(n))throw new Error("invalid scalar");let s=this.ZERO,i=this.BASE;const o=Mh(e,this.bits);for(let a=0;a<o.windows;a++){const{nextN:c,offset:l,isZero:u,isNeg:h,isNegF:f,offsetF:d}=x0(n,a,o);n=c,u?i=i.add(ru(f,t[d])):s=s.add(ru(h,t[l]))}return v0(n),{p:s,f:i}}wNAFUnsafe(e,t,n,s=this.ZERO){const i=Mh(e,this.bits);for(let o=0;o<i.windows&&n!==Xo;o++){const{nextN:a,offset:c,isZero:l,isNeg:u}=x0(n,o,i);if(n=a,!l){const h=t[c];s=s.add(u?h.negate():h)}}return v0(n),s}getPrecomputes(e,t,n){let s=zh.get(t);return s||(s=this.precomputeWindow(t,e),e!==1&&(typeof n=="function"&&(s=n(s)),zh.set(t,s))),s}cached(e,t,n){const s=qh(e);return this.wNAF(s,this.getPrecomputes(s,e,n),t)}unsafe(e,t,n,s){const i=qh(e);return i===1?this._unsafeLadder(e,t,s):this.wNAFUnsafe(i,this.getPrecomputes(i,e,n),t,s)}createCache(e,t){ex(t,this.bits),tx.set(e,t),zh.delete(e)}hasCache(e){return qh(e)!==1}}function FB(r,e,t,n){let s=e,i=r.ZERO,o=r.ZERO;for(;t>Xo||n>Xo;)t&ci&&(i=i.add(s)),n&ci&&(o=o.add(s)),s=s.double(),t>>=ci,n>>=ci;return{p1:i,p2:o}}function LB(r,e,t,n){kB(t,r),UB(n,e);const s=t.length,i=n.length;if(s!==i)throw new Error("arrays of points and scalars must have equal length");const o=r.ZERO,a=z1(BigInt(s));let c=1;a>12?c=a-3:a>4?c=a-2:a>0&&(c=2);const l=Cc(c),u=new Array(Number(l)+1).fill(o),h=Math.floor((e.BITS-1)/c)*c;let f=o;for(let d=h;d>=0;d-=c){u.fill(o);for(let g=0;g<i;g++){const m=n[g],E=Number(m>>BigInt(d)&l);u[E]=u[E].add(t[g])}let p=o;for(let g=u.length-1,m=o;g>0;g--)m=m.add(u[g]),p=p.add(m);if(f=f.add(p),d!==0)for(let g=0;g<c;g++)f=f.double()}return f}function E0(r,e,t){if(e){if(e.ORDER!==r)throw new Error("Field.ORDER must match order: Fp == p, Fn == n");return RB(e),e}else return Ms(r,{isLE:t})}function jB(r,e,t={},n){if(n===void 0&&(n=r==="edwards"),!e||typeof e!="object")throw new Error(`expected valid ${r} CURVE object`);for(const a of["p","n","h"]){const c=e[a];if(!(typeof c=="bigint"&&c>Xo))throw new Error(`CURVE.${a} must be positive bigint`)}const s=E0(e.p,t.Fp,n),i=E0(e.n,t.Fn,n),o=["Gx","Gy","a","b"];for(const a of o)if(!s.isValid(e[a]))throw new Error(`CURVE.${a} must be valid field element of CURVE.Fp`);return e=Object.freeze(Object.assign({},e)),{CURVE:e,Fp:s,Fn:i}}BigInt(0),BigInt(1),BigInt(2),BigInt(8),I1("HashToScalar-");const wa=BigInt(0),Zi=BigInt(1),ol=BigInt(2);function MB(r){return Lu(r,{adjustScalarBytes:"function",powPminus2:"function"}),Object.freeze({...r})}function zB(r){const e=MB(r),{P:t,type:n,adjustScalarBytes:s,powPminus2:i,randomBytes:o}=e,a=n==="x25519";if(!a&&n!=="x448")throw new Error("invalid type");const c=o||zi,l=a?255:448,u=a?32:56,h=BigInt(a?9:5),f=BigInt(a?121665:39081),d=a?ol**BigInt(254):ol**BigInt(447),p=a?BigInt(8)*ol**BigInt(251)-Zi:BigInt(4)*ol**BigInt(445)-Zi,g=d+p+Zi,m=$=>rr($,t),E=O(h);function O($){return xp(m($),u)}function x($){const C=xt("u coordinate",$,u);return a&&(C[31]&=127),m(tu(C))}function b($){return tu(s(xt("scalar",$,u)))}function v($,C){const k=R(x(C),b($));if(k===wa)throw new Error("invalid private or public key received");return O(k)}function S($){return v($,E)}function D($,C,k){const I=m($*(C-k));return C=m(C-I),k=m(k+I),{x_2:C,x_3:k}}function R($,C){fd("u",$,wa,t),fd("scalar",C,d,g);const k=C,I=$;let A=Zi,B=wa,U=$,N=Zi,T=wa;for(let q=BigInt(l-1);q>=wa;q--){const Y=k>>q&Zi;T^=Y,{x_2:A,x_3:U}=D(T,A,U),{x_2:B,x_3:N}=D(T,B,N),T=Y;const J=A+B,Q=m(J*J),re=A-B,ne=m(re*re),ae=Q-ne,te=U+N,ue=U-N,Ae=m(ue*J),Ne=m(te*re),Ue=Ae+Ne,Pe=Ae-Ne;U=m(Ue*Ue),N=m(I*m(Pe*Pe)),A=m(Q*ne),B=m(ae*(Q+m(f*ae)))}({x_2:A,x_3:U}=D(T,A,U)),{x_2:B,x_3:N}=D(T,B,N);const M=i(B);return m(A*M)}const _={secretKey:u,publicKey:u,seed:u},F=($=c(u))=>(Tr($,_.seed),$);function j($){const C=F($);return{secretKey:C,publicKey:S(C)}}return{keygen:j,getSharedSecret:($,C)=>v($,C),getPublicKey:$=>S($),scalarMult:v,scalarMultBase:S,utils:{randomSecretKey:F,randomPrivateKey:F},GuBytes:E.slice(),lengths:_}}const qB=BigInt(1),A0=BigInt(2),VB=BigInt(3),KB=BigInt(5);BigInt(8);const rx=BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffed"),HB={p:rx,n:BigInt("0x1000000000000000000000000000000014def9dea2f79cd65812631a5cf5d3ed"),a:BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffec"),d:BigInt("0x52036cee2b6ffe738cc740797779e89800700a4d4141d8ab75eb4dca135978a3"),Gx:BigInt("0x216936d3cd6e53fec0a4e231fdd6dc5c692cc7609525a7b2c9562d608f25d51a"),Gy:BigInt("0x6666666666666666666666666666666666666666666666666666666666666658")};function GB(r){const e=BigInt(10),t=BigInt(20),n=BigInt(40),s=BigInt(80),i=rx,o=r*r%i*r%i,a=Ar(o,A0,i)*o%i,c=Ar(a,qB,i)*r%i,l=Ar(c,KB,i)*c%i,u=Ar(l,e,i)*l%i,h=Ar(u,t,i)*u%i,f=Ar(h,n,i)*h%i,d=Ar(f,s,i)*f%i,p=Ar(d,s,i)*f%i,g=Ar(p,e,i)*l%i;return{pow_p_5_8:Ar(g,A0,i)*r%i,b2:o}}function QB(r){return r[0]&=248,r[31]&=127,r[31]|=64,r}const WB=Ms(HB.p,{isLE:!0}),dd=(()=>{const r=WB.ORDER;return zB({P:r,type:"x25519",powPminus2:e=>{const{pow_p_5_8:t,b2:n}=GB(e);return rr(Ar(t,VB,r)*n,r)},adjustScalarBytes:QB})})(),I0=(r,e)=>(r+(r>=0?e:-e)/nx)/e;function JB(r,e,t){const[[n,s],[i,o]]=e,a=I0(o*r,t),c=I0(-s*r,t);let l=r-a*n-c*i,u=-a*s-c*o;const h=l<Ln,f=u<Ln;h&&(l=-l),f&&(u=-u);const d=Cc(Math.ceil(z1(t)/2))+bo;if(l<Ln||l>=d||u<Ln||u>=d)throw new Error("splitScalar (endomorphism): failed, k="+r);return{k1neg:h,k1:l,k2neg:f,k2:u}}function pd(r){if(!["compact","recovered","der"].includes(r))throw new Error('Signature format must be "compact", "recovered", or "der"');return r}function Vh(r,e){const t={};for(let n of Object.keys(e))t[n]=r[n]===void 0?e[n]:r[n];return eu(t.lowS,"lowS"),eu(t.prehash,"prehash"),t.format!==void 0&&pd(t.format),t}class YB extends Error{constructor(e=""){super(e)}}const Dn={Err:YB,_tlv:{encode:(r,e)=>{const{Err:t}=Dn;if(r<0||r>256)throw new t("tlv.encode: wrong tag");if(e.length&1)throw new t("tlv.encode: unpadded data");const n=e.length/2,s=il(n);if(s.length/2&128)throw new t("tlv.encode: long form length too big");const i=n>127?il(s.length/2|128):"";return il(r)+i+s+e},decode(r,e){const{Err:t}=Dn;let n=0;if(r<0||r>256)throw new t("tlv.encode: wrong tag");if(e.length<2||e[n++]!==r)throw new t("tlv.decode: wrong tlv");const s=e[n++],i=!!(s&128);let o=0;if(!i)o=s;else{const c=s&127;if(!c)throw new t("tlv.decode(long): indefinite length not supported");if(c>4)throw new t("tlv.decode(long): byte length is too big");const l=e.subarray(n,n+c);if(l.length!==c)throw new t("tlv.decode: length bytes not complete");if(l[0]===0)throw new t("tlv.decode(long): zero leftmost byte");for(const u of l)o=o<<8|u;if(n+=c,o<128)throw new t("tlv.decode(long): not minimal encoding")}const a=e.subarray(n,n+o);if(a.length!==o)throw new t("tlv.decode: wrong value length");return{v:a,l:e.subarray(n+o)}}},_int:{encode(r){const{Err:e}=Dn;if(r<Ln)throw new e("integer: negative integers are not allowed");let t=il(r);if(Number.parseInt(t[0],16)&8&&(t="00"+t),t.length&1)throw new e("unexpected DER parsing assertion: unpadded hex");return t},decode(r){const{Err:e}=Dn;if(r[0]&128)throw new e("invalid signature integer: negative");if(r[0]===0&&!(r[1]&128))throw new e("invalid signature integer: unnecessary leading zero");return Fu(r)}},toSig(r){const{Err:e,_int:t,_tlv:n}=Dn,s=xt("signature",r),{v:i,l:o}=n.decode(48,s);if(o.length)throw new e("invalid signature: left bytes after parsing");const{v:a,l:c}=n.decode(2,i),{v:l,l:u}=n.decode(2,c);if(u.length)throw new e("invalid signature: left bytes after parsing");return{r:t.decode(a),s:t.decode(l)}},hexFromSig(r){const{_tlv:e,_int:t}=Dn,n=e.encode(2,t.encode(r.r)),s=e.encode(2,t.encode(r.s)),i=n+s;return e.encode(48,i)}},Ln=BigInt(0),bo=BigInt(1),nx=BigInt(2),al=BigInt(3),ZB=BigInt(4);function co(r,e){const{BYTES:t}=r;let n;if(typeof e=="bigint")n=e;else{let s=xt("private key",e);try{n=r.fromBytes(s)}catch{throw new Error(`invalid private key: expected ui8a of size ${t}, got ${typeof e}`)}}if(!r.isValidNot0(n))throw new Error("invalid private key: out of range [1..N-1]");return n}function XB(r,e={}){const t=jB("weierstrass",r,e),{Fp:n,Fn:s}=t;let i=t.CURVE;const{h:o,n:a}=i;Lu(e,{},{allowInfinityPoint:"boolean",clearCofactor:"function",isTorsionFree:"function",fromBytes:"function",toBytes:"function",endo:"object",wrapPrivateKey:"boolean"});const{endo:c}=e;if(c&&(!n.is0(i.a)||typeof c.beta!="bigint"||!Array.isArray(c.basises)))throw new Error('invalid endo: expected "beta": bigint and "basises": array');const l=ix(n,s);function u(){if(!n.isOdd)throw new Error("compression is not supported: Field does not have .isOdd()")}function h($,C,k){const{x:I,y:A}=C.toAffine(),B=n.toBytes(I);if(eu(k,"isCompressed"),k){u();const U=!n.isOdd(A);return hs(sx(U),B)}else return hs(Uint8Array.of(4),B,n.toBytes(A))}function f($){oi($,void 0,"Point");const{publicKey:C,publicKeyUncompressed:k}=l,I=$.length,A=$[0],B=$.subarray(1);if(I===C&&(A===2||A===3)){const U=n.fromBytes(B);if(!n.isValid(U))throw new Error("bad point: is not on curve, wrong x");const N=g(U);let T;try{T=n.sqrt(N)}catch(q){const Y=q instanceof Error?": "+q.message:"";throw new Error("bad point: is not on curve, sqrt error"+Y)}u();const M=n.isOdd(T);return(A&1)===1!==M&&(T=n.neg(T)),{x:U,y:T}}else if(I===k&&A===4){const U=n.BYTES,N=n.fromBytes(B.subarray(0,U)),T=n.fromBytes(B.subarray(U,U*2));if(!m(N,T))throw new Error("bad point: is not on curve");return{x:N,y:T}}else throw new Error(`bad point: got length ${I}, expected compressed=${C} or uncompressed=${k}`)}const d=e.toBytes||h,p=e.fromBytes||f;function g($){const C=n.sqr($),k=n.mul(C,$);return n.add(n.add(k,n.mul($,i.a)),i.b)}function m($,C){const k=n.sqr(C),I=g($);return n.eql(k,I)}if(!m(i.Gx,i.Gy))throw new Error("bad curve params: generator point");const E=n.mul(n.pow(i.a,al),ZB),O=n.mul(n.sqr(i.b),BigInt(27));if(n.is0(n.add(E,O)))throw new Error("bad curve params: a or b");function x($,C,k=!1){if(!n.isValid(C)||k&&n.is0(C))throw new Error(`bad point coordinate ${$}`);return C}function b($){if(!($ instanceof _))throw new Error("ProjectivePoint expected")}function v($){if(!c||!c.basises)throw new Error("no endo");return JB($,c.basises,s.ORDER)}const S=m0(($,C)=>{const{X:k,Y:I,Z:A}=$;if(n.eql(A,n.ONE))return{x:k,y:I};const B=$.is0();C==null&&(C=B?n.ONE:n.inv(A));const U=n.mul(k,C),N=n.mul(I,C),T=n.mul(A,C);if(B)return{x:n.ZERO,y:n.ZERO};if(!n.eql(T,n.ONE))throw new Error("invZ was invalid");return{x:U,y:N}}),D=m0($=>{if($.is0()){if(e.allowInfinityPoint&&!n.is0($.Y))return;throw new Error("bad point: ZERO")}const{x:C,y:k}=$.toAffine();if(!n.isValid(C)||!n.isValid(k))throw new Error("bad point: x or y not field elements");if(!m(C,k))throw new Error("bad point: equation left != right");if(!$.isTorsionFree())throw new Error("bad point: not in prime-order subgroup");return!0});function R($,C,k,I,A){return k=new _(n.mul(k.X,$),k.Y,k.Z),C=ru(I,C),k=ru(A,k),C.add(k)}class _{constructor(C,k,I){this.X=x("x",C),this.Y=x("y",k,!0),this.Z=x("z",I),Object.freeze(this)}static CURVE(){return i}static fromAffine(C){const{x:k,y:I}=C||{};if(!C||!n.isValid(k)||!n.isValid(I))throw new Error("invalid affine point");if(C instanceof _)throw new Error("projective point not allowed");return n.is0(k)&&n.is0(I)?_.ZERO:new _(k,I,n.ONE)}static fromBytes(C){const k=_.fromAffine(p(oi(C,void 0,"point")));return k.assertValidity(),k}static fromHex(C){return _.fromBytes(xt("pointHex",C))}get x(){return this.toAffine().x}get y(){return this.toAffine().y}precompute(C=8,k=!0){return j.createCache(this,C),k||this.multiply(al),this}assertValidity(){D(this)}hasEvenY(){const{y:C}=this.toAffine();if(!n.isOdd)throw new Error("Field doesn't support isOdd");return!n.isOdd(C)}equals(C){b(C);const{X:k,Y:I,Z:A}=this,{X:B,Y:U,Z:N}=C,T=n.eql(n.mul(k,N),n.mul(B,A)),M=n.eql(n.mul(I,N),n.mul(U,A));return T&&M}negate(){return new _(this.X,n.neg(this.Y),this.Z)}double(){const{a:C,b:k}=i,I=n.mul(k,al),{X:A,Y:B,Z:U}=this;let N=n.ZERO,T=n.ZERO,M=n.ZERO,q=n.mul(A,A),Y=n.mul(B,B),J=n.mul(U,U),Q=n.mul(A,B);return Q=n.add(Q,Q),M=n.mul(A,U),M=n.add(M,M),N=n.mul(C,M),T=n.mul(I,J),T=n.add(N,T),N=n.sub(Y,T),T=n.add(Y,T),T=n.mul(N,T),N=n.mul(Q,N),M=n.mul(I,M),J=n.mul(C,J),Q=n.sub(q,J),Q=n.mul(C,Q),Q=n.add(Q,M),M=n.add(q,q),q=n.add(M,q),q=n.add(q,J),q=n.mul(q,Q),T=n.add(T,q),J=n.mul(B,U),J=n.add(J,J),q=n.mul(J,Q),N=n.sub(N,q),M=n.mul(J,Y),M=n.add(M,M),M=n.add(M,M),new _(N,T,M)}add(C){b(C);const{X:k,Y:I,Z:A}=this,{X:B,Y:U,Z:N}=C;let T=n.ZERO,M=n.ZERO,q=n.ZERO;const Y=i.a,J=n.mul(i.b,al);let Q=n.mul(k,B),re=n.mul(I,U),ne=n.mul(A,N),ae=n.add(k,I),te=n.add(B,U);ae=n.mul(ae,te),te=n.add(Q,re),ae=n.sub(ae,te),te=n.add(k,A);let ue=n.add(B,N);return te=n.mul(te,ue),ue=n.add(Q,ne),te=n.sub(te,ue),ue=n.add(I,A),T=n.add(U,N),ue=n.mul(ue,T),T=n.add(re,ne),ue=n.sub(ue,T),q=n.mul(Y,te),T=n.mul(J,ne),q=n.add(T,q),T=n.sub(re,q),q=n.add(re,q),M=n.mul(T,q),re=n.add(Q,Q),re=n.add(re,Q),ne=n.mul(Y,ne),te=n.mul(J,te),re=n.add(re,ne),ne=n.sub(Q,ne),ne=n.mul(Y,ne),te=n.add(te,ne),Q=n.mul(re,te),M=n.add(M,Q),Q=n.mul(ue,te),T=n.mul(ae,T),T=n.sub(T,Q),Q=n.mul(ae,re),q=n.mul(ue,q),q=n.add(q,Q),new _(T,M,q)}subtract(C){return this.add(C.negate())}is0(){return this.equals(_.ZERO)}multiply(C){const{endo:k}=e;if(!s.isValidNot0(C))throw new Error("invalid scalar: out of range");let I,A;const B=U=>j.cached(this,U,N=>jh(_,N));if(k){const{k1neg:U,k1:N,k2neg:T,k2:M}=v(C),{p:q,f:Y}=B(N),{p:J,f:Q}=B(M);A=Y.add(Q),I=R(k.beta,q,J,U,T)}else{const{p:U,f:N}=B(C);I=U,A=N}return jh(_,[I,A])[0]}multiplyUnsafe(C){const{endo:k}=e,I=this;if(!s.isValid(C))throw new Error("invalid scalar: out of range");if(C===Ln||I.is0())return _.ZERO;if(C===bo)return I;if(j.hasCache(this))return this.multiply(C);if(k){const{k1neg:A,k1:B,k2neg:U,k2:N}=v(C),{p1:T,p2:M}=FB(_,I,B,N);return R(k.beta,T,M,A,U)}else return j.unsafe(I,C)}multiplyAndAddUnsafe(C,k,I){const A=this.multiplyUnsafe(k).add(C.multiplyUnsafe(I));return A.is0()?void 0:A}toAffine(C){return S(this,C)}isTorsionFree(){const{isTorsionFree:C}=e;return o===bo?!0:C?C(_,this):j.unsafe(this,a).is0()}clearCofactor(){const{clearCofactor:C}=e;return o===bo?this:C?C(_,this):this.multiplyUnsafe(o)}isSmallOrder(){return this.multiplyUnsafe(o).is0()}toBytes(C=!0){return eu(C,"isCompressed"),this.assertValidity(),d(_,this,C)}toHex(C=!0){return wo(this.toBytes(C))}toString(){return`<Point ${this.is0()?"ZERO":this.toHex()}>`}get px(){return this.X}get py(){return this.X}get pz(){return this.Z}toRawBytes(C=!0){return this.toBytes(C)}_setWindowSize(C){this.precompute(C)}static normalizeZ(C){return jh(_,C)}static msm(C,k){return LB(_,s,C,k)}static fromPrivateKey(C){return _.BASE.multiply(co(s,C))}}_.BASE=new _(i.Gx,i.Gy,n.ONE),_.ZERO=new _(n.ZERO,n.ONE,n.ZERO),_.Fp=n,_.Fn=s;const F=s.BITS,j=new $B(_,e.endo?Math.ceil(F/2):F);return _.BASE.precompute(8),_}function sx(r){return Uint8Array.of(r?2:3)}function ix(r,e){return{secretKey:e.BYTES,publicKey:1+r.BYTES,publicKeyUncompressed:1+2*r.BYTES,publicKeyHasPrefix:!0,signature:2*e.BYTES}}function e5(r,e={}){const{Fn:t}=r,n=e.randomBytes||zi,s=Object.assign(ix(r.Fp,t),{seed:X1(t.ORDER)});function i(f){try{return!!co(t,f)}catch{return!1}}function o(f,d){const{publicKey:p,publicKeyUncompressed:g}=s;try{const m=f.length;return d===!0&&m!==p||d===!1&&m!==g?!1:!!r.fromBytes(f)}catch{return!1}}function a(f=n(s.seed)){return TB(oi(f,s.seed,"seed"),t.ORDER)}function c(f,d=!0){return r.BASE.multiply(co(t,f)).toBytes(d)}function l(f){const d=a(f);return{secretKey:d,publicKey:c(d)}}function u(f){if(typeof f=="bigint")return!1;if(f instanceof r)return!0;const{secretKey:d,publicKey:p,publicKeyUncompressed:g}=s;if(t.allowedLengths||d===p)return;const m=xt("key",f).length;return m===p||m===g}function h(f,d,p=!0){if(u(f)===!0)throw new Error("first arg must be private key");if(u(d)===!1)throw new Error("second arg must be public key");const g=co(t,f);return r.fromHex(d).multiply(g).toBytes(p)}return Object.freeze({getPublicKey:c,getSharedSecret:h,keygen:l,Point:r,utils:{isValidSecretKey:i,isValidPublicKey:o,randomSecretKey:a,isValidPrivateKey:i,randomPrivateKey:a,normPrivateKeyToScalar:f=>co(t,f),precompute(f=8,d=r.BASE){return d.precompute(f,!1)}},lengths:s})}function t5(r,e,t={}){Ru(e),Lu(t,{},{hmac:"function",lowS:"boolean",randomBytes:"function",bits2int:"function",bits2int_modN:"function"});const n=t.randomBytes||zi,s=t.hmac||((k,...I)=>Uu(e,k,hs(...I))),{Fp:i,Fn:o}=r,{ORDER:a,BITS:c}=o,{keygen:l,getPublicKey:u,getSharedSecret:h,utils:f,lengths:d}=e5(r,t),p={prehash:!1,lowS:typeof t.lowS=="boolean"?t.lowS:!1,format:void 0,extraEntropy:!1},g="compact";function m(k){const I=a>>bo;return k>I}function E(k,I){if(!o.isValidNot0(I))throw new Error(`invalid signature ${k}: out of range 1..Point.Fn.ORDER`);return I}function O(k,I){pd(I);const A=d.signature,B=I==="compact"?A:I==="recovered"?A+1:void 0;return oi(k,B,`${I} signature`)}class x{constructor(I,A,B){this.r=E("r",I),this.s=E("s",A),B!=null&&(this.recovery=B),Object.freeze(this)}static fromBytes(I,A=g){O(I,A);let B;if(A==="der"){const{r:M,s:q}=Dn.toSig(oi(I));return new x(M,q)}A==="recovered"&&(B=I[0],A="compact",I=I.subarray(1));const U=o.BYTES,N=I.subarray(0,U),T=I.subarray(U,U*2);return new x(o.fromBytes(N),o.fromBytes(T),B)}static fromHex(I,A){return this.fromBytes(Zl(I),A)}addRecoveryBit(I){return new x(this.r,this.s,I)}recoverPublicKey(I){const A=i.ORDER,{r:B,s:U,recovery:N}=this;if(N==null||![0,1,2,3].includes(N))throw new Error("recovery id invalid");if(a*nx<A&&N>1)throw new Error("recovery id is ambiguous for h>1 curve");const T=N===2||N===3?B+a:B;if(!i.isValid(T))throw new Error("recovery id 2 or 3 invalid");const M=i.toBytes(T),q=r.fromBytes(hs(sx((N&1)===0),M)),Y=o.inv(T),J=v(xt("msgHash",I)),Q=o.create(-J*Y),re=o.create(U*Y),ne=r.BASE.multiplyUnsafe(Q).add(q.multiplyUnsafe(re));if(ne.is0())throw new Error("point at infinify");return ne.assertValidity(),ne}hasHighS(){return m(this.s)}toBytes(I=g){if(pd(I),I==="der")return Zl(Dn.hexFromSig(this));const A=o.toBytes(this.r),B=o.toBytes(this.s);if(I==="recovered"){if(this.recovery==null)throw new Error("recovery bit must be present");return hs(Uint8Array.of(this.recovery),A,B)}return hs(A,B)}toHex(I){return wo(this.toBytes(I))}assertValidity(){}static fromCompact(I){return x.fromBytes(xt("sig",I),"compact")}static fromDER(I){return x.fromBytes(xt("sig",I),"der")}normalizeS(){return this.hasHighS()?new x(this.r,o.neg(this.s),this.recovery):this}toDERRawBytes(){return this.toBytes("der")}toDERHex(){return wo(this.toBytes("der"))}toCompactRawBytes(){return this.toBytes("compact")}toCompactHex(){return wo(this.toBytes("compact"))}}const b=t.bits2int||function(k){if(k.length>8192)throw new Error("input is too large");const I=Fu(k),A=k.length*8-c;return A>0?I>>BigInt(A):I},v=t.bits2int_modN||function(k){return o.create(b(k))},S=Cc(c);function D(k){return fd("num < 2^"+c,k,Ln,S),o.toBytes(k)}function R(k,I){return oi(k,void 0,"message"),I?oi(e(k),void 0,"prehashed message"):k}function _(k,I,A){if(["recovered","canonical"].some(re=>re in A))throw new Error("sign() legacy options not supported");const{lowS:B,prehash:U,extraEntropy:N}=Vh(A,p);k=R(k,U);const T=v(k),M=co(o,I),q=[D(M),D(T)];if(N!=null&&N!==!1){const re=N===!0?n(d.secretKey):N;q.push(xt("extraEntropy",re))}const Y=hs(...q),J=T;function Q(re){const ne=b(re);if(!o.isValidNot0(ne))return;const ae=o.inv(ne),te=r.BASE.multiply(ne).toAffine(),ue=o.create(te.x);if(ue===Ln)return;const Ae=o.create(ae*o.create(J+ue*M));if(Ae===Ln)return;let Ne=(te.x===ue?0:2)|Number(te.y&bo),Ue=Ae;return B&&m(Ae)&&(Ue=o.neg(Ae),Ne^=1),new x(ue,Ue,Ne)}return{seed:Y,k2sig:Q}}function F(k,I,A={}){k=xt("message",k);const{seed:B,k2sig:U}=_(k,I,A);return SB(e.outputLen,o.BYTES,s)(B,U)}function j(k){let I;const A=typeof k=="string"||Bu(k),B=!A&&k!==null&&typeof k=="object"&&typeof k.r=="bigint"&&typeof k.s=="bigint";if(!A&&!B)throw new Error("invalid signature, expected Uint8Array, hex string or Signature instance");if(B)I=new x(k.r,k.s);else if(A){try{I=x.fromBytes(xt("sig",k),"der")}catch(U){if(!(U instanceof Dn.Err))throw U}if(!I)try{I=x.fromBytes(xt("sig",k),"compact")}catch{return!1}}return I||!1}function $(k,I,A,B={}){const{lowS:U,prehash:N,format:T}=Vh(B,p);if(A=xt("publicKey",A),I=R(xt("message",I),N),"strict"in B)throw new Error("options.strict was renamed to lowS");const M=T===void 0?j(k):x.fromBytes(xt("sig",k),T);if(M===!1)return!1;try{const q=r.fromBytes(A);if(U&&M.hasHighS())return!1;const{r:Y,s:J}=M,Q=v(I),re=o.inv(J),ne=o.create(Q*re),ae=o.create(Y*re),te=r.BASE.multiplyUnsafe(ne).add(q.multiplyUnsafe(ae));return te.is0()?!1:o.create(te.x)===Y}catch{return!1}}function C(k,I,A={}){const{prehash:B}=Vh(A,p);return I=R(I,B),x.fromBytes(k,"recovered").recoverPublicKey(I).toBytes()}return Object.freeze({keygen:l,getPublicKey:u,getSharedSecret:h,utils:f,lengths:d,Point:r,sign:F,verify:$,recoverPublicKey:C,Signature:x,hash:e})}function r5(r){const e={a:r.a,b:r.b,p:r.Fp.ORDER,n:r.n,h:r.h,Gx:r.Gx,Gy:r.Gy},t=r.Fp;let n=r.allowedPrivateKeyLengths?Array.from(new Set(r.allowedPrivateKeyLengths.map(o=>Math.ceil(o/2)))):void 0;const s=Ms(e.n,{BITS:r.nBitLength,allowedLengths:n,modFromBytes:r.wrapPrivateKey}),i={Fp:t,Fn:s,allowInfinityPoint:r.allowInfinityPoint,endo:r.endo,isTorsionFree:r.isTorsionFree,clearCofactor:r.clearCofactor,fromBytes:r.fromBytes,toBytes:r.toBytes};return{CURVE:e,curveOpts:i}}function n5(r){const{CURVE:e,curveOpts:t}=r5(r),n={hmac:r.hmac,randomBytes:r.randomBytes,lowS:r.lowS,bits2int:r.bits2int,bits2int_modN:r.bits2int_modN};return{CURVE:e,curveOpts:t,hash:r.hash,ecdsaOpts:n}}function s5(r,e){const t=e.Point;return Object.assign({},e,{ProjectivePoint:t,CURVE:Object.assign({},r,Y1(t.Fn.ORDER,t.Fn.BITS))})}function i5(r){const{CURVE:e,curveOpts:t,hash:n,ecdsaOpts:s}=n5(r),i=XB(e,t),o=t5(i,n,s);return s5(r,o)}function gd(r,e){const t=n=>i5({...r,hash:n});return{...t(e),create:t}}const ox={p:BigInt("0xffffffff00000001000000000000000000000000ffffffffffffffffffffffff"),n:BigInt("0xffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc632551"),h:BigInt(1),a:BigInt("0xffffffff00000001000000000000000000000000fffffffffffffffffffffffc"),b:BigInt("0x5ac635d8aa3a93e7b3ebbd55769886bc651d06b0cc53b0f63bce3c3e27d2604b"),Gx:BigInt("0x6b17d1f2e12c4247f8bce6e563a440f277037d812deb33a0f4a13945d898c296"),Gy:BigInt("0x4fe342e2fe1a7f9b8ee7eb4a7c0f9e162bce33576b315ececbb6406837bf51f5")},ax={p:BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffeffffffff0000000000000000ffffffff"),n:BigInt("0xffffffffffffffffffffffffffffffffffffffffffffffffc7634d81f4372ddf581a0db248b0a77aecec196accc52973"),h:BigInt(1),a:BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffeffffffff0000000000000000fffffffc"),b:BigInt("0xb3312fa7e23ee7e4988e056be3f82d19181d9c6efe8141120314088f5013875ac656398d8a2ed19d2a85c8edd3ec2aef"),Gx:BigInt("0xaa87ca22be8b05378eb1c71ef320ad746e1d3b628ba79b9859f741e082542a385502f25dbf55296c3a545e3872760ab7"),Gy:BigInt("0x3617de4a96262c6f5d9e98bf9292dc29f8f41dbd289a147ce9da3113b5f0b8c00a60b1ce1d7e819d7a431d7c90ea0e5f")},cx={p:BigInt("0x1ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff"),n:BigInt("0x01fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffa51868783bf2f966b7fcc0148f709a5d03bb5c9b8899c47aebb6fb71e91386409"),h:BigInt(1),a:BigInt("0x1fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffc"),b:BigInt("0x0051953eb9618e1c9a1f929a21a0b68540eea2da725b99b315f3b8b489918ef109e156193951ec7e937b1652c0bd3bb1bf073573df883d2c34f1ef451fd46b503f00"),Gx:BigInt("0x00c6858e06b70404e9cd9e3ecb662395b4429c648139053fb521f828af606b4d3dbaa14b5e77efe75928fe1dc127a2ffa8de3348b3c1856a429bf97e7e31c2e5bd66"),Gy:BigInt("0x011839296a789a3bc0045c8a5fb42c7d1bd998f54449579b446817afbd17273e662c97ee72995ef42640c550b9013fad0761353c7086a272c24088be94769fd16650")},o5=Ms(ox.p),a5=Ms(ax.p),c5=Ms(cx.p),l5=gd({...ox,Fp:o5,lowS:!1},Tu);gd({...ax,Fp:a5,lowS:!1},pC),gd({...cx,Fp:c5,lowS:!1,allowedPrivateKeyLengths:[130,131,132]},dC);const u5=l5,lx="base10",Ct="base16",jt="base64pad",fs="base64url",Bc="utf8",ux=0,zn=1,Rc=2,h5=0,S0=1,$a=12,Ep=32;function f5(){const r=dd.utils.randomPrivateKey(),e=dd.getPublicKey(r);return{privateKey:Vt(r,Ct),publicKey:Vt(e,Ct)}}function yd(){const r=zi(Ep);return Vt(r,Ct)}function d5(r,e){const t=dd.getSharedSecret(wr(r,Ct),wr(e,Ct)),n=AB($u,t,void 0,void 0,Ep);return Vt(n,Ct)}function Il(r){const e=$u(wr(r,Ct));return Vt(e,Ct)}function yr(r){const e=$u(wr(r,Bc));return Vt(e,Ct)}function hx(r){return wr(`${r}`,lx)}function $i(r){return Number(Vt(r,lx))}function fx(r){return r.replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"")}function dx(r){const e=r.replace(/-/g,"+").replace(/_/g,"/"),t=(4-e.length%4)%4;return e+"=".repeat(t)}function p5(r){const e=hx(typeof r.type<"u"?r.type:ux);if($i(e)===zn&&typeof r.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");const t=typeof r.senderPublicKey<"u"?wr(r.senderPublicKey,Ct):void 0,n=typeof r.iv<"u"?wr(r.iv,Ct):zi($a),s=wr(r.symKey,Ct),i=L1(s,n).encrypt(wr(r.message,Bc)),o=px({type:e,sealed:i,iv:n,senderPublicKey:t});return r.encoding===fs?fx(o):o}function g5(r){const e=wr(r.symKey,Ct),{sealed:t,iv:n}=ic({encoded:r.encoded,encoding:r.encoding}),s=L1(e,n).decrypt(t);if(s===null)throw new Error("Failed to decrypt");return Vt(s,Bc)}function y5(r,e){const t=hx(Rc),n=zi($a),s=wr(r,Bc),i=px({type:t,sealed:s,iv:n});return e===fs?fx(i):i}function m5(r,e){const{sealed:t}=ic({encoded:r,encoding:e});return Vt(t,Bc)}function px(r){if($i(r.type)===Rc)return Vt(Ua([r.type,r.sealed]),jt);if($i(r.type)===zn){if(typeof r.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");return Vt(Ua([r.type,r.senderPublicKey,r.iv,r.sealed]),jt)}return Vt(Ua([r.type,r.iv,r.sealed]),jt)}function ic(r){const e=(r.encoding||jt)===fs?dx(r.encoded):r.encoded,t=wr(e,jt),n=t.slice(h5,S0),s=S0;if($i(n)===zn){const c=s+Ep,l=c+$a,u=t.slice(s,c),h=t.slice(c,l),f=t.slice(l);return{type:n,sealed:f,iv:h,senderPublicKey:u}}if($i(n)===Rc){const c=t.slice(s),l=zi($a);return{type:n,sealed:c,iv:l}}const i=s+$a,o=t.slice(s,i),a=t.slice(i);return{type:n,sealed:a,iv:o}}function w5(r,e){const t=ic({encoded:r,encoding:e==null?void 0:e.encoding});return gx({type:$i(t.type),senderPublicKey:typeof t.senderPublicKey<"u"?Vt(t.senderPublicKey,Ct):void 0,receiverPublicKey:e==null?void 0:e.receiverPublicKey})}function gx(r){const e=(r==null?void 0:r.type)||ux;if(e===zn){if(typeof(r==null?void 0:r.senderPublicKey)>"u")throw new Error("missing sender public key");if(typeof(r==null?void 0:r.receiverPublicKey)>"u")throw new Error("missing receiver public key")}return{type:e,senderPublicKey:r==null?void 0:r.senderPublicKey,receiverPublicKey:r==null?void 0:r.receiverPublicKey}}function O0(r){return r.type===zn&&typeof r.senderPublicKey=="string"&&typeof r.receiverPublicKey=="string"}function D0(r){return r.type===Rc}function b5(r){const e=Buffer.from(r.x,"base64"),t=Buffer.from(r.y,"base64");return Ua([new Uint8Array([4]),e,t])}function x5(r,e){const[t,n,s]=r.split("."),i=Buffer.from(dx(s),"base64");if(i.length!==64)throw new Error("Invalid signature length");const o=i.slice(0,32),a=i.slice(32,64),c=`${t}.${n}`,l=$u(c),u=b5(e);if(!u5.verify(Ua([o,a]),l,u))throw new Error("Invalid signature");return Wf(r).payload}const v5="irn";function nu(r){return(r==null?void 0:r.relay)||{protocol:v5}}function lo(r){const e=t4[r];if(typeof e>"u")throw new Error(`Relay Protocol not supported: ${r}`);return e}var E5=Object.defineProperty,A5=Object.defineProperties,I5=Object.getOwnPropertyDescriptors,_0=Object.getOwnPropertySymbols,S5=Object.prototype.hasOwnProperty,O5=Object.prototype.propertyIsEnumerable,N0=(r,e,t)=>e in r?E5(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,Kh=(r,e)=>{for(var t in e||(e={}))S5.call(e,t)&&N0(r,t,e[t]);if(_0)for(var t of _0(e))O5.call(e,t)&&N0(r,t,e[t]);return r},D5=(r,e)=>A5(r,I5(e));function _5(r,e="-"){const t={},n="relay"+e;return Object.keys(r).forEach(s=>{if(s.startsWith(n)){const i=s.replace(n,""),o=r[s];t[i]=o}}),t}function C0(r){if(!r.includes("wc:")){const l=w1(r);l!=null&&l.includes("wc:")&&(r=l)}r=r.includes("wc://")?r.replace("wc://",""):r,r=r.includes("wc:")?r.replace("wc:",""):r;const e=r.indexOf(":"),t=r.indexOf("?")!==-1?r.indexOf("?"):void 0,n=r.substring(0,e),s=r.substring(e+1,t).split("@"),i=typeof t<"u"?r.substring(t):"",o=new URLSearchParams(i),a=Object.fromEntries(o.entries()),c=typeof a.methods=="string"?a.methods.split(","):void 0;return{protocol:n,topic:N5(s[0]),version:parseInt(s[1],10),symKey:a.symKey,relay:_5(a),methods:c,expiryTimestamp:a.expiryTimestamp?parseInt(a.expiryTimestamp,10):void 0}}function N5(r){return r.startsWith("//")?r.substring(2):r}function C5(r,e="-"){const t="relay",n={};return Object.keys(r).forEach(s=>{const i=s,o=t+e+i;r[i]&&(n[o]=r[i])}),n}function B0(r){const e=new URLSearchParams,t=Kh(Kh(D5(Kh({},C5(r.relay)),{symKey:r.symKey}),r.expiryTimestamp&&{expiryTimestamp:r.expiryTimestamp.toString()}),r.methods&&{methods:r.methods.join(",")});return Object.entries(t).sort(([n],[s])=>n.localeCompare(s)).forEach(([n,s])=>{s!==void 0&&e.append(n,String(s))}),`${r.protocol}:${r.topic}@${r.version}?${e}`}function cl(r,e,t){return`${r}?wc_ev=${t}&topic=${e}`}var B5=Object.defineProperty,R5=Object.defineProperties,P5=Object.getOwnPropertyDescriptors,R0=Object.getOwnPropertySymbols,T5=Object.prototype.hasOwnProperty,k5=Object.prototype.propertyIsEnumerable,P0=(r,e,t)=>e in r?B5(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,U5=(r,e)=>{for(var t in e||(e={}))T5.call(e,t)&&P0(r,t,e[t]);if(R0)for(var t of R0(e))k5.call(e,t)&&P0(r,t,e[t]);return r},$5=(r,e)=>R5(r,P5(e));function na(r){const e=[];return r.forEach(t=>{const[n,s]=t.split(":");e.push(`${n}:${s}`)}),e}function yx(r){const e=[];return Object.values(r).forEach(t=>{e.push(...na(t.accounts))}),[...new Set(e)]}function F5(r){const e=[];return Object.values(r).forEach(t=>{e.push(...t.methods)}),[...new Set(e)]}function L5(r){const e=[];return Object.values(r).forEach(t=>{e.push(...t.events)}),[...new Set(e)]}function j5(r,e){const t=[];return Object.values(r).forEach(n=>{na(n.accounts).includes(e)&&t.push(...n.methods)}),t}function M5(r,e){const t=[];return Object.values(r).forEach(n=>{na(n.accounts).includes(e)&&t.push(...n.events)}),t}function mx(r){return r.includes(":")}function z5(r){return mx(r)?r.split(":")[0]:r}function T0(r){var e,t,n;const s={};if(!oc(r))return s;for(const[i,o]of Object.entries(r)){const a=mx(i)?[i]:o.chains,c=o.methods||[],l=o.events||[],u=z5(i);s[u]=$5(U5({},s[u]),{chains:Ci(a,(e=s[u])==null?void 0:e.chains),methods:Ci(c,(t=s[u])==null?void 0:t.methods),events:Ci(l,(n=s[u])==null?void 0:n.events)})}return s}function q5(r){const e={};return r==null||r.forEach(t=>{var n;const[s,i]=t.split(":");e[s]||(e[s]={accounts:[],chains:[],events:[],methods:[]}),e[s].accounts.push(t),(n=e[s].chains)==null||n.push(`${s}:${i}`)}),e}function k0(r,e){e=e.map(n=>n.replace("did:pkh:",""));const t=q5(e);for(const[n,s]of Object.entries(t))s.methods?s.methods=Ci(s.methods,r):s.methods=r,s.events=["chainChanged","accountsChanged"];return t}function V5(r,e){var t,n,s,i,o,a;const c=T0(r),l=T0(e),u={},h=Object.keys(c).concat(Object.keys(l));for(const f of h)u[f]={chains:Ci((t=c[f])==null?void 0:t.chains,(n=l[f])==null?void 0:n.chains),methods:Ci((s=c[f])==null?void 0:s.methods,(i=l[f])==null?void 0:i.methods),events:Ci((o=c[f])==null?void 0:o.events,(a=l[f])==null?void 0:a.events)};return u}const K5={INVALID_METHOD:{message:"Invalid method.",code:1001},INVALID_EVENT:{message:"Invalid event.",code:1002},INVALID_UPDATE_REQUEST:{message:"Invalid update request.",code:1003},INVALID_EXTEND_REQUEST:{message:"Invalid extend request.",code:1004},INVALID_SESSION_SETTLE_REQUEST:{message:"Invalid session settle request.",code:1005},UNAUTHORIZED_METHOD:{message:"Unauthorized method.",code:3001},UNAUTHORIZED_EVENT:{message:"Unauthorized event.",code:3002},UNAUTHORIZED_UPDATE_REQUEST:{message:"Unauthorized update request.",code:3003},UNAUTHORIZED_EXTEND_REQUEST:{message:"Unauthorized extend request.",code:3004},USER_REJECTED:{message:"User rejected.",code:5e3},USER_REJECTED_CHAINS:{message:"User rejected chains.",code:5001},USER_REJECTED_METHODS:{message:"User rejected methods.",code:5002},USER_REJECTED_EVENTS:{message:"User rejected events.",code:5003},UNSUPPORTED_CHAINS:{message:"Unsupported chains.",code:5100},UNSUPPORTED_METHODS:{message:"Unsupported methods.",code:5101},UNSUPPORTED_EVENTS:{message:"Unsupported events.",code:5102},UNSUPPORTED_ACCOUNTS:{message:"Unsupported accounts.",code:5103},UNSUPPORTED_NAMESPACE_KEY:{message:"Unsupported namespace key.",code:5104},USER_DISCONNECTED:{message:"User disconnected.",code:6e3},SESSION_SETTLEMENT_FAILED:{message:"Session settlement failed.",code:7e3},WC_METHOD_UNSUPPORTED:{message:"Unsupported wc_ method.",code:10001}},H5={NOT_INITIALIZED:{message:"Not initialized.",code:1},NO_MATCHING_KEY:{message:"No matching key.",code:2},RESTORE_WILL_OVERRIDE:{message:"Restore will override.",code:3},RESUBSCRIBED:{message:"Resubscribed.",code:4},MISSING_OR_INVALID:{message:"Missing or invalid.",code:5},EXPIRED:{message:"Expired.",code:6},UNKNOWN_TYPE:{message:"Unknown type.",code:7},MISMATCHED_TOPIC:{message:"Mismatched topic.",code:8},NON_CONFORMING_NAMESPACES:{message:"Non conforming namespaces.",code:9}};function W(r,e){const{message:t,code:n}=H5[r];return{message:e?`${t} ${e}`:t,code:n}}function $e(r,e){const{message:t,code:n}=K5[r];return{message:e?`${t} ${e}`:t,code:n}}function ea(r,e){return Array.isArray(r)?typeof e<"u"&&r.length?r.every(e):!0:!1}function oc(r){return Object.getPrototypeOf(r)===Object.prototype&&Object.keys(r).length}function et(r){return typeof r>"u"}function Ve(r,e){return e&&et(r)?!0:typeof r=="string"&&!!r.trim().length}function Ap(r,e){return typeof r=="number"&&!isNaN(r)}function G5(r,e){const{requiredNamespaces:t}=e,n=Object.keys(r.namespaces),s=Object.keys(t);let i=!0;return ii(s,n)?(n.forEach(o=>{const{accounts:a,methods:c,events:l}=r.namespaces[o],u=na(a),h=t[o];(!ii(d1(o,h),u)||!ii(h.methods,c)||!ii(h.events,l))&&(i=!1)}),i):!1}function su(r){return Ve(r,!1)&&r.includes(":")?r.split(":").length===2:!1}function Q5(r){if(Ve(r,!1)&&r.includes(":")){const e=r.split(":");if(e.length===3){const t=e[0]+":"+e[1];return!!e[2]&&su(t)}}return!1}function W5(r){function e(t){try{return typeof new URL(t)<"u"}catch{return!1}}try{if(Ve(r,!1)){if(e(r))return!0;const t=w1(r);return e(t)}}catch{}return!1}function J5(r){var e;return(e=r==null?void 0:r.proposer)==null?void 0:e.publicKey}function Y5(r){return r==null?void 0:r.topic}function Z5(r,e){let t=null;return Ve(r==null?void 0:r.publicKey,!1)||(t=W("MISSING_OR_INVALID",`${e} controller public key should be a string`)),t}function U0(r){let e=!0;return ea(r)?r.length&&(e=r.every(t=>Ve(t,!1))):e=!1,e}function X5(r,e,t){let n=null;return ea(e)&&e.length?e.forEach(s=>{n||su(s)||(n=$e("UNSUPPORTED_CHAINS",`${t}, chain ${s} should be a string and conform to "namespace:chainId" format`))}):su(r)||(n=$e("UNSUPPORTED_CHAINS",`${t}, chains must be defined as "namespace:chainId" e.g. "eip155:1": {...} in the namespace key OR as an array of CAIP-2 chainIds e.g. eip155: { chains: ["eip155:1", "eip155:5"] }`)),n}function e6(r,e,t){let n=null;return Object.entries(r).forEach(([s,i])=>{if(n)return;const o=X5(s,d1(s,i),`${e} ${t}`);o&&(n=o)}),n}function t6(r,e){let t=null;return ea(r)?r.forEach(n=>{t||Q5(n)||(t=$e("UNSUPPORTED_ACCOUNTS",`${e}, account ${n} should be a string and conform to "namespace:chainId:address" format`))}):t=$e("UNSUPPORTED_ACCOUNTS",`${e}, accounts should be an array of strings conforming to "namespace:chainId:address" format`),t}function r6(r,e){let t=null;return Object.values(r).forEach(n=>{if(t)return;const s=t6(n==null?void 0:n.accounts,`${e} namespace`);s&&(t=s)}),t}function n6(r,e){let t=null;return U0(r==null?void 0:r.methods)?U0(r==null?void 0:r.events)||(t=$e("UNSUPPORTED_EVENTS",`${e}, events should be an array of strings or empty array for no events`)):t=$e("UNSUPPORTED_METHODS",`${e}, methods should be an array of strings or empty array for no methods`),t}function wx(r,e){let t=null;return Object.values(r).forEach(n=>{if(t)return;const s=n6(n,`${e}, namespace`);s&&(t=s)}),t}function s6(r,e,t){let n=null;if(r&&oc(r)){const s=wx(r,e);s&&(n=s);const i=e6(r,e,t);i&&(n=i)}else n=W("MISSING_OR_INVALID",`${e}, ${t} should be an object with data`);return n}function Hh(r,e){let t=null;if(r&&oc(r)){const n=wx(r,e);n&&(t=n);const s=r6(r,e);s&&(t=s)}else t=W("MISSING_OR_INVALID",`${e}, namespaces should be an object with data`);return t}function bx(r){return Ve(r.protocol,!0)}function i6(r,e){let t=!1;return r?r&&ea(r)&&r.length&&r.forEach(n=>{t=bx(n)}):t=!0,t}function o6(r){return typeof r=="number"}function kt(r){return typeof r<"u"&&typeof r!==null}function a6(r){return!(!r||typeof r!="object"||!r.code||!Ap(r.code)||!r.message||!Ve(r.message,!1))}function c6(r){return!(et(r)||!Ve(r.method,!1))}function l6(r){return!(et(r)||et(r.result)&&et(r.error)||!Ap(r.id)||!Ve(r.jsonrpc,!1))}function u6(r){return!(et(r)||!Ve(r.name,!1))}function $0(r,e){return!(!su(e)||!yx(r).includes(e))}function h6(r,e,t){return Ve(t,!1)?j5(r,e).includes(t):!1}function f6(r,e,t){return Ve(t,!1)?M5(r,e).includes(t):!1}function F0(r,e,t){let n=null;const s=d6(r),i=p6(e),o=Object.keys(s),a=Object.keys(i),c=L0(Object.keys(r)),l=L0(Object.keys(e)),u=c.filter(h=>!l.includes(h));return u.length&&(n=W("NON_CONFORMING_NAMESPACES",`${t} namespaces keys don't satisfy requiredNamespaces.
      Required: ${u.toString()}
      Received: ${Object.keys(e).toString()}`)),ii(o,a)||(n=W("NON_CONFORMING_NAMESPACES",`${t} namespaces chains don't satisfy required namespaces.
      Required: ${o.toString()}
      Approved: ${a.toString()}`)),Object.keys(e).forEach(h=>{if(!h.includes(":")||n)return;const f=na(e[h].accounts);f.includes(h)||(n=W("NON_CONFORMING_NAMESPACES",`${t} namespaces accounts don't satisfy namespace accounts for ${h}
        Required: ${h}
        Approved: ${f.toString()}`))}),o.forEach(h=>{n||(ii(s[h].methods,i[h].methods)?ii(s[h].events,i[h].events)||(n=W("NON_CONFORMING_NAMESPACES",`${t} namespaces events don't satisfy namespace events for ${h}`)):n=W("NON_CONFORMING_NAMESPACES",`${t} namespaces methods don't satisfy namespace methods for ${h}`))}),n}function d6(r){const e={};return Object.keys(r).forEach(t=>{var n;t.includes(":")?e[t]=r[t]:(n=r[t].chains)==null||n.forEach(s=>{e[s]={methods:r[t].methods,events:r[t].events}})}),e}function L0(r){return[...new Set(r.map(e=>e.includes(":")?e.split(":")[0]:e))]}function p6(r){const e={};return Object.keys(r).forEach(t=>{if(t.includes(":"))e[t]=r[t];else{const n=na(r[t].accounts);n==null||n.forEach(s=>{e[s]={accounts:r[t].accounts.filter(i=>i.includes(`${s}:`)),methods:r[t].methods,events:r[t].events}})}}),e}function g6(r,e){return Ap(r)&&r<=e.max&&r>=e.min}function j0(){const r=_c();return new Promise(e=>{switch(r){case sr.browser:e(y6());break;case sr.reactNative:e(m6());break;case sr.node:e(w6());break;default:e(!0)}})}function y6(){return ra()&&(navigator==null?void 0:navigator.onLine)}async function m6(){if(js()&&typeof global<"u"&&global!=null&&global.NetInfo){const r=await(global==null?void 0:global.NetInfo.fetch());return r==null?void 0:r.isConnected}return!0}function w6(){return!0}function b6(r){switch(_c()){case sr.browser:x6(r);break;case sr.reactNative:v6(r);break}}function x6(r){!js()&&ra()&&(window.addEventListener("online",()=>r(!0)),window.addEventListener("offline",()=>r(!1)))}function v6(r){js()&&typeof global<"u"&&global!=null&&global.NetInfo&&(global==null||global.NetInfo.addEventListener(e=>r(e==null?void 0:e.isConnected)))}function E6(){var r;return ra()&&Kn.getDocument()?((r=Kn.getDocument())==null?void 0:r.visibilityState)==="visible":!0}const Gh={};class ba{static get(e){return Gh[e]}static set(e,t){Gh[e]=t}static delete(e){delete Gh[e]}}function A6(r){const e=Oc.decode(r);if(e.length<33)throw new Error("Too short to contain a public key");return e.slice(1,33)}function I6({publicKey:r,signature:e,payload:t}){var n;const s=md(t.method),i=128|parseInt(((n=t.version)==null?void 0:n.toString())||"4"),o=D6(t.address),a=t.era==="00"?new Uint8Array([0]):md(t.era);if(a.length!==1&&a.length!==2)throw new Error("Invalid era length");const c=parseInt(t.nonce,16),l=new Uint8Array([c&255,c>>8&255]),u=BigInt(`0x${O6(t.tip)}`),h=N6(u),f=new Uint8Array([0,...r,o,...e,...a,...l,...h,...s]),d=_6(f.length+1);return new Uint8Array([...d,i,...f])}function S6(r){const e=md(r),t=i4.blake2b(e,void 0,32);return"0x"+Buffer.from(t).toString("hex")}function md(r){return new Uint8Array(r.replace(/^0x/,"").match(/.{1,2}/g).map(e=>parseInt(e,16)))}function O6(r){return r.startsWith("0x")?r.slice(2):r}function D6(r){const e=Oc.decode(r)[0];return e===42?0:e===60?2:1}function _6(r){if(r<64)return new Uint8Array([r<<2]);if(r<16384){const e=r<<2|1;return new Uint8Array([e&255,e>>8&255])}else if(r<1<<30){const e=r<<2|2;return new Uint8Array([e&255,e>>8&255,e>>16&255,e>>24&255])}else throw new Error("Compact encoding > 2^30 not supported")}function N6(r){if(r<BigInt(1)<<BigInt(6))return new Uint8Array([Number(r<<BigInt(2))]);if(r<BigInt(1)<<BigInt(14)){const e=r<<BigInt(2)|BigInt(1);return new Uint8Array([Number(e&BigInt(255)),Number(e>>BigInt(8)&BigInt(255))])}else if(r<BigInt(1)<<BigInt(30)){const e=r<<BigInt(2)|BigInt(2);return new Uint8Array([Number(e&BigInt(255)),Number(e>>BigInt(8)&BigInt(255)),Number(e>>BigInt(16)&BigInt(255)),Number(e>>BigInt(24)&BigInt(255))])}else throw new Error("BigInt compact encoding not supported > 2^30")}function C6(r){const e=Uint8Array.from(Buffer.from(r.signature,"hex")),t=A6(r.transaction.address),n=I6({publicKey:t,signature:e,payload:r.transaction}),s=Buffer.from(n).toString("hex");return S6(s)}function xx({logger:r,name:e}){const t=typeof r=="string"?$w({opts:{level:r,name:e}}).logger:r;return t.level=typeof r=="string"?r:r.level,t}const B6="PARSE_ERROR",R6="INVALID_REQUEST",P6="METHOD_NOT_FOUND",T6="INVALID_PARAMS",vx="INTERNAL_ERROR",Ip="SERVER_ERROR",k6=[-32700,-32600,-32601,-32602,-32603],Fa={[B6]:{code:-32700,message:"Parse error"},[R6]:{code:-32600,message:"Invalid Request"},[P6]:{code:-32601,message:"Method not found"},[T6]:{code:-32602,message:"Invalid params"},[vx]:{code:-32603,message:"Internal error"},[Ip]:{code:-32e3,message:"Server error"}},Ex=Ip;function U6(r){return k6.includes(r)}function M0(r){return Object.keys(Fa).includes(r)?Fa[r]:Fa[Ex]}function $6(r){const e=Object.values(Fa).find(t=>t.code===r);return e||Fa[Ex]}function F6(r,e,t){return r.message.includes("getaddrinfo ENOTFOUND")||r.message.includes("connect ECONNREFUSED")?new Error(`Unavailable ${t} RPC url at ${e}`):r}var Qh={};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var wd=function(r,e){return wd=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var s in n)n.hasOwnProperty(s)&&(t[s]=n[s])},wd(r,e)};function L6(r,e){wd(r,e);function t(){this.constructor=r}r.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var bd=function(){return bd=Object.assign||function(e){for(var t,n=1,s=arguments.length;n<s;n++){t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e},bd.apply(this,arguments)};function j6(r,e){var t={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&e.indexOf(n)<0&&(t[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(r);s<n.length;s++)e.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(r,n[s])&&(t[n[s]]=r[n[s]]);return t}function M6(r,e,t,n){var s=arguments.length,i=s<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,t):n,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")i=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(o=r[a])&&(i=(s<3?o(i):s>3?o(e,t,i):o(e,t))||i);return s>3&&i&&Object.defineProperty(e,t,i),i}function z6(r,e){return function(t,n){e(t,n,r)}}function q6(r,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,e)}function V6(r,e,t,n){function s(i){return i instanceof t?i:new t(function(o){o(i)})}return new(t||(t=Promise))(function(i,o){function a(u){try{l(n.next(u))}catch(h){o(h)}}function c(u){try{l(n.throw(u))}catch(h){o(h)}}function l(u){u.done?i(u.value):s(u.value).then(a,c)}l((n=n.apply(r,e||[])).next())})}function K6(r,e){var t={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,s,i,o;return o={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function a(l){return function(u){return c([l,u])}}function c(l){if(n)throw new TypeError("Generator is already executing.");for(;t;)try{if(n=1,s&&(i=l[0]&2?s.return:l[0]?s.throw||((i=s.return)&&i.call(s),0):s.next)&&!(i=i.call(s,l[1])).done)return i;switch(s=0,i&&(l=[l[0]&2,i.value]),l[0]){case 0:case 1:i=l;break;case 4:return t.label++,{value:l[1],done:!1};case 5:t.label++,s=l[1],l=[0];continue;case 7:l=t.ops.pop(),t.trys.pop();continue;default:if(i=t.trys,!(i=i.length>0&&i[i.length-1])&&(l[0]===6||l[0]===2)){t=0;continue}if(l[0]===3&&(!i||l[1]>i[0]&&l[1]<i[3])){t.label=l[1];break}if(l[0]===6&&t.label<i[1]){t.label=i[1],i=l;break}if(i&&t.label<i[2]){t.label=i[2],t.ops.push(l);break}i[2]&&t.ops.pop(),t.trys.pop();continue}l=e.call(r,t)}catch(u){l=[6,u],s=0}finally{n=i=0}if(l[0]&5)throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}}function H6(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}function G6(r,e){for(var t in r)t!=="default"&&!e.hasOwnProperty(t)&&(e[t]=r[t])}function xd(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],n=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Ax(r,e){var t=typeof Symbol=="function"&&r[Symbol.iterator];if(!t)return r;var n=t.call(r),s,i=[],o;try{for(;(e===void 0||e-- >0)&&!(s=n.next()).done;)i.push(s.value)}catch(a){o={error:a}}finally{try{s&&!s.done&&(t=n.return)&&t.call(n)}finally{if(o)throw o.error}}return i}function Q6(){for(var r=[],e=0;e<arguments.length;e++)r=r.concat(Ax(arguments[e]));return r}function W6(){for(var r=0,e=0,t=arguments.length;e<t;e++)r+=arguments[e].length;for(var n=Array(r),s=0,e=0;e<t;e++)for(var i=arguments[e],o=0,a=i.length;o<a;o++,s++)n[s]=i[o];return n}function ac(r){return this instanceof ac?(this.v=r,this):new ac(r)}function J6(r,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=t.apply(r,e||[]),s,i=[];return s={},o("next"),o("throw"),o("return"),s[Symbol.asyncIterator]=function(){return this},s;function o(f){n[f]&&(s[f]=function(d){return new Promise(function(p,g){i.push([f,d,p,g])>1||a(f,d)})})}function a(f,d){try{c(n[f](d))}catch(p){h(i[0][3],p)}}function c(f){f.value instanceof ac?Promise.resolve(f.value.v).then(l,u):h(i[0][2],f)}function l(f){a("next",f)}function u(f){a("throw",f)}function h(f,d){f(d),i.shift(),i.length&&a(i[0][0],i[0][1])}}function Y6(r){var e,t;return e={},n("next"),n("throw",function(s){throw s}),n("return"),e[Symbol.iterator]=function(){return this},e;function n(s,i){e[s]=r[s]?function(o){return(t=!t)?{value:ac(r[s](o)),done:s==="return"}:i?i(o):o}:i}}function Z6(r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=r[Symbol.asyncIterator],t;return e?e.call(r):(r=typeof xd=="function"?xd(r):r[Symbol.iterator](),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(i){t[i]=r[i]&&function(o){return new Promise(function(a,c){o=r[i](o),s(a,c,o.done,o.value)})}}function s(i,o,a,c){Promise.resolve(c).then(function(l){i({value:l,done:a})},o)}}function X6(r,e){return Object.defineProperty?Object.defineProperty(r,"raw",{value:e}):r.raw=e,r}function eR(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)Object.hasOwnProperty.call(r,t)&&(e[t]=r[t]);return e.default=r,e}function tR(r){return r&&r.__esModule?r:{default:r}}function rR(r,e){if(!e.has(r))throw new TypeError("attempted to get private field on non-instance");return e.get(r)}function nR(r,e,t){if(!e.has(r))throw new TypeError("attempted to set private field on non-instance");return e.set(r,t),t}const sR=Object.freeze(Object.defineProperty({__proto__:null,get __assign(){return bd},__asyncDelegator:Y6,__asyncGenerator:J6,__asyncValues:Z6,__await:ac,__awaiter:V6,__classPrivateFieldGet:rR,__classPrivateFieldSet:nR,__createBinding:H6,__decorate:M6,__exportStar:G6,__extends:L6,__generator:K6,__importDefault:tR,__importStar:eR,__makeTemplateObject:X6,__metadata:q6,__param:z6,__read:Ax,__rest:j6,__spread:Q6,__spreadArrays:W6,__values:xd},Symbol.toStringTag,{value:"Module"})),iR=Em(sR);var mn={},z0;function oR(){if(z0)return mn;z0=1,Object.defineProperty(mn,"__esModule",{value:!0}),mn.isBrowserCryptoAvailable=mn.getSubtleCrypto=mn.getBrowerCrypto=void 0;function r(){return(Ki===null||Ki===void 0?void 0:Ki.crypto)||(Ki===null||Ki===void 0?void 0:Ki.msCrypto)||{}}mn.getBrowerCrypto=r;function e(){const n=r();return n.subtle||n.webkitSubtle}mn.getSubtleCrypto=e;function t(){return!!r()&&!!e()}return mn.isBrowserCryptoAvailable=t,mn}var wn={},q0;function aR(){if(q0)return wn;q0=1,Object.defineProperty(wn,"__esModule",{value:!0}),wn.isBrowser=wn.isNode=wn.isReactNative=void 0;function r(){return typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"}wn.isReactNative=r;function e(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}wn.isNode=e;function t(){return!r()&&!e()}return wn.isBrowser=t,wn}var V0;function cR(){return V0||(V0=1,(function(r){Object.defineProperty(r,"__esModule",{value:!0});const e=iR;e.__exportStar(oR(),r),e.__exportStar(aR(),r)})(Qh)),Qh}var lR=cR();function Vr(r=3){const e=Date.now()*Math.pow(10,r),t=Math.floor(Math.random()*Math.pow(10,r));return e+t}function Cs(r=6){return BigInt(Vr(r))}function _n(r,e,t){return{id:t||Vr(),jsonrpc:"2.0",method:r,params:e}}function iu(r,e){return{id:r,jsonrpc:"2.0",result:e}}function Sp(r,e,t){return{id:r,jsonrpc:"2.0",error:uR(e)}}function uR(r,e){return typeof r>"u"?M0(vx):(typeof r=="string"&&(r=Object.assign(Object.assign({},M0(Ip)),{message:r})),U6(r.code)&&(r=$6(r.code)),r)}class hR{}class fR extends hR{constructor(){super()}}class dR extends fR{constructor(e){super()}}const pR="^wss?:";function gR(r){const e=r.match(new RegExp(/^\w+:/,"gi"));if(!(!e||!e.length))return e[0]}function yR(r,e){const t=gR(r);return typeof t>"u"?!1:new RegExp(e).test(t)}function K0(r){return yR(r,pR)}function mR(r){return new RegExp("wss?://localhost(:d{2,5})?").test(r)}function Ix(r){return typeof r=="object"&&"id"in r&&"jsonrpc"in r&&r.jsonrpc==="2.0"}function Op(r){return Ix(r)&&"method"in r}function ju(r){return Ix(r)&&(Kr(r)||mr(r))}function Kr(r){return"result"in r}function mr(r){return"error"in r}class wR extends dR{constructor(e){super(e),this.events=new Ur.EventEmitter,this.hasRegisteredEventListeners=!1,this.connection=this.setConnection(e),this.connection.connected&&this.registerEventListeners()}async connect(e=this.connection){await this.open(e)}async disconnect(){await this.close()}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}off(e,t){this.events.off(e,t)}removeListener(e,t){this.events.removeListener(e,t)}async request(e,t){return this.requestStrict(_n(e.method,e.params||[],e.id||Cs().toString()),t)}async requestStrict(e,t){return new Promise(async(n,s)=>{if(!this.connection.connected)try{await this.open()}catch(i){s(i)}this.events.on(`${e.id}`,i=>{mr(i)?s(i.error):n(i.result)});try{await this.connection.send(e,t)}catch(i){s(i)}})}setConnection(e=this.connection){return e}onPayload(e){this.events.emit("payload",e),ju(e)?this.events.emit(`${e.id}`,e):this.events.emit("message",{type:e.method,data:e.params})}onClose(e){e&&e.code===3e3&&this.events.emit("error",new Error(`WebSocket connection closed abnormally with code: ${e.code} ${e.reason?`(${e.reason})`:""}`)),this.events.emit("disconnect")}async open(e=this.connection){this.connection===e&&this.connection.connected||(this.connection.connected&&this.close(),typeof e=="string"&&(await this.connection.open(e),e=this.connection),this.connection=this.setConnection(e),await this.connection.open(),this.registerEventListeners(),this.events.emit("connect"))}async close(){await this.connection.close()}registerEventListeners(){this.hasRegisteredEventListeners||(this.connection.on("payload",e=>this.onPayload(e)),this.connection.on("close",e=>this.onClose(e)),this.connection.on("error",e=>this.events.emit("error",e)),this.connection.on("register_error",e=>this.onClose()),this.hasRegisteredEventListeners=!0)}}const bR=()=>typeof WebSocket<"u"?WebSocket:typeof global<"u"&&typeof global.WebSocket<"u"?global.WebSocket:typeof window<"u"&&typeof window.WebSocket<"u"?window.WebSocket:typeof self<"u"&&typeof self.WebSocket<"u"?self.WebSocket:require("ws"),xR=()=>typeof WebSocket<"u"||typeof global<"u"&&typeof global.WebSocket<"u"||typeof window<"u"&&typeof window.WebSocket<"u"||typeof self<"u"&&typeof self.WebSocket<"u",H0=r=>r.split("?")[0],G0=10,vR=bR();let ER=class{constructor(e){if(this.url=e,this.events=new Ur.EventEmitter,this.registering=!1,!K0(e))throw new Error(`Provided URL is not compatible with WebSocket connection: ${e}`);this.url=e}get connected(){return typeof this.socket<"u"}get connecting(){return this.registering}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}off(e,t){this.events.off(e,t)}removeListener(e,t){this.events.removeListener(e,t)}async open(e=this.url){await this.register(e)}async close(){return new Promise((e,t)=>{if(typeof this.socket>"u"){t(new Error("Connection already closed"));return}this.socket.onclose=n=>{this.onClose(n),e()},this.socket.close()})}async send(e){typeof this.socket>"u"&&(this.socket=await this.register());try{this.socket.send(vc(e))}catch(t){this.onError(e.id,t)}}register(e=this.url){if(!K0(e))throw new Error(`Provided URL is not compatible with WebSocket connection: ${e}`);if(this.registering){const t=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=t||this.events.listenerCount("open")>=t)&&this.events.setMaxListeners(t+1),new Promise((n,s)=>{this.events.once("register_error",i=>{this.resetMaxListeners(),s(i)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.socket>"u")return s(new Error("WebSocket connection is missing or invalid"));n(this.socket)})})}return this.url=e,this.registering=!0,new Promise((t,n)=>{const s=lR.isReactNative()?void 0:{rejectUnauthorized:!mR(e)},i=new vR(e,[],s);xR()?i.onerror=o=>{const a=o;n(this.emitError(a.error))}:i.on("error",o=>{n(this.emitError(o))}),i.onopen=()=>{this.onOpen(i),t(i)}})}onOpen(e){e.onmessage=t=>this.onPayload(t),e.onclose=t=>this.onClose(t),this.socket=e,this.registering=!1,this.events.emit("open")}onClose(e){this.socket=void 0,this.registering=!1,this.events.emit("close",e)}onPayload(e){if(typeof e.data>"u")return;const t=typeof e.data=="string"?Wo(e.data):e.data;this.events.emit("payload",t)}onError(e,t){const n=this.parseError(t),s=n.message||n.toString(),i=Sp(e,s);this.events.emit("payload",i)}parseError(e,t=this.url){return F6(e,H0(t),"WS")}resetMaxListeners(){this.events.getMaxListeners()>G0&&this.events.setMaxListeners(G0)}emitError(e){const t=this.parseError(new Error((e==null?void 0:e.message)||`WebSocket connection failed for host: ${H0(this.url)}`));return this.events.emit("register_error",t),t}};var AR={};const Sx="wc",Ox=2,vd="core",hn=`${Sx}@2:${vd}:`,IR={logger:"error"},SR={database:":memory:"},OR="crypto",Q0="client_ed25519_seed",DR=G.ONE_DAY,_R="keychain",NR="0.3",CR="messages",BR="0.3",RR=G.SIX_HOURS,PR="publisher",Dx="irn",TR="error",_x="wss://relay.walletconnect.org",kR="relayer",je={message:"relayer_message",message_ack:"relayer_message_ack",connect:"relayer_connect",disconnect:"relayer_disconnect",error:"relayer_error",connection_stalled:"relayer_connection_stalled",transport_closed:"relayer_transport_closed",publish:"relayer_publish"},UR="_subscription",ar={payload:"payload",connect:"connect",disconnect:"disconnect",error:"error"},$R=.1,Ed="2.23.6",Ce={link_mode:"link_mode",relay:"relay"},Sl={inbound:"inbound",outbound:"outbound"},FR="0.3",LR="WALLETCONNECT_CLIENT_ID",W0="WALLETCONNECT_LINK_MODE_APPS",Wt={created:"subscription_created",deleted:"subscription_deleted",expired:"subscription_expired",disabled:"subscription_disabled",sync:"subscription_sync",resubscribed:"subscription_resubscribed"},jR="subscription",MR="0.3",zR="pairing",qR="0.3",xa={wc_pairingDelete:{req:{ttl:G.ONE_DAY,prompt:!1,tag:1e3},res:{ttl:G.ONE_DAY,prompt:!1,tag:1001}},wc_pairingPing:{req:{ttl:G.THIRTY_SECONDS,prompt:!1,tag:1002},res:{ttl:G.THIRTY_SECONDS,prompt:!1,tag:1003}},unregistered_method:{req:{ttl:G.ONE_DAY,prompt:!1,tag:0},res:{ttl:G.ONE_DAY,prompt:!1,tag:0}}},ei={create:"pairing_create",expire:"pairing_expire",delete:"pairing_delete",ping:"pairing_ping"},vr={created:"history_created",updated:"history_updated",deleted:"history_deleted",sync:"history_sync"},VR="history",KR="0.3",HR="expirer",lr={created:"expirer_created",deleted:"expirer_deleted",expired:"expirer_expired",sync:"expirer_sync"},GR="0.3",QR="verify-api",WR="https://verify.walletconnect.com",Nx="https://verify.walletconnect.org",La=Nx,JR=`${La}/v3`,YR=[WR,Nx],ZR="echo",XR="https://echo.walletconnect.com",qr={pairing_started:"pairing_started",pairing_uri_validation_success:"pairing_uri_validation_success",pairing_uri_not_expired:"pairing_uri_not_expired",store_new_pairing:"store_new_pairing",subscribing_pairing_topic:"subscribing_pairing_topic",subscribe_pairing_topic_success:"subscribe_pairing_topic_success",existing_pairing:"existing_pairing",pairing_not_expired:"pairing_not_expired",emit_inactive_pairing:"emit_inactive_pairing",emit_session_proposal:"emit_session_proposal",subscribing_to_pairing_topic:"subscribing_to_pairing_topic"},vn={no_wss_connection:"no_wss_connection",no_internet_connection:"no_internet_connection",malformed_pairing_uri:"malformed_pairing_uri",active_pairing_already_exists:"active_pairing_already_exists",subscribe_pairing_topic_failure:"subscribe_pairing_topic_failure",pairing_expired:"pairing_expired",proposal_expired:"proposal_expired",proposal_listener_not_found:"proposal_listener_not_found"},Er={session_approve_started:"session_approve_started",proposal_not_expired:"proposal_not_expired",session_namespaces_validation_success:"session_namespaces_validation_success",create_session_topic:"create_session_topic",subscribing_session_topic:"subscribing_session_topic",subscribe_session_topic_success:"subscribe_session_topic_success",publishing_session_approve:"publishing_session_approve",session_approve_publish_success:"session_approve_publish_success",store_session:"store_session",publishing_session_settle:"publishing_session_settle",session_settle_publish_success:"session_settle_publish_success",session_request_response_started:"session_request_response_started",session_request_response_validation_success:"session_request_response_validation_success",session_request_response_publish_started:"session_request_response_publish_started"},Hs={no_internet_connection:"no_internet_connection",no_wss_connection:"no_wss_connection",proposal_expired:"proposal_expired",subscribe_session_topic_failure:"subscribe_session_topic_failure",session_approve_publish_failure:"session_approve_publish_failure",session_settle_publish_failure:"session_settle_publish_failure",session_approve_namespace_validation_failure:"session_approve_namespace_validation_failure",proposal_not_found:"proposal_not_found",session_request_response_validation_failure:"session_request_response_validation_failure",session_request_response_publish_failure:"session_request_response_publish_failure"},Gs={authenticated_session_approve_started:"authenticated_session_approve_started",create_authenticated_session_topic:"create_authenticated_session_topic",cacaos_verified:"cacaos_verified",store_authenticated_session:"store_authenticated_session",subscribing_authenticated_session_topic:"subscribing_authenticated_session_topic",subscribe_authenticated_session_topic_success:"subscribe_authenticated_session_topic_success",publishing_authenticated_session_approve:"publishing_authenticated_session_approve"},va={no_internet_connection:"no_internet_connection",invalid_cacao:"invalid_cacao",subscribe_authenticated_session_topic_failure:"subscribe_authenticated_session_topic_failure",authenticated_session_approve_publish_failure:"authenticated_session_approve_publish_failure",authenticated_session_pending_request_not_found:"authenticated_session_pending_request_not_found"},eP=.1,tP="event-client",rP=86400,nP="https://pulse.walletconnect.org/batch";function sP(r,e){if(r.length>=255)throw new TypeError("Alphabet too long");for(var t=new Uint8Array(256),n=0;n<t.length;n++)t[n]=255;for(var s=0;s<r.length;s++){var i=r.charAt(s),o=i.charCodeAt(0);if(t[o]!==255)throw new TypeError(i+" is ambiguous");t[o]=s}var a=r.length,c=r.charAt(0),l=Math.log(a)/Math.log(256),u=Math.log(256)/Math.log(a);function h(p){if(p instanceof Uint8Array||(ArrayBuffer.isView(p)?p=new Uint8Array(p.buffer,p.byteOffset,p.byteLength):Array.isArray(p)&&(p=Uint8Array.from(p))),!(p instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(p.length===0)return"";for(var g=0,m=0,E=0,O=p.length;E!==O&&p[E]===0;)E++,g++;for(var x=(O-E)*u+1>>>0,b=new Uint8Array(x);E!==O;){for(var v=p[E],S=0,D=x-1;(v!==0||S<m)&&D!==-1;D--,S++)v+=256*b[D]>>>0,b[D]=v%a>>>0,v=v/a>>>0;if(v!==0)throw new Error("Non-zero carry");m=S,E++}for(var R=x-m;R!==x&&b[R]===0;)R++;for(var _=c.repeat(g);R<x;++R)_+=r.charAt(b[R]);return _}function f(p){if(typeof p!="string")throw new TypeError("Expected String");if(p.length===0)return new Uint8Array;var g=0;if(p[g]!==" "){for(var m=0,E=0;p[g]===c;)m++,g++;for(var O=(p.length-g)*l+1>>>0,x=new Uint8Array(O);p[g];){var b=t[p.charCodeAt(g)];if(b===255)return;for(var v=0,S=O-1;(b!==0||v<E)&&S!==-1;S--,v++)b+=a*x[S]>>>0,x[S]=b%256>>>0,b=b/256>>>0;if(b!==0)throw new Error("Non-zero carry");E=v,g++}if(p[g]!==" "){for(var D=O-E;D!==O&&x[D]===0;)D++;for(var R=new Uint8Array(m+(O-D)),_=m;D!==O;)R[_++]=x[D++];return R}}}function d(p){var g=f(p);if(g)return g;throw new Error(`Non-${e} character`)}return{encode:h,decodeUnsafe:f,decode:d}}var iP=sP,oP=iP;const Cx=r=>{if(r instanceof Uint8Array&&r.constructor.name==="Uint8Array")return r;if(r instanceof ArrayBuffer)return new Uint8Array(r);if(ArrayBuffer.isView(r))return new Uint8Array(r.buffer,r.byteOffset,r.byteLength);throw new Error("Unknown type, must be binary type")},aP=r=>new TextEncoder().encode(r),cP=r=>new TextDecoder().decode(r);class lP{constructor(e,t,n){this.name=e,this.prefix=t,this.baseEncode=n}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class uP{constructor(e,t,n){if(this.name=e,this.prefix=t,t.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=n}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return Bx(this,e)}}class hP{constructor(e){this.decoders=e}or(e){return Bx(this,e)}decode(e){const t=e[0],n=this.decoders[t];if(n)return n.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const Bx=(r,e)=>new hP({...r.decoders||{[r.prefix]:r},...e.decoders||{[e.prefix]:e}});class fP{constructor(e,t,n,s){this.name=e,this.prefix=t,this.baseEncode=n,this.baseDecode=s,this.encoder=new lP(e,t,n),this.decoder=new uP(e,t,s)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const Mu=({name:r,prefix:e,encode:t,decode:n})=>new fP(r,e,t,n),Pc=({prefix:r,name:e,alphabet:t})=>{const{encode:n,decode:s}=oP(t,e);return Mu({prefix:r,name:e,encode:n,decode:i=>Cx(s(i))})},dP=(r,e,t,n)=>{const s={};for(let u=0;u<e.length;++u)s[e[u]]=u;let i=r.length;for(;r[i-1]==="=";)--i;const o=new Uint8Array(i*t/8|0);let a=0,c=0,l=0;for(let u=0;u<i;++u){const h=s[r[u]];if(h===void 0)throw new SyntaxError(`Non-${n} character`);c=c<<t|h,a+=t,a>=8&&(a-=8,o[l++]=255&c>>a)}if(a>=t||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return o},pP=(r,e,t)=>{const n=e[e.length-1]==="=",s=(1<<t)-1;let i="",o=0,a=0;for(let c=0;c<r.length;++c)for(a=a<<8|r[c],o+=8;o>t;)o-=t,i+=e[s&a>>o];if(o&&(i+=e[s&a<<t-o]),n)for(;i.length*t&7;)i+="=";return i},ht=({name:r,prefix:e,bitsPerChar:t,alphabet:n})=>Mu({prefix:e,name:r,encode(s){return pP(s,n,t)},decode(s){return dP(s,n,t,r)}}),gP=Mu({prefix:"\0",name:"identity",encode:r=>cP(r),decode:r=>aP(r)});var yP=Object.freeze({__proto__:null,identity:gP});const mP=ht({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var wP=Object.freeze({__proto__:null,base2:mP});const bP=ht({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var xP=Object.freeze({__proto__:null,base8:bP});const vP=Pc({prefix:"9",name:"base10",alphabet:"0123456789"});var EP=Object.freeze({__proto__:null,base10:vP});const AP=ht({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),IP=ht({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var SP=Object.freeze({__proto__:null,base16:AP,base16upper:IP});const OP=ht({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),DP=ht({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),_P=ht({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),NP=ht({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),CP=ht({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),BP=ht({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),RP=ht({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),PP=ht({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),TP=ht({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var kP=Object.freeze({__proto__:null,base32:OP,base32upper:DP,base32pad:_P,base32padupper:NP,base32hex:CP,base32hexupper:BP,base32hexpad:RP,base32hexpadupper:PP,base32z:TP});const UP=Pc({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),$P=Pc({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var FP=Object.freeze({__proto__:null,base36:UP,base36upper:$P});const LP=Pc({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),jP=Pc({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var MP=Object.freeze({__proto__:null,base58btc:LP,base58flickr:jP});const zP=ht({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),qP=ht({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),VP=ht({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),KP=ht({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var HP=Object.freeze({__proto__:null,base64:zP,base64pad:qP,base64url:VP,base64urlpad:KP});const Rx=Array.from(""),GP=Rx.reduce((r,e,t)=>(r[t]=e,r),[]),QP=Rx.reduce((r,e,t)=>(r[e.codePointAt(0)]=t,r),[]);function WP(r){return r.reduce((e,t)=>(e+=GP[t],e),"")}function JP(r){const e=[];for(const t of r){const n=QP[t.codePointAt(0)];if(n===void 0)throw new Error(`Non-base256emoji character: ${t}`);e.push(n)}return new Uint8Array(e)}const YP=Mu({prefix:"",name:"base256emoji",encode:WP,decode:JP});var ZP=Object.freeze({__proto__:null,base256emoji:YP}),XP=Px,J0=128,eT=-128,tT=Math.pow(2,31);function Px(r,e,t){e=e||[],t=t||0;for(var n=t;r>=tT;)e[t++]=r&255|J0,r/=128;for(;r&eT;)e[t++]=r&255|J0,r>>>=7;return e[t]=r|0,Px.bytes=t-n+1,e}var rT=Ad,nT=128,Y0=127;function Ad(r,n){var t=0,n=n||0,s=0,i=n,o,a=r.length;do{if(i>=a)throw Ad.bytes=0,new RangeError("Could not decode varint");o=r[i++],t+=s<28?(o&Y0)<<s:(o&Y0)*Math.pow(2,s),s+=7}while(o>=nT);return Ad.bytes=i-n,t}var sT=Math.pow(2,7),iT=Math.pow(2,14),oT=Math.pow(2,21),aT=Math.pow(2,28),cT=Math.pow(2,35),lT=Math.pow(2,42),uT=Math.pow(2,49),hT=Math.pow(2,56),fT=Math.pow(2,63),dT=function(r){return r<sT?1:r<iT?2:r<oT?3:r<aT?4:r<cT?5:r<lT?6:r<uT?7:r<hT?8:r<fT?9:10},pT={encode:XP,decode:rT,encodingLength:dT},Tx=pT;const Z0=(r,e,t=0)=>(Tx.encode(r,e,t),e),X0=r=>Tx.encodingLength(r),Id=(r,e)=>{const t=e.byteLength,n=X0(r),s=n+X0(t),i=new Uint8Array(s+t);return Z0(r,i,0),Z0(t,i,n),i.set(e,s),new gT(r,t,e,i)};class gT{constructor(e,t,n,s){this.code=e,this.size=t,this.digest=n,this.bytes=s}}const kx=({name:r,code:e,encode:t})=>new yT(r,e,t);class yT{constructor(e,t,n){this.name=e,this.code=t,this.encode=n}digest(e){if(e instanceof Uint8Array){const t=this.encode(e);return t instanceof Uint8Array?Id(this.code,t):t.then(n=>Id(this.code,n))}else throw Error("Unknown type, must be binary type")}}const Ux=r=>async e=>new Uint8Array(await crypto.subtle.digest(r,e)),mT=kx({name:"sha2-256",code:18,encode:Ux("SHA-256")}),wT=kx({name:"sha2-512",code:19,encode:Ux("SHA-512")});var bT=Object.freeze({__proto__:null,sha256:mT,sha512:wT});const $x=0,xT="identity",Fx=Cx,vT=r=>Id($x,Fx(r)),ET={code:$x,name:xT,encode:Fx,digest:vT};var AT=Object.freeze({__proto__:null,identity:ET});new TextEncoder,new TextDecoder;const em={...yP,...wP,...xP,...EP,...SP,...kP,...FP,...MP,...HP,...ZP};({...bT,...AT});function Lx(r){return globalThis.Buffer!=null?new Uint8Array(r.buffer,r.byteOffset,r.byteLength):r}function IT(r=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?Lx(globalThis.Buffer.allocUnsafe(r)):new Uint8Array(r)}function jx(r,e,t,n){return{name:r,prefix:e,encoder:{name:r,prefix:e,encode:t},decoder:{decode:n}}}const tm=jx("utf8","u",r=>"u"+new TextDecoder("utf8").decode(r),r=>new TextEncoder().encode(r.substring(1))),Wh=jx("ascii","a",r=>{let e="a";for(let t=0;t<r.length;t++)e+=String.fromCharCode(r[t]);return e},r=>{r=r.substring(1);const e=IT(r.length);for(let t=0;t<r.length;t++)e[t]=r.charCodeAt(t);return e}),ST={utf8:tm,"utf-8":tm,hex:em.base16,latin1:Wh,ascii:Wh,binary:Wh,...em};function OT(r,e="utf8"){const t=ST[e];if(!t)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?Lx(globalThis.Buffer.from(r,"utf-8")):t.decoder.decode(`${t.prefix}${r}`)}var DT=Object.defineProperty,_T=(r,e,t)=>e in r?DT(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,Mr=(r,e,t)=>_T(r,typeof e!="symbol"?e+"":e,t);class NT{constructor(e,t){this.core=e,this.logger=t,Mr(this,"keychain",new Map),Mr(this,"name",_R),Mr(this,"version",NR),Mr(this,"initialized",!1),Mr(this,"storagePrefix",hn),Mr(this,"init",async()=>{if(!this.initialized){const n=await this.getKeyChain();typeof n<"u"&&(this.keychain=n),this.initialized=!0}}),Mr(this,"has",n=>(this.isInitialized(),this.keychain.has(n))),Mr(this,"set",async(n,s)=>{this.isInitialized(),this.keychain.set(n,s),await this.persist()}),Mr(this,"get",n=>{this.isInitialized();const s=this.keychain.get(n);if(typeof s>"u"){const{message:i}=W("NO_MATCHING_KEY",`${this.name}: ${n}`);throw new Error(i)}return s}),Mr(this,"del",async n=>{this.isInitialized(),this.keychain.delete(n),await this.persist()}),this.core=e,this.logger=ir(t,this.name)}get context(){return Ht(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}async setKeyChain(e){await this.core.storage.setItem(this.storageKey,sd(e))}async getKeyChain(){const e=await this.core.storage.getItem(this.storageKey);return typeof e<"u"?id(e):void 0}async persist(){await this.setKeyChain(this.keychain)}isInitialized(){if(!this.initialized){const{message:e}=W("NOT_INITIALIZED",this.name);throw new Error(e)}}}var CT=Object.defineProperty,BT=(r,e,t)=>e in r?CT(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,Qe=(r,e,t)=>BT(r,typeof e!="symbol"?e+"":e,t);class RT{constructor(e,t,n){this.core=e,this.logger=t,Qe(this,"name",OR),Qe(this,"keychain"),Qe(this,"randomSessionIdentifier",yd()),Qe(this,"initialized",!1),Qe(this,"clientId"),Qe(this,"init",async()=>{this.initialized||(await this.keychain.init(),this.initialized=!0)}),Qe(this,"hasKeys",s=>(this.isInitialized(),this.keychain.has(s))),Qe(this,"getClientId",async()=>{if(this.isInitialized(),this.clientId)return this.clientId;const s=await this.getClientSeed(),i=hy(s),o=fb(i.publicKey);return this.clientId=o,o}),Qe(this,"generateKeyPair",()=>{this.isInitialized();const s=f5();return this.setPrivateKey(s.publicKey,s.privateKey)}),Qe(this,"signJWT",async s=>{this.isInitialized();const i=await this.getClientSeed(),o=hy(i),a=this.randomSessionIdentifier;return await nO(a,s,DR,o)}),Qe(this,"generateSharedKey",(s,i,o)=>{this.isInitialized();const a=this.getPrivateKey(s),c=d5(a,i);return this.setSymKey(c,o)}),Qe(this,"setSymKey",async(s,i)=>{this.isInitialized();const o=i||Il(s);return await this.keychain.set(o,s),o}),Qe(this,"deleteKeyPair",async s=>{this.isInitialized(),await this.keychain.del(s)}),Qe(this,"deleteSymKey",async s=>{this.isInitialized(),await this.keychain.del(s)}),Qe(this,"encode",async(s,i,o)=>{this.isInitialized();const a=gx(o),c=vc(i);if(D0(a))return y5(c,o==null?void 0:o.encoding);if(O0(a)){const f=a.senderPublicKey,d=a.receiverPublicKey;s=await this.generateSharedKey(f,d)}const l=this.getSymKey(s),{type:u,senderPublicKey:h}=a;return p5({type:u,symKey:l,message:c,senderPublicKey:h,encoding:o==null?void 0:o.encoding})}),Qe(this,"decode",async(s,i,o)=>{this.isInitialized();const a=w5(i,o);if(D0(a)){const c=m5(i,o==null?void 0:o.encoding);return Wo(c)}if(O0(a)){const c=a.receiverPublicKey,l=a.senderPublicKey;s=await this.generateSharedKey(c,l)}try{const c=this.getSymKey(s),l=g5({symKey:c,encoded:i,encoding:o==null?void 0:o.encoding});return Wo(l)}catch(c){this.logger.error(`Failed to decode message from topic: '${s}', clientId: '${await this.getClientId()}'`),this.logger.error(c)}}),Qe(this,"getPayloadType",(s,i=jt)=>{const o=ic({encoded:s,encoding:i});return $i(o.type)}),Qe(this,"getPayloadSenderPublicKey",(s,i=jt)=>{const o=ic({encoded:s,encoding:i});return o.senderPublicKey?Vt(o.senderPublicKey,Ct):void 0}),this.core=e,this.logger=ir(t,this.name),this.keychain=n||new NT(this.core,this.logger)}get context(){return Ht(this.logger)}async setPrivateKey(e,t){return await this.keychain.set(e,t),e}getPrivateKey(e){return this.keychain.get(e)}async getClientSeed(){let e="";try{e=this.keychain.get(Q0)}catch{e=yd(),await this.keychain.set(Q0,e)}return OT(e,"base16")}getSymKey(e){return this.keychain.get(e)}isInitialized(){if(!this.initialized){const{message:e}=W("NOT_INITIALIZED",this.name);throw new Error(e)}}}var PT=Object.defineProperty,TT=Object.defineProperties,kT=Object.getOwnPropertyDescriptors,rm=Object.getOwnPropertySymbols,UT=Object.prototype.hasOwnProperty,$T=Object.prototype.propertyIsEnumerable,Sd=(r,e,t)=>e in r?PT(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,FT=(r,e)=>{for(var t in e||(e={}))UT.call(e,t)&&Sd(r,t,e[t]);if(rm)for(var t of rm(e))$T.call(e,t)&&Sd(r,t,e[t]);return r},LT=(r,e)=>TT(r,kT(e)),Gt=(r,e,t)=>Sd(r,typeof e!="symbol"?e+"":e,t);class jT extends t3{constructor(e,t){super(e,t),this.logger=e,this.core=t,Gt(this,"messages",new Map),Gt(this,"messagesWithoutClientAck",new Map),Gt(this,"name",CR),Gt(this,"version",BR),Gt(this,"initialized",!1),Gt(this,"storagePrefix",hn),Gt(this,"init",async()=>{if(!this.initialized){this.logger.trace("Initialized");try{const n=await this.getRelayerMessages();typeof n<"u"&&(this.messages=n);const s=await this.getRelayerMessagesWithoutClientAck();typeof s<"u"&&(this.messagesWithoutClientAck=s),this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",size:this.messages.size})}catch(n){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(n)}finally{this.initialized=!0}}}),Gt(this,"set",async(n,s,i)=>{this.isInitialized();const o=yr(s);let a=this.messages.get(n);if(typeof a>"u"&&(a={}),typeof a[o]<"u")return o;if(a[o]=s,this.messages.set(n,a),i===Sl.inbound){const c=this.messagesWithoutClientAck.get(n)||{};this.messagesWithoutClientAck.set(n,LT(FT({},c),{[o]:s}))}return await this.persist(),o}),Gt(this,"get",n=>{this.isInitialized();let s=this.messages.get(n);return typeof s>"u"&&(s={}),s}),Gt(this,"getWithoutAck",n=>{this.isInitialized();const s={};for(const i of n){const o=this.messagesWithoutClientAck.get(i)||{};s[i]=Object.values(o)}return s}),Gt(this,"has",(n,s)=>{this.isInitialized();const i=this.get(n),o=yr(s);return typeof i[o]<"u"}),Gt(this,"ack",async(n,s)=>{this.isInitialized();const i=this.messagesWithoutClientAck.get(n);if(typeof i>"u")return;const o=yr(s);delete i[o],Object.keys(i).length===0?this.messagesWithoutClientAck.delete(n):this.messagesWithoutClientAck.set(n,i),await this.persist()}),Gt(this,"del",async n=>{this.isInitialized(),this.messages.delete(n),this.messagesWithoutClientAck.delete(n),await this.persist()}),this.logger=ir(e,this.name),this.core=t}get context(){return Ht(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get storageKeyWithoutClientAck(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name+"_withoutClientAck"}async setRelayerMessages(e){await this.core.storage.setItem(this.storageKey,sd(e))}async setRelayerMessagesWithoutClientAck(e){await this.core.storage.setItem(this.storageKeyWithoutClientAck,sd(e))}async getRelayerMessages(){const e=await this.core.storage.getItem(this.storageKey);return typeof e<"u"?id(e):void 0}async getRelayerMessagesWithoutClientAck(){const e=await this.core.storage.getItem(this.storageKeyWithoutClientAck);return typeof e<"u"?id(e):void 0}async persist(){await this.setRelayerMessages(this.messages),await this.setRelayerMessagesWithoutClientAck(this.messagesWithoutClientAck)}isInitialized(){if(!this.initialized){const{message:e}=W("NOT_INITIALIZED",this.name);throw new Error(e)}}}var MT=Object.defineProperty,zT=Object.defineProperties,qT=Object.getOwnPropertyDescriptors,nm=Object.getOwnPropertySymbols,VT=Object.prototype.hasOwnProperty,KT=Object.prototype.propertyIsEnumerable,Od=(r,e,t)=>e in r?MT(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,Xi=(r,e)=>{for(var t in e||(e={}))VT.call(e,t)&&Od(r,t,e[t]);if(nm)for(var t of nm(e))KT.call(e,t)&&Od(r,t,e[t]);return r},sm=(r,e)=>zT(r,qT(e)),cr=(r,e,t)=>Od(r,typeof e!="symbol"?e+"":e,t);class HT extends r3{constructor(e,t){super(e,t),this.relayer=e,this.logger=t,cr(this,"events",new Ur.EventEmitter),cr(this,"name",PR),cr(this,"queue",new Map),cr(this,"publishTimeout",G.toMiliseconds(G.ONE_MINUTE)),cr(this,"initialPublishTimeout",G.toMiliseconds(G.ONE_SECOND*15)),cr(this,"needsTransportRestart",!1),cr(this,"publish",async(n,s,i)=>{var o,a,c,l,u;this.logger.debug("Publishing Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:n,message:s,opts:i}});const h=(i==null?void 0:i.ttl)||RR,f=(i==null?void 0:i.prompt)||!1,d=(i==null?void 0:i.tag)||0,p=(i==null?void 0:i.id)||Cs().toString(),g=lo(nu().protocol),m={id:p,method:(i==null?void 0:i.publishMethod)||g.publish,params:Xi({topic:n,message:s,ttl:h,prompt:f,tag:d,attestation:i==null?void 0:i.attestation},i==null?void 0:i.tvf)},E=`Failed to publish payload, please try again. id:${p} tag:${d}`;try{et((o=m.params)==null?void 0:o.prompt)&&((a=m.params)==null||delete a.prompt),et((c=m.params)==null?void 0:c.tag)&&((l=m.params)==null||delete l.tag);const O=new Promise(async x=>{const b=({id:S})=>{var D;((D=m.id)==null?void 0:D.toString())===S.toString()&&(this.removeRequestFromQueue(S),this.relayer.events.removeListener(je.publish,b),x())};this.relayer.events.on(je.publish,b);const v=an(new Promise((S,D)=>{this.rpcPublish(m,i).then(S).catch(R=>{this.logger.warn(R,R==null?void 0:R.message),D(R)})}),this.initialPublishTimeout,`Failed initial publish, retrying.... id:${p} tag:${d}`);try{await v,this.events.removeListener(je.publish,b)}catch(S){this.queue.set(p,{request:m,opts:i,attempt:1}),this.logger.warn(S,S==null?void 0:S.message)}});this.logger.trace({type:"method",method:"publish",params:{id:p,topic:n,message:s,opts:i}}),await an(O,this.publishTimeout,E)}catch(O){if(this.logger.debug("Failed to Publish Payload"),this.logger.error(O),(u=i==null?void 0:i.internal)!=null&&u.throwOnFailedPublish)throw O}finally{this.queue.delete(p)}}),cr(this,"publishCustom",async n=>{var s,i,o,a,c;this.logger.debug("Publishing custom payload"),this.logger.trace({type:"method",method:"publishCustom",params:n});const{payload:l,opts:u={}}=n,{attestation:h,tvf:f,publishMethod:d,prompt:p,tag:g,ttl:m=G.FIVE_MINUTES}=u,E=u.id||Cs().toString(),O=lo(nu().protocol),x=d||O.publish,b={id:E,method:x,params:Xi(sm(Xi({},l),{ttl:m,prompt:p,tag:g,attestation:h}),f)},v=`Failed to publish custom payload, please try again. id:${E} tag:${g}`;try{et((s=b.params)==null?void 0:s.prompt)&&((i=b.params)==null||delete i.prompt),et((o=b.params)==null?void 0:o.tag)&&((a=b.params)==null||delete a.tag);const S=new Promise(async D=>{const R=({id:F})=>{var j;((j=b.id)==null?void 0:j.toString())===F.toString()&&(this.removeRequestFromQueue(F),this.relayer.events.removeListener(je.publish,R),D())};this.relayer.events.on(je.publish,R);const _=an(new Promise((F,j)=>{this.rpcPublish(b,u).then(F).catch($=>{this.logger.warn($,$==null?void 0:$.message),j($)})}),this.initialPublishTimeout,`Failed initial custom payload publish, retrying.... method:${x} id:${E} tag:${g}`);try{await _,this.events.removeListener(je.publish,R)}catch(F){this.queue.set(E,{request:b,opts:u,attempt:1}),this.logger.warn(F,F==null?void 0:F.message)}});this.logger.trace({type:"method",method:"publish",params:{id:E,payload:l,opts:u}}),await an(S,this.publishTimeout,v)}catch(S){if(this.logger.debug("Failed to Publish Payload"),this.logger.error(S),(c=u==null?void 0:u.internal)!=null&&c.throwOnFailedPublish)throw S}finally{this.queue.delete(E)}}),cr(this,"on",(n,s)=>{this.events.on(n,s)}),cr(this,"once",(n,s)=>{this.events.once(n,s)}),cr(this,"off",(n,s)=>{this.events.off(n,s)}),cr(this,"removeListener",(n,s)=>{this.events.removeListener(n,s)}),this.relayer=e,this.logger=ir(t,this.name),this.registerEventListeners()}get context(){return Ht(this.logger)}async rpcPublish(e,t){this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"message",direction:"outgoing",request:e});const n=await this.relayer.request(e);return this.relayer.events.emit(je.publish,Xi(Xi({},e),t)),this.logger.debug("Successfully Published Payload"),n}removeRequestFromQueue(e){this.queue.delete(e)}checkQueue(){this.queue.forEach(async(e,t)=>{var n;const s=e.attempt+1;this.queue.set(t,sm(Xi({},e),{attempt:s})),this.logger.warn({},`Publisher: queue->publishing: ${e.request.id}, tag: ${(n=e.request.params)==null?void 0:n.tag}, attempt: ${s}`),await this.rpcPublish(e.request,e.opts),this.logger.warn({},`Publisher: queue->published: ${e.request.id}`)})}registerEventListeners(){this.relayer.core.heartbeat.on(ji.pulse,()=>{if(this.needsTransportRestart){this.needsTransportRestart=!1,this.relayer.events.emit(je.connection_stalled);return}this.checkQueue()}),this.relayer.on(je.message_ack,e=>{this.removeRequestFromQueue(e.id.toString())})}}var GT=Object.defineProperty,QT=(r,e,t)=>e in r?GT(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,eo=(r,e,t)=>QT(r,typeof e!="symbol"?e+"":e,t);class WT{constructor(){eo(this,"map",new Map),eo(this,"set",(e,t)=>{const n=this.get(e);this.exists(e,t)||this.map.set(e,[...n,t])}),eo(this,"get",e=>this.map.get(e)||[]),eo(this,"exists",(e,t)=>this.get(e).includes(t)),eo(this,"delete",(e,t)=>{if(typeof t>"u"){this.map.delete(e);return}if(!this.map.has(e))return;const n=this.get(e);if(!this.exists(e,t))return;const s=n.filter(i=>i!==t);if(!s.length){this.map.delete(e);return}this.map.set(e,s)}),eo(this,"clear",()=>{this.map.clear()})}get topics(){return Array.from(this.map.keys())}}var JT=Object.defineProperty,YT=Object.defineProperties,ZT=Object.getOwnPropertyDescriptors,im=Object.getOwnPropertySymbols,XT=Object.prototype.hasOwnProperty,ek=Object.prototype.propertyIsEnumerable,Dd=(r,e,t)=>e in r?JT(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,Ea=(r,e)=>{for(var t in e||(e={}))XT.call(e,t)&&Dd(r,t,e[t]);if(im)for(var t of im(e))ek.call(e,t)&&Dd(r,t,e[t]);return r},Jh=(r,e)=>YT(r,ZT(e)),Oe=(r,e,t)=>Dd(r,typeof e!="symbol"?e+"":e,t);class tk extends i3{constructor(e,t){super(e,t),this.relayer=e,this.logger=t,Oe(this,"subscriptions",new Map),Oe(this,"topicMap",new WT),Oe(this,"events",new Ur.EventEmitter),Oe(this,"name",jR),Oe(this,"version",MR),Oe(this,"pending",new Map),Oe(this,"cached",[]),Oe(this,"initialized",!1),Oe(this,"storagePrefix",hn),Oe(this,"subscribeTimeout",G.toMiliseconds(G.ONE_MINUTE)),Oe(this,"initialSubscribeTimeout",G.toMiliseconds(G.ONE_SECOND*15)),Oe(this,"clientId"),Oe(this,"batchSubscribeTopicsLimit",500),Oe(this,"init",async()=>{this.initialized||(this.logger.trace("Initialized"),this.registerEventListeners(),await this.restore()),this.initialized=!0}),Oe(this,"subscribe",async(n,s)=>{var i;this.isInitialized(),this.logger.debug("Subscribing Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:n,opts:s}});try{const o=nu(s),a={topic:n,relay:o,transportType:s==null?void 0:s.transportType};(i=s==null?void 0:s.internal)!=null&&i.skipSubscribe||this.pending.set(n,a);const c=await this.rpcSubscribe(n,o,s);return typeof c=="string"&&(this.onSubscribe(c,a),this.logger.debug("Successfully Subscribed Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:n,opts:s}})),c}catch(o){throw this.logger.debug("Failed to Subscribe Topic"),this.logger.error(o),o}}),Oe(this,"unsubscribe",async(n,s)=>{this.isInitialized(),typeof(s==null?void 0:s.id)<"u"?await this.unsubscribeById(n,s.id,s):await this.unsubscribeByTopic(n,s)}),Oe(this,"isSubscribed",n=>new Promise(s=>{s(this.topicMap.topics.includes(n))})),Oe(this,"isKnownTopic",n=>new Promise(s=>{s(this.topicMap.topics.includes(n)||this.pending.has(n)||this.cached.some(i=>i.topic===n))})),Oe(this,"on",(n,s)=>{this.events.on(n,s)}),Oe(this,"once",(n,s)=>{this.events.once(n,s)}),Oe(this,"off",(n,s)=>{this.events.off(n,s)}),Oe(this,"removeListener",(n,s)=>{this.events.removeListener(n,s)}),Oe(this,"start",async()=>{await this.onConnect()}),Oe(this,"stop",async()=>{await this.onDisconnect()}),Oe(this,"restart",async()=>{await this.restore(),await this.onRestart()}),Oe(this,"checkPending",async()=>{if(this.pending.size===0&&(!this.initialized||!this.relayer.connected))return;const n=[];this.pending.forEach(s=>{n.push(s)}),await this.batchSubscribe(n)}),Oe(this,"registerEventListeners",()=>{this.relayer.core.heartbeat.on(ji.pulse,async()=>{await this.checkPending()}),this.events.on(Wt.created,async n=>{const s=Wt.created;this.logger.info(`Emitting ${s}`),this.logger.debug({type:"event",event:s,data:n}),await this.persist()}),this.events.on(Wt.deleted,async n=>{const s=Wt.deleted;this.logger.info(`Emitting ${s}`),this.logger.debug({type:"event",event:s,data:n}),await this.persist()})}),this.relayer=e,this.logger=ir(t,this.name),this.clientId=""}get context(){return Ht(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.relayer.core.customStoragePrefix+"//"+this.name}get length(){return this.subscriptions.size}get ids(){return Array.from(this.subscriptions.keys())}get values(){return Array.from(this.subscriptions.values())}get topics(){return this.topicMap.topics}get hasAnyTopics(){return this.topicMap.topics.length>0||this.pending.size>0||this.cached.length>0||this.subscriptions.size>0}hasSubscription(e,t){let n=!1;try{n=this.getSubscription(e).topic===t}catch{}return n}reset(){this.cached=[],this.initialized=!0}onDisable(){this.values.length>0&&(this.cached=this.values),this.subscriptions.clear(),this.topicMap.clear()}async unsubscribeByTopic(e,t){const n=this.topicMap.get(e);await Promise.all(n.map(async s=>await this.unsubscribeById(e,s,t)))}async unsubscribeById(e,t,n){this.logger.debug("Unsubscribing Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:e,id:t,opts:n}});try{const s=nu(n);await this.restartToComplete({topic:e,id:t,relay:s}),await this.rpcUnsubscribe(e,t,s);const i=$e("USER_DISCONNECTED",`${this.name}, ${e}`);await this.onUnsubscribe(e,t,i),this.logger.debug("Successfully Unsubscribed Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:e,id:t,opts:n}})}catch(s){throw this.logger.debug("Failed to Unsubscribe Topic"),this.logger.error(s),s}}async rpcSubscribe(e,t,n){var s,i;const o=await this.getSubscriptionId(e);if((s=n==null?void 0:n.internal)!=null&&s.skipSubscribe)return o;(!n||(n==null?void 0:n.transportType)===Ce.relay)&&await this.restartToComplete({topic:e,id:e,relay:t});const a={method:lo(t.protocol).subscribe,params:{topic:e}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:a});const c=(i=n==null?void 0:n.internal)==null?void 0:i.throwOnFailedPublish;try{if((n==null?void 0:n.transportType)===Ce.link_mode)return setTimeout(()=>{(this.relayer.connected||this.relayer.connecting)&&this.relayer.request(a).catch(h=>this.logger.warn(h))},G.toMiliseconds(G.ONE_SECOND)),o;const l=new Promise(async h=>{const f=d=>{d.topic===e&&(this.events.removeListener(Wt.created,f),h(d.id))};this.events.on(Wt.created,f);try{const d=await an(new Promise((p,g)=>{this.relayer.request(a).catch(m=>{this.logger.warn(m,m==null?void 0:m.message),g(m)}).then(p)}),this.initialSubscribeTimeout,`Subscribing to ${e} failed, please try again`);this.events.removeListener(Wt.created,f),h(d)}catch{}}),u=await an(l,this.subscribeTimeout,`Subscribing to ${e} failed, please try again`);if(!u&&c)throw new Error(`Subscribing to ${e} failed, please try again`);return u?o:null}catch(l){if(this.logger.debug("Outgoing Relay Subscribe Payload stalled"),this.relayer.events.emit(je.connection_stalled),c)throw l}return null}async rpcBatchSubscribe(e){if(!e.length)return!0;const t=e[0].relay,n={method:lo(t.protocol).batchSubscribe,params:{topics:e.map(s=>s.topic)}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:n});try{return await an(new Promise((s,i)=>{this.relayer.request(n).then(s).catch(o=>{this.logger.warn(o),i(o)})}),this.subscribeTimeout,"rpcBatchSubscribe failed, please try again"),!0}catch{return this.relayer.events.emit(je.connection_stalled),!1}}async rpcBatchFetchMessages(e){if(!e.length)return;const t=e[0].relay,n={method:lo(t.protocol).batchFetchMessages,params:{topics:e.map(i=>i.topic)}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:n});let s;try{s=await await an(new Promise((i,o)=>{this.relayer.request(n).catch(a=>{this.logger.warn(a),o(a)}).then(i)}),this.subscribeTimeout,"rpcBatchFetchMessages failed, please try again")}catch{this.relayer.events.emit(je.connection_stalled)}return s}rpcUnsubscribe(e,t,n){const s={method:lo(n.protocol).unsubscribe,params:{topic:e,id:t}};return this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:s}),this.relayer.request(s)}onSubscribe(e,t){this.setSubscription(e,Jh(Ea({},t),{id:e})),this.pending.delete(t.topic)}onBatchSubscribe(e){e.length&&e.forEach(t=>{this.setSubscription(t.id,Ea({},t)),this.pending.delete(t.topic)})}async onUnsubscribe(e,t,n){this.events.removeAllListeners(t),this.hasSubscription(t,e)&&this.deleteSubscription(t,n),await this.relayer.messages.del(e)}async setRelayerSubscriptions(e){await this.relayer.core.storage.setItem(this.storageKey,e)}async getRelayerSubscriptions(){return await this.relayer.core.storage.getItem(this.storageKey)}setSubscription(e,t){this.logger.debug("Setting subscription"),this.logger.trace({type:"method",method:"setSubscription",id:e,subscription:t}),this.addSubscription(e,t)}addSubscription(e,t){this.subscriptions.set(e,Ea({},t)),this.topicMap.set(t.topic,e),this.events.emit(Wt.created,t)}getSubscription(e){this.logger.debug("Getting subscription"),this.logger.trace({type:"method",method:"getSubscription",id:e});const t=this.subscriptions.get(e);if(!t){const{message:n}=W("NO_MATCHING_KEY",`${this.name}: ${e}`);throw new Error(n)}return t}deleteSubscription(e,t){this.logger.debug("Deleting subscription"),this.logger.trace({type:"method",method:"deleteSubscription",id:e,reason:t});const n=this.getSubscription(e);this.subscriptions.delete(e),this.topicMap.delete(n.topic,e),this.events.emit(Wt.deleted,Jh(Ea({},n),{reason:t}))}async persist(){await this.setRelayerSubscriptions(this.values),this.events.emit(Wt.sync)}async onRestart(){if(this.cached.length){const e=[...this.cached],t=Math.ceil(this.cached.length/this.batchSubscribeTopicsLimit);for(let n=0;n<t;n++){const s=e.splice(0,this.batchSubscribeTopicsLimit);await this.batchSubscribe(s)}}this.events.emit(Wt.resubscribed)}async restore(){try{const e=await this.getRelayerSubscriptions();if(typeof e>"u"||!e.length)return;if(this.subscriptions.size&&!e.every(t=>{var n;return t.topic===((n=this.subscriptions.get(t.id))==null?void 0:n.topic)})){const{message:t}=W("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(t),this.logger.error(`${this.name}: ${JSON.stringify(this.values)}`),new Error(t)}this.cached=e,this.logger.debug(`Successfully Restored subscriptions for ${this.name}`),this.logger.trace({type:"method",method:"restore",subscriptions:this.values})}catch(e){this.logger.debug(`Failed to Restore subscriptions for ${this.name}`),this.logger.error(e)}}async batchSubscribe(e){if(e.length){if(!await this.rpcBatchSubscribe(e)){this.logger.warn(`Batch subscribe failed for ${e.length} topics, adding to pending for retry`),e.forEach(t=>{this.pending.set(t.topic,t)});return}this.onBatchSubscribe(await Promise.all(e.map(async t=>Jh(Ea({},t),{id:await this.getSubscriptionId(t.topic)}))))}}async batchFetchMessages(e){if(!e.length)return;this.logger.trace(`Fetching batch messages for ${e.length} subscriptions`);const t=await this.rpcBatchFetchMessages(e);t&&t.messages&&(await R4(G.toMiliseconds(G.ONE_SECOND)),await this.relayer.handleBatchMessageEvents(t.messages))}async onConnect(){await this.restart(),this.reset()}onDisconnect(){this.onDisable()}isInitialized(){if(!this.initialized){const{message:e}=W("NOT_INITIALIZED",this.name);throw new Error(e)}}async restartToComplete(e){!this.relayer.connected&&!this.relayer.connecting&&(this.cached.push(e),await this.relayer.transportOpen())}async getClientId(){return this.clientId||(this.clientId=await this.relayer.core.crypto.getClientId()),this.clientId}async getSubscriptionId(e){return yr(e+await this.getClientId())}}var rk=Object.defineProperty,om=Object.getOwnPropertySymbols,nk=Object.prototype.hasOwnProperty,sk=Object.prototype.propertyIsEnumerable,_d=(r,e,t)=>e in r?rk(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,am=(r,e)=>{for(var t in e||(e={}))nk.call(e,t)&&_d(r,t,e[t]);if(om)for(var t of om(e))sk.call(e,t)&&_d(r,t,e[t]);return r},fe=(r,e,t)=>_d(r,typeof e!="symbol"?e+"":e,t);class ik extends n3{constructor(e){var t;super(e),fe(this,"protocol","wc"),fe(this,"version",2),fe(this,"core"),fe(this,"logger"),fe(this,"events",new Ur.EventEmitter),fe(this,"provider"),fe(this,"messages"),fe(this,"subscriber"),fe(this,"publisher"),fe(this,"name",kR),fe(this,"transportExplicitlyClosed",!1),fe(this,"initialized",!1),fe(this,"connectionAttemptInProgress",!1),fe(this,"relayUrl"),fe(this,"projectId"),fe(this,"packageName"),fe(this,"bundleId"),fe(this,"hasExperiencedNetworkDisruption",!1),fe(this,"pingTimeout"),fe(this,"heartBeatTimeout",G.toMiliseconds(G.THIRTY_SECONDS+G.FIVE_SECONDS)),fe(this,"reconnectTimeout"),fe(this,"connectPromise"),fe(this,"reconnectInProgress",!1),fe(this,"requestsInFlight",[]),fe(this,"connectTimeout",G.toMiliseconds(G.ONE_SECOND*15)),fe(this,"stalledRestartInProgress",!1),fe(this,"stalledRestartTimeout"),fe(this,"stalledRestartBackoff",0),fe(this,"stalledRestartBaseInterval",G.toMiliseconds(G.ONE_SECOND*2)),fe(this,"stalledRestartMaxInterval",G.toMiliseconds(G.THIRTY_SECONDS)),fe(this,"request",async n=>{var s,i;this.logger.debug("Publishing Request Payload");const o=n.id||Cs().toString();await this.toEstablishConnection();try{this.logger.trace({id:o,method:n.method,topic:(s=n.params)==null?void 0:s.topic},"relayer.request - publishing...");const a=`${o}:${((i=n.params)==null?void 0:i.tag)||""}`;this.requestsInFlight.push(a);const c=await this.provider.request(n);return this.requestsInFlight=this.requestsInFlight.filter(l=>l!==a),c}catch(a){throw this.logger.debug(`Failed to Publish Request: ${o}`),a}}),fe(this,"resetPingTimeout",()=>{Yl()&&(clearTimeout(this.pingTimeout),this.pingTimeout=setTimeout(()=>{var n,s,i,o;try{this.logger.debug({},"pingTimeout: Connection stalled, terminating..."),(o=(i=(s=(n=this.provider)==null?void 0:n.connection)==null?void 0:s.socket)==null?void 0:i.terminate)==null||o.call(i)}catch(a){this.logger.warn(a,a==null?void 0:a.message)}},this.heartBeatTimeout))}),fe(this,"onPayloadHandler",n=>{this.onProviderPayload(n),this.resetPingTimeout()}),fe(this,"onConnectHandler",()=>{this.logger.warn({},"Relayer connected "),this.startPingTimeout(),this.events.emit(je.connect)}),fe(this,"onDisconnectHandler",()=>{this.logger.warn({},"Relayer disconnected "),this.requestsInFlight=[],this.onProviderDisconnect()}),fe(this,"onProviderErrorHandler",n=>{this.logger.fatal(`Fatal socket error: ${n.message}`),this.events.emit(je.error,n),this.logger.fatal("Fatal socket error received, closing transport"),this.transportExplicitlyClosed=!0,clearTimeout(this.reconnectTimeout),this.reconnectTimeout=void 0,this.reconnectInProgress=!1,this.transportClose().catch(s=>this.logger.warn(s))}),fe(this,"registerProviderListeners",()=>{this.provider.on(ar.payload,this.onPayloadHandler),this.provider.on(ar.connect,this.onConnectHandler),this.provider.on(ar.disconnect,this.onDisconnectHandler),this.provider.on(ar.error,this.onProviderErrorHandler)}),this.core=e.core,this.logger=xx({logger:(t=e.logger)!=null?t:TR,name:this.name}),this.messages=new jT(this.logger,e.core),this.subscriber=new tk(this,this.logger),this.publisher=new HT(this,this.logger),this.projectId=e==null?void 0:e.projectId,this.relayUrl=(e==null?void 0:e.relayUrl)||_x,y4()?this.packageName=Qy():m4()&&(this.bundleId=Qy()),this.provider={}}async init(){this.logger.trace("Initialized"),this.registerEventListeners(),await Promise.all([this.messages.init(),this.subscriber.init()]),this.initialized=!0,this.transportOpen().catch(e=>this.logger.warn(e,e==null?void 0:e.message))}get context(){return Ht(this.logger)}get connected(){var e,t,n;return((n=(t=(e=this.provider)==null?void 0:e.connection)==null?void 0:t.socket)==null?void 0:n.readyState)===1||!1}get connecting(){var e,t,n;return((n=(t=(e=this.provider)==null?void 0:e.connection)==null?void 0:t.socket)==null?void 0:n.readyState)===0||this.connectPromise!==void 0||!1}async publish(e,t,n){this.isInitialized(),await this.publisher.publish(e,t,n),await this.recordMessageEvent({topic:e,message:t,publishedAt:Date.now(),transportType:Ce.relay},Sl.outbound)}async publishCustom(e){this.isInitialized(),await this.publisher.publishCustom(e)}async subscribe(e,t){var n,s,i;this.isInitialized(),(!(t!=null&&t.transportType)||(t==null?void 0:t.transportType)==="relay")&&await this.toEstablishConnection();const o=typeof((n=t==null?void 0:t.internal)==null?void 0:n.throwOnFailedPublish)>"u"?!0:(s=t==null?void 0:t.internal)==null?void 0:s.throwOnFailedPublish;let a=((i=this.subscriber.topicMap.get(e))==null?void 0:i[0])||"",c;const l=u=>{u.topic===e&&(this.subscriber.off(Wt.created,l),c())};return await Promise.all([new Promise(u=>{c=u,this.subscriber.on(Wt.created,l)}),new Promise(async(u,h)=>{a=await this.subscriber.subscribe(e,am({internal:{throwOnFailedPublish:o}},t)).catch(f=>{o&&h(f)})||a,u()})]),a}async unsubscribe(e,t){this.isInitialized(),await this.subscriber.unsubscribe(e,t)}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}off(e,t){this.events.off(e,t)}removeListener(e,t){this.events.removeListener(e,t)}async transportDisconnect(){this.provider.disconnect&&(this.hasExperiencedNetworkDisruption||this.connected)?await an(this.provider.disconnect(),2e3,"provider.disconnect()").catch(()=>this.onProviderDisconnect()):this.onProviderDisconnect()}async transportClose(){this.transportExplicitlyClosed=!0,clearTimeout(this.stalledRestartTimeout),this.stalledRestartInProgress=!1,this.stalledRestartBackoff=0,await this.resetTransport()}async transportOpen(e){if(!this.subscriber.hasAnyTopics){this.logger.info("Starting WS connection skipped because the client has no topics to work with.");return}if(this.connectPromise?(this.logger.debug({},"Waiting for existing connection attempt to resolve..."),await this.connectPromise,this.logger.debug({},"Existing connection attempt resolved")):(this.connectPromise=new Promise(async(t,n)=>{await this.connect(e).then(t).catch(n).finally(()=>{this.connectPromise=void 0})}),await this.connectPromise),!this.connected)throw new Error(`Couldn't establish socket connection to the relay server: ${this.relayUrl}`)}async restartTransport(e){this.logger.debug({},"Restarting transport..."),!this.connectionAttemptInProgress&&(this.relayUrl=e||this.relayUrl,await this.confirmOnlineStateOrThrow(),await this.resetTransport(),await this.transportOpen())}async resetTransport(){this.reconnectInProgress=!0,clearTimeout(this.reconnectTimeout),this.reconnectTimeout=void 0,await this.transportDisconnect(),await this.subscriber.stop(),this.reconnectInProgress=!1}async confirmOnlineStateOrThrow(){if(!await j0())throw new Error("No internet connection detected. Please restart your network and try again.")}async handleBatchMessageEvents(e){if((e==null?void 0:e.length)===0){this.logger.trace("Batch message events is empty. Ignoring...");return}const t=e.sort((n,s)=>n.publishedAt-s.publishedAt);this.logger.debug(`Batch of ${t.length} message events sorted`);for(const n of t)try{await this.onMessageEvent(n)}catch(s){this.logger.warn(s,"Error while processing batch message event: "+(s==null?void 0:s.message))}this.logger.trace(`Batch of ${t.length} message events processed`)}async onLinkMessageEvent(e,t){const{topic:n}=e;if(!t.sessionExists){const s=He(G.FIVE_MINUTES),i={topic:n,expiry:s,relay:{protocol:"irn"},active:!1};await this.core.pairing.pairings.set(n,i)}this.events.emit(je.message,e),await this.recordMessageEvent(e,Sl.inbound)}async connect(e){await this.confirmOnlineStateOrThrow(),e&&e!==this.relayUrl&&(this.relayUrl=e,await this.transportDisconnect()),this.connectionAttemptInProgress=!0,this.transportExplicitlyClosed=!1;let t=1;for(;t<6;){try{if(this.transportExplicitlyClosed)break;this.logger.debug({},`Connecting to ${this.relayUrl}, attempt: ${t}...`),await this.createProvider(),await new Promise(async(n,s)=>{const i=()=>{s(new Error("Connection interrupted while trying to connect"))};this.provider.once(ar.disconnect,i),await an(new Promise((o,a)=>{this.provider.connect().then(o).catch(a)}),this.connectTimeout,`Socket stalled when trying to connect to ${this.relayUrl}`).catch(o=>{s(o)}).finally(()=>{this.provider.off(ar.disconnect,i),clearTimeout(this.reconnectTimeout)}),await new Promise(async(o,a)=>{const c=()=>{s(new Error("Connection interrupted while trying to subscribe"))};this.provider.once(ar.disconnect,c),await this.subscriber.start().then(o).catch(a).finally(()=>{this.provider.off(ar.disconnect,c)})}),this.hasExperiencedNetworkDisruption=!1,n()})}catch(n){await this.subscriber.stop();const s=n;this.logger.warn({},s.message),this.hasExperiencedNetworkDisruption=!0}finally{this.connectionAttemptInProgress=!1}if(this.connected){this.logger.debug({},`Connected to ${this.relayUrl} successfully on attempt: ${t}`);break}await new Promise(n=>setTimeout(n,G.toMiliseconds(t*1))),t++}}startPingTimeout(){var e,t,n,s,i;if(Yl())try{(t=(e=this.provider)==null?void 0:e.connection)!=null&&t.socket&&((i=(s=(n=this.provider)==null?void 0:n.connection)==null?void 0:s.socket)==null||i.on("ping",()=>{this.resetPingTimeout()})),this.resetPingTimeout()}catch(o){this.logger.warn(o,o==null?void 0:o.message)}}async createProvider(){this.provider.connection&&this.unregisterProviderListeners();const e=await this.core.crypto.signJWT(this.relayUrl);this.provider=new wR(new ER(E4({sdkVersion:Ed,protocol:this.protocol,version:this.version,relayUrl:this.relayUrl,projectId:this.projectId,auth:e,useOnCloseEvent:!0,bundleId:this.bundleId,packageName:this.packageName}))),this.registerProviderListeners()}async recordMessageEvent(e,t){const{topic:n,message:s}=e;await this.messages.set(n,s,t)}async shouldIgnoreMessageEvent(e){const{topic:t,message:n}=e;if(!n||n.length===0)return this.logger.warn(`Ignoring invalid/empty message: ${n}`),!0;if(!await this.subscriber.isKnownTopic(t))return this.logger.warn(`Ignoring message for unknown topic ${t}`),!0;const s=this.messages.has(t,n);return s&&this.logger.warn(`Ignoring duplicate message: ${n}`),s}async onProviderPayload(e){if(this.logger.debug("Incoming Relay Payload"),this.logger.trace({type:"payload",direction:"incoming",payload:e}),Op(e)){if(!e.method.endsWith(UR))return;const t=e.params,{topic:n,message:s,publishedAt:i,attestation:o}=t.data,a={topic:n,message:s,publishedAt:i,transportType:Ce.relay,attestation:o};this.logger.debug("Emitting Relayer Payload"),this.logger.trace(am({type:"event",event:t.id},a)),this.events.emit(t.id,a),await this.acknowledgePayload(e),await this.onMessageEvent(a)}else ju(e)&&this.events.emit(je.message_ack,e)}async onMessageEvent(e){await this.shouldIgnoreMessageEvent(e)||(await this.recordMessageEvent(e,Sl.inbound),this.events.emit(je.message,e))}async acknowledgePayload(e){const t=iu(e.id,!0);await this.provider.connection.send(t)}unregisterProviderListeners(){this.provider.off(ar.payload,this.onPayloadHandler),this.provider.off(ar.connect,this.onConnectHandler),this.provider.off(ar.disconnect,this.onDisconnectHandler),this.provider.off(ar.error,this.onProviderErrorHandler),clearTimeout(this.pingTimeout)}async registerEventListeners(){let e=await j0();b6(async t=>{e!==t&&(e=t,t?await this.transportOpen().catch(n=>this.logger.error(n,n==null?void 0:n.message)):(this.hasExperiencedNetworkDisruption=!0,await this.transportDisconnect(),this.transportExplicitlyClosed=!1))}),this.core.heartbeat.on(ji.pulse,async()=>{if(!this.transportExplicitlyClosed&&!this.connected&&E6())try{await this.confirmOnlineStateOrThrow(),await this.transportOpen()}catch(t){this.logger.warn(t,t==null?void 0:t.message)}}),this.events.on(je.connection_stalled,()=>{if(this.transportExplicitlyClosed||this.stalledRestartInProgress)return;this.stalledRestartInProgress=!0;const t=this.stalledRestartBackoff===0?0:Math.min(Math.pow(2,this.stalledRestartBackoff-1)*this.stalledRestartBaseInterval,this.stalledRestartMaxInterval);this.stalledRestartBackoff++,this.logger.warn(`Connection stalled, restarting transport${t?` in ${t}ms`:""}...`),this.stalledRestartTimeout=setTimeout(async()=>{try{if(this.transportExplicitlyClosed)return;await this.restartTransport()}catch(n){this.logger.error(n,n==null?void 0:n.message)}finally{this.stalledRestartInProgress=!1}},t)})}async onProviderDisconnect(){clearTimeout(this.pingTimeout),this.events.emit(je.disconnect),this.connectionAttemptInProgress=!1,!this.reconnectInProgress&&(this.reconnectInProgress=!0,await this.subscriber.stop(),this.subscriber.hasAnyTopics&&(this.transportExplicitlyClosed||(this.reconnectTimeout=setTimeout(async()=>{await this.transportOpen().catch(e=>this.logger.error(e,e==null?void 0:e.message)),this.reconnectTimeout=void 0,this.reconnectInProgress=!1},G.toMiliseconds($R)))))}isInitialized(){if(!this.initialized){const{message:e}=W("NOT_INITIALIZED",this.name);throw new Error(e)}}async toEstablishConnection(){if(await this.confirmOnlineStateOrThrow(),!this.connected){if(this.connectPromise){await this.connectPromise;return}await this.connect()}}}function ok(r,e){return r===e||Number.isNaN(r)&&Number.isNaN(e)}function cm(r){return Object.getOwnPropertySymbols(r).filter(e=>Object.prototype.propertyIsEnumerable.call(r,e))}function lm(r){return r==null?r===void 0?"[object Undefined]":"[object Null]":Object.prototype.toString.call(r)}const ak="[object RegExp]",ck="[object String]",lk="[object Number]",uk="[object Boolean]",um="[object Arguments]",hk="[object Symbol]",fk="[object Date]",dk="[object Map]",pk="[object Set]",gk="[object Array]",yk="[object Function]",mk="[object ArrayBuffer]",Yh="[object Object]",wk="[object Error]",bk="[object DataView]",xk="[object Uint8Array]",vk="[object Uint8ClampedArray]",Ek="[object Uint16Array]",Ak="[object Uint32Array]",Ik="[object BigUint64Array]",Sk="[object Int8Array]",Ok="[object Int16Array]",Dk="[object Int32Array]",_k="[object BigInt64Array]",Nk="[object Float32Array]",Ck="[object Float64Array]";function hm(r){if(!r||typeof r!="object")return!1;const e=Object.getPrototypeOf(r);return e===null||e===Object.prototype||Object.getPrototypeOf(e)===null?Object.prototype.toString.call(r)==="[object Object]":!1}function Bk(r,e,t){return Ra(r,e,void 0,void 0,void 0,void 0,t)}function Ra(r,e,t,n,s,i,o){const a=o(r,e,t,n,s,i);if(a!==void 0)return a;if(typeof r==typeof e)switch(typeof r){case"bigint":case"string":case"boolean":case"symbol":case"undefined":return r===e;case"number":return r===e||Object.is(r,e);case"function":return r===e;case"object":return ja(r,e,i,o)}return ja(r,e,i,o)}function ja(r,e,t,n){if(Object.is(r,e))return!0;let s=lm(r),i=lm(e);if(s===um&&(s=Yh),i===um&&(i=Yh),s!==i)return!1;switch(s){case ck:return r.toString()===e.toString();case lk:{const c=r.valueOf(),l=e.valueOf();return ok(c,l)}case uk:case fk:case hk:return Object.is(r.valueOf(),e.valueOf());case ak:return r.source===e.source&&r.flags===e.flags;case yk:return r===e}t=t??new Map;const o=t.get(r),a=t.get(e);if(o!=null&&a!=null)return o===e;t.set(r,e),t.set(e,r);try{switch(s){case dk:{if(r.size!==e.size)return!1;for(const[c,l]of r.entries())if(!e.has(c)||!Ra(l,e.get(c),c,r,e,t,n))return!1;return!0}case pk:{if(r.size!==e.size)return!1;const c=Array.from(r.values()),l=Array.from(e.values());for(let u=0;u<c.length;u++){const h=c[u],f=l.findIndex(d=>Ra(h,d,void 0,r,e,t,n));if(f===-1)return!1;l.splice(f,1)}return!0}case gk:case xk:case vk:case Ek:case Ak:case Ik:case Sk:case Ok:case Dk:case _k:case Nk:case Ck:{if(typeof Buffer<"u"&&Buffer.isBuffer(r)!==Buffer.isBuffer(e)||r.length!==e.length)return!1;for(let c=0;c<r.length;c++)if(!Ra(r[c],e[c],c,r,e,t,n))return!1;return!0}case mk:return r.byteLength!==e.byteLength?!1:ja(new Uint8Array(r),new Uint8Array(e),t,n);case bk:return r.byteLength!==e.byteLength||r.byteOffset!==e.byteOffset?!1:ja(new Uint8Array(r),new Uint8Array(e),t,n);case wk:return r.name===e.name&&r.message===e.message;case Yh:{if(!(ja(r.constructor,e.constructor,t,n)||hm(r)&&hm(e)))return!1;const c=[...Object.keys(r),...cm(r)],l=[...Object.keys(e),...cm(e)];if(c.length!==l.length)return!1;for(let u=0;u<c.length;u++){const h=c[u],f=r[h];if(!Object.hasOwn(e,h))return!1;const d=e[h];if(!Ra(f,d,h,r,e,t,n))return!1}return!0}default:return!1}}finally{t.delete(r),t.delete(e)}}function Rk(){}function Pk(r,e){return Bk(r,e,Rk)}var Tk=Object.defineProperty,fm=Object.getOwnPropertySymbols,kk=Object.prototype.hasOwnProperty,Uk=Object.prototype.propertyIsEnumerable,Nd=(r,e,t)=>e in r?Tk(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,dm=(r,e)=>{for(var t in e||(e={}))kk.call(e,t)&&Nd(r,t,e[t]);if(fm)for(var t of fm(e))Uk.call(e,t)&&Nd(r,t,e[t]);return r},Pt=(r,e,t)=>Nd(r,typeof e!="symbol"?e+"":e,t);class qi extends s3{constructor(e,t,n,s=hn,i=void 0){super(e,t,n,s),this.core=e,this.logger=t,this.name=n,Pt(this,"map",new Map),Pt(this,"version",FR),Pt(this,"cached",[]),Pt(this,"initialized",!1),Pt(this,"getKey"),Pt(this,"storagePrefix",hn),Pt(this,"recentlyDeleted",[]),Pt(this,"recentlyDeletedLimit",200),Pt(this,"init",async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(o=>{this.getKey&&o!==null&&!et(o)?this.map.set(this.getKey(o),o):J5(o)?this.map.set(o.id,o):Y5(o)&&this.map.set(o.topic,o)}),this.cached=[],this.initialized=!0)}),Pt(this,"set",async(o,a)=>{this.isInitialized(),this.map.has(o)?await this.update(o,a):(this.logger.debug("Setting value"),this.logger.trace({type:"method",method:"set",key:o,value:a}),this.map.set(o,a),await this.persist())}),Pt(this,"get",o=>(this.isInitialized(),this.logger.debug("Getting value"),this.logger.trace({type:"method",method:"get",key:o}),this.getData(o))),Pt(this,"getAll",o=>(this.isInitialized(),o?this.values.filter(a=>Object.keys(o).every(c=>Pk(a[c],o[c]))):this.values)),Pt(this,"update",async(o,a)=>{this.isInitialized(),this.logger.debug("Updating value"),this.logger.trace({type:"method",method:"update",key:o,update:a});const c=dm(dm({},this.getData(o)),a);this.map.set(o,c),await this.persist()}),Pt(this,"delete",async(o,a)=>{this.isInitialized(),this.map.has(o)&&(this.logger.debug("Deleting value"),this.logger.trace({type:"method",method:"delete",key:o,reason:a}),this.map.delete(o),this.addToRecentlyDeleted(o),await this.persist())}),this.logger=ir(t,this.name),this.storagePrefix=s,this.getKey=i}get context(){return Ht(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get length(){return this.map.size}get keys(){return Array.from(this.map.keys())}get values(){return Array.from(this.map.values())}addToRecentlyDeleted(e){this.recentlyDeleted.push(e),this.recentlyDeleted.length>=this.recentlyDeletedLimit&&this.recentlyDeleted.splice(0,this.recentlyDeletedLimit/2)}async setDataStore(e){await this.core.storage.setItem(this.storageKey,e)}async getDataStore(){return await this.core.storage.getItem(this.storageKey)}getData(e){const t=this.map.get(e);if(!t){if(this.recentlyDeleted.includes(e)){const{message:s}=W("MISSING_OR_INVALID",`Record was recently deleted - ${this.name}: ${e}`);throw this.logger.error(s),new Error(s)}const{message:n}=W("NO_MATCHING_KEY",`${this.name}: ${e}`);throw this.logger.error(n),new Error(n)}return t}async persist(){await this.setDataStore(this.values)}async restore(){try{const e=await this.getDataStore();if(typeof e>"u"||!e.length)return;if(this.map.size){const{message:t}=W("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(t),new Error(t)}this.cached=e,this.logger.debug(`Successfully Restored value for ${this.name}`),this.logger.trace({type:"method",method:"restore",value:this.values})}catch(e){this.logger.debug(`Failed to Restore value for ${this.name}`),this.logger.error(e)}}isInitialized(){if(!this.initialized){const{message:e}=W("NOT_INITIALIZED",this.name);throw new Error(e)}}}var $k=Object.defineProperty,Fk=(r,e,t)=>e in r?$k(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,de=(r,e,t)=>Fk(r,typeof e!="symbol"?e+"":e,t);class Lk{constructor(e,t){this.core=e,this.logger=t,de(this,"name",zR),de(this,"version",qR),de(this,"events",new Nw),de(this,"pairings"),de(this,"initialized",!1),de(this,"storagePrefix",hn),de(this,"ignoredPayloadTypes",[zn]),de(this,"registeredMethods",[]),de(this,"init",async()=>{this.initialized||(await this.pairings.init(),await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.initialized=!0,this.logger.trace("Initialized"))}),de(this,"register",({methods:n})=>{this.isInitialized(),this.registeredMethods=[...new Set([...this.registeredMethods,...n])]}),de(this,"create",async n=>{this.isInitialized();const s=yd(),i=await this.core.crypto.setSymKey(s),o=He(G.FIVE_MINUTES),a={protocol:Dx},c={topic:i,expiry:o,relay:a,active:!1,methods:n==null?void 0:n.methods},l=B0({protocol:this.core.protocol,version:this.core.version,topic:i,symKey:s,relay:a,expiryTimestamp:o,methods:n==null?void 0:n.methods});return this.events.emit(ei.create,c),this.core.expirer.set(i,o),await this.pairings.set(i,c),await this.core.relayer.subscribe(i,{transportType:n==null?void 0:n.transportType,internal:n==null?void 0:n.internal}),{topic:i,uri:l}}),de(this,"pair",async n=>{this.isInitialized();const s=this.core.eventClient.createEvent({properties:{topic:n==null?void 0:n.uri,trace:[qr.pairing_started]}});this.isValidPair(n,s);const{topic:i,symKey:o,relay:a,expiryTimestamp:c,methods:l}=C0(n.uri);s.props.properties.topic=i,s.addTrace(qr.pairing_uri_validation_success),s.addTrace(qr.pairing_uri_not_expired);let u;if(this.pairings.keys.includes(i)){if(u=this.pairings.get(i),s.addTrace(qr.existing_pairing),u.active)throw s.setError(vn.active_pairing_already_exists),new Error(`Pairing already exists: ${i}. Please try again with a new connection URI.`);s.addTrace(qr.pairing_not_expired)}const h=c||He(G.FIVE_MINUTES),f={topic:i,relay:a,expiry:h,active:!1,methods:l};this.core.expirer.set(i,h),await this.pairings.set(i,f),s.addTrace(qr.store_new_pairing),n.activatePairing&&await this.activate({topic:i}),this.events.emit(ei.create,f),s.addTrace(qr.emit_inactive_pairing),this.core.crypto.keychain.has(i)||await this.core.crypto.setSymKey(o,i),s.addTrace(qr.subscribing_pairing_topic);try{await this.core.relayer.confirmOnlineStateOrThrow()}catch{s.setError(vn.no_internet_connection)}try{await this.core.relayer.subscribe(i,{relay:a})}catch(d){throw s.setError(vn.subscribe_pairing_topic_failure),d}return s.addTrace(qr.subscribe_pairing_topic_success),f}),de(this,"activate",async({topic:n})=>{this.isInitialized();const s=He(G.FIVE_MINUTES);this.core.expirer.set(n,s),await this.pairings.update(n,{active:!0,expiry:s})}),de(this,"ping",async n=>{this.isInitialized(),await this.isValidPing(n),this.logger.warn("ping() is deprecated and will be removed in the next major release.");const{topic:s}=n;if(this.pairings.keys.includes(s)){const i=await this.sendRequest(s,"wc_pairingPing",{}),{done:o,resolve:a,reject:c}=Js();this.events.once(ve("pairing_ping",i),({error:l})=>{l?c(l):a()}),await o()}}),de(this,"updateExpiry",async({topic:n,expiry:s})=>{this.isInitialized(),await this.pairings.update(n,{expiry:s})}),de(this,"updateMetadata",async({topic:n,metadata:s})=>{this.isInitialized(),await this.pairings.update(n,{peerMetadata:s})}),de(this,"getPairings",()=>(this.isInitialized(),this.pairings.values)),de(this,"disconnect",async n=>{this.isInitialized(),await this.isValidDisconnect(n);const{topic:s}=n;this.pairings.keys.includes(s)&&(await this.sendRequest(s,"wc_pairingDelete",$e("USER_DISCONNECTED")),await this.deletePairing(s))}),de(this,"formatUriFromPairing",n=>{this.isInitialized();const{topic:s,relay:i,expiry:o,methods:a}=n,c=this.core.crypto.keychain.get(s);return B0({protocol:this.core.protocol,version:this.core.version,topic:s,symKey:c,relay:i,expiryTimestamp:o,methods:a})}),de(this,"sendRequest",async(n,s,i)=>{const o=_n(s,i),a=await this.core.crypto.encode(n,o),c=xa[s].req;return this.core.history.set(n,o),this.core.relayer.publish(n,a,c),o.id}),de(this,"sendResult",async(n,s,i)=>{const o=iu(n,i),a=await this.core.crypto.encode(s,o),c=(await this.core.history.get(s,n)).request.method,l=xa[c].res;await this.core.relayer.publish(s,a,l),await this.core.history.resolve(o)}),de(this,"sendError",async(n,s,i)=>{const o=Sp(n,i),a=await this.core.crypto.encode(s,o),c=(await this.core.history.get(s,n)).request.method,l=xa[c]?xa[c].res:xa.unregistered_method.res;await this.core.relayer.publish(s,a,l),await this.core.history.resolve(o)}),de(this,"deletePairing",async(n,s)=>{await this.core.relayer.unsubscribe(n),await Promise.all([this.pairings.delete(n,$e("USER_DISCONNECTED")),this.core.crypto.deleteSymKey(n),s?Promise.resolve():this.core.expirer.del(n)])}),de(this,"cleanup",async()=>{const n=this.pairings.getAll().filter(s=>is(s.expiry));await Promise.all(n.map(s=>this.deletePairing(s.topic)))}),de(this,"onRelayEventRequest",async n=>{const{topic:s,payload:i}=n;switch(i.method){case"wc_pairingPing":return await this.onPairingPingRequest(s,i);case"wc_pairingDelete":return await this.onPairingDeleteRequest(s,i);default:return await this.onUnknownRpcMethodRequest(s,i)}}),de(this,"onRelayEventResponse",async n=>{const{topic:s,payload:i}=n,o=(await this.core.history.get(s,i.id)).request.method;switch(o){case"wc_pairingPing":return this.onPairingPingResponse(s,i);default:return this.onUnknownRpcMethodResponse(o)}}),de(this,"onPairingPingRequest",async(n,s)=>{const{id:i}=s;try{this.isValidPing({topic:n}),await this.sendResult(i,n,!0),this.events.emit(ei.ping,{id:i,topic:n})}catch(o){await this.sendError(i,n,o),this.logger.error(o)}}),de(this,"onPairingPingResponse",(n,s)=>{const{id:i}=s;setTimeout(()=>{Kr(s)?this.events.emit(ve("pairing_ping",i),{}):mr(s)&&this.events.emit(ve("pairing_ping",i),{error:s.error})},500)}),de(this,"onPairingDeleteRequest",async(n,s)=>{const{id:i}=s;try{this.isValidDisconnect({topic:n}),await this.deletePairing(n),this.events.emit(ei.delete,{id:i,topic:n})}catch(o){await this.sendError(i,n,o),this.logger.error(o)}}),de(this,"onUnknownRpcMethodRequest",async(n,s)=>{const{id:i,method:o}=s;try{if(this.registeredMethods.includes(o))return;const a=$e("WC_METHOD_UNSUPPORTED",o);await this.sendError(i,n,a),this.logger.error(a)}catch(a){await this.sendError(i,n,a),this.logger.error(a)}}),de(this,"onUnknownRpcMethodResponse",n=>{this.registeredMethods.includes(n)||this.logger.error($e("WC_METHOD_UNSUPPORTED",n))}),de(this,"isValidPair",(n,s)=>{var i;if(!kt(n)){const{message:a}=W("MISSING_OR_INVALID",`pair() params: ${n}`);throw s.setError(vn.malformed_pairing_uri),new Error(a)}if(!W5(n.uri)){const{message:a}=W("MISSING_OR_INVALID",`pair() uri: ${n.uri}`);throw s.setError(vn.malformed_pairing_uri),new Error(a)}const o=C0(n==null?void 0:n.uri);if(!((i=o==null?void 0:o.relay)!=null&&i.protocol)){const{message:a}=W("MISSING_OR_INVALID","pair() uri#relay-protocol");throw s.setError(vn.malformed_pairing_uri),new Error(a)}if(!(o!=null&&o.symKey)){const{message:a}=W("MISSING_OR_INVALID","pair() uri#symKey");throw s.setError(vn.malformed_pairing_uri),new Error(a)}if(o!=null&&o.expiryTimestamp&&G.toMiliseconds(o==null?void 0:o.expiryTimestamp)<Date.now()){s.setError(vn.pairing_expired);const{message:a}=W("EXPIRED","pair() URI has expired. Please try again with a new connection URI.");throw new Error(a)}}),de(this,"isValidPing",async n=>{if(!kt(n)){const{message:i}=W("MISSING_OR_INVALID",`ping() params: ${n}`);throw new Error(i)}const{topic:s}=n;await this.isValidPairingTopic(s)}),de(this,"isValidDisconnect",async n=>{if(!kt(n)){const{message:i}=W("MISSING_OR_INVALID",`disconnect() params: ${n}`);throw new Error(i)}const{topic:s}=n;await this.isValidPairingTopic(s)}),de(this,"isValidPairingTopic",async n=>{if(!Ve(n,!1)){const{message:s}=W("MISSING_OR_INVALID",`pairing topic should be a string: ${n}`);throw new Error(s)}if(!this.pairings.keys.includes(n)){const{message:s}=W("NO_MATCHING_KEY",`pairing topic doesn't exist: ${n}`);throw new Error(s)}if(is(this.pairings.get(n).expiry)){await this.deletePairing(n);const{message:s}=W("EXPIRED",`pairing topic: ${n}`);throw new Error(s)}}),this.core=e,this.logger=ir(t,this.name),this.pairings=new qi(this.core,this.logger,this.name,this.storagePrefix)}get context(){return Ht(this.logger)}isInitialized(){if(!this.initialized){const{message:e}=W("NOT_INITIALIZED",this.name);throw new Error(e)}}registerRelayerEvents(){this.core.relayer.on(je.message,async e=>{const{topic:t,message:n,transportType:s}=e;if(this.pairings.keys.includes(t)&&s!==Ce.link_mode&&!this.ignoredPayloadTypes.includes(this.core.crypto.getPayloadType(n)))try{const i=await this.core.crypto.decode(t,n);Op(i)?(this.core.history.set(t,i),await this.onRelayEventRequest({topic:t,payload:i})):ju(i)&&(await this.core.history.resolve(i),await this.onRelayEventResponse({topic:t,payload:i}),this.core.history.delete(t,i.id)),await this.core.relayer.messages.ack(t,n)}catch(i){this.logger.error(i)}})}registerExpirerEvents(){this.core.expirer.on(lr.expired,async e=>{const{topic:t}=m1(e.target);t&&this.pairings.keys.includes(t)&&(await this.deletePairing(t,!0),this.events.emit(ei.expire,{topic:t}))})}}var jk=Object.defineProperty,Mk=(r,e,t)=>e in r?jk(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,nt=(r,e,t)=>Mk(r,typeof e!="symbol"?e+"":e,t);class zk extends e3{constructor(e,t){super(e,t),this.core=e,this.logger=t,nt(this,"records",new Map),nt(this,"events",new Ur.EventEmitter),nt(this,"name",VR),nt(this,"version",KR),nt(this,"cached",[]),nt(this,"initialized",!1),nt(this,"storagePrefix",hn),nt(this,"init",async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(n=>this.records.set(n.id,n)),this.cached=[],this.registerEventListeners(),this.initialized=!0)}),nt(this,"set",(n,s,i)=>{if(this.isInitialized(),this.logger.debug("Setting JSON-RPC request history record"),this.logger.trace({type:"method",method:"set",topic:n,request:s,chainId:i}),this.records.has(s.id))return;const o={id:s.id,topic:n,request:{method:s.method,params:s.params||null},chainId:i,expiry:He(G.THIRTY_DAYS)};this.records.set(o.id,o),this.persist(),this.events.emit(vr.created,o)}),nt(this,"resolve",async n=>{if(this.isInitialized(),this.logger.debug("Updating JSON-RPC response history record"),this.logger.trace({type:"method",method:"update",response:n}),!this.records.has(n.id))return;const s=await this.getRecord(n.id);typeof s.response>"u"&&(s.response=mr(n)?{error:n.error}:{result:n.result},this.records.set(s.id,s),this.persist(),this.events.emit(vr.updated,s))}),nt(this,"get",async(n,s)=>(this.isInitialized(),this.logger.debug("Getting record"),this.logger.trace({type:"method",method:"get",topic:n,id:s}),await this.getRecord(s))),nt(this,"delete",(n,s)=>{this.isInitialized(),this.logger.debug("Deleting record"),this.logger.trace({type:"method",method:"delete",id:s}),this.values.forEach(i=>{if(i.topic===n){if(typeof s<"u"&&i.id!==s)return;this.records.delete(i.id),this.events.emit(vr.deleted,i)}}),this.persist()}),nt(this,"exists",async(n,s)=>(this.isInitialized(),this.records.has(s)?(await this.getRecord(s)).topic===n:!1)),nt(this,"on",(n,s)=>{this.events.on(n,s)}),nt(this,"once",(n,s)=>{this.events.once(n,s)}),nt(this,"off",(n,s)=>{this.events.off(n,s)}),nt(this,"removeListener",(n,s)=>{this.events.removeListener(n,s)}),this.logger=ir(t,this.name)}get context(){return Ht(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get size(){return this.records.size}get keys(){return Array.from(this.records.keys())}get values(){return Array.from(this.records.values())}get pending(){const e=[];return this.values.forEach(t=>{if(typeof t.response<"u")return;const n={topic:t.topic,request:_n(t.request.method,t.request.params,t.id),chainId:t.chainId};return e.push(n)}),e}async setJsonRpcRecords(e){await this.core.storage.setItem(this.storageKey,e)}async getJsonRpcRecords(){return await this.core.storage.getItem(this.storageKey)}getRecord(e){this.isInitialized();const t=this.records.get(e);if(!t){const{message:n}=W("NO_MATCHING_KEY",`${this.name}: ${e}`);throw new Error(n)}return t}async persist(){await this.setJsonRpcRecords(this.values),this.events.emit(vr.sync)}async restore(){try{const e=await this.getJsonRpcRecords();if(typeof e>"u"||!e.length)return;if(this.records.size){const{message:t}=W("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(t),new Error(t)}this.cached=e,this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",records:this.values})}catch(e){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(e)}}registerEventListeners(){this.events.on(vr.created,e=>{const t=vr.created;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,record:e})}),this.events.on(vr.updated,e=>{const t=vr.updated;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,record:e})}),this.events.on(vr.deleted,e=>{const t=vr.deleted;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,record:e})}),this.core.heartbeat.on(ji.pulse,()=>{this.cleanup()})}cleanup(){try{this.isInitialized();let e=!1;this.records.forEach(t=>{G.toMiliseconds(t.expiry||0)-Date.now()<=0&&(this.logger.info(`Deleting expired history log: ${t.id}`),this.records.delete(t.id),this.events.emit(vr.deleted,t,!1),e=!0)}),e&&this.persist()}catch(e){this.logger.warn(e)}}isInitialized(){if(!this.initialized){const{message:e}=W("NOT_INITIALIZED",this.name);throw new Error(e)}}}var qk=Object.defineProperty,Vk=(r,e,t)=>e in r?qk(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,yt=(r,e,t)=>Vk(r,typeof e!="symbol"?e+"":e,t);class Kk extends o3{constructor(e,t){super(e,t),this.core=e,this.logger=t,yt(this,"expirations",new Map),yt(this,"events",new Ur.EventEmitter),yt(this,"name",HR),yt(this,"version",GR),yt(this,"cached",[]),yt(this,"initialized",!1),yt(this,"storagePrefix",hn),yt(this,"init",async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(n=>this.expirations.set(n.target,n)),this.cached=[],this.registerEventListeners(),this.initialized=!0)}),yt(this,"has",n=>{try{const s=this.formatTarget(n);return typeof this.getExpiration(s)<"u"}catch{return!1}}),yt(this,"set",(n,s)=>{this.isInitialized();const i=this.formatTarget(n),o={target:i,expiry:s};this.expirations.set(i,o),this.checkExpiry(i,o),this.events.emit(lr.created,{target:i,expiration:o})}),yt(this,"get",n=>{this.isInitialized();const s=this.formatTarget(n);return this.getExpiration(s)}),yt(this,"del",n=>{if(this.isInitialized(),this.has(n)){const s=this.formatTarget(n),i=this.getExpiration(s);this.expirations.delete(s),this.events.emit(lr.deleted,{target:s,expiration:i})}}),yt(this,"on",(n,s)=>{this.events.on(n,s)}),yt(this,"once",(n,s)=>{this.events.once(n,s)}),yt(this,"off",(n,s)=>{this.events.off(n,s)}),yt(this,"removeListener",(n,s)=>{this.events.removeListener(n,s)}),this.logger=ir(t,this.name)}get context(){return Ht(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get length(){return this.expirations.size}get keys(){return Array.from(this.expirations.keys())}get values(){return Array.from(this.expirations.values())}formatTarget(e){if(typeof e=="string")return A4(e);if(typeof e=="number")return I4(e);const{message:t}=W("UNKNOWN_TYPE",`Target type: ${typeof e}`);throw new Error(t)}async setExpirations(e){await this.core.storage.setItem(this.storageKey,e)}async getExpirations(){return await this.core.storage.getItem(this.storageKey)}async persist(){await this.setExpirations(this.values),this.events.emit(lr.sync)}async restore(){try{const e=await this.getExpirations();if(typeof e>"u"||!e.length)return;if(this.expirations.size){const{message:t}=W("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(t),new Error(t)}this.cached=e,this.logger.debug(`Successfully Restored expirations for ${this.name}`),this.logger.trace({type:"method",method:"restore",expirations:this.values})}catch(e){this.logger.debug(`Failed to Restore expirations for ${this.name}`),this.logger.error(e)}}getExpiration(e){const t=this.expirations.get(e);if(!t){const{message:n}=W("NO_MATCHING_KEY",`${this.name}: ${e}`);throw this.logger.warn(n),new Error(n)}return t}checkExpiry(e,t){const{expiry:n}=t;G.toMiliseconds(n)-Date.now()<=0&&this.expire(e,t)}expire(e,t){this.expirations.delete(e),this.events.emit(lr.expired,{target:e,expiration:t})}checkExpirations(){this.core.relayer.connected&&this.expirations.forEach((e,t)=>this.checkExpiry(t,e))}registerEventListeners(){this.core.heartbeat.on(ji.pulse,()=>this.checkExpirations()),this.events.on(lr.created,e=>{const t=lr.created;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:e}),this.persist()}),this.events.on(lr.expired,e=>{const t=lr.expired;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:e}),this.persist()}),this.events.on(lr.deleted,e=>{const t=lr.deleted;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:e}),this.persist()})}isInitialized(){if(!this.initialized){const{message:e}=W("NOT_INITIALIZED",this.name);throw new Error(e)}}}var Hk=Object.defineProperty,Gk=(r,e,t)=>e in r?Hk(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,qe=(r,e,t)=>Gk(r,typeof e!="symbol"?e+"":e,t);class Qk extends a3{constructor(e,t,n){super(e,t,n),this.core=e,this.logger=t,this.store=n,qe(this,"name",QR),qe(this,"abortController"),qe(this,"isDevEnv"),qe(this,"verifyUrlV3",JR),qe(this,"storagePrefix",hn),qe(this,"version",Ox),qe(this,"publicKey"),qe(this,"fetchPromise"),qe(this,"init",async()=>{var s;this.isDevEnv||(this.publicKey=await this.store.getItem(this.storeKey),this.publicKey&&G.toMiliseconds((s=this.publicKey)==null?void 0:s.expiresAt)<Date.now()&&(this.logger.debug("verify v2 public key expired"),await this.removePublicKey()))}),qe(this,"register",async s=>{if(!ra()||this.isDevEnv)return;const i=window.location.origin,{id:o,decryptedId:a}=s,c=`${this.verifyUrlV3}/attestation?projectId=${this.core.projectId}&origin=${i}&id=${o}&decryptedId=${a}`;try{const l=Kn.getDocument(),u=this.startAbortTimer(G.ONE_SECOND*5),h=await new Promise((f,d)=>{const p=()=>{window.removeEventListener("message",m),l.body.removeChild(g),d("attestation aborted")};this.abortController.signal.addEventListener("abort",p);const g=l.createElement("iframe");g.src=c,g.style.display="none",g.addEventListener("error",p,{signal:this.abortController.signal});const m=E=>{if(E.data&&typeof E.data=="string")try{const O=JSON.parse(E.data);if(O.type==="verify_attestation"){if(Wf(O.attestation).payload.id!==o)return;clearInterval(u),l.body.removeChild(g),this.abortController.signal.removeEventListener("abort",p),window.removeEventListener("message",m),f(O.attestation===null?"":O.attestation)}}catch(O){this.logger.warn(O)}};l.body.appendChild(g),window.addEventListener("message",m,{signal:this.abortController.signal})});return this.logger.debug(h,"jwt attestation"),h}catch(l){this.logger.warn(l)}return""}),qe(this,"resolve",async s=>{if(this.isDevEnv)return"";const{attestationId:i,hash:o,encryptedId:a}=s;if(i===""){this.logger.debug("resolve: attestationId is empty, skipping");return}if(i){if(Wf(i).payload.id!==a)return;const l=await this.isValidJwtAttestation(i);if(l){if(!l.isVerified){this.logger.warn("resolve: jwt attestation: origin url not verified");return}return l}}if(!o)return;const c=this.getVerifyUrl(s==null?void 0:s.verifyUrl);return this.fetchAttestation(o,c)}),qe(this,"fetchAttestation",async(s,i)=>{this.logger.debug(`resolving attestation: ${s} from url: ${i}`);const o=this.startAbortTimer(G.ONE_SECOND*5),a=await fetch(`${i}/attestation/${s}?v2Supported=true`,{signal:this.abortController.signal});return clearTimeout(o),a.status===200?await a.json():void 0}),qe(this,"getVerifyUrl",s=>{let i=s||La;return YR.includes(i)||(this.logger.info(`verify url: ${i}, not included in trusted list, assigning default: ${La}`),i=La),i}),qe(this,"fetchPublicKey",async()=>{try{this.logger.debug(`fetching public key from: ${this.verifyUrlV3}`);const s=this.startAbortTimer(G.FIVE_SECONDS),i=await fetch(`${this.verifyUrlV3}/public-key`,{signal:this.abortController.signal});return clearTimeout(s),await i.json()}catch(s){this.logger.warn(s)}}),qe(this,"persistPublicKey",async s=>{this.logger.debug(s,"persisting public key to local storage"),await this.store.setItem(this.storeKey,s),this.publicKey=s}),qe(this,"removePublicKey",async()=>{this.logger.debug("removing verify v2 public key from storage"),await this.store.removeItem(this.storeKey),this.publicKey=void 0}),qe(this,"isValidJwtAttestation",async s=>{const i=await this.getPublicKey();try{if(i)return this.validateAttestation(s,i)}catch(a){this.logger.error(a),this.logger.warn("error validating attestation")}const o=await this.fetchAndPersistPublicKey();try{if(o)return this.validateAttestation(s,o)}catch(a){this.logger.error(a),this.logger.warn("error validating attestation")}}),qe(this,"getPublicKey",async()=>this.publicKey?this.publicKey:await this.fetchAndPersistPublicKey()),qe(this,"fetchAndPersistPublicKey",async()=>{if(this.fetchPromise)return await this.fetchPromise,this.publicKey;this.fetchPromise=new Promise(async i=>{const o=await this.fetchPublicKey();o&&(await this.persistPublicKey(o),i(o))});const s=await this.fetchPromise;return this.fetchPromise=void 0,s}),qe(this,"validateAttestation",(s,i)=>{const o=x5(s,i.publicKey),a={hasExpired:G.toMiliseconds(o.exp)<Date.now(),payload:o};if(a.hasExpired)throw this.logger.warn("resolve: jwt attestation expired"),new Error("JWT attestation expired");return{origin:a.payload.origin,isScam:a.payload.isScam,isVerified:a.payload.isVerified}}),this.logger=ir(t,this.name),this.abortController=new AbortController,this.isDevEnv=dp(),this.init()}get storeKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//verify:public:key"}get context(){return Ht(this.logger)}startAbortTimer(e){return this.abortController=new AbortController,setTimeout(()=>this.abortController.abort(),G.toMiliseconds(e))}}var Wk=Object.defineProperty,Jk=(r,e,t)=>e in r?Wk(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,pm=(r,e,t)=>Jk(r,typeof e!="symbol"?e+"":e,t);class Yk extends c3{constructor(e,t){super(e,t),this.projectId=e,this.logger=t,pm(this,"context",ZR),pm(this,"registerDeviceToken",async n=>{const{clientId:s,token:i,notificationType:o,enableEncrypted:a=!1}=n,c=`${XR}/${this.projectId}/clients`;await fetch(c,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({client_id:s,type:o,token:i,always_raw:a})})}),this.logger=ir(t,this.context)}}var Zk=Object.defineProperty,gm=Object.getOwnPropertySymbols,Xk=Object.prototype.hasOwnProperty,eU=Object.prototype.propertyIsEnumerable,Cd=(r,e,t)=>e in r?Zk(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,Aa=(r,e)=>{for(var t in e||(e={}))Xk.call(e,t)&&Cd(r,t,e[t]);if(gm)for(var t of gm(e))eU.call(e,t)&&Cd(r,t,e[t]);return r},We=(r,e,t)=>Cd(r,typeof e!="symbol"?e+"":e,t);class tU extends l3{constructor(e,t,n=!0){super(e,t,n),this.core=e,this.logger=t,We(this,"context",tP),We(this,"storagePrefix",hn),We(this,"storageVersion",eP),We(this,"events",new Map),We(this,"shouldPersist",!1),We(this,"init",async()=>{if(!dp())try{const s={eventId:Jy(),timestamp:Date.now(),domain:this.getAppDomain(),props:{event:"INIT",type:"",properties:{client_id:await this.core.crypto.getClientId(),user_agent:g1(this.core.relayer.protocol,this.core.relayer.version,Ed)}}};await this.sendEvent([s])}catch(s){this.logger.warn(s)}}),We(this,"createEvent",s=>{const{event:i="ERROR",type:o="",properties:{topic:a,trace:c}}=s,l=Jy(),u=this.core.projectId||"",h=Date.now(),f=Aa({eventId:l,timestamp:h,props:{event:i,type:o,properties:{topic:a,trace:c}},bundleId:u,domain:this.getAppDomain()},this.setMethods(l));return this.telemetryEnabled&&(this.events.set(l,f),this.shouldPersist=!0),f}),We(this,"getEvent",s=>{const{eventId:i,topic:o}=s;if(i)return this.events.get(i);const a=Array.from(this.events.values()).find(c=>c.props.properties.topic===o);if(a)return Aa(Aa({},a),this.setMethods(a.eventId))}),We(this,"deleteEvent",s=>{const{eventId:i}=s;this.events.delete(i),this.shouldPersist=!0}),We(this,"setEventListeners",()=>{this.core.heartbeat.on(ji.pulse,async()=>{this.shouldPersist&&await this.persist(),this.events.forEach(s=>{G.fromMiliseconds(Date.now())-G.fromMiliseconds(s.timestamp)>rP&&(this.events.delete(s.eventId),this.shouldPersist=!0)})})}),We(this,"setMethods",s=>({addTrace:i=>this.addTrace(s,i),setError:i=>this.setError(s,i)})),We(this,"addTrace",(s,i)=>{const o=this.events.get(s);o&&(o.props.properties.trace.push(i),this.events.set(s,o),this.shouldPersist=!0)}),We(this,"setError",(s,i)=>{const o=this.events.get(s);o&&(o.props.type=i,o.timestamp=Date.now(),this.events.set(s,o),this.shouldPersist=!0)}),We(this,"persist",async()=>{await this.core.storage.setItem(this.storageKey,Array.from(this.events.values())),this.shouldPersist=!1}),We(this,"restore",async()=>{try{const s=await this.core.storage.getItem(this.storageKey)||[];if(!s.length)return;s.forEach(i=>{this.events.set(i.eventId,Aa(Aa({},i),this.setMethods(i.eventId)))})}catch(s){this.logger.warn(s)}}),We(this,"submit",async()=>{if(!this.telemetryEnabled||this.events.size===0)return;const s=[];for(const[i,o]of this.events)o.props.type&&s.push(o);if(s.length!==0)try{if((await this.sendEvent(s)).ok)for(const i of s)this.events.delete(i.eventId),this.shouldPersist=!0}catch(i){this.logger.warn(i)}}),We(this,"sendEvent",async s=>{const i=this.getAppDomain()?"":"&sp=desktop";return await fetch(`${nP}?projectId=${this.core.projectId}&st=events_sdk&sv=js-${Ed}${i}`,{method:"POST",body:JSON.stringify(s)})}),We(this,"getAppDomain",()=>p1().url),this.logger=ir(t,this.context),this.telemetryEnabled=n,n?this.restore().then(async()=>{await this.submit(),this.setEventListeners()}):this.persist()}get storageKey(){return this.storagePrefix+this.storageVersion+this.core.customStoragePrefix+"//"+this.context}}var rU=Object.defineProperty,ym=Object.getOwnPropertySymbols,nU=Object.prototype.hasOwnProperty,sU=Object.prototype.propertyIsEnumerable,Bd=(r,e,t)=>e in r?rU(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,mm=(r,e)=>{for(var t in e||(e={}))nU.call(e,t)&&Bd(r,t,e[t]);if(ym)for(var t of ym(e))sU.call(e,t)&&Bd(r,t,e[t]);return r},De=(r,e,t)=>Bd(r,typeof e!="symbol"?e+"":e,t);class Dp extends JI{constructor(e){var t;super(e),De(this,"protocol",Sx),De(this,"version",Ox),De(this,"name",vd),De(this,"relayUrl"),De(this,"projectId"),De(this,"customStoragePrefix"),De(this,"events",new Ur.EventEmitter),De(this,"logger"),De(this,"heartbeat"),De(this,"relayer"),De(this,"crypto"),De(this,"storage"),De(this,"history"),De(this,"expirer"),De(this,"pairing"),De(this,"verify"),De(this,"echoClient"),De(this,"linkModeSupportedApps"),De(this,"eventClient"),De(this,"initialized",!1),De(this,"logChunkController"),De(this,"on",(a,c)=>this.events.on(a,c)),De(this,"once",(a,c)=>this.events.once(a,c)),De(this,"off",(a,c)=>this.events.off(a,c)),De(this,"removeListener",(a,c)=>this.events.removeListener(a,c)),De(this,"dispatchEnvelope",({topic:a,message:c,sessionExists:l})=>{if(!a||!c)return;const u={topic:a,message:c,publishedAt:Date.now(),transportType:Ce.link_mode};this.relayer.onLinkMessageEvent(u,{sessionExists:l})});const n=this.getGlobalCore(e==null?void 0:e.customStoragePrefix);if(n)try{return this.customStoragePrefix=n.customStoragePrefix,this.logger=n.logger,this.heartbeat=n.heartbeat,this.crypto=n.crypto,this.history=n.history,this.expirer=n.expirer,this.storage=n.storage,this.relayer=n.relayer,this.pairing=n.pairing,this.verify=n.verify,this.echoClient=n.echoClient,this.linkModeSupportedApps=n.linkModeSupportedApps,this.eventClient=n.eventClient,this.initialized=n.initialized,this.logChunkController=n.logChunkController,n}catch(a){console.warn("Failed to copy global core",a)}this.projectId=e==null?void 0:e.projectId,this.relayUrl=(e==null?void 0:e.relayUrl)||_x,this.customStoragePrefix=e!=null&&e.customStoragePrefix?`:${e.customStoragePrefix}`:"";const s=qI({level:typeof(e==null?void 0:e.logger)=="string"&&e.logger?e.logger:IR.logger,name:vd}),{logger:i,chunkLoggerController:o}=$w({opts:s,maxSizeInBytes:e==null?void 0:e.maxLogBlobSizeInBytes,loggerOverride:e==null?void 0:e.logger});this.logChunkController=o,(t=this.logChunkController)!=null&&t.downloadLogsBlobInBrowser&&(window.downloadLogsBlobInBrowser=async()=>{var a,c;(a=this.logChunkController)!=null&&a.downloadLogsBlobInBrowser&&((c=this.logChunkController)==null||c.downloadLogsBlobInBrowser({clientId:await this.crypto.getClientId()}))}),this.logger=ir(i,this.name),this.heartbeat=new EA,this.crypto=new RT(this,this.logger,e==null?void 0:e.keychain),this.history=new zk(this,this.logger),this.expirer=new Kk(this,this.logger),this.storage=e!=null&&e.storage?e.storage:new sI(mm(mm({},SR),e==null?void 0:e.storageOptions)),this.relayer=new ik({core:this,logger:this.logger,relayUrl:this.relayUrl,projectId:this.projectId}),this.pairing=new Lk(this,this.logger),this.verify=new Qk(this,this.logger,this.storage),this.echoClient=new Yk(this.projectId||"",this.logger),this.linkModeSupportedApps=[],this.eventClient=new tU(this,this.logger,e==null?void 0:e.telemetryEnabled),this.setGlobalCore(this)}static async init(e){const t=new Dp(e);await t.initialize();const n=await t.crypto.getClientId();return await t.storage.setItem(LR,n),t}get context(){return Ht(this.logger)}async start(){this.initialized||await this.initialize()}async getLogsBlob(){var e;return(e=this.logChunkController)==null?void 0:e.logsToBlob({clientId:await this.crypto.getClientId()})}async addLinkModeSupportedApp(e){this.linkModeSupportedApps.includes(e)||(this.linkModeSupportedApps.push(e),await this.storage.setItem(W0,this.linkModeSupportedApps))}async initialize(){this.logger.trace("Initialized");try{await this.crypto.init(),await this.history.init(),await this.expirer.init(),await this.relayer.init(),await this.heartbeat.init(),await this.pairing.init(),this.linkModeSupportedApps=await this.storage.getItem(W0)||[],this.initialized=!0,this.logger.info("Core Initialization Success")}catch(e){throw this.logger.warn(e,`Core Initialization Failure at epoch ${Date.now()}`),this.logger.error(e.message),e}}getGlobalCore(e=""){try{if(this.isGlobalCoreDisabled())return;const t=`_walletConnectCore_${e}`,n=`${t}_count`;return globalThis[n]=(globalThis[n]||0)+1,globalThis[n]>1&&console.warn(`WalletConnect Core is already initialized. This is probably a mistake and can lead to unexpected behavior. Init() was called ${globalThis[n]} times.`),globalThis[t]}catch(t){console.warn("Failed to get global WalletConnect core",t);return}}setGlobalCore(e){var t;try{if(this.isGlobalCoreDisabled())return;const n=`_walletConnectCore_${((t=e.opts)==null?void 0:t.customStoragePrefix)||""}`;globalThis[n]=e}catch(n){console.warn("Failed to set global WalletConnect core",n)}}isGlobalCoreDisabled(){try{return typeof process<"u"&&AR.DISABLE_GLOBAL_CORE==="true"}catch{return!0}}}const iU=Dp,Mx="wc",zx=2,qx="client",_p=`${Mx}@${zx}:${qx}:`,Zh={name:qx,logger:"error"},wm="WALLETCONNECT_DEEPLINK_CHOICE",oU="proposal",bm="Proposal expired",aU="session",to=G.SEVEN_DAYS,cU="engine",st={wc_sessionPropose:{req:{ttl:G.FIVE_MINUTES,prompt:!0,tag:1100},res:{ttl:G.FIVE_MINUTES,prompt:!1,tag:1101},reject:{ttl:G.FIVE_MINUTES,prompt:!1,tag:1120},autoReject:{ttl:G.FIVE_MINUTES,prompt:!1,tag:1121}},wc_sessionSettle:{req:{ttl:G.FIVE_MINUTES,prompt:!1,tag:1102},res:{ttl:G.FIVE_MINUTES,prompt:!1,tag:1103}},wc_sessionUpdate:{req:{ttl:G.ONE_DAY,prompt:!1,tag:1104},res:{ttl:G.ONE_DAY,prompt:!1,tag:1105}},wc_sessionExtend:{req:{ttl:G.ONE_DAY,prompt:!1,tag:1106},res:{ttl:G.ONE_DAY,prompt:!1,tag:1107}},wc_sessionRequest:{req:{ttl:G.FIVE_MINUTES,prompt:!0,tag:1108},res:{ttl:G.FIVE_MINUTES,prompt:!1,tag:1109}},wc_sessionEvent:{req:{ttl:G.FIVE_MINUTES,prompt:!0,tag:1110},res:{ttl:G.FIVE_MINUTES,prompt:!1,tag:1111}},wc_sessionDelete:{req:{ttl:G.ONE_DAY,prompt:!1,tag:1112},res:{ttl:G.ONE_DAY,prompt:!1,tag:1113}},wc_sessionPing:{req:{ttl:G.ONE_DAY,prompt:!1,tag:1114},res:{ttl:G.ONE_DAY,prompt:!1,tag:1115}},wc_sessionAuthenticate:{req:{ttl:G.ONE_HOUR,prompt:!0,tag:1116},res:{ttl:G.ONE_HOUR,prompt:!1,tag:1117},reject:{ttl:G.FIVE_MINUTES,prompt:!1,tag:1118},autoReject:{ttl:G.FIVE_MINUTES,prompt:!1,tag:1119}}},Xh={min:G.FIVE_MINUTES,max:G.SEVEN_DAYS},zr={idle:"IDLE",active:"ACTIVE"},lU={eth_sendTransaction:{key:""},eth_sendRawTransaction:{key:""},wallet_sendCalls:{key:""},solana_signTransaction:{key:"signature"},solana_signAllTransactions:{key:"transactions"},solana_signAndSendTransaction:{key:"signature"},sui_signAndExecuteTransaction:{key:"digest"},sui_signTransaction:{key:""},hedera_signAndExecuteTransaction:{key:"transactionId"},hedera_executeTransaction:{key:"transactionId"},near_signTransaction:{key:""},near_signTransactions:{key:""},tron_signTransaction:{key:"txID"},xrpl_signTransaction:{key:""},xrpl_signTransactionFor:{key:""},algo_signTxn:{key:""},sendTransfer:{key:"txid"},stacks_stxTransfer:{key:"txId"},polkadot_signTransaction:{key:""},cosmos_signDirect:{key:""}},uU="request",hU=["wc_sessionPropose","wc_sessionRequest","wc_authRequest","wc_sessionAuthenticate"],fU="wc",dU="auth",pU="authKeys",gU="pairingTopics",yU="requests",zu=`${fU}@${1.5}:${dU}:`,Ol=`${zu}:PUB_KEY`;var mU=Object.defineProperty,wU=Object.defineProperties,bU=Object.getOwnPropertyDescriptors,xm=Object.getOwnPropertySymbols,xU=Object.prototype.hasOwnProperty,vU=Object.prototype.propertyIsEnumerable,Rd=(r,e,t)=>e in r?mU(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,we=(r,e)=>{for(var t in e||(e={}))xU.call(e,t)&&Rd(r,t,e[t]);if(xm)for(var t of xm(e))vU.call(e,t)&&Rd(r,t,e[t]);return r},it=(r,e)=>wU(r,bU(e)),V=(r,e,t)=>Rd(r,typeof e!="symbol"?e+"":e,t);class EU extends d3{constructor(e){super(e),V(this,"name",cU),V(this,"events",new Nw),V(this,"initialized",!1),V(this,"requestQueue",{state:zr.idle,queue:[]}),V(this,"sessionRequestQueue",{state:zr.idle,queue:[]}),V(this,"emittedSessionRequests",new P4({limit:500})),V(this,"requestQueueDelay",G.ONE_SECOND),V(this,"expectedPairingMethodMap",new Map),V(this,"recentlyDeletedMap",new Map),V(this,"recentlyDeletedLimit",200),V(this,"relayMessageCache",[]),V(this,"pendingSessions",new Map),V(this,"init",async()=>{this.initialized||(await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.registerPairingEvents(),await this.registerLinkModeListeners(),this.client.core.pairing.register({methods:Object.keys(st)}),this.initialized=!0,setTimeout(async()=>{await this.processPendingMessageEvents(),this.sessionRequestQueue.queue=this.getPendingSessionRequests(),this.processSessionRequestQueue()},G.toMiliseconds(this.requestQueueDelay)))}),V(this,"connect",async t=>{var n;this.isInitialized(),await this.confirmOnlineStateOrThrow();const s=it(we({},t),{requiredNamespaces:t.requiredNamespaces||{},optionalNamespaces:t.optionalNamespaces||{}});await this.isValidConnect(s),s.optionalNamespaces=V5(s.requiredNamespaces,s.optionalNamespaces),s.requiredNamespaces={};const{pairingTopic:i,requiredNamespaces:o,optionalNamespaces:a,sessionProperties:c,scopedProperties:l,relays:u,authentication:h,walletPay:f}=s,d=((n=h==null?void 0:h[0])==null?void 0:n.ttl)||st.wc_sessionPropose.req.ttl||G.FIVE_MINUTES;this.validateRequestExpiry(d);let p=i,g,m=!1;try{if(p){const _=this.client.core.pairing.pairings.get(p);this.client.logger.warn("connect() with existing pairing topic is deprecated and will be removed in the next major release."),m=_.active}}catch(_){throw this.client.logger.error(`connect() -> pairing.get(${p}) failed`),_}if(!p||!m){const{topic:_,uri:F}=await this.client.core.pairing.create({internal:{skipSubscribe:!0}});p=_,g=F}if(!p){const{message:_}=W("NO_MATCHING_KEY",`connect() pairing topic: ${p}`);throw new Error(_)}const E=await this.client.core.crypto.generateKeyPair(),O=He(d),x=we(it(we(we({requiredNamespaces:o,optionalNamespaces:a,relays:u??[{protocol:Dx}],proposer:{publicKey:E,metadata:this.client.metadata},expiryTimestamp:O,pairingTopic:p},c&&{sessionProperties:c}),l&&{scopedProperties:l}),{id:Vr()}),(h||f)&&{requests:{authentication:h==null?void 0:h.map(_=>{const{domain:F,chains:j,nonce:$,uri:C,exp:k,nbf:I,type:A,statement:B,requestId:U,resources:N,signatureTypes:T}=_;return{domain:F,chains:j,nonce:$,type:A??"caip122",aud:C,version:"1",iat:new Date().toISOString(),exp:k,nbf:I,statement:B,requestId:U,resources:N,signatureTypes:T}}),walletPay:f}}),b=ve("session_connect",x.id),{reject:v,resolve:S,done:D}=Js(d,bm),R=({id:_})=>{_===x.id&&(this.client.events.off("proposal_expire",R),this.pendingSessions.delete(x.id),this.events.emit(b,{error:{message:bm,code:0}}))};return this.client.events.on("proposal_expire",R),this.events.once(b,({error:_,session:F})=>{this.client.events.off("proposal_expire",R),_?v(_):F&&S(F)}),await this.setProposal(x.id,x),await this.sendProposeSession({proposal:x,publishOpts:{internal:{throwOnFailedPublish:!0},tvf:{correlationId:x.id}}}).catch(_=>{throw this.deleteProposal(x.id),_}),{uri:g,approval:D}}),V(this,"pair",async t=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{return await this.client.core.pairing.pair(t)}catch(n){throw this.client.logger.error("pair() failed"),n}}),V(this,"approve",async t=>{var n,s,i;const o=this.client.core.eventClient.createEvent({properties:{topic:(n=t==null?void 0:t.id)==null?void 0:n.toString(),trace:[Er.session_approve_started]}});try{this.isInitialized(),await this.confirmOnlineStateOrThrow()}catch(F){throw o.setError(Hs.no_internet_connection),F}try{await this.isValidProposalId(t==null?void 0:t.id)}catch(F){throw this.client.logger.error(`approve() -> proposal.get(${t==null?void 0:t.id}) failed`),o.setError(Hs.proposal_not_found),F}try{await this.isValidApprove(t)}catch(F){throw this.client.logger.error("approve() -> isValidApprove() failed"),o.setError(Hs.session_approve_namespace_validation_failure),F}const{id:a,relayProtocol:c,namespaces:l,sessionProperties:u,scopedProperties:h,sessionConfig:f,proposalRequestsResponses:d}=t,p=this.client.proposal.get(a);this.client.core.eventClient.deleteEvent({eventId:o.eventId});const{pairingTopic:g,proposer:m,requiredNamespaces:E,optionalNamespaces:O}=p;let x=(s=this.client.core.eventClient)==null?void 0:s.getEvent({topic:g});x||(x=(i=this.client.core.eventClient)==null?void 0:i.createEvent({type:Er.session_approve_started,properties:{topic:g,trace:[Er.session_approve_started,Er.session_namespaces_validation_success]}}));const b=await this.client.core.crypto.generateKeyPair(),v=m.publicKey,S=await this.client.core.crypto.generateSharedKey(b,v),D=it(we(we(we({relay:{protocol:c??"irn"},namespaces:l,controller:{publicKey:b,metadata:this.client.metadata},expiry:He(to)},u&&{sessionProperties:u}),h&&{scopedProperties:h}),f&&{sessionConfig:f}),{proposalRequestsResponses:d}),R=Ce.relay;x.addTrace(Er.subscribing_session_topic);try{await this.client.core.relayer.subscribe(S,{transportType:R,internal:{skipSubscribe:!0}})}catch(F){throw x.setError(Hs.subscribe_session_topic_failure),F}x.addTrace(Er.subscribe_session_topic_success);const _=it(we({},D),{topic:S,requiredNamespaces:E,optionalNamespaces:O,pairingTopic:g,acknowledged:!1,self:D.controller,peer:{publicKey:m.publicKey,metadata:m.metadata},controller:b,transportType:Ce.relay,authentication:d==null?void 0:d.authentication,walletPayResult:d==null?void 0:d.walletPay});await this.client.session.set(S,_),x.addTrace(Er.store_session);try{await this.sendApproveSession({sessionTopic:S,proposal:p,pairingProposalResponse:{relay:{protocol:c??"irn"},responderPublicKey:b},sessionSettleRequest:D,publishOpts:{internal:{throwOnFailedPublish:!0},tvf:we({correlationId:a},this.getTVFApproveParams(_))}}),x.addTrace(Er.session_approve_publish_success)}catch(F){throw this.client.logger.error(F),this.client.session.delete(S,$e("USER_DISCONNECTED")),await this.client.core.relayer.unsubscribe(S),F}return this.client.core.eventClient.deleteEvent({eventId:x.eventId}),await this.client.core.pairing.updateMetadata({topic:g,metadata:m.metadata}),await this.deleteProposal(a),await this.client.core.pairing.activate({topic:g}),await this.setExpiry(S,He(to)),{topic:S,acknowledged:()=>Promise.resolve(this.client.session.get(S))}}),V(this,"reject",async t=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{await this.isValidReject(t)}catch(o){throw this.client.logger.error("reject() -> isValidReject() failed"),o}const{id:n,reason:s}=t;let i;try{i=this.client.proposal.get(n).pairingTopic}catch(o){throw this.client.logger.error(`reject() -> proposal.get(${n}) failed`),o}i&&await this.sendError({id:n,topic:i,error:s,rpcOpts:st.wc_sessionPropose.reject}),await this.deleteProposal(n)}),V(this,"update",async t=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{await this.isValidUpdate(t)}catch(h){throw this.client.logger.error("update() -> isValidUpdate() failed"),h}const{topic:n,namespaces:s}=t,{done:i,resolve:o,reject:a}=Js(G.FIVE_MINUTES,"Session update request expired without receiving any acknowledgement"),c=Vr(),l=Cs().toString(),u=this.client.session.get(n).namespaces;return this.events.once(ve("session_update",c),({error:h})=>{h?a(h):o()}),await this.client.session.update(n,{namespaces:s}),await this.sendRequest({topic:n,method:"wc_sessionUpdate",params:{namespaces:s},throwOnFailedPublish:!0,clientRpcId:c,relayRpcId:l}).catch(h=>{this.client.logger.error(h),this.client.session.update(n,{namespaces:u}),a(h)}),{acknowledged:i}}),V(this,"extend",async t=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{await this.isValidExtend(t)}catch(c){throw this.client.logger.error("extend() -> isValidExtend() failed"),c}const{topic:n}=t,s=Vr(),{done:i,resolve:o,reject:a}=Js(G.FIVE_MINUTES,"Session extend request expired without receiving any acknowledgement");return this.events.once(ve("session_extend",s),({error:c})=>{c?a(c):o()}),await this.setExpiry(n,He(to)),this.sendRequest({topic:n,method:"wc_sessionExtend",params:{},clientRpcId:s,throwOnFailedPublish:!0}).catch(c=>{a(c)}),{acknowledged:i}}),V(this,"request",async t=>{this.isInitialized();try{await this.isValidRequest(t)}catch(m){throw this.client.logger.error("request() -> isValidRequest() failed"),m}const{chainId:n,request:s,topic:i,expiry:o=st.wc_sessionRequest.req.ttl}=t,a=this.client.session.get(i);(a==null?void 0:a.transportType)===Ce.relay&&await this.confirmOnlineStateOrThrow();const c=Vr(),l=Cs().toString(),{done:u,resolve:h,reject:f}=Js(o,"Request expired. Please try again.");this.events.once(ve("session_request",c),({error:m,result:E})=>{m?f(m):h(E)});const d="wc_sessionRequest",p=this.getAppLinkIfEnabled(a.peer.metadata,a.transportType);if(p)return await this.sendRequest({clientRpcId:c,relayRpcId:l,topic:i,method:d,params:{request:it(we({},s),{expiryTimestamp:He(o)}),chainId:n},expiry:o,throwOnFailedPublish:!0,appLink:p}).catch(m=>f(m)),this.client.events.emit("session_request_sent",{topic:i,request:s,chainId:n,id:c}),await u();const g={request:it(we({},s),{expiryTimestamp:He(o)}),chainId:n};return await Promise.all([new Promise(async m=>{await this.sendRequest({clientRpcId:c,relayRpcId:l,topic:i,method:d,params:g,expiry:o,throwOnFailedPublish:!0,tvf:this.getTVFParams(c,g)}).catch(E=>f(E)),this.client.events.emit("session_request_sent",{topic:i,request:s,chainId:n,id:c}),m()}),new Promise(async m=>{var E;if(!((E=a.sessionConfig)!=null&&E.disableDeepLink)){const O=await _4(this.client.core.storage,wm);await S4({id:c,topic:i,wcDeepLink:O})}m()}),u()]).then(m=>m[2])}),V(this,"respond",async t=>{var n,s;this.isInitialized();const i=this.client.core.eventClient.createEvent({properties:{topic:(t==null?void 0:t.topic)||((s=(n=t==null?void 0:t.response)==null?void 0:n.id)==null?void 0:s.toString()),trace:[Er.session_request_response_started]}});try{await this.isValidRespond(t)}catch(h){throw i.addTrace(h==null?void 0:h.message),i.setError(Hs.session_request_response_validation_failure),h}i.addTrace(Er.session_request_response_validation_success);const{topic:o,response:a}=t,{id:c}=a,l=this.client.session.get(o);l.transportType===Ce.relay&&await this.confirmOnlineStateOrThrow();const u=this.getAppLinkIfEnabled(l.peer.metadata,l.transportType);try{i.addTrace(Er.session_request_response_publish_started),Kr(a)?await this.sendResult({id:c,topic:o,result:a.result,throwOnFailedPublish:!0,appLink:u}):mr(a)&&await this.sendError({id:c,topic:o,error:a.error,appLink:u}),this.cleanupAfterResponse(t)}catch(h){throw i.addTrace(h==null?void 0:h.message),i.setError(Hs.session_request_response_publish_failure),h}}),V(this,"ping",async t=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{await this.isValidPing(t)}catch(s){throw this.client.logger.error("ping() -> isValidPing() failed"),s}const{topic:n}=t;if(this.client.session.keys.includes(n)){const s=Vr(),i=Cs().toString(),{done:o,resolve:a,reject:c}=Js(G.FIVE_MINUTES,"Ping request expired without receiving any acknowledgement");this.events.once(ve("session_ping",s),({error:l})=>{l?c(l):a()}),await Promise.all([this.sendRequest({topic:n,method:"wc_sessionPing",params:{},throwOnFailedPublish:!0,clientRpcId:s,relayRpcId:i}),o()])}else this.client.core.pairing.pairings.keys.includes(n)&&(this.client.logger.warn("ping() on pairing topic is deprecated and will be removed in the next major release."),await this.client.core.pairing.ping({topic:n}))}),V(this,"emit",async t=>{this.isInitialized(),await this.confirmOnlineStateOrThrow(),await this.isValidEmit(t);const{topic:n,event:s,chainId:i}=t,o=Cs().toString(),a=Vr();await this.sendRequest({topic:n,method:"wc_sessionEvent",params:{event:s,chainId:i},throwOnFailedPublish:!0,relayRpcId:o,clientRpcId:a})}),V(this,"disconnect",async t=>{this.isInitialized(),await this.confirmOnlineStateOrThrow(),await this.isValidDisconnect(t);const{topic:n}=t;if(this.client.session.keys.includes(n))await this.sendRequest({topic:n,method:"wc_sessionDelete",params:$e("USER_DISCONNECTED"),throwOnFailedPublish:!0}),await this.deleteSession({topic:n,emitEvent:!1});else if(this.client.core.pairing.pairings.keys.includes(n))await this.client.core.pairing.disconnect({topic:n});else{const{message:s}=W("MISMATCHED_TOPIC",`Session or pairing topic not found: ${n}`);throw new Error(s)}}),V(this,"find",t=>(this.isInitialized(),this.client.session.getAll().filter(n=>G5(n,t)))),V(this,"getPendingSessionRequests",()=>this.client.pendingRequest.getAll()),V(this,"authenticate",async(t,n)=>{var s;this.isInitialized(),this.isValidAuthenticate(t);const i=n&&this.client.core.linkModeSupportedApps.includes(n)&&((s=this.client.metadata.redirect)==null?void 0:s.linkMode),o=i?Ce.link_mode:Ce.relay;o===Ce.relay&&await this.confirmOnlineStateOrThrow();const{chains:a,statement:c="",uri:l,domain:u,nonce:h,type:f,exp:d,nbf:p,methods:g=[],expiry:m}=t,E=[...t.resources||[]],{topic:O,uri:x}=await this.client.core.pairing.create({methods:["wc_sessionAuthenticate"],transportType:o});this.client.logger.info({message:"Generated new pairing",pairing:{topic:O,uri:x}});const b=await this.client.core.crypto.generateKeyPair(),v=Il(b);if(await Promise.all([this.client.auth.authKeys.set(Ol,{responseTopic:v,publicKey:b}),this.client.auth.pairingTopics.set(v,{topic:v,pairingTopic:O})]),await this.client.core.relayer.subscribe(v,{transportType:o}),this.client.logger.info(`sending request to new pairing topic: ${O}`),g.length>0){const{namespace:N}=El(a[0]);let T=HC(N,"request",g);Al(E)&&(T=QC(T,E.pop())),E.push(T)}const S=m&&m>st.wc_sessionAuthenticate.req.ttl?m:st.wc_sessionAuthenticate.req.ttl,D={authPayload:{type:f??"caip122",chains:a,statement:c,aud:l,domain:u,version:"1",nonce:h,iat:new Date().toISOString(),exp:d,nbf:p,resources:E},requester:{publicKey:b,metadata:this.client.metadata},expiryTimestamp:He(S)},R={eip155:{chains:a,methods:[...new Set(["personal_sign",...g])],events:["chainChanged","accountsChanged"]}},_={requiredNamespaces:{},optionalNamespaces:R,relays:[{protocol:"irn"}],pairingTopic:O,proposer:{publicKey:b,metadata:this.client.metadata},expiryTimestamp:He(st.wc_sessionPropose.req.ttl),id:Vr()},{done:F,resolve:j,reject:$}=Js(S,"Request expired"),C=Vr(),k=ve("session_connect",_.id),I=ve("session_request",C),A=async({error:N,session:T})=>{this.events.off(I,B),N?$(N):T&&j({session:T})},B=async N=>{var T,M,q;if(await this.deletePendingAuthRequest(C,{message:"fulfilled",code:0}),N.error){const te=$e("WC_METHOD_UNSUPPORTED","wc_sessionAuthenticate");return N.error.code===te.code?void 0:(this.events.off(k,A),$(N.error.message))}await this.deleteProposal(_.id),this.events.off(k,A);const{cacaos:Y,responder:J}=N.result,Q=[],re=[];for(const te of Y){await a0({cacao:te,projectId:this.client.core.projectId})||(this.client.logger.error(te,"Signature verification failed"),$($e("SESSION_SETTLEMENT_FAILED","Signature verification failed")));const{p:ue}=te,Ae=Al(ue.resources),Ne=[od(ue.iss)],Ue=Xl(ue.iss);if(Ae){const Pe=c0(Ae),Bt=l0(Ae);Q.push(...Pe),Ne.push(...Bt)}for(const Pe of Ne)re.push(`${Pe}:${Ue}`)}const ne=await this.client.core.crypto.generateSharedKey(b,J.publicKey);let ae;Q.length>0&&(ae={topic:ne,acknowledged:!0,self:{publicKey:b,metadata:this.client.metadata},peer:J,controller:J.publicKey,expiry:He(to),requiredNamespaces:{},optionalNamespaces:{},relay:{protocol:"irn"},pairingTopic:O,namespaces:k0([...new Set(Q)],[...new Set(re)]),transportType:o},await this.client.core.relayer.subscribe(ne,{transportType:o}),await this.client.session.set(ne,ae),O&&await this.client.core.pairing.updateMetadata({topic:O,metadata:J.metadata}),ae=this.client.session.get(ne)),(T=this.client.metadata.redirect)!=null&&T.linkMode&&(M=J.metadata.redirect)!=null&&M.linkMode&&(q=J.metadata.redirect)!=null&&q.universal&&n&&(this.client.core.addLinkModeSupportedApp(J.metadata.redirect.universal),this.client.session.update(ne,{transportType:Ce.link_mode})),j({auths:Y,session:ae})};this.events.once(k,A),this.events.once(I,B);let U;try{if(i){const N=_n("wc_sessionAuthenticate",D,C);this.client.core.history.set(O,N);const T=await this.client.core.crypto.encode("",N,{type:Rc,encoding:fs});U=cl(n,O,T)}else await Promise.all([this.sendRequest({topic:O,method:"wc_sessionAuthenticate",params:D,expiry:t.expiry,throwOnFailedPublish:!0,clientRpcId:C}),this.sendRequest({topic:O,method:"wc_sessionPropose",params:_,expiry:st.wc_sessionPropose.req.ttl,throwOnFailedPublish:!0,clientRpcId:_.id})])}catch(N){throw this.events.off(k,A),this.events.off(I,B),N}return await this.setProposal(_.id,_),await this.setAuthRequest(C,{request:it(we({},D),{verifyContext:{}}),pairingTopic:O,transportType:o}),{uri:U??x,response:F}}),V(this,"approveSessionAuthenticate",async t=>{const{id:n,auths:s}=t,i=this.client.core.eventClient.createEvent({properties:{topic:n.toString(),trace:[Gs.authenticated_session_approve_started]}});try{this.isInitialized()}catch(m){throw i.setError(va.no_internet_connection),m}const o=this.getPendingAuthRequest(n);if(!o)throw i.setError(va.authenticated_session_pending_request_not_found),new Error(`Could not find pending auth request with id ${n}`);const a=o.transportType||Ce.relay;a===Ce.relay&&await this.confirmOnlineStateOrThrow();const c=o.requester.publicKey,l=await this.client.core.crypto.generateKeyPair(),u=Il(c),h={type:zn,receiverPublicKey:c,senderPublicKey:l},f=[],d=[];for(const m of s){if(!await a0({cacao:m,projectId:this.client.core.projectId})){i.setError(va.invalid_cacao);const v=$e("SESSION_SETTLEMENT_FAILED","Signature verification failed");throw await this.sendError({id:n,topic:u,error:v,encodeOpts:h}),new Error(v.message)}i.addTrace(Gs.cacaos_verified);const{p:E}=m,O=Al(E.resources),x=[od(E.iss)],b=Xl(E.iss);if(O){const v=c0(O),S=l0(O);f.push(...v),x.push(...S)}for(const v of x)d.push(`${v}:${b}`)}const p=await this.client.core.crypto.generateSharedKey(l,c);i.addTrace(Gs.create_authenticated_session_topic);let g;if((f==null?void 0:f.length)>0){g={topic:p,acknowledged:!0,self:{publicKey:l,metadata:this.client.metadata},peer:{publicKey:c,metadata:o.requester.metadata},controller:c,expiry:He(to),authentication:s,requiredNamespaces:{},optionalNamespaces:{},relay:{protocol:"irn"},pairingTopic:o.pairingTopic,namespaces:k0([...new Set(f)],[...new Set(d)]),transportType:a},i.addTrace(Gs.subscribing_authenticated_session_topic);try{await this.client.core.relayer.subscribe(p,{transportType:a})}catch(m){throw i.setError(va.subscribe_authenticated_session_topic_failure),m}i.addTrace(Gs.subscribe_authenticated_session_topic_success),await this.client.session.set(p,g),i.addTrace(Gs.store_authenticated_session),await this.client.core.pairing.updateMetadata({topic:o.pairingTopic,metadata:o.requester.metadata})}i.addTrace(Gs.publishing_authenticated_session_approve);try{await this.sendResult({topic:u,id:n,result:{cacaos:s,responder:{publicKey:l,metadata:this.client.metadata}},encodeOpts:h,throwOnFailedPublish:!0,appLink:this.getAppLinkIfEnabled(o.requester.metadata,a)})}catch(m){throw i.setError(va.authenticated_session_approve_publish_failure),m}return await this.client.auth.requests.delete(n,{message:"fulfilled",code:0}),await this.client.core.pairing.activate({topic:o.pairingTopic}),this.client.core.eventClient.deleteEvent({eventId:i.eventId}),{session:g}}),V(this,"rejectSessionAuthenticate",async t=>{this.isInitialized();const{id:n,reason:s}=t,i=this.getPendingAuthRequest(n);if(!i)throw new Error(`Could not find pending auth request with id ${n}`);i.transportType===Ce.relay&&await this.confirmOnlineStateOrThrow();const o=i.requester.publicKey,a=await this.client.core.crypto.generateKeyPair(),c=Il(o),l={type:zn,receiverPublicKey:o,senderPublicKey:a};await this.sendError({id:n,topic:c,error:s,encodeOpts:l,rpcOpts:st.wc_sessionAuthenticate.reject,appLink:this.getAppLinkIfEnabled(i.requester.metadata,i.transportType)}),await this.client.auth.requests.delete(n,{message:"rejected",code:0}),await this.deleteProposal(n)}),V(this,"formatAuthMessage",t=>{this.isInitialized();const{request:n,iss:s}=t;return T1(n,s)}),V(this,"processRelayMessageCache",()=>{setTimeout(async()=>{if(this.relayMessageCache.length!==0)for(;this.relayMessageCache.length>0;)try{const t=this.relayMessageCache.shift();t&&await this.onRelayMessage(t)}catch(t){this.client.logger.error(t)}},50)}),V(this,"cleanupDuplicatePairings",async t=>{if(t.pairingTopic)try{const n=this.client.core.pairing.pairings.get(t.pairingTopic),s=this.client.core.pairing.pairings.getAll().filter(i=>{var o,a;return((o=i.peerMetadata)==null?void 0:o.url)&&((a=i.peerMetadata)==null?void 0:a.url)===t.peer.metadata.url&&i.topic&&i.topic!==n.topic});if(s.length===0)return;this.client.logger.info(`Cleaning up ${s.length} duplicate pairing(s)`),await Promise.all(s.map(i=>this.client.core.pairing.disconnect({topic:i.topic}))),this.client.logger.info("Duplicate pairings clean up finished")}catch(n){this.client.logger.error(n)}}),V(this,"deleteSession",async t=>{var n;const{topic:s,expirerHasDeleted:i=!1,emitEvent:o=!0,id:a=0}=t,{self:c}=this.client.session.get(s);await this.client.core.relayer.unsubscribe(s),await this.client.session.delete(s,$e("USER_DISCONNECTED")),this.addToRecentlyDeleted(s,"session"),this.client.core.crypto.keychain.has(c.publicKey)&&await this.client.core.crypto.deleteKeyPair(c.publicKey),this.client.core.crypto.keychain.has(s)&&await this.client.core.crypto.deleteSymKey(s),i||this.client.core.expirer.del(s),this.client.core.storage.removeItem(wm).catch(l=>this.client.logger.warn(l)),s===((n=this.sessionRequestQueue.queue[0])==null?void 0:n.topic)&&(this.sessionRequestQueue.state=zr.idle),await Promise.all(this.getPendingSessionRequests().filter(l=>l.topic===s).map(l=>this.deletePendingSessionRequest(l.id,$e("USER_DISCONNECTED")))),o&&this.client.events.emit("session_delete",{id:a,topic:s})}),V(this,"deleteProposal",async(t,n)=>{if(n)try{const s=this.client.proposal.get(t),i=this.client.core.eventClient.getEvent({topic:s.pairingTopic});i==null||i.setError(Hs.proposal_expired)}catch{}await Promise.all([this.client.proposal.delete(t,$e("USER_DISCONNECTED")),n?Promise.resolve():this.client.core.expirer.del(t)]),this.addToRecentlyDeleted(t,"proposal")}),V(this,"deletePendingSessionRequest",async(t,n,s=!1)=>{await Promise.all([this.client.pendingRequest.delete(t,n),s?Promise.resolve():this.client.core.expirer.del(t)]),this.addToRecentlyDeleted(t,"request"),this.sessionRequestQueue.queue=this.sessionRequestQueue.queue.filter(i=>i.id!==t),s&&(this.sessionRequestQueue.state=zr.idle,this.client.events.emit("session_request_expire",{id:t}))}),V(this,"deletePendingAuthRequest",async(t,n,s=!1)=>{await Promise.all([this.client.auth.requests.delete(t,n),s?Promise.resolve():this.client.core.expirer.del(t)])}),V(this,"setExpiry",async(t,n)=>{this.client.session.keys.includes(t)&&(this.client.core.expirer.set(t,n),await this.client.session.update(t,{expiry:n}))}),V(this,"setProposal",async(t,n)=>{this.client.core.expirer.set(t,He(st.wc_sessionPropose.req.ttl)),await this.client.proposal.set(t,n)}),V(this,"setAuthRequest",async(t,n)=>{const{request:s,pairingTopic:i,transportType:o=Ce.relay}=n;this.client.core.expirer.set(t,s.expiryTimestamp),await this.client.auth.requests.set(t,{authPayload:s.authPayload,requester:s.requester,expiryTimestamp:s.expiryTimestamp,id:t,pairingTopic:i,verifyContext:s.verifyContext,transportType:o})}),V(this,"setPendingSessionRequest",async t=>{const{id:n,topic:s,params:i,verifyContext:o}=t,a=i.request.expiryTimestamp||He(st.wc_sessionRequest.req.ttl);this.client.core.expirer.set(n,a),await this.client.pendingRequest.set(n,{id:n,topic:s,params:i,verifyContext:o})}),V(this,"sendRequest",async t=>{const{topic:n,method:s,params:i,expiry:o,relayRpcId:a,clientRpcId:c,throwOnFailedPublish:l,appLink:u,tvf:h,publishOpts:f={}}=t,d=_n(s,i,c);let p;const g=!!u;try{const O=g?fs:jt;p=await this.client.core.crypto.encode(n,d,{encoding:O})}catch(O){throw await this.cleanup(),this.client.logger.error(`sendRequest() -> core.crypto.encode() for topic ${n} failed`),O}let m;if(hU.includes(s)){const O=yr(JSON.stringify(d)),x=yr(p);m=await this.client.core.verify.register({id:x,decryptedId:O})}const E=we(we({},st[s].req),f);if(E.attestation=m,o&&(E.ttl=o),a&&(E.id=a),this.client.core.history.set(n,d),g){const O=cl(u,n,p);await global.Linking.openURL(O,this.client.name)}else E.tvf=it(we({},h),{correlationId:d.id}),l?(E.internal=it(we({},E.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish(n,p,E)):this.client.core.relayer.publish(n,p,E).catch(O=>this.client.logger.error(O));return d.id}),V(this,"sendProposeSession",async t=>{const{proposal:n,publishOpts:s}=t,i=_n("wc_sessionPropose",n,n.id);this.client.core.history.set(n.pairingTopic,i);const o=await this.client.core.crypto.encode(n.pairingTopic,i,{encoding:jt}),a=yr(JSON.stringify(i)),c=yr(o),l=await this.client.core.verify.register({id:c,decryptedId:a});await this.client.core.relayer.publishCustom({payload:{pairingTopic:n.pairingTopic,sessionProposal:o},opts:it(we({},s),{publishMethod:"wc_proposeSession",attestation:l})})}),V(this,"sendApproveSession",async t=>{const{sessionTopic:n,pairingProposalResponse:s,proposal:i,sessionSettleRequest:o,publishOpts:a}=t,c=iu(i.id,s),l=await this.client.core.crypto.encode(i.pairingTopic,c,{encoding:jt}),u=_n("wc_sessionSettle",o,a==null?void 0:a.id),h=await this.client.core.crypto.encode(n,u,{encoding:jt});this.client.core.history.set(n,u),await this.client.core.relayer.publishCustom({payload:{sessionTopic:n,pairingTopic:i.pairingTopic,sessionProposalResponse:l,sessionSettlementRequest:h},opts:it(we({},a),{publishMethod:"wc_approveSession"})})}),V(this,"sendResult",async t=>{const{id:n,topic:s,result:i,throwOnFailedPublish:o,encodeOpts:a,appLink:c}=t,l=iu(n,i);let u;const h=c&&typeof(global==null?void 0:global.Linking)<"u";try{const p=h?fs:jt;u=await this.client.core.crypto.encode(s,l,it(we({},a||{}),{encoding:p}))}catch(p){throw await this.cleanup(),this.client.logger.error(`sendResult() -> core.crypto.encode() for topic ${s} failed`),p}let f,d;try{f=await this.client.core.history.get(s,n);const p=f.request;try{d=this.getTVFParams(n,p.params,i)}catch(g){this.client.logger.warn(`sendResult() -> getTVFParams() failed: ${g==null?void 0:g.message}`)}}catch(p){throw this.client.logger.error(`sendResult() -> history.get(${s}, ${n}) failed`),p}if(h){const p=cl(c,s,u);await global.Linking.openURL(p,this.client.name)}else{const p=f.request.method,g=st[p].res;g.tvf=it(we({},d),{correlationId:n}),o?(g.internal=it(we({},g.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish(s,u,g)):this.client.core.relayer.publish(s,u,g).catch(m=>this.client.logger.error(m))}await this.client.core.history.resolve(l)}),V(this,"sendError",async t=>{const{id:n,topic:s,error:i,encodeOpts:o,rpcOpts:a,appLink:c}=t,l=Sp(n,i);let u;const h=c&&typeof(global==null?void 0:global.Linking)<"u";try{const d=h?fs:jt;u=await this.client.core.crypto.encode(s,l,it(we({},o||{}),{encoding:d}))}catch(d){throw await this.cleanup(),this.client.logger.error(`sendError() -> core.crypto.encode() for topic ${s} failed`),d}let f;try{f=await this.client.core.history.get(s,n)}catch(d){throw this.client.logger.error(`sendError() -> history.get(${s}, ${n}) failed`),d}if(h){const d=cl(c,s,u);await global.Linking.openURL(d,this.client.name)}else{const d=f.request.method,p=a||st[d].res;this.client.core.relayer.publish(s,u,p)}await this.client.core.history.resolve(l)}),V(this,"cleanup",async()=>{const t=[],n=[];this.client.session.getAll().forEach(s=>{let i=!1;is(s.expiry)&&(i=!0),this.client.core.crypto.keychain.has(s.topic)||(i=!0),i&&t.push(s.topic)}),this.client.proposal.getAll().forEach(s=>{is(s.expiryTimestamp)&&n.push(s.id)}),await Promise.all([...t.map(s=>this.deleteSession({topic:s})),...n.map(s=>this.deleteProposal(s))])}),V(this,"onProviderMessageEvent",async t=>{!this.initialized||this.relayMessageCache.length>0?this.relayMessageCache.push(t):await this.onRelayMessage(t)}),V(this,"onRelayEventRequest",async t=>{this.requestQueue.queue.push(t),await this.processRequestsQueue()}),V(this,"processRequestsQueue",async()=>{if(this.requestQueue.state===zr.active){this.client.logger.info("Request queue already active, skipping...");return}for(this.client.logger.info(`Request queue starting with ${this.requestQueue.queue.length} requests`);this.requestQueue.queue.length>0;){this.requestQueue.state=zr.active;const t=this.requestQueue.queue.shift();if(t)try{await this.processRequest(t)}catch(n){this.client.logger.warn(n)}}this.requestQueue.state=zr.idle}),V(this,"processRequest",async t=>{const{topic:n,payload:s,attestation:i,transportType:o,encryptedId:a}=t,c=s.method;if(!this.shouldIgnorePairingRequest({topic:n,requestMethod:c}))switch(c){case"wc_sessionPropose":return await this.onSessionProposeRequest({topic:n,payload:s,attestation:i,encryptedId:a});case"wc_sessionSettle":return await this.onSessionSettleRequest(n,s);case"wc_sessionUpdate":return await this.onSessionUpdateRequest(n,s);case"wc_sessionExtend":return await this.onSessionExtendRequest(n,s);case"wc_sessionPing":return await this.onSessionPingRequest(n,s);case"wc_sessionDelete":return await this.onSessionDeleteRequest(n,s);case"wc_sessionRequest":return await this.onSessionRequest({topic:n,payload:s,attestation:i,encryptedId:a,transportType:o});case"wc_sessionEvent":return await this.onSessionEventRequest(n,s);case"wc_sessionAuthenticate":return await this.onSessionAuthenticateRequest({topic:n,payload:s,attestation:i,encryptedId:a,transportType:o});default:return this.client.logger.info(`Unsupported request method ${c}`)}}),V(this,"onRelayEventResponse",async t=>{const{topic:n,payload:s,transportType:i}=t,o=(await this.client.core.history.get(n,s.id)).request.method;switch(o){case"wc_sessionPropose":return this.onSessionProposeResponse(n,s,i);case"wc_sessionSettle":return this.onSessionSettleResponse(n,s);case"wc_sessionUpdate":return this.onSessionUpdateResponse(n,s);case"wc_sessionExtend":return this.onSessionExtendResponse(n,s);case"wc_sessionPing":return this.onSessionPingResponse(n,s);case"wc_sessionRequest":return this.onSessionRequestResponse(n,s);case"wc_sessionAuthenticate":return this.onSessionAuthenticateResponse(n,s);default:return this.client.logger.info(`Unsupported response method ${o}`)}}),V(this,"onRelayEventUnknownPayload",t=>{const{topic:n}=t,{message:s}=W("MISSING_OR_INVALID",`Decoded payload on topic ${n} is not identifiable as a JSON-RPC request or a response.`);throw new Error(s)}),V(this,"shouldIgnorePairingRequest",t=>{const{topic:n,requestMethod:s}=t,i=this.expectedPairingMethodMap.get(n);return!i||i.includes(s)?!1:!!(i.includes("wc_sessionAuthenticate")&&this.client.events.listenerCount("session_authenticate")>0)}),V(this,"onSessionProposeRequest",async t=>{const{topic:n,payload:s,attestation:i,encryptedId:o}=t,{params:a,id:c}=s;try{const l=this.client.core.eventClient.getEvent({topic:n});this.client.events.listenerCount("session_proposal")===0&&(console.warn("No listener for session_proposal event"),l==null||l.setError(vn.proposal_listener_not_found)),this.isValidConnect(we({},s.params));const u=a.expiryTimestamp||He(st.wc_sessionPropose.req.ttl),h=we({id:c,pairingTopic:n,expiryTimestamp:u,attestation:i,encryptedId:o},a);await this.setProposal(c,h);const f=await this.getVerifyContext({attestationId:i,hash:yr(JSON.stringify(s)),encryptedId:o,metadata:h.proposer.metadata});l==null||l.addTrace(qr.emit_session_proposal),this.client.events.emit("session_proposal",{id:c,params:h,verifyContext:f})}catch(l){await this.sendError({id:c,topic:n,error:l,rpcOpts:st.wc_sessionPropose.autoReject}),this.client.logger.error(l)}}),V(this,"onSessionProposeResponse",async(t,n,s)=>{const{id:i}=n;if(Kr(n)){const{result:o}=n;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",result:o});const a=this.client.proposal.get(i);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",proposal:a});const c=a.proposer.publicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",selfPublicKey:c});const l=o.responderPublicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",peerPublicKey:l});const u=await this.client.core.crypto.generateSharedKey(c,l);this.pendingSessions.set(i,{sessionTopic:u,pairingTopic:t,proposalId:i,publicKey:c});const h=await this.client.core.relayer.subscribe(u,{transportType:s});this.client.logger.trace({type:"method",method:"onSessionProposeResponse",subscriptionId:h}),await this.client.core.pairing.activate({topic:t})}else if(mr(n)){await this.deleteProposal(i);const o=ve("session_connect",i);if(this.events.listenerCount(o)===0)throw new Error(`emitting ${o} without any listeners, 954`);this.events.emit(o,{error:n.error})}}),V(this,"onSessionSettleRequest",async(t,n)=>{const{id:s,params:i}=n;try{this.isValidSessionSettleRequest(i);const{relay:o,controller:a,expiry:c,namespaces:l,sessionProperties:u,scopedProperties:h,sessionConfig:f,proposalRequestsResponses:d}=n.params,p=[...this.pendingSessions.values()].find(E=>E.sessionTopic===t);if(!p)return this.client.logger.error(`Pending session not found for topic ${t}`);const g=this.client.proposal.get(p.proposalId),m=it(we(we(we({topic:t,relay:o,expiry:c,namespaces:l,acknowledged:!0,pairingTopic:p.pairingTopic,requiredNamespaces:g.requiredNamespaces,optionalNamespaces:g.optionalNamespaces,controller:a.publicKey,self:{publicKey:p.publicKey,metadata:this.client.metadata},peer:{publicKey:a.publicKey,metadata:a.metadata}},u&&{sessionProperties:u}),h&&{scopedProperties:h}),f&&{sessionConfig:f}),{transportType:Ce.relay,authentication:d==null?void 0:d.authentication,walletPayResult:d==null?void 0:d.walletPay});await this.client.session.set(m.topic,m),await this.setExpiry(m.topic,m.expiry),await this.client.core.pairing.updateMetadata({topic:p.pairingTopic,metadata:m.peer.metadata}),this.pendingSessions.delete(p.proposalId),this.deleteProposal(p.proposalId,!1),this.cleanupDuplicatePairings(m),await this.sendResult({id:n.id,topic:t,throwOnFailedPublish:!0,result:!0}),this.client.events.emit("session_connect",{session:m}),this.events.emit(ve("session_connect",p.proposalId),{session:m})}catch(o){await this.sendError({id:s,topic:t,error:o}),this.client.logger.error(o)}}),V(this,"onSessionSettleResponse",async(t,n)=>{const{id:s}=n;Kr(n)?(await this.client.session.update(t,{acknowledged:!0}),this.events.emit(ve("session_approve",s),{})):mr(n)&&(await this.client.session.delete(t,$e("USER_DISCONNECTED")),this.events.emit(ve("session_approve",s),{error:n.error}))}),V(this,"onSessionUpdateRequest",async(t,n)=>{const{params:s,id:i}=n;try{const o=`${t}_session_update`,a=ba.get(o);if(a&&this.isRequestOutOfSync(a,i)){this.client.logger.warn(`Discarding out of sync request - ${i}`),this.sendError({id:i,topic:t,error:$e("INVALID_UPDATE_REQUEST")});return}this.isValidUpdate(we({topic:t},s));try{ba.set(o,i),await this.client.session.update(t,{namespaces:s.namespaces}),await this.sendResult({id:i,topic:t,result:!0})}catch(c){throw ba.delete(o),c}this.client.events.emit("session_update",{id:i,topic:t,params:s})}catch(o){await this.sendError({id:i,topic:t,error:o}),this.client.logger.error(o)}}),V(this,"isRequestOutOfSync",(t,n)=>n.toString().slice(0,-3)<t.toString().slice(0,-3)),V(this,"onSessionUpdateResponse",(t,n)=>{const{id:s}=n,i=ve("session_update",s);if(this.events.listenerCount(i)===0)throw new Error(`emitting ${i} without any listeners`);Kr(n)?this.events.emit(ve("session_update",s),{}):mr(n)&&this.events.emit(ve("session_update",s),{error:n.error})}),V(this,"onSessionExtendRequest",async(t,n)=>{const{id:s}=n;try{this.isValidExtend({topic:t}),await this.setExpiry(t,He(to)),await this.sendResult({id:s,topic:t,result:!0}),this.client.events.emit("session_extend",{id:s,topic:t})}catch(i){await this.sendError({id:s,topic:t,error:i}),this.client.logger.error(i)}}),V(this,"onSessionExtendResponse",(t,n)=>{const{id:s}=n,i=ve("session_extend",s);if(this.events.listenerCount(i)===0)throw new Error(`emitting ${i} without any listeners`);Kr(n)?this.events.emit(ve("session_extend",s),{}):mr(n)&&this.events.emit(ve("session_extend",s),{error:n.error})}),V(this,"onSessionPingRequest",async(t,n)=>{const{id:s}=n;try{this.isValidPing({topic:t}),await this.sendResult({id:s,topic:t,result:!0,throwOnFailedPublish:!0}),this.client.events.emit("session_ping",{id:s,topic:t})}catch(i){await this.sendError({id:s,topic:t,error:i}),this.client.logger.error(i)}}),V(this,"onSessionPingResponse",(t,n)=>{const{id:s}=n,i=ve("session_ping",s);setTimeout(()=>{if(this.events.listenerCount(i)===0)throw new Error(`emitting ${i} without any listeners 2176`);Kr(n)?this.events.emit(ve("session_ping",s),{}):mr(n)&&this.events.emit(ve("session_ping",s),{error:n.error})},500)}),V(this,"onSessionDeleteRequest",async(t,n)=>{const{id:s}=n;try{await this.isValidDisconnect({topic:t,reason:n.params}),this.cleanupPendingSentRequestsForTopic({topic:t,error:$e("USER_DISCONNECTED")}),await this.deleteSession({topic:t,id:s})}catch(i){this.client.logger.error(i)}}),V(this,"onSessionRequest",async t=>{var n,s,i;const{topic:o,payload:a,attestation:c,encryptedId:l,transportType:u}=t,{id:h,params:f}=a;try{await this.isValidRequest(we({topic:o},f));const d=this.client.session.get(o),p=await this.getVerifyContext({attestationId:c,hash:yr(JSON.stringify(_n("wc_sessionRequest",f,h))),encryptedId:l,metadata:d.peer.metadata,transportType:u}),g={id:h,topic:o,params:f,verifyContext:p};await this.setPendingSessionRequest(g),u===Ce.link_mode&&(n=d.peer.metadata.redirect)!=null&&n.universal&&this.client.core.addLinkModeSupportedApp((s=d.peer.metadata.redirect)==null?void 0:s.universal),(i=this.client.signConfig)!=null&&i.disableRequestQueue?this.emitSessionRequest(g):(this.addSessionRequestToSessionRequestQueue(g),this.processSessionRequestQueue())}catch(d){await this.sendError({id:h,topic:o,error:d}),this.client.logger.error(d)}}),V(this,"onSessionRequestResponse",(t,n)=>{const{id:s}=n,i=ve("session_request",s);if(this.events.listenerCount(i)===0)throw new Error(`emitting ${i} without any listeners`);Kr(n)?this.events.emit(ve("session_request",s),{result:n.result}):mr(n)&&this.events.emit(ve("session_request",s),{error:n.error})}),V(this,"onSessionEventRequest",async(t,n)=>{const{id:s,params:i}=n;try{const o=`${t}_session_event_${i.event.name}`,a=ba.get(o);if(a&&this.isRequestOutOfSync(a,s)){this.client.logger.info(`Discarding out of sync request - ${s}`);return}this.isValidEmit(we({topic:t},i)),this.client.events.emit("session_event",{id:s,topic:t,params:i}),ba.set(o,s)}catch(o){await this.sendError({id:s,topic:t,error:o}),this.client.logger.error(o)}}),V(this,"onSessionAuthenticateResponse",(t,n)=>{const{id:s}=n;this.client.logger.trace({type:"method",method:"onSessionAuthenticateResponse",topic:t,payload:n}),Kr(n)?this.events.emit(ve("session_request",s),{result:n.result}):mr(n)&&this.events.emit(ve("session_request",s),{error:n.error})}),V(this,"onSessionAuthenticateRequest",async t=>{var n;const{topic:s,payload:i,attestation:o,encryptedId:a,transportType:c}=t;try{const{requester:l,authPayload:u,expiryTimestamp:h}=i.params,f=await this.getVerifyContext({attestationId:o,hash:yr(JSON.stringify(i)),encryptedId:a,metadata:l.metadata,transportType:c}),d={requester:l,pairingTopic:s,id:i.id,authPayload:u,verifyContext:f,expiryTimestamp:h};await this.setAuthRequest(i.id,{request:d,pairingTopic:s,transportType:c}),c===Ce.link_mode&&(n=l.metadata.redirect)!=null&&n.universal&&this.client.core.addLinkModeSupportedApp(l.metadata.redirect.universal),this.client.events.emit("session_authenticate",{topic:s,params:i.params,id:i.id,verifyContext:f})}catch(l){this.client.logger.error(l);const u=i.params.requester.publicKey,h=await this.client.core.crypto.generateKeyPair(),f=this.getAppLinkIfEnabled(i.params.requester.metadata,c),d={type:zn,receiverPublicKey:u,senderPublicKey:h};await this.sendError({id:i.id,topic:s,error:l,encodeOpts:d,rpcOpts:st.wc_sessionAuthenticate.autoReject,appLink:f})}}),V(this,"addSessionRequestToSessionRequestQueue",t=>{this.sessionRequestQueue.queue.push(t)}),V(this,"cleanupAfterResponse",t=>{this.deletePendingSessionRequest(t.response.id,{message:"fulfilled",code:0}),setTimeout(()=>{this.sessionRequestQueue.state=zr.idle,this.processSessionRequestQueue()},G.toMiliseconds(this.requestQueueDelay))}),V(this,"cleanupPendingSentRequestsForTopic",({topic:t,error:n})=>{const s=this.client.core.history.pending;s.length>0&&s.filter(i=>i.topic===t&&i.request.method==="wc_sessionRequest").forEach(i=>{this.events.emit(ve("session_request",i.request.id),{error:n})})}),V(this,"processSessionRequestQueue",()=>{if(this.sessionRequestQueue.state===zr.active){this.client.logger.info("session request queue is already active.");return}const t=this.sessionRequestQueue.queue[0];if(!t){this.client.logger.info("session request queue is empty.");return}try{this.emitSessionRequest(t)}catch(n){this.client.logger.error(n)}}),V(this,"emitSessionRequest",t=>{if(this.emittedSessionRequests.has(t.id)){this.client.logger.warn({id:t.id},`Skipping emitting \`session_request\` event for duplicate request. id: ${t.id}`);return}this.sessionRequestQueue.state=zr.active,this.emittedSessionRequests.add(t.id),this.client.events.emit("session_request",t)}),V(this,"onPairingCreated",t=>{if(t.methods&&this.expectedPairingMethodMap.set(t.topic,t.methods),t.active)return;const n=this.client.proposal.getAll().find(s=>s.pairingTopic===t.topic);n&&this.onSessionProposeRequest({topic:t.topic,payload:_n("wc_sessionPropose",it(we({},n),{requiredNamespaces:n.requiredNamespaces,optionalNamespaces:n.optionalNamespaces,relays:n.relays,proposer:n.proposer,sessionProperties:n.sessionProperties,scopedProperties:n.scopedProperties}),n.id),attestation:n.attestation,encryptedId:n.encryptedId})}),V(this,"isValidConnect",async t=>{if(!kt(t)){const{message:l}=W("MISSING_OR_INVALID",`connect() params: ${JSON.stringify(t)}`);throw new Error(l)}const{pairingTopic:n,requiredNamespaces:s,optionalNamespaces:i,sessionProperties:o,scopedProperties:a,relays:c}=t;if(et(n)||await this.isValidPairingTopic(n),!i6(c)){const{message:l}=W("MISSING_OR_INVALID",`connect() relays: ${c}`);throw new Error(l)}if(s&&!et(s)&&oc(s)!==0){const l="requiredNamespaces are deprecated and are automatically assigned to optionalNamespaces";["fatal","error","silent"].includes(this.client.logger.level)?console.warn(l):this.client.logger.warn(l),this.validateNamespaces(s,"requiredNamespaces")}if(i&&!et(i)&&oc(i)!==0&&this.validateNamespaces(i,"optionalNamespaces"),o&&!et(o)&&this.validateSessionProps(o,"sessionProperties"),a&&!et(a)){this.validateSessionProps(a,"scopedProperties");const l=Object.keys(s||{}).concat(Object.keys(i||{}));if(!Object.keys(a).every(u=>l.includes(u.split(":")[0])))throw new Error(`Scoped properties must be a subset of required/optional namespaces, received: ${JSON.stringify(a)}, required/optional namespaces: ${JSON.stringify(l)}`)}}),V(this,"validateNamespaces",(t,n)=>{const s=s6(t,"connect()",n);if(s)throw new Error(s.message)}),V(this,"isValidApprove",async t=>{if(!kt(t))throw new Error(W("MISSING_OR_INVALID",`approve() params: ${t}`).message);const{id:n,namespaces:s,relayProtocol:i,sessionProperties:o,scopedProperties:a}=t;this.checkRecentlyDeleted(n),await this.isValidProposalId(n);const c=this.client.proposal.get(n),l=Hh(s,"approve()");if(l)throw new Error(l.message);const u=F0(c.requiredNamespaces,s,"approve()");if(u)throw new Error(u.message);if(!Ve(i,!0)){const{message:h}=W("MISSING_OR_INVALID",`approve() relayProtocol: ${i}`);throw new Error(h)}if(o&&!et(o)&&this.validateSessionProps(o,"sessionProperties"),a&&!et(a)){this.validateSessionProps(a,"scopedProperties");const h=new Set(Object.keys(s));if(!Object.keys(a).every(f=>h.has(f.split(":")[0])))throw new Error(`Scoped properties must be a subset of approved namespaces, received: ${JSON.stringify(a)}, approved namespaces: ${Array.from(h).join(", ")}`)}}),V(this,"isValidReject",async t=>{if(!kt(t)){const{message:i}=W("MISSING_OR_INVALID",`reject() params: ${t}`);throw new Error(i)}const{id:n,reason:s}=t;if(this.checkRecentlyDeleted(n),await this.isValidProposalId(n),!a6(s)){const{message:i}=W("MISSING_OR_INVALID",`reject() reason: ${JSON.stringify(s)}`);throw new Error(i)}}),V(this,"isValidSessionSettleRequest",t=>{if(!kt(t)){const{message:l}=W("MISSING_OR_INVALID",`onSessionSettleRequest() params: ${t}`);throw new Error(l)}const{relay:n,controller:s,namespaces:i,expiry:o}=t;if(!bx(n)){const{message:l}=W("MISSING_OR_INVALID","onSessionSettleRequest() relay protocol should be a string");throw new Error(l)}const a=Z5(s,"onSessionSettleRequest()");if(a)throw new Error(a.message);const c=Hh(i,"onSessionSettleRequest()");if(c)throw new Error(c.message);if(is(o)){const{message:l}=W("EXPIRED","onSessionSettleRequest()");throw new Error(l)}}),V(this,"isValidUpdate",async t=>{if(!kt(t)){const{message:c}=W("MISSING_OR_INVALID",`update() params: ${t}`);throw new Error(c)}const{topic:n,namespaces:s}=t;this.checkRecentlyDeleted(n),await this.isValidSessionTopic(n);const i=this.client.session.get(n),o=Hh(s,"update()");if(o)throw new Error(o.message);const a=F0(i.requiredNamespaces,s,"update()");if(a)throw new Error(a.message)}),V(this,"isValidExtend",async t=>{if(!kt(t)){const{message:s}=W("MISSING_OR_INVALID",`extend() params: ${t}`);throw new Error(s)}const{topic:n}=t;this.checkRecentlyDeleted(n),await this.isValidSessionTopic(n)}),V(this,"isValidRequest",async t=>{if(!kt(t)){const{message:c}=W("MISSING_OR_INVALID",`request() params: ${t}`);throw new Error(c)}const{topic:n,request:s,chainId:i,expiry:o}=t;this.checkRecentlyDeleted(n),await this.isValidSessionTopic(n);const{namespaces:a}=this.client.session.get(n);if(!$0(a,i)){const{message:c}=W("MISSING_OR_INVALID",`request() chainId: ${i}`);throw new Error(c)}if(!c6(s)){const{message:c}=W("MISSING_OR_INVALID",`request() ${JSON.stringify(s)}`);throw new Error(c)}if(!h6(a,i,s.method)){const{message:c}=W("MISSING_OR_INVALID",`request() method: ${s.method}`);throw new Error(c)}this.validateRequestExpiry(o)}),V(this,"isValidRespond",async t=>{var n;if(!kt(t)){const{message:a}=W("MISSING_OR_INVALID",`respond() params: ${t}`);throw new Error(a)}const{topic:s,response:i}=t;try{await this.isValidSessionTopic(s)}catch(a){throw(n=t==null?void 0:t.response)!=null&&n.id&&this.cleanupAfterResponse(t),a}if(!l6(i)){const{message:a}=W("MISSING_OR_INVALID",`respond() response: ${JSON.stringify(i)}`);throw new Error(a)}const o=this.client.pendingRequest.get(i.id);if(o.topic!==s){const{message:a}=W("MISMATCHED_TOPIC",`Request response topic mismatch. reqId: ${i.id}, expected topic: ${o.topic}, received topic: ${s}`);throw new Error(a)}}),V(this,"isValidPing",async t=>{if(!kt(t)){const{message:s}=W("MISSING_OR_INVALID",`ping() params: ${t}`);throw new Error(s)}const{topic:n}=t;await this.isValidSessionOrPairingTopic(n)}),V(this,"isValidEmit",async t=>{if(!kt(t)){const{message:a}=W("MISSING_OR_INVALID",`emit() params: ${t}`);throw new Error(a)}const{topic:n,event:s,chainId:i}=t;await this.isValidSessionTopic(n);const{namespaces:o}=this.client.session.get(n);if(!$0(o,i)){const{message:a}=W("MISSING_OR_INVALID",`emit() chainId: ${i}`);throw new Error(a)}if(!u6(s)){const{message:a}=W("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(s)}`);throw new Error(a)}if(!f6(o,i,s.name)){const{message:a}=W("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(s)}`);throw new Error(a)}}),V(this,"isValidDisconnect",async t=>{if(!kt(t)){const{message:s}=W("MISSING_OR_INVALID",`disconnect() params: ${t}`);throw new Error(s)}const{topic:n}=t;await this.isValidSessionOrPairingTopic(n)}),V(this,"isValidAuthenticate",t=>{const{chains:n,uri:s,domain:i,nonce:o}=t;if(!Array.isArray(n)||n.length===0)throw new Error("chains is required and must be a non-empty array");if(!Ve(s,!1))throw new Error("uri is required parameter");if(!Ve(i,!1))throw new Error("domain is required parameter");if(!Ve(o,!1))throw new Error("nonce is required parameter");if([...new Set(n.map(c=>El(c).namespace))].length>1)throw new Error("Multi-namespace requests are not supported. Please request single namespace only.");const{namespace:a}=El(n[0]);if(a!=="eip155")throw new Error("Only eip155 namespace is supported for authenticated sessions. Please use .connect() for non-eip155 chains.")}),V(this,"getVerifyContext",async t=>{const{attestationId:n,hash:s,encryptedId:i,metadata:o,transportType:a}=t,c={verified:{verifyUrl:o.verifyUrl||La,validation:"UNKNOWN",origin:o.url||""}};try{if(a===Ce.link_mode){const u=this.getAppLinkIfEnabled(o,a);return c.verified.validation=u&&new URL(u).origin===new URL(o.url).origin?"VALID":"INVALID",c}const l=await this.client.core.verify.resolve({attestationId:n,hash:s,encryptedId:i,verifyUrl:o.verifyUrl});l&&(c.verified.origin=l.origin,c.verified.isScam=l.isScam,c.verified.validation=l.origin===new URL(o.url).origin?"VALID":"INVALID")}catch(l){this.client.logger.warn(l)}return this.client.logger.debug(`Verify context: ${JSON.stringify(c)}`),c}),V(this,"validateSessionProps",(t,n)=>{Object.values(t).forEach((s,i)=>{if(s==null){const{message:o}=W("MISSING_OR_INVALID",`${n} must contain an existing value for each key. Received: ${s} for key ${Object.keys(t)[i]}`);throw new Error(o)}})}),V(this,"getPendingAuthRequest",t=>{const n=this.client.auth.requests.get(t);return typeof n=="object"?n:void 0}),V(this,"addToRecentlyDeleted",(t,n)=>{if(this.recentlyDeletedMap.set(t,n),this.recentlyDeletedMap.size>=this.recentlyDeletedLimit){let s=0;const i=this.recentlyDeletedLimit/2;for(const o of this.recentlyDeletedMap.keys()){if(s++>=i)break;this.recentlyDeletedMap.delete(o)}}}),V(this,"checkRecentlyDeleted",t=>{const n=this.recentlyDeletedMap.get(t);if(n){const{message:s}=W("MISSING_OR_INVALID",`Record was recently deleted - ${n}: ${t}`);throw new Error(s)}}),V(this,"isLinkModeEnabled",(t,n)=>{var s,i,o,a,c,l,u,h,f;return!t||n!==Ce.link_mode?!1:((i=(s=this.client.metadata)==null?void 0:s.redirect)==null?void 0:i.linkMode)===!0&&((a=(o=this.client.metadata)==null?void 0:o.redirect)==null?void 0:a.universal)!==void 0&&((l=(c=this.client.metadata)==null?void 0:c.redirect)==null?void 0:l.universal)!==""&&((u=t==null?void 0:t.redirect)==null?void 0:u.universal)!==void 0&&((h=t==null?void 0:t.redirect)==null?void 0:h.universal)!==""&&((f=t==null?void 0:t.redirect)==null?void 0:f.linkMode)===!0&&this.client.core.linkModeSupportedApps.includes(t.redirect.universal)&&typeof(global==null?void 0:global.Linking)<"u"}),V(this,"getAppLinkIfEnabled",(t,n)=>{var s;return this.isLinkModeEnabled(t,n)?(s=t==null?void 0:t.redirect)==null?void 0:s.universal:void 0}),V(this,"handleLinkModeMessage",({url:t})=>{if(!t||!t.includes("wc_ev")||!t.includes("topic"))return;const n=Wy(t,"topic")||"",s=decodeURIComponent(Wy(t,"wc_ev")||""),i=this.client.session.keys.includes(n);i&&this.client.session.update(n,{transportType:Ce.link_mode}),this.client.core.dispatchEnvelope({topic:n,message:s,sessionExists:i})}),V(this,"registerLinkModeListeners",async()=>{var t;if(dp()||js()&&(t=this.client.metadata.redirect)!=null&&t.linkMode){const n=global==null?void 0:global.Linking;if(typeof n<"u"){n.addEventListener("url",this.handleLinkModeMessage,this.client.name);const s=await n.getInitialURL();s&&setTimeout(()=>{this.handleLinkModeMessage({url:s})},50)}}}),V(this,"getTVFApproveParams",t=>{try{const n=yx(t.namespaces),s=F5(t.namespaces),i=L5(t.namespaces),o=t.sessionProperties,a=t.scopedProperties;return{approvedChains:n,approvedMethods:s,approvedEvents:i,sessionProperties:o,scopedProperties:a}}catch(n){return this.client.logger.warn(n,"Error getting TVF approve params"),{}}}),V(this,"getTVFParams",(t,n,s)=>{var i,o,a;if(!((i=n.request)!=null&&i.method))return{};const c={correlationId:t,rpcMethods:[n.request.method],chainId:n.chainId};try{const l=this.extractTxHashesFromResult(n.request,s);c.txHashes=l,c.contractAddresses=this.isValidContractData(n.request.params)?[(a=(o=n.request.params)==null?void 0:o[0])==null?void 0:a.to]:[]}catch(l){this.client.logger.warn(l,"Error getting TVF params")}return c}),V(this,"isValidContractData",t=>{var n;if(!t)return!1;try{const s=(t==null?void 0:t.data)||((n=t==null?void 0:t[0])==null?void 0:n.data);if(!s.startsWith("0x"))return!1;const i=s.slice(2);return/^[0-9a-fA-F]*$/.test(i)?i.length%2===0:!1}catch{}return!1}),V(this,"extractTxHashesFromResult",(t,n)=>{var s;try{if(!n)return[];const i=t.method,o=lU[i];if(i==="sui_signTransaction")return[DC(n.transactionBytes)];if(i==="near_signTransaction")return[n0(n)];if(i==="near_signTransactions")return n.map(c=>n0(c));if(i==="xrpl_signTransactionFor"||i==="xrpl_signTransaction")return[(s=n.tx_json)==null?void 0:s.hash];if(i==="polkadot_signTransaction")return[C6({transaction:t.params.transactionPayload,signature:n.signature})];if(i==="algo_signTxn")return ea(n)?n.map(c=>s0(c)):[s0(n)];if(i==="cosmos_signDirect")return[NC(n)];if(i==="wallet_sendCalls")return CC(n);if(typeof n=="string")return[n];const a=n[o.key];if(ea(a))return i==="solana_signAllTransactions"?a.map(c=>OC(c)):a;if(typeof a=="string")return[a]}catch(i){this.client.logger.warn(i,"Error extracting tx hashes from result")}return[]})}async processPendingMessageEvents(){try{const e=this.client.session.keys,t=this.client.core.relayer.messages.getWithoutAck(e);for(const[n,s]of Object.entries(t))for(const i of s)try{await this.onProviderMessageEvent({topic:n,message:i,publishedAt:Date.now()})}catch{this.client.logger.warn(`Error processing pending message event for topic: ${n}, message: ${i}`)}}catch(e){this.client.logger.warn(e,"processPendingMessageEvents failed")}}isInitialized(){if(!this.initialized){const{message:e}=W("NOT_INITIALIZED",this.name);throw new Error(e)}}async confirmOnlineStateOrThrow(){await this.client.core.relayer.confirmOnlineStateOrThrow()}registerRelayerEvents(){this.client.core.relayer.on(je.message,e=>{this.onProviderMessageEvent(e)})}async onRelayMessage(e){const{topic:t,message:n,attestation:s,transportType:i}=e,{publicKey:o}=this.client.auth.authKeys.keys.includes(Ol)?this.client.auth.authKeys.get(Ol):{publicKey:void 0};try{const a=await this.client.core.crypto.decode(t,n,{receiverPublicKey:o,encoding:i===Ce.link_mode?fs:jt});Op(a)?(this.client.core.history.set(t,a),await this.onRelayEventRequest({topic:t,payload:a,attestation:s,transportType:i,encryptedId:yr(n)})):ju(a)?(await this.client.core.history.resolve(a),await this.onRelayEventResponse({topic:t,payload:a,transportType:i}),this.client.core.history.delete(t,a.id)):(this.client.logger.error(`onRelayMessage() -> unknown payload: ${JSON.stringify(a)}`),await this.onRelayEventUnknownPayload({topic:t,payload:a,transportType:i})),await this.client.core.relayer.messages.ack(t,n)}catch(a){this.client.logger.error(`onRelayMessage() -> failed to process an inbound message: ${n}`),this.client.logger.error(a)}}registerExpirerEvents(){this.client.core.expirer.on(lr.expired,async e=>{const{topic:t,id:n}=m1(e.target);if(n&&this.client.pendingRequest.keys.includes(n))return await this.deletePendingSessionRequest(n,W("EXPIRED"),!0);if(n&&this.client.auth.requests.keys.includes(n))return await this.deletePendingAuthRequest(n,W("EXPIRED"),!0);t?this.client.session.keys.includes(t)&&(await this.deleteSession({topic:t,expirerHasDeleted:!0}),this.client.events.emit("session_expire",{topic:t})):n&&(await this.deleteProposal(n,!0),this.client.events.emit("proposal_expire",{id:n}))})}registerPairingEvents(){this.client.core.pairing.events.on(ei.create,e=>this.onPairingCreated(e)),this.client.core.pairing.events.on(ei.delete,e=>{this.addToRecentlyDeleted(e.topic,"pairing")})}isValidPairingTopic(e){if(!Ve(e,!1)){const{message:t}=W("MISSING_OR_INVALID",`pairing topic should be a string: ${e}`);throw new Error(t)}if(!this.client.core.pairing.pairings.keys.includes(e)){const{message:t}=W("NO_MATCHING_KEY",`pairing topic doesn't exist: ${e}`);throw new Error(t)}if(is(this.client.core.pairing.pairings.get(e).expiry)){const{message:t}=W("EXPIRED",`pairing topic: ${e}`);throw new Error(t)}}async isValidSessionTopic(e){if(!Ve(e,!1)){const{message:t}=W("MISSING_OR_INVALID",`session topic should be a string: ${e}`);throw new Error(t)}if(this.checkRecentlyDeleted(e),!this.client.session.keys.includes(e)){const{message:t}=W("NO_MATCHING_KEY",`session topic doesn't exist: ${e}`);throw new Error(t)}if(is(this.client.session.get(e).expiry)){await this.deleteSession({topic:e});const{message:t}=W("EXPIRED",`session topic: ${e}`);throw new Error(t)}if(!this.client.core.crypto.keychain.has(e)){const{message:t}=W("MISSING_OR_INVALID",`session topic does not exist in keychain: ${e}`);throw await this.deleteSession({topic:e}),new Error(t)}}async isValidSessionOrPairingTopic(e){if(this.checkRecentlyDeleted(e),this.client.session.keys.includes(e))await this.isValidSessionTopic(e);else if(this.client.core.pairing.pairings.keys.includes(e))this.isValidPairingTopic(e);else if(Ve(e,!1)){const{message:t}=W("NO_MATCHING_KEY",`session or pairing topic doesn't exist: ${e}`);throw new Error(t)}else{const{message:t}=W("MISSING_OR_INVALID",`session or pairing topic should be a string: ${e}`);throw new Error(t)}}async isValidProposalId(e){if(!o6(e)){const{message:t}=W("MISSING_OR_INVALID",`proposal id should be a number: ${e}`);throw new Error(t)}if(!this.client.proposal.keys.includes(e)){const{message:t}=W("NO_MATCHING_KEY",`proposal id doesn't exist: ${e}`);throw new Error(t)}if(is(this.client.proposal.get(e).expiryTimestamp)){await this.deleteProposal(e);const{message:t}=W("EXPIRED",`proposal id: ${e}`);throw new Error(t)}}validateRequestExpiry(e){if(e&&!g6(e,Xh)){const{message:t}=W("MISSING_OR_INVALID",`request() expiry: ${e}. Expiry must be a number (in seconds) between ${Xh.min} and ${Xh.max}`);throw new Error(t)}}}class AU extends qi{constructor(e,t){super(e,t,oU,_p),this.core=e,this.logger=t}}class IU extends qi{constructor(e,t){super(e,t,aU,_p),this.core=e,this.logger=t}}class SU extends qi{constructor(e,t){super(e,t,uU,_p,n=>n.id),this.core=e,this.logger=t}}class OU extends qi{constructor(e,t){super(e,t,pU,zu,()=>Ol),this.core=e,this.logger=t}}class DU extends qi{constructor(e,t){super(e,t,gU,zu),this.core=e,this.logger=t}}class _U extends qi{constructor(e,t){super(e,t,yU,zu,n=>n.id),this.core=e,this.logger=t}}var NU=Object.defineProperty,CU=(r,e,t)=>e in r?NU(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,ef=(r,e,t)=>CU(r,typeof e!="symbol"?e+"":e,t);class BU{constructor(e,t){this.core=e,this.logger=t,ef(this,"authKeys"),ef(this,"pairingTopics"),ef(this,"requests"),this.authKeys=new OU(this.core,this.logger),this.pairingTopics=new DU(this.core,this.logger),this.requests=new _U(this.core,this.logger)}async init(){await this.authKeys.init(),await this.pairingTopics.init(),await this.requests.init()}}var RU=Object.defineProperty,PU=(r,e,t)=>e in r?RU(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,pe=(r,e,t)=>PU(r,typeof e!="symbol"?e+"":e,t);class Np extends f3{constructor(e){super(e),pe(this,"protocol",Mx),pe(this,"version",zx),pe(this,"name",Zh.name),pe(this,"metadata"),pe(this,"core"),pe(this,"logger"),pe(this,"events",new Ur.EventEmitter),pe(this,"engine"),pe(this,"session"),pe(this,"proposal"),pe(this,"pendingRequest"),pe(this,"auth"),pe(this,"signConfig"),pe(this,"on",(n,s)=>this.events.on(n,s)),pe(this,"once",(n,s)=>this.events.once(n,s)),pe(this,"off",(n,s)=>this.events.off(n,s)),pe(this,"removeListener",(n,s)=>this.events.removeListener(n,s)),pe(this,"removeAllListeners",n=>this.events.removeAllListeners(n)),pe(this,"connect",async n=>{try{return await this.engine.connect(n)}catch(s){throw this.logger.error(s.message),s}}),pe(this,"pair",async n=>{try{return await this.engine.pair(n)}catch(s){throw this.logger.error(s.message),s}}),pe(this,"approve",async n=>{try{return await this.engine.approve(n)}catch(s){throw this.logger.error(s.message),s}}),pe(this,"reject",async n=>{try{return await this.engine.reject(n)}catch(s){throw this.logger.error(s.message),s}}),pe(this,"update",async n=>{try{return await this.engine.update(n)}catch(s){throw this.logger.error(s.message),s}}),pe(this,"extend",async n=>{try{return await this.engine.extend(n)}catch(s){throw this.logger.error(s.message),s}}),pe(this,"request",async n=>{try{return await this.engine.request(n)}catch(s){throw this.logger.error(s.message),s}}),pe(this,"respond",async n=>{try{return await this.engine.respond(n)}catch(s){throw this.logger.error(s.message),s}}),pe(this,"ping",async n=>{try{return await this.engine.ping(n)}catch(s){throw this.logger.error(s.message),s}}),pe(this,"emit",async n=>{try{return await this.engine.emit(n)}catch(s){throw this.logger.error(s.message),s}}),pe(this,"disconnect",async n=>{try{return await this.engine.disconnect(n)}catch(s){throw this.logger.error(s.message),s}}),pe(this,"find",n=>{try{return this.engine.find(n)}catch(s){throw this.logger.error(s.message),s}}),pe(this,"getPendingSessionRequests",()=>{try{return this.engine.getPendingSessionRequests()}catch(n){throw this.logger.error(n.message),n}}),pe(this,"authenticate",async(n,s)=>{try{return await this.engine.authenticate(n,s)}catch(i){throw this.logger.error(i.message),i}}),pe(this,"formatAuthMessage",n=>{try{return this.engine.formatAuthMessage(n)}catch(s){throw this.logger.error(s.message),s}}),pe(this,"approveSessionAuthenticate",async n=>{try{return await this.engine.approveSessionAuthenticate(n)}catch(s){throw this.logger.error(s.message),s}}),pe(this,"rejectSessionAuthenticate",async n=>{try{return await this.engine.rejectSessionAuthenticate(n)}catch(s){throw this.logger.error(s.message),s}}),this.name=(e==null?void 0:e.name)||Zh.name,this.metadata=b4(e==null?void 0:e.metadata),this.signConfig=e==null?void 0:e.signConfig;const t=xx({logger:(e==null?void 0:e.logger)||Zh.logger,name:this.name});this.logger=t,this.core=(e==null?void 0:e.core)||new iU(e),this.session=new IU(this.core,this.logger),this.proposal=new AU(this.core,this.logger),this.pendingRequest=new SU(this.core,this.logger),this.engine=new EU(this),this.auth=new BU(this.core,this.logger)}static async init(e){const t=new Np(e);return await t.initialize(),t}get context(){return Ht(this.logger)}get pairing(){return this.core.pairing.pairings}async initialize(){this.logger.trace("Initialized");try{await this.core.start(),await this.session.init(),await this.proposal.init(),await this.pendingRequest.init(),await this.auth.init(),await this.engine.init(),this.logger.info("SignClient Initialization Success")}catch(e){throw this.logger.info("SignClient Initialization Failure"),this.logger.error(e.message),e}}}const TU="2b0ddf4a2e6e6a53f52d2bcb9a0c2e0f",kU={name:"Kairos 777",description:"AI-Powered Trading Platform  Trade crypto with bots, charts & on-chain execution",url:"https://kairos-trade.netlify.app",icons:["https://kairos-trade.netlify.app/icons/icon-192.png"]},UU=["eip155:56","eip155:1","eip155:137","eip155:42161","eip155:43114","eip155:8453"],$U=["eth_sendTransaction","personal_sign","eth_signTypedData_v4"],FU=["chainChanged","accountsChanged"];let Hr=null,Xe=null,Gr={};const Cp="kairos_wc_session";function Vx(r){try{localStorage.setItem(Cp,JSON.stringify({topic:r.topic,namespaces:r.namespaces,peer:r.peer,expiry:r.expiry}))}catch{}}function LU(){try{const r=localStorage.getItem(Cp);return r?JSON.parse(r):null}catch{return null}}function Dl(){localStorage.removeItem(Cp)}async function Bp(){if(Hr)return Hr;Hr=await Np.init({projectId:TU,metadata:kU}),Hr.on("session_event",({topic:e,params:t})=>{const{event:n}=t;Gr.onSessionEvent&&Gr.onSessionEvent(n)}),Hr.on("session_update",({topic:e,params:t})=>{const{namespaces:n}=t;Xe&&Xe.topic===e&&(Xe={...Xe,namespaces:n},Vx(Xe),Gr.onSessionUpdate&&Gr.onSessionUpdate(Xe))}),Hr.on("session_delete",({topic:e})=>{Xe&&Xe.topic===e&&(Xe=null,Dl(),Gr.onDisconnect&&Gr.onDisconnect())});const r=LU();if(r!=null&&r.topic)try{const t=Hr.session.getAll().find(n=>n.topic===r.topic);t?(Xe=t,Gr.onReconnect&&Gr.onReconnect(t)):Dl()}catch{Dl()}return Hr}function jU(r){Gr={...Gr,...r}}async function MU(){const r=await Bp(),{uri:e,approval:t}=await r.connect({requiredNamespaces:{eip155:{chains:UU,methods:$U,events:FU}}});return{uri:e,waitForApproval:async()=>{const n=await t();return Xe=n,Vx(n),n}}}async function Kx(){if(!(!Hr||!Xe)){try{await Hr.disconnect({topic:Xe.topic,reason:{code:6e3,message:"User disconnected"}})}catch{}Xe=null,Dl()}}function _l(){var i,o,a,c,l,u,h;if(!Xe)return null;const r=(i=Xe.namespaces)==null?void 0:i.eip155;if(!((o=r==null?void 0:r.accounts)!=null&&o.length))return null;const[e,t,n]=r.accounts[0].split(":"),s=[...new Set(r.accounts.map(f=>parseInt(f.split(":")[1])))];return{address:n,chainId:parseInt(t),chains:s,peerName:((c=(a=Xe.peer)==null?void 0:a.metadata)==null?void 0:c.name)||"External Wallet",peerIcon:((h=(u=(l=Xe.peer)==null?void 0:l.metadata)==null?void 0:u.icons)==null?void 0:h[0])||null}}function zU({value:r,size:e=200}){return w.jsxs("div",{className:"flex flex-col items-center gap-3",children:[w.jsx("div",{className:"w-48 h-48 rounded-2xl bg-white flex items-center justify-center p-4",style:{background:"linear-gradient(135deg, #fff 0%, #f3f4f6 100%)"},children:w.jsx(ev,{className:"w-20 h-20 text-gray-400"})}),w.jsx("p",{className:"text-xs text-gray-500 text-center max-w-[240px]",children:"Copia el URI y pgalo en Kairos Wallet  WalletConnect"})]})}function qU({isOpen:r,onClose:e,onConnected:t}){var O,x,b,v,S;const[n,s]=ie.useState("idle"),[i,o]=ie.useState(""),[a,c]=ie.useState(!1),[l,u]=ie.useState(""),[h,f]=ie.useState(null),d=ie.useRef(null);ie.useEffect(()=>{r&&(Bp().then(()=>{const D=_l();D&&(f(D),s("connected"))}).catch(()=>{}),jU({onDisconnect:()=>{f(null),s("idle"),t&&t(null)},onReconnect:D=>{const R=_l();R&&(f(R),s("connected"),t&&t(R))}}))},[r]);const p=ie.useCallback(async()=>{var D,R;s("generating"),u("");try{const{uri:_,waitForApproval:F}=await MU();o(_),s("waiting"),d.current=F;const j=await F(),$=_l();f($),s("connected"),t&&t($)}catch(_){(D=_==null?void 0:_.message)!=null&&D.includes("rejected")||(R=_==null?void 0:_.message)!=null&&R.includes("expired")?u("Conexin rechazada o expirada. Intenta de nuevo."):u((_==null?void 0:_.message)||"Error al conectar"),s("error")}},[t]),g=ie.useCallback(async()=>{await Kx(),f(null),s("idle"),t&&t(null)},[t]),m=ie.useCallback(async()=>{try{await navigator.clipboard.writeText(i),c(!0),setTimeout(()=>c(!1),2e3)}catch{}},[i]),E=ie.useCallback(()=>{const D=i?`https://kairos-wallet.netlify.app?wc=${encodeURIComponent(i)}`:"https://kairos-wallet.netlify.app";window.open(D,"_blank")},[i]);return r?w.jsx(Ys,{children:w.jsx(Te.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 z-[100] flex items-center justify-center bg-black/60 backdrop-blur-sm p-4",onClick:e,children:w.jsxs(Te.div,{initial:{scale:.9,opacity:0,y:20},animate:{scale:1,opacity:1,y:0},exit:{scale:.9,opacity:0,y:20},transition:{type:"spring",damping:25},className:"bg-[#0C0D10] border border-white/10 rounded-2xl w-full max-w-md overflow-hidden",onClick:D=>D.stopPropagation(),children:[w.jsxs("div",{className:"flex items-center justify-between px-5 py-4 border-b border-white/5",children:[w.jsxs("div",{className:"flex items-center gap-2",children:[w.jsx(Nl,{className:"w-5 h-5 text-blue-400"}),w.jsx("h2",{className:"text-lg font-bold text-white",children:"Conectar Wallet"})]}),w.jsx("button",{onClick:e,className:"p-1.5 rounded-lg hover:bg-white/10 transition-colors",children:w.jsx(qo,{className:"w-5 h-5 text-gray-400"})})]}),w.jsx("div",{className:"p-5",children:w.jsxs(Ys,{mode:"wait",children:[n==="idle"&&w.jsxs(Te.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"space-y-3",children:[w.jsx("p",{className:"text-sm text-gray-400 mb-4",children:"Conecta tu Kairos Wallet u otra wallet compatible para firmar transacciones on-chain de forma segura."}),w.jsxs("button",{onClick:p,className:"w-full flex items-center gap-4 p-4 rounded-xl bg-gradient-to-r from-purple-500/10 to-blue-500/10 border border-purple-500/20 hover:border-purple-500/40 transition-all group",children:[w.jsxs("div",{className:"w-12 h-12 rounded-xl bg-purple-500/20 flex items-center justify-center shrink-0",children:[w.jsx("img",{src:"https://kairos-wallet.netlify.app/icons/logo-128.png",alt:"Kairos Wallet",className:"w-8 h-8 rounded-lg",onError:D=>{D.target.style.display="none",D.target.nextSibling.style.display="flex"}}),w.jsx("div",{className:"w-8 h-8 rounded-lg bg-purple-500/30 items-center justify-center hidden",children:w.jsx(ro,{className:"w-5 h-5 text-purple-400"})})]}),w.jsxs("div",{className:"text-left flex-1",children:[w.jsxs("div",{className:"flex items-center gap-2",children:[w.jsx("span",{className:"font-semibold text-white group-hover:text-purple-300 transition-colors",children:"Kairos Wallet"}),w.jsx("span",{className:"text-[10px] px-1.5 py-0.5 rounded-full bg-purple-500/20 text-purple-300 font-medium",children:"Recomendado"})]}),w.jsx("p",{className:"text-xs text-gray-500 mt-0.5",children:"Multi-chain  AES-256  WalletConnect v2"})]}),w.jsx(Yx,{className:"w-4 h-4 text-purple-400 opacity-0 group-hover:opacity-100 transition-opacity"})]}),w.jsxs("button",{onClick:p,className:"w-full flex items-center gap-4 p-4 rounded-xl bg-white/[0.02] border border-white/5 hover:border-white/15 transition-all group",children:[w.jsx("div",{className:"w-12 h-12 rounded-xl bg-blue-500/10 flex items-center justify-center shrink-0",children:w.jsx(Nl,{className:"w-6 h-6 text-blue-400"})}),w.jsxs("div",{className:"text-left flex-1",children:[w.jsx("span",{className:"font-semibold text-white group-hover:text-blue-300 transition-colors",children:"WalletConnect"}),w.jsx("p",{className:"text-xs text-gray-500 mt-0.5",children:"MetaMask, Trust Wallet, Rainbow y ms"})]})]}),w.jsxs("div",{className:"flex items-center gap-2 mt-3 px-1",children:[w.jsx(Ia,{className:"w-3.5 h-3.5 text-green-500/60"}),w.jsx("p",{className:"text-[11px] text-gray-600",children:"Tu clave privada nunca sale de tu wallet. Trade solo enva solicitudes de firma."})]})]},"idle"),n==="generating"&&w.jsxs(Te.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"flex flex-col items-center py-8 gap-4",children:[w.jsx(_s,{className:"w-10 h-10 text-blue-400 animate-spin"}),w.jsx("p",{className:"text-sm text-gray-400",children:"Generando conexin segura..."})]},"generating"),n==="waiting"&&w.jsxs(Te.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"flex flex-col items-center gap-4",children:[w.jsx(zU,{value:i}),w.jsxs("div",{className:"w-full flex items-center gap-2 bg-white/5 rounded-lg p-2",children:[w.jsx("code",{className:"flex-1 text-[10px] text-gray-400 truncate font-mono",children:i}),w.jsx("button",{onClick:m,className:"shrink-0 p-1.5 rounded-md hover:bg-white/10 transition-colors",children:a?w.jsx(du,{className:"w-4 h-4 text-green-400"}):w.jsx(za,{className:"w-4 h-4 text-gray-400"})})]}),w.jsxs("button",{onClick:E,className:"w-full flex items-center justify-center gap-2 py-3 rounded-xl bg-purple-600 hover:bg-purple-500 text-white font-medium transition-colors",children:[w.jsx(Zx,{className:"w-4 h-4"}),"Abrir Kairos Wallet",w.jsx(Td,{className:"w-3.5 h-3.5 opacity-60"})]}),w.jsxs("div",{className:"flex items-center gap-2",children:[w.jsx(_s,{className:"w-3.5 h-3.5 text-blue-400 animate-spin"}),w.jsx("p",{className:"text-xs text-gray-500",children:"Esperando aprobacin en tu wallet..."})]})]},"waiting"),n==="connected"&&h&&w.jsxs(Te.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0},className:"space-y-4",children:[w.jsxs("div",{className:"flex items-center gap-3 p-4 rounded-xl bg-green-500/10 border border-green-500/20",children:[w.jsx(Xx,{className:"w-8 h-8 text-green-400 shrink-0"}),w.jsxs("div",{children:[w.jsx("p",{className:"text-sm font-semibold text-green-300",children:"Wallet Conectada"}),w.jsx("p",{className:"text-xs text-green-400/60 mt-0.5",children:h.peerName})]})]}),w.jsxs("div",{className:"flex items-center gap-3 p-3 rounded-xl bg-white/[0.03] border border-white/5",children:[w.jsx("div",{className:"w-10 h-10 rounded-full bg-gradient-to-br from-purple-500 to-blue-500 flex items-center justify-center text-white font-bold text-sm",children:(O=h.address)==null?void 0:O.slice(2,4).toUpperCase()}),w.jsxs("div",{className:"flex-1 min-w-0",children:[w.jsx("p",{className:"text-sm font-mono text-white truncate",children:h.address}),w.jsxs("p",{className:"text-xs text-gray-500",children:[((x=h.chains)==null?void 0:x.length)||1," cadena",((b=h.chains)==null?void 0:b.length)>1?"s":""," conectada",((v=h.chains)==null?void 0:v.length)>1?"s":""]})]}),w.jsx("button",{onClick:()=>m(),className:"p-1.5 rounded-md hover:bg-white/10",children:w.jsx(za,{className:"w-4 h-4 text-gray-400"})})]}),w.jsx("div",{className:"flex flex-wrap gap-1.5",children:(S=h.chains)==null?void 0:S.map(D=>w.jsx("span",{className:"text-[10px] px-2 py-0.5 rounded-full bg-white/5 text-gray-400",children:{56:"BSC",1:"Ethereum",137:"Polygon",42161:"Arbitrum",43114:"Avalanche",8453:"Base"}[D]||`Chain ${D}`},D))}),w.jsxs("button",{onClick:g,className:"w-full flex items-center justify-center gap-2 py-2.5 rounded-xl border border-red-500/20 text-red-400 hover:bg-red-500/10 transition-colors text-sm",children:[w.jsx(Am,{className:"w-4 h-4"}),"Desconectar"]})]},"connected"),n==="error"&&w.jsxs(Te.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"flex flex-col items-center gap-4 py-4",children:[w.jsx("div",{className:"w-16 h-16 rounded-full bg-red-500/10 flex items-center justify-center",children:w.jsx(qo,{className:"w-8 h-8 text-red-400"})}),w.jsx("p",{className:"text-sm text-red-400 text-center",children:l}),w.jsx("button",{onClick:()=>{s("idle"),u("")},className:"px-6 py-2 rounded-lg bg-white/10 text-white text-sm hover:bg-white/15 transition-colors",children:"Intentar de nuevo"})]},"error")]})})]})})}):null}const ds=[{id:56,name:"BNB Smart Chain",short:"BSC",color:"#F0B90B",rpc:"https://bsc-dataseed1.binance.org",rpcFallback:"https://bsc-dataseed2.binance.org",explorer:"https://bscscan.com",explorerApi:"https://api.bscscan.com/api",nativeSymbol:"BNB",nativeDecimals:18,apiKey:""},{id:8453,name:"Base",short:"Base",color:"#0052FF",rpc:"https://mainnet.base.org",rpcFallback:"https://base.publicnode.com",explorer:"https://basescan.org",explorerApi:"https://api.basescan.org/api",nativeSymbol:"ETH",nativeDecimals:18,apiKey:""},{id:42161,name:"Arbitrum One",short:"ARB",color:"#28A0F0",rpc:"https://arb1.arbitrum.io/rpc",rpcFallback:"https://arbitrum.publicnode.com",explorer:"https://arbiscan.io",explorerApi:"https://api.arbiscan.io/api",nativeSymbol:"ETH",nativeDecimals:18,apiKey:""},{id:137,name:"Polygon",short:"MATIC",color:"#8247E5",rpc:"https://polygon-rpc.com",rpcFallback:"https://polygon.publicnode.com",explorer:"https://polygonscan.com",explorerApi:"https://api.polygonscan.com/api",nativeSymbol:"POL",nativeDecimals:18,apiKey:""}],Hx=["function balanceOf(address) view returns (uint256)","function transfer(address to, uint256 amount) returns (bool)","function decimals() view returns (uint8)","function symbol() view returns (string)"],Pd=r=>r?`${r.slice(0,6)}...${r.slice(-4)}`:"",Pa=r=>{const e=parseFloat(r);return e===0?"0.00":e<.01?e.toFixed(6):e<1?e.toFixed(4):e<1e3?e.toFixed(2):e.toLocaleString(void 0,{maximumFractionDigits:2})},Rp=r=>{try{return new vg(r.rpc,r.id)}catch{return new vg(r.rpcFallback,r.id)}},VU=async(r,e)=>{try{const t=Vo.addresses[r.id];if(!t)return"0";const n=Rp(r),i=await new _i(t,Hx,n).balanceOf(e);return Fd(i,Vo.decimals)}catch(t){return console.warn(`Failed to get KAIROS balance on ${r.short}:`,t.message),"0"}},KU=async(r,e)=>{try{const n=await Rp(r).getBalance(e);return Fd(n,r.nativeDecimals)}catch{return"0"}},HU=async(r,e,t,n)=>{const s=Vo.addresses[r.id];if(!s)throw new Error(`KAIROS no est desplegado en ${r.name}`);const i=Rp(r),o=new of(e,i),a=new _i(s,Hx,o),c=kv(n.toString(),Vo.decimals);return await a.transfer(t,c)},GU=async(r,e)=>{try{const t=Vo.addresses[r.id];if(!t)return[];const n=`${r.explorerApi}?module=account&action=tokentx&contractaddress=${t}&address=${e}&page=1&offset=10&sort=desc`,i=await(await fetch(n)).json();return i.status==="1"&&Array.isArray(i.result)?i.result.map(o=>({hash:o.hash,from:o.from,to:o.to,value:Fd(o.value||"0",parseInt(o.tokenDecimal)||18),timestamp:parseInt(o.timeStamp)*1e3,chainId:r.id,chainShort:r.short,chainColor:r.color,isIncoming:o.to.toLowerCase()===e.toLowerCase()})):[]}catch{return[]}};function U$(){var ia,oa;const{user:r}=Ku(),e=(r==null?void 0:r.walletAddress)||"",t=(r==null?void 0:r.role)==="admin",[n,s]=ie.useState({}),[i,o]=ie.useState(0),[a,c]=ie.useState(!0),[l,u]=ie.useState(!1),[h,f]=ie.useState(!1),[d,p]=ie.useState(!1),[g,m]=ie.useState(!1),[E,O]=ie.useState(!1),[x,b]=ie.useState([]),[v,S]=ie.useState(!1),[D,R]=ie.useState(!1),[_,F]=ie.useState(!1),[j,$]=ie.useState(!1),[C,k]=ie.useState(""),[I,A]=ie.useState(""),[B,U]=ie.useState(!1),N=ie.useRef(null),[T,M]=ie.useState(!1),[q,Y]=ie.useState(!1),[J,Q]=ie.useState(""),[re,ne]=ie.useState(!1),[ae,te]=ie.useState(""),[ue,Ae]=ie.useState(!1),[Ne,Ue]=ie.useState(null);ie.useEffect(()=>{Bp().then(()=>{const se=_l();se&&Ue(se)}).catch(()=>{})},[]);const Pe=ie.useMemo(()=>{try{const se=xv();if(se&&se.startsWith("0x"))return se;if(r!=null&&r.encryptedKey&&!r.encryptedKey.startsWith("v1:")){const be=atob(r.encryptedKey);if(be.startsWith("0x"))return be}const Be=localStorage.getItem("kairos_trade_wallet");if(Be){const{encryptedKey:be}=JSON.parse(Be);if(be&&!be.startsWith("v1:")){const ft=atob(be);if(ft.startsWith("0x"))return ft}}}catch{}return null},[r==null?void 0:r.encryptedKey]),Bt=ie.useCallback(async()=>{if(!e)return;u(!0);const se={};let Be=0;await Promise.all(ds.map(async be=>{const[ft,Qn]=await Promise.all([VU(be,e),KU(be,e)]);se[be.id]={kairos:ft,native:Qn},Be+=parseFloat(ft)||0})),s(se),o(Be),c(!1),u(!1)},[e]);ie.useEffect(()=>{Bt()},[Bt]);const $r=ie.useCallback(async()=>{if(!e)return;S(!0);const se=[];await Promise.all(ds.map(async Be=>{const be=await GU(Be,e);se.push(...be)})),se.sort((Be,be)=>be.timestamp-Be.timestamp),b(se.slice(0,20)),S(!1)},[e]),Tc=ie.useCallback(async se=>{try{await navigator.clipboard.writeText(se),f(!0),setTimeout(()=>f(!1),2e3)}catch{}},[]),kc=async()=>{var se;if(C){U(!0),A("");try{(se=(await Fp.post("/auth/login",{email:r==null?void 0:r.email,password:C})).data)!=null&&se.success?(N.current=C,$(!0),k(""),setTimeout(()=>{$(!1),R(!1),N.current=null},6e4)):A("Contrasea incorrecta")}catch{A("Contrasea incorrecta")}finally{U(!1)}}},Uc=async()=>{te("");const se=J.trim();if(!se.startsWith("0x")||se.length!==66){te("Private key invlida. Debe empezar con 0x y tener 66 caracteres.");return}const Be=N.current;if(!Be){te("Sesin de seguridad expirada. Desbloquea de nuevo.");return}ne(!0);try{const be=new of(se),ft=await Lp(se,Be);localStorage.setItem("kairos_trade_wallet",JSON.stringify({walletAddress:be.address,encryptedKey:ft})),jp(se),await fetch("https://kairos-api-u6k5.onrender.com/api/auth/update-key",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${r==null?void 0:r.accessToken}`},body:JSON.stringify({walletAddress:be.address,encryptedKey:ft})});const{login:Fc}=Ku.getState();Fc({...r,walletAddress:be.address,encryptedKey:ft}),Y(!1),Q("")}catch(be){te("Error al importar: "+be.message)}ne(!1)},[sa,Vi]=ie.useState(!1),$c=async()=>{const se=N.current||prompt("Ingresa tu contrasea para cifrar la wallet:");if(se){Vi(!0);try{const Be=of.createRandom(),be=Be.address,ft=Be.privateKey,Qn=await Lp(ft,se);localStorage.setItem("kairos_trade_wallet",JSON.stringify({walletAddress:be,encryptedKey:Qn})),jp(ft),await fetch("https://kairos-api-u6k5.onrender.com/api/auth/update-key",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${r==null?void 0:r.accessToken}`},body:JSON.stringify({walletAddress:be,encryptedKey:Qn})});const{login:Gx}=Ku.getState();Gx({...r,walletAddress:be,encryptedKey:Qn})}catch(Be){console.error("Failed to generate wallet:",Be)}Vi(!1)}};return e?w.jsxs("div",{className:"flex-1 overflow-y-auto px-5 py-5 space-y-5",style:{maxWidth:"100%"},children:[w.jsxs(Te.div,{initial:{opacity:0,y:8},animate:{opacity:1,y:0},className:"flex items-center justify-between gap-3",children:[w.jsxs("div",{className:"flex items-center gap-3",children:[w.jsx("div",{className:"w-12 h-12 rounded-2xl bg-[var(--gold)]/15 flex items-center justify-center",children:w.jsx(ro,{size:22,className:"text-[var(--gold)]"})}),w.jsxs("div",{children:[w.jsxs("div",{className:"flex items-center gap-2",children:[w.jsx("h1",{className:"text-xl font-bold",children:"Kairos Wallet"}),t&&w.jsx("span",{className:"px-2 py-0.5 rounded-full text-[9px] font-bold uppercase tracking-wider",style:{background:"linear-gradient(135deg, #D4AF37, #B8972E)",color:"#0D0D0D"},children:"Admin"})]}),w.jsxs("button",{onClick:()=>Tc(e),className:"flex items-center gap-1.5 text-xs text-[var(--text-dim)] hover:text-[var(--gold)] transition-colors",children:[Pd(e),h?w.jsx(du,{size:10,className:"text-green-400"}):w.jsx(za,{size:10})]}),t&&w.jsx("p",{className:"text-[9px] text-[var(--gold)]/60 mt-0.5",children:"Wallet de comisiones  Kairos 777 Inc"})]})]}),w.jsxs("div",{className:"flex items-center gap-2",children:[w.jsx("button",{onClick:Bt,disabled:l,className:"p-2 rounded-xl transition-all hover:bg-white/5",children:w.jsx(tv,{size:16,className:`text-[var(--text-dim)] ${l?"animate-spin":""}`})}),w.jsxs("button",{onClick:async()=>{M(!0);try{const se=await Fp.post("/api/auth/cross-app-token",{target:"wallet"});se.success?window.open(`https://kairos-wallet.netlify.app?cat=${se.data.crossAppToken}`,"_blank"):window.open("https://kairos-wallet.netlify.app","_blank")}catch{window.open("https://kairos-wallet.netlify.app","_blank")}M(!1)},disabled:T,className:"flex items-center gap-1.5 px-3 py-2 rounded-xl text-xs font-semibold text-[var(--gold)] transition-all hover:bg-[var(--gold)]/10 disabled:opacity-50",style:{border:"1px solid rgba(59,130,246,0.15)"},children:[T?w.jsx(_s,{size:12,className:"animate-spin"}):w.jsx(Nl,{size:12}),"Wallet Completa"]})]})]}),Ne&&w.jsxs(Te.div,{initial:{opacity:0,y:8},animate:{opacity:1,y:0},className:"rounded-xl p-3.5 flex items-center justify-between",style:{background:"linear-gradient(135deg, rgba(168,85,247,0.08), rgba(59,130,246,0.04))",border:"1px solid rgba(168,85,247,0.15)"},children:[w.jsxs("div",{className:"flex items-center gap-3",children:[w.jsx("div",{className:"w-8 h-8 rounded-full bg-gradient-to-br from-purple-500 to-blue-500 flex items-center justify-center text-white text-[10px] font-bold",children:"WC"}),w.jsxs("div",{children:[w.jsxs("p",{className:"text-xs font-bold text-purple-300 flex items-center gap-1.5",children:[w.jsx("span",{className:"w-1.5 h-1.5 rounded-full bg-green-400 animate-pulse"}),Ne.peerName||"Wallet Externa"]}),w.jsxs("p",{className:"text-[10px] font-mono text-gray-500",children:[(ia=Ne.address)==null?void 0:ia.slice(0,6),"...",(oa=Ne.address)==null?void 0:oa.slice(-4)]})]})]}),w.jsxs("div",{className:"flex items-center gap-1.5",children:[w.jsx("button",{onClick:()=>Ae(!0),className:"px-2.5 py-1 rounded-lg text-[10px] font-semibold text-purple-300 hover:bg-purple-500/10 transition-colors",children:"Detalles"}),w.jsx("button",{onClick:async()=>{await Kx(),Ue(null)},className:"p-1.5 rounded-lg hover:bg-red-500/10 transition-colors",title:"Desconectar",children:w.jsx(Am,{size:12,className:"text-red-400"})})]})]}),!Ne&&w.jsx(Te.div,{initial:{opacity:0,y:8},animate:{opacity:1,y:0},className:"rounded-xl overflow-hidden cursor-pointer group",style:{border:"1px solid rgba(168,85,247,0.1)"},onClick:()=>Ae(!0),children:w.jsxs("div",{className:"flex items-center gap-3 p-3.5 bg-white/[0.015] hover:bg-purple-500/5 transition-colors",children:[w.jsx("div",{className:"w-8 h-8 rounded-full bg-purple-500/10 flex items-center justify-center",children:w.jsx(Nl,{size:14,className:"text-purple-400"})}),w.jsxs("div",{className:"flex-1",children:[w.jsx("p",{className:"text-xs font-semibold text-gray-300 group-hover:text-purple-300 transition-colors",children:"Conectar Wallet Externa"}),w.jsx("p",{className:"text-[10px] text-gray-600",children:"Kairos Wallet, MetaMask, Trust Wallet via WalletConnect"})]}),w.jsx(rv,{size:14,className:"text-gray-600 group-hover:text-purple-400 transition-colors"})]})}),w.jsx(qU,{isOpen:ue,onClose:()=>Ae(!1),onConnected:se=>{Ue(se),se&&Ae(!1)}}),w.jsxs(Te.div,{initial:{opacity:0,y:12},animate:{opacity:1,y:0},transition:{delay:.05},className:"rounded-2xl p-6 relative overflow-hidden",style:{background:"linear-gradient(135deg, rgba(59,130,246,0.08), rgba(59,130,246,0.02))",border:"1px solid rgba(59,130,246,0.12)"},children:[w.jsx("div",{className:"absolute -top-20 -right-20 w-60 h-60 rounded-full pointer-events-none",style:{background:"radial-gradient(circle, rgba(59,130,246,0.06), transparent)"}}),w.jsx("p",{className:"text-xs text-[var(--text-dim)] font-semibold uppercase tracking-wider mb-1",children:"Balance Total KAIROS"}),a?w.jsx("div",{className:"h-10 w-48 rounded-lg bg-white/5 animate-pulse"}):w.jsxs("div",{className:"flex items-baseline gap-2",children:[w.jsx("h2",{className:"text-4xl font-black text-white",children:Pa(i)}),w.jsx("span",{className:"text-sm font-bold text-[var(--gold)]",children:"KAIROS"})]}),w.jsxs("p",{className:"text-xs text-[var(--text-dim)] mt-1",children:[" $",Pa(i)," USD ",w.jsx("span",{className:"text-[var(--text-dim)]/50",children:"(1 KAIROS = 1 USD)"})]}),w.jsxs("div",{className:"flex gap-3 mt-5",children:[t&&!Pe?w.jsxs("button",{onClick:()=>Y(!0),className:"flex-1 flex items-center justify-center gap-2 py-3 rounded-xl text-sm font-bold text-black transition-all hover:scale-[1.02]",style:{background:"linear-gradient(135deg, #D4AF37, #B8972E)",boxShadow:"0 4px 20px rgba(212,175,55,0.3)"},children:[w.jsx(ll,{size:16}),"Importar Wallet"]}):w.jsxs("button",{onClick:()=>p(!0),className:"flex-1 flex items-center justify-center gap-2 py-3 rounded-xl text-sm font-bold text-white transition-all hover:scale-[1.02]",style:{background:"linear-gradient(135deg, #3B82F6, #2563EB)",boxShadow:"0 4px 20px rgba(59,130,246,0.2)"},children:[w.jsx(tf,{size:16}),"Enviar"]}),w.jsxs("button",{onClick:()=>m(!0),className:"flex-1 flex items-center justify-center gap-2 py-3 rounded-xl text-sm font-bold text-white transition-all hover:scale-[1.02]",style:{background:"rgba(0,220,130,0.15)",border:"1px solid rgba(0,220,130,0.2)"},children:[w.jsx(ll,{size:16,className:"text-[var(--green)]"}),w.jsx("span",{className:"text-[var(--green)]",children:"Recibir"})]}),w.jsxs("button",{onClick:()=>{O(!0),$r()},className:"flex-1 flex items-center justify-center gap-2 py-3 rounded-xl text-sm font-bold text-[var(--text-dim)] transition-all hover:scale-[1.02] hover:text-white",style:{background:"rgba(255,255,255,0.04)",border:"1px solid rgba(255,255,255,0.06)"},children:[w.jsx(Cl,{size:16}),"Historial"]})]})]}),t&&w.jsx(Te.div,{initial:{opacity:0,y:8},animate:{opacity:1,y:0},className:"rounded-xl p-4",style:{background:"linear-gradient(135deg, rgba(212,175,55,0.08), rgba(212,175,55,0.03))",border:"1px solid rgba(212,175,55,0.15)"},children:w.jsxs("div",{className:"flex items-start gap-3",children:[w.jsx(Ia,{size:18,className:"text-[var(--gold)] mt-0.5 flex-shrink-0"}),w.jsxs("div",{children:[w.jsx("p",{className:"text-xs font-bold text-[var(--gold)] mb-1",children:"Kairos Wallet  Administrador"}),w.jsxs("p",{className:"text-[10px] text-[var(--text-dim)] leading-relaxed",children:[!e&&"No tienes wallet vinculada. Genera una nueva o importa una existente para operar.",e&&!Pe&&"Wallet vinculada. Importa tu clave privada para enviar transacciones.",e&&Pe&&"Wallet activa  puedes enviar, recibir y operar directamente desde Kairos 777."]})]})]})}),w.jsxs("div",{className:"space-y-2.5",children:[w.jsxs("h3",{className:"text-sm font-bold flex items-center gap-2",children:[w.jsx(Ia,{size:14,className:"text-[var(--gold)]"}),"Balances por Chain"]}),ds.map((se,Be)=>{const be=n[se.id]||{kairos:"0",native:"0"},ft=parseFloat(be.kairos);return w.jsxs(Te.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.1+Be*.05},className:"rounded-xl p-4 flex items-center justify-between transition-all hover:scale-[1.005]",style:{background:`linear-gradient(135deg, ${se.color}06, ${se.color}02)`,border:`1px solid ${se.color}15`},children:[w.jsxs("div",{className:"flex items-center gap-3",children:[w.jsx("div",{className:"w-10 h-10 rounded-xl flex items-center justify-center text-sm font-black",style:{background:`${se.color}15`,color:se.color},children:se.short.slice(0,2)}),w.jsxs("div",{children:[w.jsx("p",{className:"text-sm font-bold",children:se.name}),w.jsxs("p",{className:"text-[10px] text-[var(--text-dim)]",children:[Pa(be.native)," ",se.nativeSymbol]})]})]}),w.jsx("div",{className:"text-right",children:a?w.jsx("div",{className:"h-5 w-20 rounded bg-white/5 animate-pulse"}):w.jsxs(w.Fragment,{children:[w.jsxs("p",{className:"text-sm font-bold",style:{color:ft>0?"white":"var(--text-dim)"},children:[Pa(be.kairos)," ",w.jsx("span",{className:"text-[10px] text-[var(--gold)]",children:"KAIROS"})]}),w.jsxs("a",{href:`${se.explorer}/token/${Vo.addresses[se.id]}?a=${e}`,target:"_blank",rel:"noopener noreferrer",className:"text-[10px] text-[var(--text-dim)] hover:text-[var(--gold)] transition-colors flex items-center gap-1 justify-end",children:["Ver en explorer ",w.jsx(Td,{size:8})]})]})})]},se.id)})]}),Pe&&w.jsxs(Te.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.4},children:[w.jsxs("button",{onClick:()=>{F(!_),R(!1),A("")},className:"w-full flex items-center justify-between rounded-xl px-4 py-3 transition-all hover:scale-[1.005]",style:{background:"rgba(255,255,255,0.02)",border:"1px solid rgba(255,255,255,0.06)"},children:[w.jsxs("div",{className:"flex items-center gap-2",children:[w.jsx(Ia,{size:14,className:"text-[var(--text-dim)]"}),w.jsx("span",{className:"text-xs font-medium text-[var(--text-dim)]",children:"Seguridad Avanzada"})]}),w.jsx(nv,{size:14,className:`text-[var(--text-dim)] transition-transform ${_?"rotate-180":""}`})]}),w.jsx(Ys,{children:_&&w.jsx(Te.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},transition:{duration:.2},className:"overflow-hidden",children:w.jsx("div",{className:"rounded-xl p-4 mt-2",style:{background:"linear-gradient(135deg, rgba(239,68,68,0.03), rgba(239,68,68,0.01))",border:"1px solid rgba(239,68,68,0.08)"},children:j?w.jsxs("div",{children:[w.jsxs("div",{className:"flex items-center justify-between mb-2",children:[w.jsxs("div",{className:"flex items-center gap-2",children:[w.jsx(rf,{size:14,className:"text-red-400"}),w.jsx("span",{className:"text-xs font-bold text-red-400/80",children:"Clave Privada"})]}),w.jsxs("button",{onClick:()=>R(!D),className:"flex items-center gap-1.5 px-2 py-1 rounded-lg text-[10px] font-semibold text-red-400/60 hover:text-red-400 transition-colors",style:{background:"rgba(239,68,68,0.06)"},children:[D?w.jsx(sv,{size:10}):w.jsx(iv,{size:10}),D?"Ocultar":"Mostrar"]})]}),D&&w.jsxs("div",{className:"flex items-center gap-2",children:[w.jsx("code",{className:"flex-1 text-[10px] text-red-400/70 font-mono break-all bg-black/20 rounded-lg p-2",children:Pe}),w.jsx("button",{onClick:()=>Tc(Pe),className:"p-2 rounded-lg hover:bg-red-400/10",children:w.jsx(za,{size:12,className:"text-red-400/50"})})]}),w.jsx("p",{className:"text-[9px] text-red-400/30 mt-2",children:" Nunca compartas tu clave privada."})]}):w.jsxs("div",{children:[w.jsx("p",{className:"text-[10px] text-[var(--text-dim)] mb-3",children:"Ingresa tu contrasea para acceder a la clave privada."}),w.jsxs("div",{className:"flex items-center gap-2",children:[w.jsx("input",{type:"password",value:C,onChange:se=>{k(se.target.value),A("")},onKeyDown:se=>se.key==="Enter"&&kc(),placeholder:"Contrasea",className:"flex-1 bg-black/30 border border-white/10 rounded-lg px-3 py-2 text-xs text-white placeholder-white/20 focus:outline-none focus:border-[var(--gold)]/40"}),w.jsx("button",{onClick:kc,disabled:B||!C,className:"px-4 py-2 rounded-lg text-xs font-semibold transition-all disabled:opacity-30",style:{background:"rgba(239,68,68,0.15)",color:"rgba(239,68,68,0.8)"},children:B?w.jsx(_s,{size:12,className:"animate-spin"}):"Verificar"})]}),I&&w.jsx("p",{className:"text-[10px] text-red-400 mt-2",children:I})]})})})})]}),w.jsxs("div",{className:"grid grid-cols-2 gap-2.5",children:[w.jsxs("a",{href:"https://kairos-wallet.netlify.app",target:"_blank",rel:"noopener noreferrer",className:"rounded-xl p-4 text-left transition-all hover:scale-[1.02] block",style:{background:"rgba(59,130,246,0.05)",border:"1px solid rgba(59,130,246,0.1)"},children:[w.jsx(ro,{size:20,className:"text-[var(--gold)] mb-2"}),w.jsx("p",{className:"text-xs font-bold",children:"Kairos Wallet"}),w.jsx("p",{className:"text-[10px] text-[var(--text-dim)] mt-0.5",children:"Swap, Bridge, Staking, NFTs, WalletConnect"})]}),w.jsxs("a",{href:`${ds[0].explorer}/address/${e}`,target:"_blank",rel:"noopener noreferrer",className:"rounded-xl p-4 text-left transition-all hover:scale-[1.02] block",style:{background:"rgba(240,185,11,0.04)",border:"1px solid rgba(240,185,11,0.1)"},children:[w.jsx(Cl,{size:20,className:"text-amber-400 mb-2"}),w.jsx("p",{className:"text-xs font-bold",children:"BSCScan"}),w.jsx("p",{className:"text-[10px] text-[var(--text-dim)] mt-0.5",children:"Ver todas las transacciones on-chain"})]})]}),w.jsx(Ys,{children:q&&w.jsx(Te.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/70 backdrop-blur-sm z-50 flex items-center justify-center p-4",children:w.jsxs(Te.div,{initial:{scale:.95,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.95,opacity:0},className:"w-full max-w-md rounded-2xl p-6",style:{background:"var(--bg-card)",border:"1px solid rgba(212,175,55,0.2)"},children:[w.jsxs("div",{className:"flex items-center justify-between mb-5",children:[w.jsxs("h3",{className:"text-lg font-bold flex items-center gap-2",children:[w.jsx(ll,{size:18,className:"text-[var(--gold)]"}),"Importar Wallet a Kairos"]}),w.jsx("button",{onClick:()=>{Y(!1),Q(""),te("")},className:"p-1 rounded-lg hover:bg-white/10",children:w.jsx(qo,{size:18})})]}),w.jsx("p",{className:"text-xs text-[var(--text-dim)] mb-4 leading-relaxed",children:"Pega tu clave privada para vincular tu wallet existente como wallet nativa de Kairos. La PK se encripta y almacena de forma segura en tu dispositivo."}),w.jsxs("div",{className:"mb-3",children:[w.jsx("label",{className:"text-[10px] text-[var(--text-dim)] uppercase tracking-wider mb-1 block",children:"Private Key"}),w.jsx("input",{type:"password",value:J,onChange:se=>{Q(se.target.value),te("")},placeholder:"0x...",className:"w-full px-4 py-3 rounded-xl text-sm bg-white/5 border border-white/10 focus:border-[var(--gold)] focus:outline-none font-mono"})]}),ae&&w.jsxs("div",{className:"flex items-center gap-2 text-xs text-red-400 mb-3",children:[w.jsx(rf,{size:12})," ",ae]}),w.jsxs("div",{className:"flex items-center gap-2 text-[10px] text-amber-400/80 mb-4 p-2 rounded-lg",style:{background:"rgba(255,191,0,0.06)"},children:[w.jsx(Ia,{size:12,className:"flex-shrink-0"}),w.jsx("span",{children:"Tu PK nunca se enva a ningn servidor. Se encripta localmente en tu navegador."})]}),w.jsx("button",{onClick:Uc,disabled:re||!J.trim(),className:"w-full py-3 rounded-xl text-sm font-bold text-black transition-all hover:brightness-110 disabled:opacity-50 flex items-center justify-center gap-2",style:{background:"linear-gradient(135deg, #D4AF37, #B8972E)"},children:re?w.jsxs(w.Fragment,{children:[w.jsx(_s,{size:16,className:"animate-spin"})," Importando..."]}):w.jsxs(w.Fragment,{children:[w.jsx(ro,{size:16})," Importar y Vincular"]})})]})})}),w.jsx(Ys,{children:d&&w.jsx(QU,{chains:ds,walletAddress:e,privateKey:Pe,onClose:()=>p(!1),onSuccess:Bt})}),w.jsx(Ys,{children:g&&w.jsx(WU,{walletAddress:e,onClose:()=>m(!1)})}),w.jsx(Ys,{children:E&&w.jsx(JU,{history:x,loading:v,walletAddress:e,onClose:()=>O(!1)})})]}):w.jsx("div",{className:"flex-1 flex items-center justify-center",children:w.jsxs("div",{className:"text-center p-8 max-w-sm",children:[w.jsx("div",{className:"w-16 h-16 rounded-2xl bg-[var(--gold)]/10 flex items-center justify-center mx-auto mb-4",children:w.jsx(ro,{size:28,className:"text-[var(--gold)]"})}),w.jsx("h2",{className:"text-lg font-bold mb-2",children:"Configura tu Wallet"}),w.jsx("p",{className:"text-sm text-[var(--text-dim)] mb-6",children:"Tu wallet KAIROS te permite recibir, enviar y operar con KAIROS en mltiples blockchains de forma segura."}),w.jsx("button",{onClick:$c,disabled:sa,className:"w-full py-3 rounded-xl text-sm font-bold text-black transition-all hover:brightness-110 disabled:opacity-50 flex items-center justify-center gap-2",style:{background:"linear-gradient(135deg, #D4AF37, #B8972E)"},children:sa?w.jsxs(w.Fragment,{children:[w.jsx(_s,{size:16,className:"animate-spin"})," Generando..."]}):w.jsxs(w.Fragment,{children:[w.jsx(ro,{size:16})," Generar Mi Wallet"]})}),w.jsx("p",{className:"text-[10px] text-[var(--text-dim)] mt-3",children:"Se crear una wallet segura con clave privada encriptada en tu dispositivo."})]})})}function QU({chains:r,walletAddress:e,privateKey:t,onClose:n,onSuccess:s}){const[i,o]=ie.useState(r[0]),[a,c]=ie.useState(""),[l,u]=ie.useState(""),[h,f]=ie.useState(!1),[d,p]=ie.useState(null),[g,m]=ie.useState(""),E=async()=>{if(m(""),!a||!vv(a)){m("Direccin invlida");return}if(!l||parseFloat(l)<=0){m("Ingresa un monto vlido");return}if(!t){m("No se encontr la clave privada");return}f(!0);try{const O=await HU(i,t,a,l);p(O.hash),s==null||s()}catch(O){m(O.reason||O.message||"Error al enviar transaccin")}finally{f(!1)}};return w.jsx(Te.div,{className:"fixed inset-0 z-[60] flex items-center justify-center px-4",style:{background:"rgba(0,0,0,0.7)",backdropFilter:"blur(10px)"},initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},children:w.jsxs(Te.div,{className:"w-full max-w-md rounded-2xl p-6",style:{background:"var(--surface)",border:"1px solid var(--border)"},initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},children:[w.jsxs("div",{className:"flex items-center justify-between mb-5",children:[w.jsxs("h3",{className:"text-lg font-bold flex items-center gap-2",children:[w.jsx(tf,{size:18,className:"text-[var(--gold)]"}),"Enviar KAIROS"]}),w.jsx("button",{onClick:n,className:"p-1.5 rounded-lg hover:bg-white/5",children:w.jsx(qo,{size:16})})]}),d?w.jsxs("div",{className:"text-center py-6",children:[w.jsx("div",{className:"w-16 h-16 rounded-full bg-green-500/15 flex items-center justify-center mx-auto mb-4",children:w.jsx(du,{size:28,className:"text-green-400"})}),w.jsx("h4",{className:"text-lg font-bold text-white mb-2",children:"Transaccin Enviada!"}),w.jsxs("p",{className:"text-xs text-[var(--text-dim)] mb-4",children:["Tu transaccin est siendo procesada en ",i.name]}),w.jsxs("a",{href:`${i.explorer}/tx/${d}`,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-1.5 px-4 py-2 rounded-xl text-xs font-semibold text-[var(--gold)] hover:bg-[var(--gold)]/10 transition-colors",style:{border:"1px solid rgba(59,130,246,0.15)"},children:["Ver en Explorer ",w.jsx(Td,{size:12})]}),w.jsx("button",{onClick:n,className:"block w-full mt-4 py-3 rounded-xl text-sm font-bold text-white",style:{background:"linear-gradient(135deg, #3B82F6, #2563EB)"},children:"Cerrar"})]}):w.jsxs("div",{className:"space-y-4",children:[w.jsxs("div",{children:[w.jsx("label",{className:"text-[10px] font-bold text-[var(--text-dim)] uppercase tracking-wider mb-1.5 block",children:"Red"}),w.jsx("div",{className:"grid grid-cols-4 gap-1.5",children:r.map(O=>w.jsx("button",{onClick:()=>o(O),className:"flex items-center justify-center gap-1 py-2 rounded-lg text-[11px] font-bold transition-all",style:{background:i.id===O.id?`${O.color}20`:"rgba(255,255,255,0.03)",border:`1px solid ${i.id===O.id?O.color+"40":"rgba(255,255,255,0.06)"}`,color:i.id===O.id?O.color:"var(--text-dim)"},children:O.short},O.id))})]}),w.jsxs("div",{children:[w.jsx("label",{className:"text-[10px] font-bold text-[var(--text-dim)] uppercase tracking-wider mb-1.5 block",children:"Direccin destino"}),w.jsx("input",{type:"text",value:a,onChange:O=>c(O.target.value),placeholder:"0x...",className:"w-full px-4 py-3 rounded-xl text-sm font-mono outline-none transition-all focus:ring-2 focus:ring-[var(--gold)]/30",style:{background:"rgba(255,255,255,0.04)",border:"1px solid rgba(255,255,255,0.08)"}})]}),w.jsxs("div",{children:[w.jsx("label",{className:"text-[10px] font-bold text-[var(--text-dim)] uppercase tracking-wider mb-1.5 block",children:"Cantidad KAIROS"}),w.jsx("input",{type:"number",value:l,onChange:O=>u(O.target.value),placeholder:"0.00",className:"w-full px-4 py-3 rounded-xl text-sm outline-none transition-all focus:ring-2 focus:ring-[var(--gold)]/30",style:{background:"rgba(255,255,255,0.04)",border:"1px solid rgba(255,255,255,0.08)"}})]}),g&&w.jsxs("div",{className:"flex items-center gap-2 px-3 py-2 rounded-xl text-xs text-red-400",style:{background:"rgba(239,68,68,0.08)",border:"1px solid rgba(239,68,68,0.15)"},children:[w.jsx(rf,{size:12}),typeof g=="string"?g:String(g)]}),w.jsx("button",{onClick:E,disabled:h,className:"w-full py-3.5 rounded-xl text-sm font-bold text-white transition-all hover:scale-[1.01] disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2",style:{background:"linear-gradient(135deg, #3B82F6, #2563EB)",boxShadow:"0 4px 20px rgba(59,130,246,0.2)"},children:h?w.jsxs(w.Fragment,{children:[w.jsx(_s,{size:16,className:"animate-spin"})," Enviando..."]}):w.jsxs(w.Fragment,{children:[w.jsx(tf,{size:16})," Enviar ",l?`${l} KAIROS`:"KAIROS"]})}),w.jsxs("p",{className:"text-[9px] text-[var(--text-dim)]/50 text-center",children:["Necesitas ",i.nativeSymbol," en ",i.name," para pagar el gas"]})]})]})})}function WU({walletAddress:r,onClose:e}){const[t,n]=ie.useState(!1),s=async()=>{try{await navigator.clipboard.writeText(r),n(!0),setTimeout(()=>n(!1),2e3)}catch{}};return w.jsx(Te.div,{className:"fixed inset-0 z-[60] flex items-center justify-center px-4",style:{background:"rgba(0,0,0,0.7)",backdropFilter:"blur(10px)"},initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},children:w.jsxs(Te.div,{className:"w-full max-w-sm rounded-2xl p-6 text-center",style:{background:"var(--surface)",border:"1px solid var(--border)"},initial:{scale:.9},animate:{scale:1},exit:{scale:.9},children:[w.jsxs("div",{className:"flex items-center justify-between mb-5",children:[w.jsxs("h3",{className:"text-lg font-bold flex items-center gap-2",children:[w.jsx(ll,{size:18,className:"text-green-400"}),"Recibir KAIROS"]}),w.jsx("button",{onClick:e,className:"p-1.5 rounded-lg hover:bg-white/5",children:w.jsx(qo,{size:16})})]}),w.jsxs("div",{className:"w-48 h-48 rounded-2xl mx-auto mb-4 flex items-center justify-center relative overflow-hidden",style:{background:"white"},children:[w.jsx("div",{className:"absolute inset-2 grid grid-cols-8 gap-[2px]",children:Array.from({length:64}).map((i,o)=>{const c=((r.charCodeAt(o*3%r.length)||0)+o)%3!==0;return w.jsx("div",{className:"rounded-[1px]",style:{background:c?"#000":"#fff"}},o)})}),w.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:w.jsx("div",{className:"w-10 h-10 rounded-lg bg-white flex items-center justify-center shadow-md",children:w.jsx("span",{className:"text-sm font-black text-blue-600",children:"K"})})})]}),w.jsx("p",{className:"text-[10px] text-[var(--text-dim)] mb-3",children:"Enva KAIROS a esta direccin en cualquier chain soportada"}),w.jsxs("button",{onClick:s,className:"w-full flex items-center justify-center gap-2 px-4 py-3 rounded-xl text-sm font-mono transition-all hover:bg-white/5",style:{background:"rgba(255,255,255,0.04)",border:"1px solid rgba(255,255,255,0.08)"},children:[w.jsx("span",{className:"truncate",children:r}),t?w.jsx(du,{size:14,className:"text-green-400 shrink-0"}):w.jsx(za,{size:14,className:"text-[var(--text-dim)] shrink-0"})]}),w.jsx("div",{className:"flex justify-center gap-2 mt-4",children:ds.map(i=>w.jsx("div",{className:"px-2 py-1 rounded-md text-[9px] font-bold",style:{background:`${i.color}15`,color:i.color},children:i.short},i.id))})]})})}function JU({history:r,loading:e,walletAddress:t,onClose:n}){return w.jsx(Te.div,{className:"fixed inset-0 z-[60] flex items-center justify-center px-4",style:{background:"rgba(0,0,0,0.7)",backdropFilter:"blur(10px)"},initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},children:w.jsxs(Te.div,{className:"w-full max-w-lg rounded-2xl overflow-hidden",style:{background:"var(--surface)",border:"1px solid var(--border)",maxHeight:"80vh"},initial:{scale:.9},animate:{scale:1},exit:{scale:.9},children:[w.jsxs("div",{className:"flex items-center justify-between p-5",style:{borderBottom:"1px solid var(--border)"},children:[w.jsxs("h3",{className:"text-lg font-bold flex items-center gap-2",children:[w.jsx(Cl,{size:18,className:"text-[var(--gold)]"}),"Historial KAIROS"]}),w.jsx("button",{onClick:n,className:"p-1.5 rounded-lg hover:bg-white/5",children:w.jsx(qo,{size:16})})]}),w.jsxs("div",{className:"overflow-y-auto p-4 space-y-2",style:{maxHeight:"calc(80vh - 70px)"},children:[e&&w.jsxs("div",{className:"py-8 text-center",children:[w.jsx(_s,{size:24,className:"animate-spin text-[var(--gold)] mx-auto mb-2"}),w.jsx("p",{className:"text-xs text-[var(--text-dim)]",children:"Cargando transacciones..."})]}),!e&&r.length===0&&w.jsxs("div",{className:"py-8 text-center",children:[w.jsx(Cl,{size:32,className:"text-[var(--text-dim)]/30 mx-auto mb-2"}),w.jsx("p",{className:"text-sm text-[var(--text-dim)]",children:"No hay transacciones an"})]}),!e&&r.map((s,i)=>{const o=ds.find(a=>a.id===s.chainId)||ds[0];return w.jsxs("a",{href:`${o.explorer}/tx/${s.hash}`,target:"_blank",rel:"noopener noreferrer",className:"flex items-center justify-between p-3 rounded-xl transition-all hover:bg-white/[0.03]",style:{border:"1px solid rgba(255,255,255,0.04)"},children:[w.jsxs("div",{className:"flex items-center gap-3",children:[w.jsx("div",{className:"w-9 h-9 rounded-xl flex items-center justify-center",style:{background:s.isIncoming?"rgba(0,220,130,0.1)":"rgba(59,130,246,0.1)"},children:s.isIncoming?w.jsx(ov,{size:16,className:"text-green-400"}):w.jsx(av,{size:16,className:"text-blue-400"})}),w.jsxs("div",{children:[w.jsxs("p",{className:"text-xs font-bold",children:[s.isIncoming?"Recibido":"Enviado",w.jsx("span",{className:"ml-1.5 text-[9px] font-semibold px-1.5 py-0.5 rounded",style:{background:`${o.color}15`,color:o.color},children:o.short})]}),w.jsx("p",{className:"text-[10px] text-[var(--text-dim)] font-mono",children:s.isIncoming?`de ${Pd(s.from)}`:`a ${Pd(s.to)}`})]})]}),w.jsxs("div",{className:"text-right",children:[w.jsxs("p",{className:`text-xs font-bold ${s.isIncoming?"text-green-400":"text-white"}`,children:[s.isIncoming?"+":"-",Pa(s.value)," KAIROS"]}),w.jsx("p",{className:"text-[9px] text-[var(--text-dim)]",children:new Date(s.timestamp).toLocaleDateString("es",{day:"2-digit",month:"short",hour:"2-digit",minute:"2-digit"})})]})]},`${s.hash}-${i}`)})]})]})})}export{U$ as default};
//# sourceMappingURL=WalletPage-iuCayP3S.js.map
