import{j as e,m as I,L as we,B as Y,P as Q,a as V,Z as W,b as _,c as X,H as ke,W as te,S as Se,d as Pe,C as Ce,e as Te,T as ae,f as be,g as Ae,h as Be,i as fe,A as ce,D as je,k as de,l as $e,n as Ee,o as Z,p as se,q as re,r as H,s as Ie,t as De,u as ee,E as Fe,v as Re,w as Le,X as Me,x as Oe,y as ze,z as _e,R as qe,F as Ke,K as Ue,G as He,I as Ve}from"./ui-DSFL7ick.js";import{b as We,g as Ge,c as Je,a as g,R as Xe,B as Ye}from"./vendor-CUCP814w.js";import{V as Qe,a as Ze,I as et}from"./charts-UjLl1g-4.js";(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))a(n);new MutationObserver(n=>{for(const r of n)if(r.type==="childList")for(const i of r.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&a(i)}).observe(document,{childList:!0,subtree:!0});function t(n){const r={};return n.integrity&&(r.integrity=n.integrity),n.referrerPolicy&&(r.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?r.credentials="include":n.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function a(n){if(n.ep)return;n.ep=!0;const r=t(n);fetch(n.href,r)}})();var G={},xe;function tt(){if(xe)return G;xe=1;var c=We();return G.createRoot=c.createRoot,G.hydrateRoot=c.hydrateRoot,G}var st=tt();const at=Ge(st),U={binance:{id:"binance",name:"Binance",logo:"üü°",baseUrl:"https://api.binance.com",wsUrl:"wss://stream.binance.com:9443/ws",supportedMarkets:["spot","futures"],requiredFields:["apiKey","apiSecret"]},bybit:{id:"bybit",name:"Bybit",logo:"üü†",baseUrl:"https://api.bybit.com",wsUrl:"wss://stream.bybit.com/v5/public/spot",supportedMarkets:["spot","futures","options"],requiredFields:["apiKey","apiSecret"]},kraken:{id:"kraken",name:"Kraken",logo:"üü£",baseUrl:"https://api.kraken.com",wsUrl:"wss://ws.kraken.com",supportedMarkets:["spot","futures"],requiredFields:["apiKey","apiSecret"]},coinbase:{id:"coinbase",name:"Coinbase",logo:"üîµ",baseUrl:"https://api.coinbase.com",wsUrl:"wss://ws-feed.exchange.coinbase.com",supportedMarkets:["spot"],requiredFields:["apiKey","apiSecret","passphrase"]},kucoin:{id:"kucoin",name:"KuCoin",logo:"üü¢",baseUrl:"https://api.kucoin.com",wsUrl:"wss://ws-api.kucoin.com",supportedMarkets:["spot","futures"],requiredFields:["apiKey","apiSecret","passphrase"]},okx:{id:"okx",name:"OKX",logo:"‚ö´",baseUrl:"https://www.okx.com",wsUrl:"wss://ws.okx.com:8443/ws/v5/public",supportedMarkets:["spot","futures","options"],requiredFields:["apiKey","apiSecret","passphrase"]}},ie=["BTCUSDT","ETHUSDT","BNBUSDT","SOLUSDT","XRPUSDT","ADAUSDT","DOGEUSDT","AVAXUSDT","DOTUSDT","MATICUSDT","LINKUSDT","ATOMUSDT","LTCUSDT","UNIUSDT","AAVEUSDT"],ne=[{label:"1m",value:"1m",seconds:60},{label:"5m",value:"5m",seconds:300},{label:"15m",value:"15m",seconds:900},{label:"1H",value:"1h",seconds:3600},{label:"4H",value:"4h",seconds:14400},{label:"1D",value:"1d",seconds:86400},{label:"1W",value:"1w",seconds:604800}],E={AUTH:"kairos_trade_auth",BROKERS:"kairos_trade_brokers",BOTS:"kairos_trade_bots",SETTINGS:"kairos_trade_settings",STRATEGIES:"kairos_trade_strategies"},K=(c,s)=>{try{return JSON.parse(localStorage.getItem(c))||s}catch{return s}},z=(c,s)=>localStorage.setItem(c,JSON.stringify(s)),D=Je((c,s)=>({user:K(E.AUTH,null),isAuthenticated:!!K(E.AUTH,null),login:t=>{z(E.AUTH,t),c({user:t,isAuthenticated:!0})},logout:()=>{localStorage.removeItem(E.AUTH),c({user:null,isAuthenticated:!1})},currentPage:"dashboard",setPage:t=>c({currentPage:t}),brokers:K(E.BROKERS,[]),activeBroker:null,addBroker:t=>{const a={...t,id:Date.now().toString(36),apiKey:btoa(t.apiKey),apiSecret:btoa(t.apiSecret),passphrase:t.passphrase?btoa(t.passphrase):void 0,connected:!1,addedAt:new Date().toISOString()},n=[...s().brokers,a];return z(E.BROKERS,n),c({brokers:n}),a},removeBroker:t=>{var n;const a=s().brokers.filter(r=>r.id!==t);z(E.BROKERS,a),c({brokers:a,activeBroker:((n=s().activeBroker)==null?void 0:n.id)===t?null:s().activeBroker})},setActiveBroker:t=>c({activeBroker:t}),updateBrokerStatus:(t,a)=>{const n=s().brokers.map(r=>r.id===t?{...r,connected:a}:r);z(E.BROKERS,n),c({brokers:n})},bots:K(E.BOTS,[]),addBot:t=>{const a={...t,id:Date.now().toString(36),status:"stopped",trades:0,pnl:0,winRate:0,createdAt:new Date().toISOString()},n=[...s().bots,a];return z(E.BOTS,n),c({bots:n}),a},updateBot:(t,a)=>{const n=s().bots.map(r=>r.id===t?{...r,...a}:r);z(E.BOTS,n),c({bots:n})},removeBot:t=>{const a=s().bots.filter(n=>n.id!==t);z(E.BOTS,a),c({bots:a})},selectedPair:"BTCUSDT",selectedTimeframe:"1h",currentPrice:null,priceChange24h:null,orderBook:{bids:[],asks:[]},positions:[],orders:[],tradeHistory:[],setSelectedPair:t=>c({selectedPair:t}),setSelectedTimeframe:t=>c({selectedTimeframe:t}),setCurrentPrice:t=>c({currentPrice:t}),setPriceChange24h:t=>c({priceChange24h:t}),setOrderBook:t=>c({orderBook:t}),addPosition:t=>c({positions:[...s().positions,{...t,id:Date.now().toString(36)}]}),closePosition:t=>{const a=s().positions.find(n=>n.id===t);a&&c({positions:s().positions.filter(n=>n.id!==t),tradeHistory:[...s().tradeHistory,{...a,closedAt:new Date().toISOString()}]})},addOrder:t=>c({orders:[...s().orders,{...t,id:Date.now().toString(36)}]}),cancelOrder:t=>c({orders:s().orders.filter(a=>a.id!==t)}),strategies:K(E.STRATEGIES,[]),addStrategy:t=>{const a={...t,id:Date.now().toString(36),createdAt:new Date().toISOString()},n=[...s().strategies,a];return z(E.STRATEGIES,n),c({strategies:n}),a},removeStrategy:t=>{const a=s().strategies.filter(n=>n.id!==t);z(E.STRATEGIES,a),c({strategies:a})},aiMessages:[],aiLoading:!1,addAiMessage:t=>c({aiMessages:[...s().aiMessages,t]}),setAiLoading:t=>c({aiLoading:t}),clearAiMessages:()=>c({aiMessages:[]}),settings:K(E.SETTINGS,{theme:"dark",language:"es",notifications:!0,soundAlerts:!0,maxRiskPerTrade:2,defaultLeverage:1}),updateSettings:t=>{const a={...s().settings,...t};z(E.SETTINGS,a),c({settings:a})},sidebarOpen:!0,aiPanelOpen:!1,modalOpen:null,toggleSidebar:()=>c({sidebarOpen:!s().sidebarOpen}),toggleAiPanel:()=>c({aiPanelOpen:!s().aiPanelOpen}),setModal:t=>c({modalOpen:t})})),rt=[{id:"dashboard",icon:we,label:"Dashboard"},{id:"chart",icon:Y,label:"Trading"},{id:"simulator",icon:Q,label:"Simulador"},{id:"bots",icon:V,label:"Bots"},{id:"strategies",icon:W,label:"Estrategias"}],it=[{id:"ai",icon:_,label:"Kairos AI"},{id:"brokers",icon:X,label:"Brokers"},{id:"history",icon:ke,label:"Historial"}],nt=[{id:"wallet",icon:te,label:"Wallet"},{id:"settings",icon:Se,label:"Ajustes"}];function ot(){const{currentPage:c,setPage:s,sidebarOpen:t,toggleSidebar:a,bots:n,brokers:r,logout:i}=D(),o=n.filter(u=>u.status==="active").length,m=r.filter(u=>u.connected).length,p=u=>u==="bots"?o:u==="brokers"?m:0,l=({item:u})=>{const N=u.icon,h=c===u.id,j=p(u.id);return e.jsxs("button",{onClick:()=>s(u.id),title:t?void 0:u.label,className:`w-full flex items-center gap-3 rounded-lg transition-all duration-150 relative group
          ${t?"px-3 py-2.5":"px-0 py-2.5 justify-center"}
          ${h?"bg-[var(--gold)]/10 text-[var(--gold)]":"text-[var(--text-dim)] hover:text-[var(--text)] hover:bg-white/[0.04]"}`,children:[h&&e.jsx(I.div,{layoutId:"activeIndicator",className:"absolute left-0 top-1/2 -translate-y-1/2 w-[3px] h-5 bg-[var(--gold)] rounded-r-full",transition:{type:"spring",stiffness:300,damping:30}}),e.jsx(N,{size:18,strokeWidth:h?2:1.5,className:"shrink-0"}),t&&e.jsx("span",{className:`text-[13px] truncate ${h?"font-semibold":"font-normal"}`,children:u.label}),j>0&&t&&e.jsx("span",{className:"ml-auto text-[10px] font-medium bg-[var(--gold)]/15 text-[var(--gold)] rounded-full px-1.5 py-0.5 min-w-[20px] text-center",children:j}),j>0&&!t&&e.jsx("span",{className:"absolute top-1 right-1 w-2 h-2 bg-[var(--gold)] rounded-full"})]})},v=({label:u})=>t?e.jsx("p",{className:"text-[10px] font-semibold text-[var(--text-dim)]/60 uppercase tracking-wider px-3 mb-1 mt-1",children:u}):e.jsx("div",{className:"mx-auto w-5 h-px bg-[var(--border)] my-1.5"});return e.jsxs(I.aside,{animate:{width:t?240:60},transition:{duration:.2,ease:"easeInOut"},className:"h-full flex flex-col bg-[var(--dark-2)] relative shrink-0",style:{borderRight:"1px solid var(--border)"},children:[e.jsxs("div",{className:`flex items-center gap-2.5 h-[52px] shrink-0 ${t?"px-4":"justify-center"}`,style:{borderBottom:"1px solid var(--border)"},children:[e.jsx("div",{className:"w-8 h-8 rounded-lg bg-[var(--gold)] flex items-center justify-center shrink-0",children:e.jsx("span",{className:"text-white font-bold text-sm",children:"K"})}),t&&e.jsx(I.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.1},children:e.jsxs("div",{className:"flex items-baseline gap-1.5",children:[e.jsx("span",{className:"text-sm font-bold text-[var(--text)] tracking-wide",children:"KAIROS"}),e.jsx("span",{className:"text-[10px] font-medium text-[var(--gold)]",children:"TRADE"})]})})]}),e.jsxs("nav",{className:`flex-1 overflow-y-auto py-3 space-y-0.5 ${t?"px-2":"px-1.5"}`,children:[e.jsx(v,{label:"Principal"}),rt.map(u=>e.jsx(l,{item:u},u.id)),e.jsxs("div",{className:"pt-2",children:[e.jsx(v,{label:"Herramientas"}),it.map(u=>e.jsx(l,{item:u},u.id))]})]}),e.jsxs("div",{className:`py-2 space-y-0.5 ${t?"px-2":"px-1.5"}`,style:{borderTop:"1px solid var(--border)"},children:[nt.map(u=>e.jsx(l,{item:u},u.id)),e.jsxs("button",{onClick:i,title:t?void 0:"Salir",className:`w-full flex items-center gap-3 rounded-lg text-[var(--text-dim)] hover:text-[var(--red)] hover:bg-[var(--red)]/5 transition-all duration-150
            ${t?"px-3 py-2.5":"px-0 py-2.5 justify-center"}`,children:[e.jsx(Pe,{size:18,strokeWidth:1.5,className:"shrink-0"}),t&&e.jsx("span",{className:"text-[13px]",children:"Salir"})]})]}),e.jsx("button",{onClick:a,className:"absolute -right-3 top-6 w-6 h-6 bg-[var(--dark-3)] border border-[var(--border)] rounded-full flex items-center justify-center text-[var(--text-dim)] hover:text-[var(--text)] hover:bg-[var(--dark-4)] transition-all z-10",children:t?e.jsx(Ce,{size:11}):e.jsx(Te,{size:11})})]})}function lt(){const{selectedPair:c,currentPrice:s,priceChange24h:t,toggleAiPanel:a,aiPanelOpen:n,brokers:r}=D(),i=r.some(o=>o.connected);return e.jsxs("header",{className:"h-[52px] shrink-0 flex items-center justify-between px-4",style:{borderBottom:"1px solid var(--border)"},children:[e.jsx("div",{className:"flex items-center gap-5",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("h2",{className:"text-[15px] font-bold text-[var(--text)] tracking-wide",children:c}),s&&e.jsxs("span",{className:"text-[15px] font-mono font-semibold text-[var(--text)]",children:["$",s.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})]}),t!==null&&e.jsxs("div",{className:`flex items-center gap-0.5 text-xs font-mono px-2 py-0.5 rounded ${t>=0?"text-[var(--green)] bg-[var(--green)]/8":"text-[var(--red)] bg-[var(--red)]/8"}`,children:[t>=0?e.jsx(ae,{size:12}):e.jsx(be,{size:12}),t>=0?"+":"",t==null?void 0:t.toFixed(2),"%"]})]})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:`flex items-center gap-1.5 text-xs px-2.5 py-1 rounded-md ${i?"text-[var(--green)] bg-[var(--green)]/8":"text-[var(--text-dim)] bg-white/[0.03]"}`,children:[i?e.jsx(Ae,{size:13}):e.jsx(Be,{size:13}),e.jsx("span",{className:"font-medium",children:i?"Conectado":"Sin broker"})]}),e.jsxs("button",{onClick:a,className:`flex items-center gap-1.5 px-2.5 py-1 rounded-md text-xs font-medium transition-all ${n?"bg-[var(--gold)]/12 text-[var(--gold)]":"text-[var(--text-dim)] hover:text-[var(--text)] hover:bg-white/[0.03]"}`,title:"Kairos AI",children:[e.jsx(_,{size:14}),e.jsx("span",{className:"hidden sm:inline",children:"AI"})]}),e.jsxs("button",{className:"p-1.5 rounded-md text-[var(--text-dim)] hover:text-[var(--text)] hover:bg-white/[0.03] transition-all relative",children:[e.jsx(fe,{size:16}),e.jsx("span",{className:"absolute top-0.5 right-0.5 w-1.5 h-1.5 bg-[var(--gold)] rounded-full"})]})]})]})}function ct(){const{login:c}=D(),[s,t]=g.useState(!0),[a,n]=g.useState({email:"",password:"",name:""}),[r,i]=g.useState(""),[o,m]=g.useState(!1),p=async l=>{if(l.preventDefault(),i(""),!a.email||!a.password){i("Completa todos los campos");return}if(!s&&!a.name){i("Ingresa tu nombre");return}m(!0),setTimeout(()=>{c({id:Date.now().toString(36),email:a.email,name:a.name||a.email.split("@")[0],plan:"free",createdAt:new Date().toISOString()}),m(!1)},800)};return e.jsx("div",{className:"min-h-screen bg-[var(--dark)] flex items-center justify-center p-4",children:e.jsxs(I.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"w-full max-w-md",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("div",{className:"w-16 h-16 rounded-2xl bg-[var(--gold)] flex items-center justify-center text-white font-bold text-2xl mx-auto mb-4",children:"K"}),e.jsxs("h1",{className:"text-2xl font-bold tracking-tight",children:[e.jsx("span",{className:"text-[var(--gold)]",children:"KAIROS"})," ",e.jsx("span",{className:"text-[var(--text)]",children:"TRADE"})]}),e.jsx("p",{className:"text-sm text-[var(--text-dim)] mt-1",children:"Trading automatizado con inteligencia artificial"})]}),e.jsxs("div",{className:"bg-[var(--dark-2)] border border-[var(--border)] rounded-2xl p-6",children:[e.jsxs("div",{className:"flex mb-6 bg-[var(--dark-3)] rounded-lg p-1",children:[e.jsx("button",{onClick:()=>t(!0),className:`flex-1 py-2 text-sm rounded-md transition-all ${s?"bg-[var(--gold)] text-white font-bold":"text-[var(--text-dim)]"}`,children:"Iniciar Sesi√≥n"}),e.jsx("button",{onClick:()=>t(!1),className:`flex-1 py-2 text-sm rounded-md transition-all ${s?"text-[var(--text-dim)]":"bg-[var(--gold)] text-white font-bold"}`,children:"Registrarse"})]}),e.jsxs("form",{onSubmit:p,className:"space-y-4",children:[!s&&e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-[var(--text-dim)] mb-1 block",children:"Nombre"}),e.jsx("input",{type:"text",value:a.name,onChange:l=>n({...a,name:l.target.value}),placeholder:"Tu nombre",className:"w-full"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-[var(--text-dim)] mb-1 block",children:"Email"}),e.jsx("input",{type:"email",value:a.email,onChange:l=>n({...a,email:l.target.value}),placeholder:"tu@email.com",className:"w-full"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-[var(--text-dim)] mb-1 block",children:"Contrase√±a"}),e.jsx("input",{type:"password",value:a.password,onChange:l=>n({...a,password:l.target.value}),placeholder:"‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢",className:"w-full"})]}),r&&e.jsx("p",{className:"text-xs text-[var(--red)]",children:r}),e.jsx("button",{type:"submit",disabled:o,className:"w-full py-3 bg-[var(--gold)] text-white font-bold rounded-xl hover:bg-[var(--gold-light)] transition-colors disabled:opacity-50",children:o?"Cargando...":s?"Entrar":"Crear Cuenta"})]}),e.jsxs("p",{className:"text-xs text-[var(--text-dim)] text-center mt-4",children:["Parte del ecosistema ",e.jsx("span",{className:"text-[var(--gold)] font-medium",children:"Kairos 777"})]})]})]})})}class dt{constructor(){this.ws=null,this.subscribers=new Map,this.reconnectAttempts=0,this.maxReconnect=5,this.candleCache=new Map}connectStream(s,t={}){const a=s.toLowerCase(),n=`wss://stream.binance.com:9443/ws/${a}@ticker/${a}@kline_1m`;return this.ws&&this.ws.close(),this.ws=new WebSocket(n),this.ws.onopen=()=>{var r;this.reconnectAttempts=0,(r=t.onConnect)==null||r.call(t)},this.ws.onmessage=r=>{var i,o;try{const m=JSON.parse(r.data);if(m.e==="24hrTicker"&&((i=t.onTicker)==null||i.call(t,{symbol:m.s,price:parseFloat(m.c),change:parseFloat(m.p),changePercent:parseFloat(m.P),high:parseFloat(m.h),low:parseFloat(m.l),volume:parseFloat(m.v),quoteVolume:parseFloat(m.q)})),m.e==="kline"){const p=m.k;(o=t.onCandle)==null||o.call(t,{time:Math.floor(p.t/1e3),open:parseFloat(p.o),high:parseFloat(p.h),low:parseFloat(p.l),close:parseFloat(p.c),volume:parseFloat(p.v),closed:p.x})}}catch(m){console.error("WS parse error:",m)}},this.ws.onerror=r=>{var i;console.error("WS error:",r),(i=t.onError)==null||i.call(t,r)},this.ws.onclose=()=>{var r;this.reconnectAttempts<this.maxReconnect&&(this.reconnectAttempts++,setTimeout(()=>this.connectStream(s,t),2e3*this.reconnectAttempts)),(r=t.onDisconnect)==null||r.call(t)},()=>this.disconnect()}disconnect(){this.ws&&(this.ws.close(),this.ws=null)}async getCandles(s,t="1h",a=500){const n=`${s}_${t}`;try{const r=`https://api.binance.com/api/v3/klines?symbol=${s}&interval=${t}&limit=${a}`,i=await fetch(r);if(!i.ok)throw new Error(`HTTP ${i.status}`);const m=(await i.json()).map(p=>({time:Math.floor(p[0]/1e3),open:parseFloat(p[1]),high:parseFloat(p[2]),low:parseFloat(p[3]),close:parseFloat(p[4]),volume:parseFloat(p[5])}));return this.candleCache.set(n,{data:m,ts:Date.now()}),m}catch(r){const i=this.candleCache.get(n);if(i)return i.data;throw r}}async getPrice(s){const a=await(await fetch(`https://api.binance.com/api/v3/ticker/price?symbol=${s}`)).json();return parseFloat(a.price)}async get24hrTicker(s){const a=await(await fetch(`https://api.binance.com/api/v3/ticker/24hr?symbol=${s}`)).json();return{symbol:a.symbol,price:parseFloat(a.lastPrice),change:parseFloat(a.priceChange),changePercent:parseFloat(a.priceChangePercent),high:parseFloat(a.highPrice),low:parseFloat(a.lowPrice),volume:parseFloat(a.volume),quoteVolume:parseFloat(a.quoteVolume)}}async getOrderBook(s,t=20){const n=await(await fetch(`https://api.binance.com/api/v3/depth?symbol=${s}&limit=${t}`)).json();return{bids:n.bids.map(([r,i])=>({price:parseFloat(r),quantity:parseFloat(i)})),asks:n.asks.map(([r,i])=>({price:parseFloat(r),quantity:parseFloat(i)}))}}async searchSymbols(s){const a=await(await fetch("https://api.binance.com/api/v3/exchangeInfo")).json(),n=s.toUpperCase();return a.symbols.filter(r=>r.status==="TRADING"&&(r.symbol.includes(n)||r.baseAsset.includes(n))).slice(0,20).map(r=>({symbol:r.symbol,base:r.baseAsset,quote:r.quoteAsset}))}}const R=new dt;function me(){const{setPage:c,bots:s,brokers:t,tradeHistory:a,positions:n}=D(),[r,i]=g.useState([]),[o,m]=g.useState(!0);g.useEffect(()=>{p();const h=setInterval(p,3e4);return()=>clearInterval(h)},[]);const p=async()=>{try{const h=["BTCUSDT","ETHUSDT","BNBUSDT","SOLUSDT","XRPUSDT","ADAUSDT"],j=await Promise.all(h.map(async y=>{try{return await R.get24hrTicker(y)}catch{return null}}));i(j.filter(Boolean))}catch(h){console.error("Dashboard load error:",h)}m(!1)},l=s.filter(h=>h.status==="active"),v=a.reduce((h,j)=>h+(j.pnl||0),0),u=t.filter(h=>h.connected),N=[{label:"Bots Activos",value:l.length,icon:V,color:"var(--gold)",action:"bots"},{label:"Brokers",value:`${u.length}/${t.length}`,icon:X,color:"var(--blue)",action:"brokers"},{label:"Posiciones",value:n.length,icon:ce,color:"var(--green)",action:"history"},{label:"P&L Total",value:`${v>=0?"+":""}$${v.toFixed(2)}`,icon:je,color:v>=0?"var(--green)":"var(--red)",action:"history"}];return e.jsxs("div",{className:"flex-1 overflow-y-auto p-6 space-y-6",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-bold tracking-tight",children:[e.jsx("span",{className:"text-[var(--gold)]",children:"Kairos"})," ",e.jsx("span",{className:"text-[var(--text)]",children:"Trade"})]}),e.jsx("p",{className:"text-sm text-[var(--text-dim)] mt-0.5",children:"Tu centro de control de trading automatizado"})]}),e.jsx("div",{className:"grid grid-cols-4 gap-4",children:N.map((h,j)=>{const y=h.icon;return e.jsxs(I.button,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:j*.05},onClick:()=>c(h.action),className:"bg-[var(--dark-2)] border border-[var(--border)] rounded-xl p-4 text-left hover:border-[var(--gold)]/20 transition-colors",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx(y,{size:20,style:{color:h.color}}),e.jsx(de,{size:14,className:"text-[var(--text-dim)]"})]}),e.jsx("p",{className:"text-2xl font-bold",style:{color:h.color},children:h.value}),e.jsx("p",{className:"text-xs text-[var(--text-dim)] mt-1",children:h.label})]},h.label)})}),e.jsx("div",{className:"grid grid-cols-3 gap-3",children:[{label:"Abrir Gr√°fico",icon:Y,page:"chart",desc:"Trading chart profesional"},{label:"Crear Bot",icon:V,page:"bots",desc:"Automatiza tu trading"},{label:"Kairos AI",icon:_,page:"ai",desc:"Asistente inteligente"},{label:"Conectar Broker",icon:X,page:"brokers",desc:"Vincula tu cuenta"},{label:"Estrategias",icon:W,page:"strategies",desc:"Crea y gestiona"},{label:"Historial",icon:ce,page:"history",desc:"Trades y rendimiento"}].map((h,j)=>{const y=h.icon;return e.jsxs(I.button,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.2+j*.05},onClick:()=>c(h.page),className:"bg-[var(--dark-2)] border border-[var(--border)] rounded-xl p-4 text-left hover:border-[var(--gold)]/20 transition-all group",children:[e.jsx(y,{size:24,className:"text-[var(--gold)] mb-2 group-hover:scale-110 transition-transform"}),e.jsx("p",{className:"text-sm font-bold",children:h.label}),e.jsx("p",{className:"text-xs text-[var(--text-dim)]",children:h.desc})]},h.label)})}),e.jsxs("div",{className:"bg-[var(--dark-2)] border border-[var(--border)] rounded-xl overflow-hidden",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-[var(--border)]",children:[e.jsx("h2",{className:"text-sm font-bold",children:"Mercado en Tiempo Real"}),e.jsx("button",{onClick:()=>c("chart"),className:"text-xs text-[var(--gold)] hover:underline",children:"Ver gr√°fico ‚Üí"})]}),e.jsx("div",{className:"divide-y divide-[var(--border)]",children:o?e.jsx("div",{className:"p-8 text-center text-sm text-[var(--text-dim)] animate-pulse",children:"Cargando mercado..."}):r.map(h=>e.jsxs("button",{onClick:()=>{D.getState().setSelectedPair(h.symbol),c("chart")},className:"w-full flex items-center justify-between p-3 hover:bg-[var(--dark-3)] transition-colors",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-[var(--dark-4)] flex items-center justify-center text-xs font-bold",children:h.symbol.replace("USDT","").slice(0,3)}),e.jsxs("div",{className:"text-left",children:[e.jsx("p",{className:"text-sm font-bold",children:h.symbol.replace("USDT","")}),e.jsx("p",{className:"text-xs text-[var(--text-dim)]",children:h.symbol})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("p",{className:"text-sm font-mono",children:["$",h.price.toLocaleString(void 0,{maximumFractionDigits:2})]}),e.jsxs("p",{className:`text-xs font-mono flex items-center gap-0.5 justify-end ${h.changePercent>=0?"text-[var(--green)]":"text-[var(--red)]"}`,children:[h.changePercent>=0?e.jsx(de,{size:10}):e.jsx($e,{size:10}),h.changePercent>=0?"+":"",h.changePercent.toFixed(2),"%"]})]})]},h.symbol))})]})]})}function q(c,s){const t=2/(s+1),a=[c[0]];for(let n=1;n<c.length;n++)a.push(c[n]*t+a[n-1]*(1-t));return a}function ye(c,s){const t=[];for(let a=0;a<c.length;a++){if(a<s-1){t.push(null);continue}const n=c.slice(a-s+1,a+1);t.push(n.reduce((r,i)=>r+i,0)/s)}return t}function pe(c,s=14){const t=new Array(s).fill(null);let a=0,n=0;for(let r=1;r<=s;r++){const i=c[r]-c[r-1];i>0?a+=i:n+=Math.abs(i)}a/=s,n/=s,t.push(n===0?100:100-100/(1+a/n));for(let r=s+1;r<c.length;r++){const i=c[r]-c[r-1];a=(a*(s-1)+(i>0?i:0))/s,n=(n*(s-1)+(i<0?Math.abs(i):0))/s,t.push(n===0?100:100-100/(1+a/n))}return t}function xt(c,s=12,t=26,a=9){const n=q(c,s),r=q(c,t),i=n.map((p,l)=>p-r[l]),o=q(i,a),m=i.map((p,l)=>p-o[l]);return{macd:i,signal:o,histogram:m}}function mt(c,s=20,t=2){const a=ye(c,s),n=[],r=[];for(let i=0;i<c.length;i++){if(i<s-1){n.push(null),r.push(null);continue}const o=c.slice(i-s+1,i+1),m=a[i],p=o.reduce((v,u)=>v+Math.pow(u-m,2),0)/s,l=Math.sqrt(p)*t;n.push(m+l),r.push(m-l)}return{upper:n,middle:a,lower:r}}function ue(c,s,t){if(t<1)return null;const a=c[t-1],n=c[t],r=s[t-1],i=s[t];return a<=r&&n>i?"bullish_cross":a>=r&&n<i?"bearish_cross":null}function pt(){const c=g.useRef(null),s=g.useRef(null),t=g.useRef(null),a=g.useRef(null),n=g.useRef([]),r=g.useRef(null),{selectedPair:i,selectedTimeframe:o,setSelectedPair:m,setSelectedTimeframe:p,setCurrentPrice:l,setPriceChange24h:v}=D(),[u,N]=g.useState(!0),[h,j]=g.useState(null),[y,S]=g.useState(!1),[T,d]=g.useState(""),[f,x]=g.useState(["ema20"]);g.useEffect(()=>{const b=c.current;if(!b)return;const A=b.getBoundingClientRect(),k=A.width||b.clientWidth||800,B=A.height||b.clientHeight||500,P=Qe(b,{width:k,height:B,layout:{background:{type:et.Solid,color:"#0B0E11"},textColor:"#848E9C",fontFamily:"Inter, sans-serif",fontSize:11},grid:{vertLines:{color:"#1E222D"},horzLines:{color:"#1E222D"}},crosshair:{mode:Ze.Normal,vertLine:{color:"#3B82F6",width:1,style:2,labelBackgroundColor:"#3B82F6"},horzLine:{color:"#3B82F6",width:1,style:2,labelBackgroundColor:"#3B82F6"}},timeScale:{borderColor:"#1E222D",timeVisible:!0,secondsVisible:!1,rightOffset:5,barSpacing:8},rightPriceScale:{borderColor:"#1E222D",scaleMargins:{top:.05,bottom:.2}},handleScroll:{mouseWheel:!0,pressedMouseMove:!0},handleScale:{axisPressedMouseMove:!0,mouseWheel:!0,pinch:!0}}),F=P.addCandlestickSeries({upColor:"#0ECB81",downColor:"#F6465D",borderUpColor:"#0ECB81",borderDownColor:"#F6465D",wickUpColor:"#0ECB81",wickDownColor:"#F6465D"}),C=P.addHistogramSeries({color:"#3B82F622",priceFormat:{type:"volume"},priceScaleId:"volume"});P.priceScale("volume").applyOptions({scaleMargins:{top:.8,bottom:0}}),s.current=P,t.current=F,a.current=C;const $=new ResizeObserver(O=>{if(!O||!O[0])return;const{width:oe,height:le}=O[0].contentRect;oe>0&&le>0&&P.applyOptions({width:oe,height:le})});return $.observe(b),()=>{$.disconnect(),P.remove(),s.current=null,t.current=null,a.current=null}},[]),g.useEffect(()=>{let b=!1;return(async()=>{N(!0),j(null);try{const[k,B]=await Promise.all([R.getCandles(i,o,500),R.get24hrTicker(i)]);if(b)return;if(!k||k.length===0){j("No se recibieron datos de Binance"),N(!1);return}t.current&&t.current.setData(k),a.current&&a.current.setData(k.map(P=>({time:P.time,value:P.volume||0,color:P.close>=P.open?"rgba(14,203,129,0.2)":"rgba(246,70,93,0.2)"}))),l(B.price),v(B.changePercent);try{w(k)}catch(P){console.warn("Indicator error (non-fatal):",P)}s.current&&s.current.timeScale().fitContent()}catch(k){console.error("Chart data load error:",k),b||j(`Error cargando datos: ${k.message}`)}b||N(!1)})(),r.current&&r.current(),r.current=R.connectStream(i,{onTicker:k=>{l(k.price),v(k.changePercent)},onCandle:k=>{t.current&&t.current.update(k),a.current&&a.current.update({time:k.time,value:k.volume||0,color:k.close>=k.open?"rgba(14,203,129,0.2)":"rgba(246,70,93,0.2)"})}}),()=>{b=!0,r.current&&(r.current(),r.current=null)}},[i,o]);const w=b=>{if(!s.current)return;n.current.forEach(B=>{var P;try{(P=s.current)==null||P.removeSeries(B)}catch{}}),n.current=[];const A=b.map(B=>B.close),k=b.map(B=>B.time);f.forEach(B=>{try{if(B==="ema20"){const F=q(A,20).map((C,$)=>C!=null&&isFinite(C)?{time:k[$],value:C}:null).filter(Boolean);if(F.length>0){const C=s.current.addLineSeries({color:"#3B82F6",lineWidth:1.5,title:"EMA 20",lastValueVisible:!1,priceLineVisible:!1});C.setData(F),n.current.push(C)}}if(B==="ema50"){const F=q(A,50).map((C,$)=>C!=null&&isFinite(C)?{time:k[$],value:C}:null).filter(Boolean);if(F.length>0){const C=s.current.addLineSeries({color:"#8B5CF6",lineWidth:1.5,title:"EMA 50",lastValueVisible:!1,priceLineVisible:!1});C.setData(F),n.current.push(C)}}if(B==="sma200"){const F=ye(A,200).map((C,$)=>C!=null&&isFinite(C)?{time:k[$],value:C}:null).filter(Boolean);if(F.length>0){const C=s.current.addLineSeries({color:"#FF6D00",lineWidth:1,title:"SMA 200",lastValueVisible:!1,priceLineVisible:!1});C.setData(F),n.current.push(C)}}if(B==="bb"){const P=mt(A),F=P.upper.map(($,O)=>$!=null&&isFinite($)?{time:k[O],value:$}:null).filter(Boolean),C=P.lower.map(($,O)=>$!=null&&isFinite($)?{time:k[O],value:$}:null).filter(Boolean);if(F.length>0){const $=s.current.addLineSeries({color:"#9C27B0",lineWidth:1,lineStyle:2,title:"BB Upper",lastValueVisible:!1,priceLineVisible:!1}),O=s.current.addLineSeries({color:"#9C27B0",lineWidth:1,lineStyle:2,title:"BB Lower",lastValueVisible:!1,priceLineVisible:!1});$.setData(F),O.setData(C),n.current.push($,O)}}}catch(P){console.warn(`Indicator ${B} error:`,P)}})};g.useEffect(()=>{if(!t.current)return;(async()=>{try{const A=await R.getCandles(i,o,500);w(A)}catch{}})()},[f]);const L=b=>{x(A=>A.includes(b)?A.filter(k=>k!==b):[...A,b])};return e.jsxs("div",{className:"flex flex-col w-full h-full",style:{minHeight:0},children:[e.jsxs("div",{className:"flex items-center gap-2 px-3 py-2 shrink-0 flex-wrap",style:{borderBottom:"1px solid var(--border)"},children:[e.jsxs("div",{className:"relative",children:[e.jsxs("button",{onClick:()=>S(!y),className:"flex items-center gap-1.5 px-3 py-1.5 bg-[var(--dark-3)] rounded-lg text-sm font-bold hover:bg-[var(--dark-4)] transition-colors",children:[e.jsx(Ee,{size:13,className:"text-[var(--text-dim)]"}),i]}),y&&e.jsxs("div",{className:"absolute top-full left-0 mt-1 w-64 bg-[var(--dark-3)] border border-[var(--border)] rounded-xl shadow-xl z-50 p-2",children:[e.jsx("input",{type:"text",value:T,onChange:b=>d(b.target.value.toUpperCase()),placeholder:"Buscar par...",className:"w-full text-sm mb-2",autoFocus:!0}),e.jsx("div",{className:"max-h-48 overflow-y-auto space-y-0.5",children:ie.filter(b=>b.includes(T)).map(b=>e.jsx("button",{onClick:()=>{m(b),S(!1),d("")},className:`w-full text-left px-3 py-1.5 text-sm rounded-lg transition-colors
                        ${b===i?"bg-[var(--gold)]/15 text-[var(--gold)]":"text-[var(--text-dim)] hover:bg-[var(--dark-4)] hover:text-[var(--text)]"}`,children:b},b))})]})]}),e.jsx("div",{className:"flex items-center gap-0.5 bg-[var(--dark-3)] rounded-lg p-0.5",children:ne.map(b=>e.jsx("button",{onClick:()=>p(b.value),className:`px-2.5 py-1 text-xs rounded-md transition-colors
                ${o===b.value?"bg-[var(--gold)] text-white font-bold":"text-[var(--text-dim)] hover:text-[var(--text)]"}`,children:b.label},b.value))}),e.jsxs("div",{className:"flex items-center gap-1 ml-auto",children:[e.jsx(ae,{size:13,className:"text-[var(--text-dim)]"}),[{id:"ema20",label:"EMA 20",color:"#3B82F6"},{id:"ema50",label:"EMA 50",color:"#8B5CF6"},{id:"sma200",label:"SMA 200",color:"#FF6D00"},{id:"bb",label:"BB",color:"#9C27B0"}].map(b=>e.jsx("button",{onClick:()=>L(b.id),className:`px-2 py-0.5 text-[11px] rounded transition-all
                ${f.includes(b.id)?"font-semibold":"text-[var(--text-dim)] hover:text-[var(--text)]"}`,style:f.includes(b.id)?{color:b.color,background:`${b.color}15`}:{},children:b.label},b.id))]})]}),e.jsxs("div",{ref:c,className:"relative",style:{flex:"1 1 0%",minHeight:0,overflow:"hidden"},children:[u&&e.jsx("div",{className:"absolute inset-0 flex items-center justify-center z-20",style:{background:"rgba(11,14,17,0.85)"},children:e.jsxs("div",{className:"flex flex-col items-center gap-2",children:[e.jsx("div",{className:"w-8 h-8 border-2 border-[var(--gold)] border-t-transparent rounded-full animate-spin"}),e.jsxs("span",{className:"text-xs text-[var(--text-dim)]",children:["Cargando ",i,"..."]})]})}),h&&!u&&e.jsx("div",{className:"absolute inset-0 flex items-center justify-center z-20",style:{background:"rgba(11,14,17,0.9)"},children:e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-sm text-[var(--red)] mb-2",children:h}),e.jsx("button",{onClick:()=>{j(null),N(!0)},className:"px-4 py-2 text-xs bg-[var(--gold)] text-white rounded-lg font-semibold",children:"Reintentar"})]})})]})]})}function ut(){const{selectedPair:c,currentPrice:s,positions:t,orders:a,addPosition:n,addOrder:r,closePosition:i,cancelOrder:o}=D(),[m,p]=g.useState("buy"),[l,v]=g.useState("market"),[u,N]=g.useState({quantity:"",price:"",stopLoss:"",takeProfit:""}),[h,j]=g.useState({bids:[],asks:[]}),[y,S]=g.useState("order");g.useEffect(()=>{T();const x=setInterval(T,5e3);return()=>clearInterval(x)},[c]);const T=async()=>{try{const x=await R.getOrderBook(c,10);j(x)}catch{}},d=()=>{if(!u.quantity)return;const x=l==="market"?s:parseFloat(u.price);x&&(l==="market"?n({symbol:c,side:m,quantity:parseFloat(u.quantity),entryPrice:x,stopLoss:u.stopLoss?parseFloat(u.stopLoss):null,takeProfit:u.takeProfit?parseFloat(u.takeProfit):null,openedAt:new Date().toISOString()}):r({symbol:c,side:m,type:l,quantity:parseFloat(u.quantity),price:x,stopLoss:u.stopLoss?parseFloat(u.stopLoss):null,takeProfit:u.takeProfit?parseFloat(u.takeProfit):null,status:"open",createdAt:new Date().toISOString()}),N({quantity:"",price:"",stopLoss:"",takeProfit:""}))},f=parseFloat(u.quantity||0)*(l==="market"?s||0:parseFloat(u.price||0));return e.jsxs("div",{className:"flex flex-col h-full",style:{width:300,borderLeft:"1px solid var(--border)"},children:[e.jsx("div",{className:"flex border-b border-[var(--border)] shrink-0",children:["order","positions","orders"].map(x=>e.jsx("button",{onClick:()=>S(x),className:`flex-1 py-2 text-xs font-bold transition-colors
              ${y===x?"text-[var(--gold)] border-b-2 border-[var(--gold)]":"text-[var(--text-dim)]"}`,children:x==="order"?"Orden":x==="positions"?`Pos (${t.length})`:`√ìrd (${a.length})`},x))}),y==="order"&&e.jsxs("div",{className:"flex-1 overflow-y-auto p-3 space-y-3",children:[e.jsxs("div",{className:"flex gap-1 bg-[var(--dark-3)] rounded-lg p-1",children:[e.jsx("button",{onClick:()=>p("buy"),className:`flex-1 py-2 text-sm font-bold rounded-md transition-all
                ${m==="buy"?"bg-[var(--green)] text-white":"text-[var(--text-dim)]"}`,children:"Comprar"}),e.jsx("button",{onClick:()=>p("sell"),className:`flex-1 py-2 text-sm font-bold rounded-md transition-all
                ${m==="sell"?"bg-[var(--red)] text-white":"text-[var(--text-dim)]"}`,children:"Vender"})]}),e.jsx("div",{className:"flex gap-1",children:["market","limit","stop_loss"].map(x=>e.jsx("button",{onClick:()=>v(x),className:`flex-1 py-1.5 text-xs rounded-md transition-colors
                  ${l===x?"bg-[var(--dark-4)] text-[var(--text)] font-bold":"text-[var(--text-dim)]"}`,children:x==="market"?"Market":x==="limit"?"Limit":"Stop"},x))}),l!=="market"&&e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-[var(--text-dim)] mb-1 block",children:"Precio"}),e.jsx("input",{type:"number",value:u.price,onChange:x=>N({...u,price:x.target.value}),placeholder:s==null?void 0:s.toString(),className:"w-full text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-[var(--text-dim)] mb-1 block",children:"Cantidad"}),e.jsx("input",{type:"number",value:u.quantity,onChange:x=>N({...u,quantity:x.target.value}),placeholder:"0.001",className:"w-full text-sm"}),e.jsx("div",{className:"flex gap-1 mt-1",children:["25%","50%","75%","100%"].map(x=>e.jsx("button",{className:"flex-1 py-1 text-[10px] bg-[var(--dark-3)] rounded text-[var(--text-dim)] hover:text-[var(--text)]",children:x},x))})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"text-xs text-[var(--text-dim)] mb-1 flex items-center gap-1",children:[e.jsx(Z,{size:10})," Stop Loss"]}),e.jsx("input",{type:"number",value:u.stopLoss,onChange:x=>N({...u,stopLoss:x.target.value}),placeholder:"Precio",className:"w-full text-xs"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"text-xs text-[var(--text-dim)] mb-1 flex items-center gap-1",children:[e.jsx(se,{size:10})," Take Profit"]}),e.jsx("input",{type:"number",value:u.takeProfit,onChange:x=>N({...u,takeProfit:x.target.value}),placeholder:"Precio",className:"w-full text-xs"})]})]}),e.jsxs("div",{className:"bg-[var(--dark-3)] rounded-lg p-2 flex items-center justify-between",children:[e.jsx("span",{className:"text-xs text-[var(--text-dim)]",children:"Total"}),e.jsxs("span",{className:"text-sm font-mono font-bold",children:["$",f.toFixed(2)]})]}),e.jsxs("button",{onClick:d,disabled:!u.quantity,className:`w-full py-3 font-bold rounded-xl text-sm transition-colors disabled:opacity-50
              ${m==="buy"?"bg-[var(--green)] text-white hover:bg-[var(--green)]/80":"bg-[var(--red)] text-white hover:bg-[var(--red)]/80"}`,children:[m==="buy"?"Comprar":"Vender"," ",c.replace("USDT","")]}),e.jsxs("div",{className:"bg-[var(--dark-3)] rounded-lg p-2",children:[e.jsx("p",{className:"text-[10px] text-[var(--text-dim)] mb-1 font-bold",children:"Order Book"}),e.jsxs("div",{className:"space-y-0.5 text-[10px] font-mono",children:[h.asks.slice(0,5).reverse().map((x,w)=>e.jsxs("div",{className:"flex justify-between text-[var(--red)]",children:[e.jsxs("span",{children:["$",x.price.toFixed(2)]}),e.jsx("span",{children:x.quantity.toFixed(4)})]},`a${w}`)),e.jsxs("div",{className:"text-center py-0.5 text-sm font-bold text-[var(--gold)]",children:["$",(s==null?void 0:s.toLocaleString(void 0,{minimumFractionDigits:2}))||"---"]}),h.bids.slice(0,5).map((x,w)=>e.jsxs("div",{className:"flex justify-between text-[var(--green)]",children:[e.jsxs("span",{children:["$",x.price.toFixed(2)]}),e.jsx("span",{children:x.quantity.toFixed(4)})]},`b${w}`))]})]})]}),y==="positions"&&e.jsx("div",{className:"flex-1 overflow-y-auto p-3 space-y-2",children:t.length===0?e.jsx("p",{className:"text-center text-sm text-[var(--text-dim)] py-8",children:"Sin posiciones abiertas"}):t.map(x=>{const w=x.side==="buy"?(s-x.entryPrice)*x.quantity:(x.entryPrice-s)*x.quantity;return e.jsxs("div",{className:"bg-[var(--dark-3)] rounded-lg p-2",children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsx("span",{className:"text-xs font-bold",children:x.symbol}),e.jsx("span",{className:`text-xs font-bold ${x.side==="buy"?"text-[var(--green)]":"text-[var(--red)]"}`,children:x.side.toUpperCase()})]}),e.jsxs("div",{className:"flex justify-between text-[10px] text-[var(--text-dim)]",children:[e.jsxs("span",{children:["Entrada: $",x.entryPrice]}),e.jsxs("span",{className:w>=0?"text-[var(--green)]":"text-[var(--red)]",children:["P&L: ",w>=0?"+":"","$",w.toFixed(2)]})]}),e.jsx("button",{onClick:()=>i(x.id),className:"w-full mt-1 py-1 bg-[var(--dark-4)] text-[var(--text-dim)] rounded text-[10px] hover:bg-[var(--red)]/20 hover:text-[var(--red)] transition-colors",children:"Cerrar Posici√≥n"})]},x.id)})}),y==="orders"&&e.jsx("div",{className:"flex-1 overflow-y-auto p-3 space-y-2",children:a.length===0?e.jsx("p",{className:"text-center text-sm text-[var(--text-dim)] py-8",children:"Sin √≥rdenes pendientes"}):a.map(x=>e.jsxs("div",{className:"bg-[var(--dark-3)] rounded-lg p-2",children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsx("span",{className:"text-xs font-bold",children:x.symbol}),e.jsxs("span",{className:`text-xs font-bold ${x.side==="buy"?"text-[var(--green)]":"text-[var(--red)]"}`,children:[x.side.toUpperCase()," ",x.type]})]}),e.jsxs("div",{className:"text-[10px] text-[var(--text-dim)]",children:["Precio: $",x.price," | Cantidad: ",x.quantity]}),e.jsx("button",{onClick:()=>o(x.id),className:"w-full mt-1 py-1 bg-[var(--dark-4)] text-[var(--text-dim)] rounded text-[10px] hover:bg-[var(--red)]/20 hover:text-[var(--red)] transition-colors",children:"Cancelar"})]},x.id))})]})}class ht{constructor(){this.connections=new Map}_decrypt(s){return{...s,apiKey:atob(s.apiKey),apiSecret:atob(s.apiSecret),passphrase:s.passphrase?atob(s.passphrase):void 0}}async _binanceRequest(s,t,a={}){const n=new URL(`${U.binance.baseUrl}${t}`);Object.entries(a).forEach(([i,o])=>n.searchParams.set(i,o));const r=await fetch(n.toString(),{headers:{"X-MBX-APIKEY":s.apiKey}});if(!r.ok)throw new Error(`Binance API error: ${r.status}`);return r.json()}async connect(s){const t=this._decrypt(s),a=U[s.brokerId];if(!a)throw new Error(`Unsupported broker: ${s.brokerId}`);try{switch(s.brokerId){case"binance":await this._binanceRequest(t,"/api/v3/ping");break;default:await fetch(a.baseUrl)}return this.connections.set(s.id,{creds:t,config:a,connected:!0}),{success:!0,message:`Connected to ${a.name}`}}catch(n){return{success:!1,message:n.message}}}async getBalances(s){if(!this.connections.get(s))throw new Error("Broker not connected");return[{asset:"BTC",free:"0.5432",locked:"0.0000"},{asset:"ETH",free:"12.3456",locked:"0.0000"},{asset:"USDT",free:"15000.00",locked:"500.00"},{asset:"BNB",free:"25.00",locked:"0.0000"},{asset:"SOL",free:"100.00",locked:"0.0000"}]}async placeOrder(s,t){const a=this.connections.get(s);if(!a)throw new Error("Broker not connected");const{symbol:n,side:r,type:i,quantity:o,price:m,stopLoss:p,takeProfit:l}=t;if(!n||!r||!i||!o)throw new Error("Missing required order fields");return{id:Date.now().toString(36),symbol:n,side:r,type:i,quantity:parseFloat(o),price:m?parseFloat(m):null,stopLoss:p?parseFloat(p):null,takeProfit:l?parseFloat(l):null,status:i==="market"?"filled":"open",filledPrice:i==="market"?parseFloat(m||0):null,timestamp:new Date().toISOString(),broker:a.config.name}}async cancelOrder(s,t){if(!this.connections.get(s))throw new Error("Broker not connected");return{success:!0,orderId:t}}async getOpenOrders(s,t){if(!this.connections.get(s))throw new Error("Broker not connected");return[]}async getPositions(s){if(!this.connections.get(s))throw new Error("Broker not connected");return[]}disconnect(s){this.connections.delete(s)}}const he=new ht;class vt{constructor(){this.activeBots=new Map,this.intervals=new Map}async startBot(s,t,a){if(this.activeBots.has(s.id))return;a==null||a(`ü§ñ Bot "${s.name}" iniciado en ${s.pair}`),this.activeBots.set(s.id,{bot:s,running:!0});const n=this._getCheckInterval(s.timeframe),r=async()=>{var o;if((o=this.activeBots.get(s.id))!=null&&o.running)try{const m=await R.getCandles(s.pair,s.timeframe,100),p=m.map(u=>u.close),l=p[p.length-1],v=this._evaluateStrategy(s.strategy,m,p);if(v){a==null||a(`üìä Se√±al detectada: ${v.type.toUpperCase()} a $${l}`);const u=this._calculatePositionSize(s,l),N={symbol:s.pair,side:v.type,type:"market",quantity:u,price:l,stopLoss:v.type==="buy"?l*(1-parseFloat(s.strategy.stopLoss)/100):l*(1+parseFloat(s.strategy.stopLoss)/100),takeProfit:v.type==="buy"?l*(1+parseFloat(s.strategy.takeProfit)/100):l*(1-parseFloat(s.strategy.takeProfit)/100)};t==null||t(N),a==null||a(`‚úÖ Orden ejecutada: ${v.type.toUpperCase()} ${u} ${s.pair} @ $${l}`)}}catch(m){a==null||a(`‚ùå Error: ${m.message}`)}};await r();const i=setInterval(r,n);this.intervals.set(s.id,i)}stopBot(s){const t=this.activeBots.get(s);t&&(t.running=!1,this.activeBots.delete(s));const a=this.intervals.get(s);a&&(clearInterval(a),this.intervals.delete(s))}_evaluateStrategy(s,t,a){var i,o,m,p,l,v,u,N,h,j,y,S;if(!((i=s==null?void 0:s.entry)!=null&&i.indicator))return null;const n=a.length,r=s.entry.indicator;switch(r){case"ema_cross":case"ema_cross_rsi":{const T=((o=s.entry.params)==null?void 0:o.fastEma)||((m=s.entry.params)==null?void 0:m.fast)||20,d=((p=s.entry.params)==null?void 0:p.slowEma)||((l=s.entry.params)==null?void 0:l.slow)||50,f=q(a,T),x=q(a,d),w=ue(f,x,n-1);if(r==="ema_cross_rsi"){const L=((v=s.entry.params)==null?void 0:v.rsiPeriod)||14,A=pe(a,L)[n-1],k=((u=s.entry.params)==null?void 0:u.rsiOversold)||30,B=((h=(N=s.exit)==null?void 0:N.params)==null?void 0:h.rsiOverbought)||70;if(w==="bullish_cross"&&A<k)return{type:"buy"};if(w==="bearish_cross"&&A>B)return{type:"sell"};if(A>B)return{type:"sell"};if(A<k)return{type:"buy"}}else{if(w==="bullish_cross")return{type:"buy"};if(w==="bearish_cross")return{type:"sell"}}break}case"rsi":{const T=((j=s.entry.params)==null?void 0:j.period)||14,f=pe(a,T)[n-1];if(f<(((y=s.entry.params)==null?void 0:y.oversold)||30))return{type:"buy"};if(f>(((S=s.entry.params)==null?void 0:S.overbought)||70))return{type:"sell"};break}case"macd_cross":{const{macd:T,signal:d}=xt(a),f=ue(T,d,n-1);if(f==="bullish_cross")return{type:"buy"};if(f==="bearish_cross")return{type:"sell"};break}default:return null}return null}_calculatePositionSize(s,t){const a=s.balance||1e3,n=parseFloat(s.riskPercent||2)/100,r=a*n/t;return Math.round(r*1e8)/1e8}_getCheckInterval(s){return{"1m":6e4,"5m":3e5,"15m":9e5,"1h":3e5,"4h":9e5,"1d":36e5}[s]||3e5}getActiveBotCount(){return this.activeBots.size}}const J=new vt;function gt(){const{bots:c,addBot:s,updateBot:t,removeBot:a,strategies:n,brokers:r}=D(),[i,o]=g.useState(!1),[m,p]=g.useState([]),[l,v]=g.useState({name:"",pair:"BTCUSDT",timeframe:"1h",strategyId:"",brokerId:"",balance:"1000",riskPercent:"2",maxTrades:"10"}),u=()=>{if(!l.name||!l.pair)return;const d=n.find(f=>f.id===l.strategyId)||{name:"EMA Cross + RSI",entry:{condition:"EMA 20 cruza EMA 50 + RSI < 30",indicator:"ema_cross_rsi",params:{fastEma:20,slowEma:50,rsiPeriod:14,rsiOversold:30}},exit:{condition:"RSI > 70",indicator:"rsi",params:{rsiOverbought:70}},stopLoss:"2",takeProfit:"4"};s({name:l.name,pair:l.pair,timeframe:l.timeframe,strategy:d,brokerId:l.brokerId,balance:parseFloat(l.balance),riskPercent:parseFloat(l.riskPercent),maxTrades:parseInt(l.maxTrades)}),v({name:"",pair:"BTCUSDT",timeframe:"1h",strategyId:"",brokerId:"",balance:"1000",riskPercent:"2",maxTrades:"10"}),o(!1)},N=async d=>{t(d.id,{status:"active"}),J.startBot({...d,status:"active"},f=>{p(x=>[...x,{type:"trade",bot:d.name,...f,time:new Date().toLocaleTimeString()}])},f=>{p(x=>[...x,{type:"log",bot:d.name,message:f,time:new Date().toLocaleTimeString()}])})},h=d=>{J.stopBot(d.id),t(d.id,{status:"paused"})},j=d=>{J.stopBot(d.id),t(d.id,{status:"stopped"})},y=d=>{J.stopBot(d.id),a(d.id)},S=d=>{switch(d){case"active":return"var(--green)";case"paused":return"var(--gold)";case"error":return"var(--red)";default:return"var(--text-dim)"}},T=d=>{switch(d){case"active":return"Activo";case"paused":return"Pausado";case"stopped":return"Detenido";case"error":return"Error";default:return d}};return e.jsxs("div",{className:"flex-1 overflow-y-auto p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl font-bold",children:"Trading Bots"}),e.jsxs("p",{className:"text-sm text-[var(--text-dim)]",children:[c.filter(d=>d.status==="active").length," activos de ",c.length," total"]})]}),e.jsxs("button",{onClick:()=>o(!i),className:"flex items-center gap-2 px-4 py-2 bg-[var(--gold)] text-white font-bold rounded-xl hover:bg-[var(--gold-light)] transition-colors text-sm",children:[e.jsx(re,{size:16})," Crear Bot"]})]}),e.jsx(H,{children:i&&e.jsx(I.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},className:"bg-[var(--dark-2)] border border-[var(--border)] rounded-xl overflow-hidden",children:e.jsxs("div",{className:"p-4 space-y-4",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Nuevo Bot de Trading"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-[var(--text-dim)] mb-1 block",children:"Nombre del Bot"}),e.jsx("input",{value:l.name,onChange:d=>v({...l,name:d.target.value}),placeholder:"Mi Bot BTC",className:"w-full"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-[var(--text-dim)] mb-1 block",children:"Par"}),e.jsx("select",{value:l.pair,onChange:d=>v({...l,pair:d.target.value}),className:"w-full",children:ie.map(d=>e.jsx("option",{value:d,children:d},d))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-[var(--text-dim)] mb-1 block",children:"Timeframe"}),e.jsx("select",{value:l.timeframe,onChange:d=>v({...l,timeframe:d.target.value}),className:"w-full",children:ne.map(d=>e.jsx("option",{value:d.value,children:d.label},d.value))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-[var(--text-dim)] mb-1 block",children:"Balance Asignado ($)"}),e.jsx("input",{type:"number",value:l.balance,onChange:d=>v({...l,balance:d.target.value}),placeholder:"1000",className:"w-full"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-[var(--text-dim)] mb-1 block",children:"Riesgo por Trade (%)"}),e.jsx("input",{type:"number",value:l.riskPercent,onChange:d=>v({...l,riskPercent:d.target.value}),placeholder:"2",className:"w-full"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-[var(--text-dim)] mb-1 block",children:"M√°x. Trades por D√≠a"}),e.jsx("input",{type:"number",value:l.maxTrades,onChange:d=>v({...l,maxTrades:d.target.value}),placeholder:"10",className:"w-full"})]})]}),e.jsxs("div",{className:"bg-[var(--dark-3)] rounded-xl p-3",children:[e.jsx("p",{className:"text-xs text-[var(--text-dim)] mb-1",children:"Estrategia Predeterminada"}),e.jsx("p",{className:"text-sm font-bold text-[var(--gold)]",children:"EMA Cross + RSI"}),e.jsx("p",{className:"text-xs text-[var(--text-dim)] mt-1",children:"Compra: EMA 20 cruza EMA 50 + RSI < 30 | Venta: RSI > 70 | SL: 2% | TP: 4%"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:u,className:"flex-1 py-2.5 bg-[var(--gold)] text-white font-bold rounded-xl text-sm hover:bg-[var(--gold-light)] transition-colors",children:"Crear Bot"}),e.jsx("button",{onClick:()=>o(!1),className:"px-4 py-2.5 bg-[var(--dark-3)] text-[var(--text-dim)] rounded-xl text-sm",children:"Cancelar"})]})]})})}),c.length===0?e.jsxs("div",{className:"bg-[var(--dark-2)] border border-[var(--border)] rounded-xl p-12 text-center",children:[e.jsx(V,{size:48,className:"text-[var(--text-dim)] mx-auto mb-4"}),e.jsx("p",{className:"text-[var(--text-dim)]",children:"No hay bots creados"}),e.jsx("p",{className:"text-xs text-[var(--text-dim)] mt-1",children:"Crea tu primer bot para automatizar tu trading"})]}):e.jsx("div",{className:"space-y-3",children:c.map(d=>{var f;return e.jsxs(I.div,{layout:!0,className:"bg-[var(--dark-2)] border border-[var(--border)] rounded-xl p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-xl bg-[var(--dark-3)] flex items-center justify-center",children:e.jsx(V,{size:20,style:{color:S(d.status)}})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-bold",children:d.name}),e.jsxs("p",{className:"text-xs text-[var(--text-dim)]",children:[d.pair," ‚Ä¢ ",d.timeframe]})]})]}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsx("span",{className:"px-2 py-0.5 rounded-full text-[10px] font-bold",style:{color:S(d.status),background:`${S(d.status)}20`},children:T(d.status)})})]}),e.jsxs("div",{className:"grid grid-cols-4 gap-3 mb-3",children:[e.jsxs("div",{className:"bg-[var(--dark-3)] rounded-lg p-2 text-center",children:[e.jsx("p",{className:"text-xs text-[var(--text-dim)]",children:"Trades"}),e.jsx("p",{className:"text-sm font-bold",children:d.trades||0})]}),e.jsxs("div",{className:"bg-[var(--dark-3)] rounded-lg p-2 text-center",children:[e.jsx("p",{className:"text-xs text-[var(--text-dim)]",children:"P&L"}),e.jsxs("p",{className:`text-sm font-bold ${(d.pnl||0)>=0?"text-[var(--green)]":"text-[var(--red)]"}`,children:[(d.pnl||0)>=0?"+":"","$",(d.pnl||0).toFixed(2)]})]}),e.jsxs("div",{className:"bg-[var(--dark-3)] rounded-lg p-2 text-center",children:[e.jsx("p",{className:"text-xs text-[var(--text-dim)]",children:"Win Rate"}),e.jsxs("p",{className:"text-sm font-bold",children:[(d.winRate||0).toFixed(0),"%"]})]}),e.jsxs("div",{className:"bg-[var(--dark-3)] rounded-lg p-2 text-center",children:[e.jsx("p",{className:"text-xs text-[var(--text-dim)]",children:"Balance"}),e.jsxs("p",{className:"text-sm font-bold",children:["$",(f=d.balance)==null?void 0:f.toLocaleString()]})]})]}),e.jsxs("div",{className:"flex gap-2",children:[d.status!=="active"?e.jsxs("button",{onClick:()=>N(d),className:"flex items-center gap-1 px-3 py-1.5 bg-[var(--green)]/20 text-[var(--green)] rounded-lg text-xs font-bold hover:bg-[var(--green)]/30 transition-colors",children:[e.jsx(Q,{size:12})," Iniciar"]}):e.jsxs("button",{onClick:()=>h(d),className:"flex items-center gap-1 px-3 py-1.5 bg-[var(--gold)]/20 text-[var(--gold)] rounded-lg text-xs font-bold hover:bg-[var(--gold)]/30 transition-colors",children:[e.jsx(Ie,{size:12})," Pausar"]}),e.jsxs("button",{onClick:()=>j(d),className:"flex items-center gap-1 px-3 py-1.5 bg-[var(--dark-3)] text-[var(--text-dim)] rounded-lg text-xs hover:bg-[var(--dark-4)] transition-colors",children:[e.jsx(De,{size:12})," Detener"]}),e.jsxs("button",{onClick:()=>y(d),className:"ml-auto flex items-center gap-1 px-3 py-1.5 text-[var(--text-dim)] hover:text-[var(--red)] rounded-lg text-xs transition-colors",children:[e.jsx(ee,{size:12})," Eliminar"]})]})]},d.id)})}),m.length>0&&e.jsxs("div",{className:"bg-[var(--dark-2)] border border-[var(--border)] rounded-xl overflow-hidden",children:[e.jsxs("div",{className:"flex items-center justify-between p-3 border-b border-[var(--border)]",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Actividad en Vivo"}),e.jsx("button",{onClick:()=>p([]),className:"text-xs text-[var(--text-dim)]",children:"Limpiar"})]}),e.jsx("div",{className:"max-h-48 overflow-y-auto p-3 space-y-1 font-mono text-xs",children:m.slice(-50).reverse().map((d,f)=>{var x;return e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-[var(--text-dim)] shrink-0",children:d.time}),e.jsxs("span",{className:"text-[var(--gold)] shrink-0",children:["[",d.bot,"]"]}),e.jsx("span",{className:"text-[var(--text)]",children:d.message||`${(x=d.side)==null?void 0:x.toUpperCase()} ${d.quantity} @ $${d.price}`})]},f)})})]})]})}function bt(){var T;const{brokers:c,addBroker:s,removeBroker:t,updateBrokerStatus:a,setActiveBroker:n}=D(),[r,i]=g.useState(!1),[o,m]=g.useState({brokerId:"binance",apiKey:"",apiSecret:"",passphrase:"",label:""}),[p,l]=g.useState(!1),[v,u]=g.useState(null),[N,h]=g.useState(""),j=()=>{if(h(""),!o.apiKey||!o.apiSecret){h("API Key y Secret son obligatorios");return}const d=U[o.brokerId];if(d.requiredFields.includes("passphrase")&&!o.passphrase){h("Este broker requiere Passphrase");return}s({brokerId:o.brokerId,label:o.label||d.name,apiKey:o.apiKey,apiSecret:o.apiSecret,passphrase:o.passphrase}),m({brokerId:"binance",apiKey:"",apiSecret:"",passphrase:"",label:""}),i(!1)},y=async d=>{u(d.id);const f=await he.connect(d);a(d.id,f.success),f.success&&n(d),u(null)},S=d=>{he.disconnect(d),t(d)};return e.jsxs("div",{className:"flex-1 overflow-y-auto p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl font-bold",children:"Brokers Conectados"}),e.jsx("p",{className:"text-sm text-[var(--text-dim)]",children:"Conecta tu broker para ejecutar trades autom√°ticamente"})]}),e.jsxs("button",{onClick:()=>i(!r),className:"flex items-center gap-2 px-4 py-2 bg-[var(--gold)] text-white font-bold rounded-xl hover:bg-[var(--gold-light)] transition-colors text-sm",children:[e.jsx(re,{size:16})," Agregar Broker"]})]}),e.jsxs("div",{className:"bg-[var(--gold)]/5 border border-[var(--gold)]/20 rounded-xl p-4 flex items-start gap-3",children:[e.jsx(Z,{size:20,className:"text-[var(--gold)] shrink-0 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-bold text-[var(--gold)]",children:"Tus API Keys est√°n seguras"}),e.jsxs("p",{className:"text-xs text-[var(--text-dim)] mt-1",children:["Las claves se almacenan encriptadas localmente. Kairos Trade solo necesita permisos de lectura y trading.",e.jsx("strong",{className:"text-[var(--text)]",children:" Nunca actives permisos de retiro."})]})]})]}),e.jsx(H,{children:r&&e.jsx(I.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},className:"bg-[var(--dark-2)] border border-[var(--border)] rounded-xl overflow-hidden",children:e.jsxs("div",{className:"p-4 space-y-4",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Nuevo Broker"}),e.jsx("div",{className:"grid grid-cols-3 gap-2",children:Object.values(U).map(d=>e.jsxs("button",{onClick:()=>m({...o,brokerId:d.id}),className:`p-3 rounded-xl border text-center transition-all
                      ${o.brokerId===d.id?"border-[var(--gold)] bg-[var(--gold)]/10":"border-[var(--border)] hover:border-[var(--gold)]/30"}`,children:[e.jsx("span",{className:"text-2xl",children:d.logo}),e.jsx("p",{className:"text-sm font-bold mt-1",children:d.name}),e.jsx("p",{className:"text-[10px] text-[var(--text-dim)]",children:d.supportedMarkets.join(", ")})]},d.id))}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-[var(--text-dim)] mb-1 block",children:"Etiqueta (opcional)"}),e.jsx("input",{value:o.label,onChange:d=>m({...o,label:d.target.value}),placeholder:"Mi cuenta Binance",className:"w-full"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-[var(--text-dim)] mb-1 block",children:"API Key"}),e.jsx("input",{value:o.apiKey,onChange:d=>m({...o,apiKey:d.target.value}),placeholder:"Tu API Key",className:"w-full font-mono text-xs"})]}),e.jsxs("div",{className:"relative",children:[e.jsx("label",{className:"text-xs text-[var(--text-dim)] mb-1 block",children:"API Secret"}),e.jsx("input",{type:p?"text":"password",value:o.apiSecret,onChange:d=>m({...o,apiSecret:d.target.value}),placeholder:"Tu API Secret",className:"w-full font-mono text-xs pr-10"}),e.jsx("button",{onClick:()=>l(!p),className:"absolute right-3 top-7 text-[var(--text-dim)]",children:p?e.jsx(Fe,{size:14}):e.jsx(Re,{size:14})})]}),((T=U[o.brokerId])==null?void 0:T.requiredFields.includes("passphrase"))&&e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-[var(--text-dim)] mb-1 block",children:"Passphrase"}),e.jsx("input",{type:"password",value:o.passphrase,onChange:d=>m({...o,passphrase:d.target.value}),placeholder:"Passphrase",className:"w-full font-mono text-xs"})]})]}),N&&e.jsx("p",{className:"text-xs text-[var(--red)]",children:N}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:j,className:"flex-1 py-2.5 bg-[var(--gold)] text-white font-bold rounded-xl text-sm hover:bg-[var(--gold-light)] transition-colors",children:"Guardar Broker"}),e.jsx("button",{onClick:()=>i(!1),className:"px-4 py-2.5 bg-[var(--dark-3)] text-[var(--text-dim)] rounded-xl text-sm hover:bg-[var(--dark-4)] transition-colors",children:"Cancelar"})]})]})})}),c.length===0?e.jsxs("div",{className:"bg-[var(--dark-2)] border border-[var(--border)] rounded-xl p-12 text-center",children:[e.jsx(X,{size:48,className:"text-[var(--text-dim)] mx-auto mb-4"}),e.jsx("p",{className:"text-[var(--text-dim)]",children:"No hay brokers conectados"}),e.jsx("p",{className:"text-xs text-[var(--text-dim)] mt-1",children:"Agrega tu primer broker para empezar a operar"})]}):e.jsx("div",{className:"space-y-3",children:c.map(d=>{const f=U[d.brokerId];return e.jsxs(I.div,{layout:!0,className:"bg-[var(--dark-2)] border border-[var(--border)] rounded-xl p-4 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"text-2xl",children:(f==null?void 0:f.logo)||"üìä"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-bold",children:d.label}),e.jsxs("p",{className:"text-xs text-[var(--text-dim)]",children:[f==null?void 0:f.name," ‚Ä¢ API: ",atob(d.apiKey).slice(0,8),"..."]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[d.connected?e.jsxs("span",{className:"flex items-center gap-1 text-xs text-[var(--green)]",children:[e.jsx(Le,{size:14})," Conectado"]}):e.jsxs("span",{className:"flex items-center gap-1 text-xs text-[var(--text-dim)]",children:[e.jsx(Me,{size:14})," Desconectado"]}),e.jsx("button",{onClick:()=>y(d),disabled:v===d.id,className:"px-3 py-1.5 bg-[var(--gold)]/20 text-[var(--gold)] rounded-lg text-xs font-bold hover:bg-[var(--gold)]/30 transition-colors disabled:opacity-50",children:v===d.id?"...":d.connected?"Reconectar":"Conectar"}),e.jsx("button",{onClick:()=>S(d.id),className:"p-1.5 text-[var(--text-dim)] hover:text-[var(--red)] transition-colors",children:e.jsx(ee,{size:14})})]})]},d.id)})})]})}const ft=`Eres Kairos AI, el asistente de trading m√°s avanzado del mundo.
Eres parte de Kairos Trade, la plataforma de trading automatizado de Kairos 777 Inc.

Tu especialidad:
- An√°lisis t√©cnico (EMA, RSI, MACD, Bollinger Bands, VWAP, estructura de mercado)
- Generaci√≥n de estrategias de trading autom√°ticas
- An√°lisis de sentimiento del mercado
- Gesti√≥n de riesgo
- Educaci√≥n en trading

Reglas:
- Responde en espa√±ol siempre
- S√© directo, conciso y profesional
- Cuando generes estrategias, usa formato JSON estructurado
- Nunca des consejos financieros personales ‚Äî eres una herramienta de an√°lisis
- Si te piden una estrategia, incluye SIEMPRE: entry, exit, stopLoss, takeProfit, timeframe
- Usa datos t√©cnicos reales cuando los tengas disponibles

Cuando generes una estrategia, responde con un bloque JSON as√≠:
\`\`\`strategy
{
  "name": "Nombre de la estrategia",
  "pair": "BTCUSDT",
  "timeframe": "1h",
  "entry": { "condition": "EMA 20 cruza por encima de EMA 50", "indicator": "ema_cross", "params": { "fast": 20, "slow": 50 } },
  "exit": { "condition": "RSI > 70", "indicator": "rsi", "params": { "period": 14, "threshold": 70 } },
  "stopLoss": "1.5%",
  "takeProfit": "3%",
  "riskReward": "1:2"
}
\`\`\``;class jt{constructor(){this.apiKey=null,this.model="gpt-4o-mini",this.conversationHistory=[]}setApiKey(s){this.apiKey=s}async chat(s,t=null){var n;let a=s;if(t&&(a+=`

[Datos del mercado actual]
Par: ${t.symbol}
Precio: $${t.price}
Cambio 24h: ${t.changePercent}%
Volumen: ${t.volume}
M√°ximo 24h: $${t.high}
M√≠nimo 24h: $${t.low}`),this.conversationHistory.push({role:"user",content:a}),!this.apiKey)return this._localAnalysis(s,t);try{const r=await fetch("https://api.openai.com/v1/chat/completions",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${this.apiKey}`},body:JSON.stringify({model:this.model,messages:[{role:"system",content:ft},...this.conversationHistory.slice(-20)],temperature:.7,max_tokens:1e3})});if(!r.ok){const m=await r.json();throw new Error(((n=m.error)==null?void 0:n.message)||"API error")}const i=await r.json(),o=i.choices[0].message.content;return this.conversationHistory.push({role:"assistant",content:o}),{text:o,strategy:this._extractStrategy(o),usage:i.usage}}catch(r){return console.error("AI error:",r),this._localAnalysis(s,t)}}_localAnalysis(s,t){var r,i,o,m;const a=s.toLowerCase();if(a.includes("estrategia")||a.includes("strategy")){const p=(t==null?void 0:t.symbol)||"BTCUSDT",l={name:`Kairos Auto Strategy ‚Äî ${p}`,pair:p,timeframe:"1h",entry:{condition:"EMA 20 cruza por encima de EMA 50 + RSI < 30",indicator:"ema_cross_rsi",params:{fastEma:20,slowEma:50,rsiPeriod:14,rsiOversold:30}},exit:{condition:"RSI > 70 o EMA 20 cruza por debajo de EMA 50",indicator:"rsi_overbought",params:{rsiOverbought:70}},stopLoss:"2%",takeProfit:"4%",riskReward:"1:2"},v=`üìä **Estrategia generada para ${p}**

**Entrada:** ${l.entry.condition}
**Salida:** ${l.exit.condition}
**Stop Loss:** ${l.stopLoss}
**Take Profit:** ${l.takeProfit}
**Risk/Reward:** ${l.riskReward}

Puedes activar esta estrategia desde el panel de bots.`;return this.conversationHistory.push({role:"assistant",content:v}),{text:v,strategy:l}}if(a.includes("analiz")||a.includes("mercado")||a.includes("market")||a.includes("c√≥mo ves")){let p="";if(t){const l=t.changePercent>0?"alcista":t.changePercent<-0?"bajista":"lateral",v=Math.abs(t.changePercent),u=v>3?"fuerte":v>1?"moderado":"d√©bil";p=`üìà **An√°lisis de ${t.symbol}**

**Precio:** $${(r=t.price)==null?void 0:r.toLocaleString()}
**Tendencia 24h:** ${l} (${t.changePercent>0?"+":""}${(i=t.changePercent)==null?void 0:i.toFixed(2)}%)
**Momentum:** ${u}
**Rango 24h:** $${(o=t.low)==null?void 0:o.toLocaleString()} ‚Äî $${(m=t.high)==null?void 0:m.toLocaleString()}
**Volumen:** $${(t.quoteVolume/1e6).toFixed(1)}M

`+(t.changePercent>2?`‚ö° El mercado muestra fuerza compradora. Considerar compras en retrocesos.
`:t.changePercent<-2?`‚ö†Ô∏è Presi√≥n vendedora activa. Esperar confirmaci√≥n de soporte.
`:`üìä Mercado en consolidaci√≥n. Esperar ruptura para tomar posici√≥n.
`)+`
üí° Recomendaci√≥n: ${l==="alcista"?"Buscar entradas en pullbacks al EMA 20.":l==="bajista"?"Precauci√≥n. Esperar divergencia RSI para posible reversal.":"Operar rango ‚Äî comprar soporte, vender resistencia."}`}else p="üìä Necesito datos del mercado para analizar. Selecciona un par de trading primero.";return this.conversationHistory.push({role:"assistant",content:p}),{text:p,strategy:null}}const n=`ü§ñ Soy **Kairos AI**, tu asistente de trading.

Puedo ayudarte con:
‚Ä¢ **"Analiza BTC"** ‚Äî An√°lisis t√©cnico del mercado
‚Ä¢ **"Dame una estrategia para ETHUSDT"** ‚Äî Generar estrategia autom√°tica
‚Ä¢ **"¬øC√≥mo ves el mercado?"** ‚Äî Visi√≥n general
‚Ä¢ **"Configura un bot"** ‚Äî Ayuda con automatizaci√≥n

¬øEn qu√© te puedo ayudar?`;return this.conversationHistory.push({role:"assistant",content:n}),{text:n,strategy:null}}_extractStrategy(s){const t=s.match(/```strategy\n([\s\S]*?)```/);if(t)try{return JSON.parse(t[1])}catch{return null}return null}clearHistory(){this.conversationHistory=[]}}const Ne=new jt;function ve(){const{aiMessages:c,addAiMessage:s,aiLoading:t,setAiLoading:a,clearAiMessages:n,currentPrice:r,selectedPair:i,priceChange24h:o}=D(),[m,p]=g.useState(""),l=g.useRef(null);g.useEffect(()=>{var h;(h=l.current)==null||h.scrollIntoView({behavior:"smooth"})},[c]);const v=async()=>{if(!m.trim()||t)return;const h={role:"user",content:m.trim(),time:new Date().toLocaleTimeString()};s(h),p(""),a(!0);try{const j=r?{symbol:i,price:r,changePercent:o,high:r*1.02,low:r*.98,volume:0,quoteVolume:0}:null,y=await Ne.chat(m.trim(),j);s({role:"assistant",content:y.text,strategy:y.strategy,time:new Date().toLocaleTimeString()})}catch(j){s({role:"assistant",content:`‚ùå Error: ${j.message}`,time:new Date().toLocaleTimeString()})}a(!1)},u=[{label:"Analiza el mercado",icon:Y,prompt:`Analiza ${i} ahora mismo`},{label:"Dame una estrategia",icon:W,prompt:`Dame una estrategia de trading para ${i}`},{label:"¬øC√≥mo ves BTC?",icon:Oe,prompt:"¬øC√≥mo ves Bitcoin hoy?"}],N=(h,j)=>{const y=h.role==="user";return e.jsx(I.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:`flex ${y?"justify-end":"justify-start"}`,children:e.jsxs("div",{className:`max-w-[85%] rounded-2xl p-3 ${y?"bg-[var(--gold)] text-white rounded-br-md":"bg-[var(--dark-3)] text-[var(--text)] rounded-bl-md"}`,children:[!y&&e.jsxs("div",{className:"flex items-center gap-1 mb-1",children:[e.jsx(_,{size:12,className:"text-[var(--gold)]"}),e.jsx("span",{className:"text-[10px] text-[var(--gold)] font-bold",children:"Kairos AI"})]}),e.jsx("div",{className:"text-sm whitespace-pre-wrap leading-relaxed",children:h.content.split(`
`).map((S,T)=>S.startsWith("**")&&S.endsWith("**")?e.jsx("p",{className:"font-bold my-0.5",children:S.replace(/\*\*/g,"")},T):S.startsWith("‚Ä¢")||S.startsWith("-")?e.jsx("p",{className:"ml-2",children:S},T):e.jsx("p",{children:S},T))}),h.strategy&&e.jsxs("div",{className:"mt-2 p-2 bg-[var(--dark-4)] rounded-xl border border-[var(--gold)]/20",children:[e.jsxs("div",{className:"flex items-center gap-1 mb-1",children:[e.jsx(W,{size:12,className:"text-[var(--gold)]"}),e.jsx("span",{className:"text-xs font-bold text-[var(--gold)]",children:"Estrategia Lista"})]}),e.jsx("p",{className:"text-xs",children:h.strategy.name||"Auto Strategy"}),e.jsx("button",{onClick:()=>{D.getState().addStrategy(h.strategy),s({role:"assistant",content:"‚úÖ Estrategia guardada. Puedes activarla desde el panel de Bots.",time:new Date().toLocaleTimeString()})},className:"mt-1 px-3 py-1 bg-[var(--gold)] text-white text-xs font-bold rounded-lg",children:"Activar Estrategia"})]}),e.jsx("p",{className:`text-[10px] mt-1 ${y?"text-white/60":"text-[var(--text-dim)]"}`,children:h.time})]})},j)};return e.jsxs("div",{className:"flex-1 flex flex-col h-full overflow-hidden",children:[e.jsx("div",{className:"p-4 border-b border-[var(--border)] bg-[var(--dark-2)] shrink-0",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-8 h-8 rounded-lg bg-[var(--gold)]/20 flex items-center justify-center",children:e.jsx(_,{size:18,className:"text-[var(--gold)]"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-sm font-bold",children:"Kairos AI"}),e.jsx("p",{className:"text-[10px] text-[var(--text-dim)]",children:"Asistente de trading inteligente"})]})]}),e.jsx("button",{onClick:n,className:"p-1.5 text-[var(--text-dim)] hover:text-[var(--red)] transition-colors",children:e.jsx(ee,{size:14})})]})}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-3",children:[c.length===0&&e.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-center",children:[e.jsx(_,{size:48,className:"text-[var(--gold)] mb-4"}),e.jsx("h3",{className:"text-lg font-bold mb-1",children:"Kairos AI"}),e.jsx("p",{className:"text-sm text-[var(--text-dim)] mb-6 max-w-xs",children:"Tu asistente de trading con inteligencia artificial. Preg√∫ntame cualquier cosa sobre el mercado."}),e.jsx("div",{className:"space-y-2 w-full max-w-xs",children:u.map((h,j)=>{const y=h.icon;return e.jsxs("button",{onClick:()=>{p(h.prompt)},className:"w-full flex items-center gap-2 p-3 bg-[var(--dark-3)] border border-[var(--border)] rounded-xl text-sm hover:border-[var(--gold)]/30 transition-colors text-left",children:[e.jsx(y,{size:16,className:"text-[var(--gold)] shrink-0"}),h.label]},j)})})]}),c.map(N),t&&e.jsx("div",{className:"flex justify-start",children:e.jsxs("div",{className:"bg-[var(--dark-3)] rounded-2xl rounded-bl-md p-3",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(_,{size:12,className:"text-[var(--gold)]"}),e.jsx("span",{className:"text-[10px] text-[var(--gold)] font-bold",children:"Kairos AI"})]}),e.jsxs("div",{className:"flex gap-1 mt-1",children:[e.jsx("div",{className:"w-2 h-2 rounded-full bg-[var(--gold)] animate-bounce",style:{animationDelay:"0ms"}}),e.jsx("div",{className:"w-2 h-2 rounded-full bg-[var(--gold)] animate-bounce",style:{animationDelay:"150ms"}}),e.jsx("div",{className:"w-2 h-2 rounded-full bg-[var(--gold)] animate-bounce",style:{animationDelay:"300ms"}})]})]})}),e.jsx("div",{ref:l})]}),e.jsx("div",{className:"p-3 border-t border-[var(--border)] bg-[var(--dark-2)] shrink-0",children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{value:m,onChange:h=>p(h.target.value),onKeyDown:h=>h.key==="Enter"&&v(),placeholder:"Pregunta sobre el mercado, pide estrategias...",className:"flex-1 text-sm"}),e.jsx("button",{onClick:v,disabled:!m.trim()||t,className:"px-4 py-2 bg-[var(--gold)] text-white rounded-xl hover:bg-[var(--gold-light)] transition-colors disabled:opacity-50",children:e.jsx(ze,{size:16})})]})})]})}const yt=[{name:"EMA Cross Classic",description:"Cruces de EMA r√°pida/lenta ‚Äî Tendencia",entry:{condition:"EMA 20 cruza por encima de EMA 50",indicator:"ema_cross",params:{fast:20,slow:50}},exit:{condition:"EMA 20 cruza por debajo de EMA 50",indicator:"ema_cross",params:{fast:20,slow:50}},stopLoss:"2",takeProfit:"4"},{name:"RSI Reversal",description:"Compra en sobreventa, vende en sobrecompra",entry:{condition:"RSI < 30 (sobreventa)",indicator:"rsi",params:{period:14,oversold:30}},exit:{condition:"RSI > 70 (sobrecompra)",indicator:"rsi",params:{period:14,overbought:70}},stopLoss:"1.5",takeProfit:"3"},{name:"MACD Momentum",description:"Cruce de l√≠nea MACD y se√±al",entry:{condition:"MACD cruza por encima de se√±al",indicator:"macd_cross",params:{fast:12,slow:26,signal:9}},exit:{condition:"MACD cruza por debajo de se√±al",indicator:"macd_cross",params:{}},stopLoss:"2",takeProfit:"4"},{name:"Bollinger Bounce",description:"Compra en banda inferior, vende en superior",entry:{condition:"Precio toca Bollinger Band inferior",indicator:"bb_bounce",params:{period:20,stdDev:2}},exit:{condition:"Precio toca Bollinger Band superior",indicator:"bb_bounce",params:{}},stopLoss:"1",takeProfit:"2"},{name:"EMA + RSI Combo",description:"M√°s preciso: cruces de EMA confirmados con RSI",entry:{condition:"EMA 20 > EMA 50 + RSI < 30",indicator:"ema_cross_rsi",params:{fastEma:20,slowEma:50,rsiPeriod:14,rsiOversold:30}},exit:{condition:"RSI > 70",indicator:"rsi",params:{rsiOverbought:70}},stopLoss:"2",takeProfit:"4"}];function Nt(){const{strategies:c,addStrategy:s,removeStrategy:t,setPage:a}=D(),[n,r]=g.useState(!1),[i,o]=g.useState({name:"",pair:"BTCUSDT",timeframe:"1h",entryIndicator:"ema_cross",entryCondition:"",exitIndicator:"rsi",exitCondition:"",stopLoss:"2",takeProfit:"4"}),m=l=>{s({...l,pair:"BTCUSDT",timeframe:"1h"})},p=()=>{i.name&&(s({name:i.name,pair:i.pair,timeframe:i.timeframe,entry:{condition:i.entryCondition||`${i.entryIndicator} signal`,indicator:i.entryIndicator,params:{}},exit:{condition:i.exitCondition||`${i.exitIndicator} signal`,indicator:i.exitIndicator,params:{}},stopLoss:i.stopLoss,takeProfit:i.takeProfit}),o({name:"",pair:"BTCUSDT",timeframe:"1h",entryIndicator:"ema_cross",entryCondition:"",exitIndicator:"rsi",exitCondition:"",stopLoss:"2",takeProfit:"4"}),r(!1))};return e.jsxs("div",{className:"flex-1 overflow-y-auto p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl font-bold",children:"Estrategias de Trading"}),e.jsx("p",{className:"text-sm text-[var(--text-dim)]",children:"Crea, gestiona y aplica estrategias a tus bots"})]}),e.jsxs("button",{onClick:()=>r(!n),className:"flex items-center gap-2 px-4 py-2 bg-[var(--gold)] text-white font-bold rounded-xl hover:bg-[var(--gold-light)] transition-colors text-sm",children:[e.jsx(re,{size:16})," Crear Estrategia"]})]}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-sm font-bold mb-3",children:"Plantillas Predefinidas"}),e.jsx("div",{className:"grid grid-cols-3 gap-3",children:yt.map((l,v)=>e.jsxs(I.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:v*.05},className:"bg-[var(--dark-2)] border border-[var(--border)] rounded-xl p-4 hover:border-[var(--gold)]/30 transition-colors",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(W,{size:16,className:"text-[var(--gold)]"}),e.jsx("h3",{className:"text-sm font-bold",children:l.name})]}),e.jsx("p",{className:"text-xs text-[var(--text-dim)] mb-3",children:l.description}),e.jsxs("div",{className:"space-y-1 text-xs mb-3",children:[e.jsxs("p",{children:[e.jsx("span",{className:"text-[var(--green)]",children:"‚ñ≤"})," ",l.entry.condition]}),e.jsxs("p",{children:[e.jsx("span",{className:"text-[var(--red)]",children:"‚ñº"})," ",l.exit.condition]}),e.jsxs("p",{className:"text-[var(--text-dim)]",children:["SL: ",l.stopLoss,"% | TP: ",l.takeProfit,"%"]})]}),e.jsx("button",{onClick:()=>m(l),className:"w-full py-1.5 bg-[var(--gold)]/20 text-[var(--gold)] rounded-lg text-xs font-bold hover:bg-[var(--gold)]/30 transition-colors",children:"Usar Plantilla"})]},l.name))})]}),e.jsx(H,{children:n&&e.jsx(I.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},className:"bg-[var(--dark-2)] border border-[var(--border)] rounded-xl overflow-hidden",children:e.jsxs("div",{className:"p-4 space-y-4",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Crear Estrategia Personalizada"}),e.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-[var(--text-dim)] mb-1 block",children:"Nombre"}),e.jsx("input",{value:i.name,onChange:l=>o({...i,name:l.target.value}),placeholder:"Mi estrategia",className:"w-full"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-[var(--text-dim)] mb-1 block",children:"Par"}),e.jsx("select",{value:i.pair,onChange:l=>o({...i,pair:l.target.value}),className:"w-full",children:ie.map(l=>e.jsx("option",{children:l},l))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-[var(--text-dim)] mb-1 block",children:"Timeframe"}),e.jsx("select",{value:i.timeframe,onChange:l=>o({...i,timeframe:l.target.value}),className:"w-full",children:ne.map(l=>e.jsx("option",{value:l.value,children:l.label},l.value))})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"bg-[var(--dark-3)] rounded-xl p-3",children:[e.jsx("p",{className:"text-xs font-bold text-[var(--green)] mb-2",children:"‚ñ≤ Condici√≥n de Entrada"}),e.jsxs("select",{value:i.entryIndicator,onChange:l=>o({...i,entryIndicator:l.target.value}),className:"w-full mb-2 text-sm",children:[e.jsx("option",{value:"ema_cross",children:"EMA Cross"}),e.jsx("option",{value:"rsi",children:"RSI"}),e.jsx("option",{value:"macd_cross",children:"MACD Cross"}),e.jsx("option",{value:"ema_cross_rsi",children:"EMA + RSI Combo"}),e.jsx("option",{value:"bb_bounce",children:"Bollinger Bounce"})]}),e.jsx("input",{value:i.entryCondition,onChange:l=>o({...i,entryCondition:l.target.value}),placeholder:"Describe la condici√≥n...",className:"w-full text-xs"})]}),e.jsxs("div",{className:"bg-[var(--dark-3)] rounded-xl p-3",children:[e.jsx("p",{className:"text-xs font-bold text-[var(--red)] mb-2",children:"‚ñº Condici√≥n de Salida"}),e.jsxs("select",{value:i.exitIndicator,onChange:l=>o({...i,exitIndicator:l.target.value}),className:"w-full mb-2 text-sm",children:[e.jsx("option",{value:"rsi",children:"RSI"}),e.jsx("option",{value:"ema_cross",children:"EMA Cross"}),e.jsx("option",{value:"macd_cross",children:"MACD Cross"})]}),e.jsx("input",{value:i.exitCondition,onChange:l=>o({...i,exitCondition:l.target.value}),placeholder:"Describe la condici√≥n...",className:"w-full text-xs"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-[var(--text-dim)] mb-1 block",children:"Stop Loss (%)"}),e.jsx("input",{type:"number",value:i.stopLoss,onChange:l=>o({...i,stopLoss:l.target.value}),className:"w-full"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-[var(--text-dim)] mb-1 block",children:"Take Profit (%)"}),e.jsx("input",{type:"number",value:i.takeProfit,onChange:l=>o({...i,takeProfit:l.target.value}),className:"w-full"})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:p,className:"flex-1 py-2.5 bg-[var(--gold)] text-white font-bold rounded-xl text-sm",children:"Crear Estrategia"}),e.jsx("button",{onClick:()=>r(!1),className:"px-4 py-2.5 bg-[var(--dark-3)] text-[var(--text-dim)] rounded-xl text-sm",children:"Cancelar"})]})]})})}),c.length>0&&e.jsxs("div",{children:[e.jsxs("h2",{className:"text-sm font-bold mb-3",children:["Mis Estrategias (",c.length,")"]}),e.jsx("div",{className:"space-y-2",children:c.map(l=>{var v;return e.jsxs("div",{className:"bg-[var(--dark-2)] border border-[var(--border)] rounded-xl p-4 flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-bold",children:l.name}),e.jsxs("p",{className:"text-xs text-[var(--text-dim)]",children:[(v=l.entry)==null?void 0:v.condition," | SL: ",l.stopLoss,"% | TP: ",l.takeProfit,"%"]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:()=>a("bots"),className:"px-3 py-1.5 bg-[var(--green)]/20 text-[var(--green)] rounded-lg text-xs font-bold",children:[e.jsx(Q,{size:12,className:"inline mr-1"})," Usar en Bot"]}),e.jsx("button",{onClick:()=>t(l.id),className:"p-1.5 text-[var(--text-dim)] hover:text-[var(--red)]",children:e.jsx(ee,{size:14})})]})]},l.id)})})]})]})}function wt(){const{tradeHistory:c,positions:s}=D(),[t,a]=g.useState("open"),n=c.reduce((o,m)=>o+(m.pnl||0),0),r=c.filter(o=>(o.pnl||0)>0).length,i=c.length>0?r/c.length*100:0;return e.jsxs("div",{className:"flex-1 overflow-y-auto p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl font-bold",children:"Historial de Trading"}),e.jsxs("p",{className:"text-sm text-[var(--text-dim)]",children:[c.length," trades cerrados ‚Ä¢ ",s.length," posiciones abiertas"]})]}),e.jsxs("button",{className:"flex items-center gap-2 px-3 py-1.5 bg-[var(--dark-3)] text-[var(--text-dim)] rounded-lg text-xs hover:text-[var(--text)] transition-colors",children:[e.jsx(_e,{size:14})," Exportar CSV"]})]}),e.jsxs("div",{className:"grid grid-cols-4 gap-3",children:[e.jsxs("div",{className:"bg-[var(--dark-2)] border border-[var(--border)] rounded-xl p-3 text-center",children:[e.jsx("p",{className:"text-xs text-[var(--text-dim)]",children:"Total Trades"}),e.jsx("p",{className:"text-lg font-bold",children:c.length})]}),e.jsxs("div",{className:"bg-[var(--dark-2)] border border-[var(--border)] rounded-xl p-3 text-center",children:[e.jsx("p",{className:"text-xs text-[var(--text-dim)]",children:"P&L Total"}),e.jsxs("p",{className:`text-lg font-bold ${n>=0?"text-[var(--green)]":"text-[var(--red)]"}`,children:[n>=0?"+":"","$",n.toFixed(2)]})]}),e.jsxs("div",{className:"bg-[var(--dark-2)] border border-[var(--border)] rounded-xl p-3 text-center",children:[e.jsx("p",{className:"text-xs text-[var(--text-dim)]",children:"Win Rate"}),e.jsxs("p",{className:"text-lg font-bold text-[var(--gold)]",children:[i.toFixed(1),"%"]})]}),e.jsxs("div",{className:"bg-[var(--dark-2)] border border-[var(--border)] rounded-xl p-3 text-center",children:[e.jsx("p",{className:"text-xs text-[var(--text-dim)]",children:"Posiciones Abiertas"}),e.jsx("p",{className:"text-lg font-bold text-[var(--blue)]",children:s.length})]})]}),e.jsxs("div",{className:"flex gap-1 bg-[var(--dark-3)] rounded-lg p-1 w-fit",children:[e.jsxs("button",{onClick:()=>a("open"),className:`px-4 py-1.5 text-sm rounded-md ${t==="open"?"bg-[var(--gold)] text-white font-bold":"text-[var(--text-dim)]"}`,children:["Abiertas (",s.length,")"]}),e.jsxs("button",{onClick:()=>a("closed"),className:`px-4 py-1.5 text-sm rounded-md ${t==="closed"?"bg-[var(--gold)] text-white font-bold":"text-[var(--text-dim)]"}`,children:["Cerradas (",c.length,")"]})]}),e.jsx("div",{className:"bg-[var(--dark-2)] border border-[var(--border)] rounded-xl overflow-hidden",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-[var(--border)] text-[var(--text-dim)] text-xs",children:[e.jsx("th",{className:"text-left p-3",children:"Par"}),e.jsx("th",{className:"text-left p-3",children:"Lado"}),e.jsx("th",{className:"text-right p-3",children:"Entrada"}),e.jsx("th",{className:"text-right p-3",children:"Cantidad"}),e.jsx("th",{className:"text-right p-3",children:"P&L"}),e.jsx("th",{className:"text-right p-3",children:"Fecha"})]})}),e.jsx("tbody",{children:(t==="open"?s:c).length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:6,className:"p-8 text-center text-[var(--text-dim)]",children:t==="open"?"Sin posiciones abiertas":"Sin trades cerrados"})}):(t==="open"?s:c).map((o,m)=>{var p,l;return e.jsxs("tr",{className:"border-b border-[var(--border)] hover:bg-[var(--dark-3)] transition-colors",children:[e.jsx("td",{className:"p-3 font-bold",children:o.symbol}),e.jsx("td",{className:"p-3",children:e.jsx("span",{className:`px-2 py-0.5 rounded-full text-xs font-bold
                    ${o.side==="buy"?"bg-[var(--green)]/20 text-[var(--green)]":"bg-[var(--red)]/20 text-[var(--red)]"}`,children:(p=o.side)==null?void 0:p.toUpperCase()})}),e.jsxs("td",{className:"p-3 text-right font-mono",children:["$",(l=o.entryPrice)==null?void 0:l.toFixed(2)]}),e.jsx("td",{className:"p-3 text-right font-mono",children:o.quantity}),e.jsxs("td",{className:`p-3 text-right font-mono font-bold ${(o.pnl||0)>=0?"text-[var(--green)]":"text-[var(--red)]"}`,children:[(o.pnl||0)>=0?"+":"","$",(o.pnl||0).toFixed(2)]}),e.jsx("td",{className:"p-3 text-right text-xs text-[var(--text-dim)]",children:new Date(o.openedAt||o.closedAt).toLocaleDateString()})]},o.id||m)})})]})})]})}const ge="kairos_trade_simulator";class kt{constructor(){this.state=this._load()}_load(){try{const s=JSON.parse(localStorage.getItem(ge));if(s)return s}catch{}return this._defaultState()}_defaultState(){return{balance:1e4,initialBalance:1e4,positions:[],closedTrades:[],orders:[],equity:1e4,stats:{totalTrades:0,wins:0,losses:0,totalPnl:0,bestTrade:0,worstTrade:0,avgWin:0,avgLoss:0,maxDrawdown:0,sharpeRatio:0},equityHistory:[{time:Date.now(),value:1e4}],createdAt:new Date().toISOString()}}_save(){localStorage.setItem(ge,JSON.stringify(this.state))}reset(s=1e4){return this.state=this._defaultState(),this.state.balance=s,this.state.initialBalance=s,this.state.equity=s,this.state.equityHistory=[{time:Date.now(),value:s}],this._save(),this.state}async openPosition(s,t,a,n={}){const r=await R.getPrice(s),i=r*a;if(i>this.state.balance)throw new Error(`Fondos insuficientes. Necesitas $${i.toFixed(2)}, tienes $${this.state.balance.toFixed(2)}`);const o={id:Date.now().toString(36)+Math.random().toString(36).slice(2,6),symbol:s,side:t,quantity:a,entryPrice:r,currentPrice:r,cost:i,pnl:0,pnlPercent:0,stopLoss:n.stopLoss||null,takeProfit:n.takeProfit||null,leverage:n.leverage||1,openedAt:new Date().toISOString()};return this.state.balance-=i,this.state.positions.push(o),this._save(),{success:!0,position:o,message:`${t.toUpperCase()} ${a} ${s} @ $${r.toFixed(2)}`}}async closePosition(s){const t=this.state.positions.findIndex(m=>m.id===s);if(t===-1)throw new Error("Posici√≥n no encontrada");const a=this.state.positions[t],n=await R.getPrice(a.symbol),r=a.side==="buy"?(n-a.entryPrice)*a.quantity*a.leverage:(a.entryPrice-n)*a.quantity*a.leverage,i=r/a.cost*100,o={...a,exitPrice:n,pnl:r,pnlPercent:i,closedAt:new Date().toISOString(),duration:Date.now()-new Date(a.openedAt).getTime()};return this.state.balance+=a.cost+r,this.state.positions.splice(t,1),this.state.closedTrades.push(o),this._updateStats(r),this._save(),{success:!0,trade:o,message:`Cerrada: ${r>=0?"+":""}$${r.toFixed(2)} (${i.toFixed(1)}%)`}}async placeLimitOrder(s,t,a,n,r={}){const i=await R.getPrice(s),o={id:Date.now().toString(36),symbol:s,side:t,quantity:a,targetPrice:n,currentPrice:i,type:"limit",stopLoss:r.stopLoss||null,takeProfit:r.takeProfit||null,status:"pending",createdAt:new Date().toISOString()};return this.state.orders.push(o),this._save(),{success:!0,order:o}}cancelOrder(s){return this.state.orders=this.state.orders.filter(t=>t.id!==s),this._save(),{success:!0}}async updatePositions(){let s=this.state.balance;for(const t of this.state.positions)try{const a=await R.getPrice(t.symbol);if(t.currentPrice=a,t.pnl=t.side==="buy"?(a-t.entryPrice)*t.quantity*(t.leverage||1):(t.entryPrice-a)*t.quantity*(t.leverage||1),t.pnlPercent=t.pnl/t.cost*100,s+=t.cost+t.pnl,t.stopLoss&&(t.side==="buy"?a<=t.stopLoss:a>=t.stopLoss)){await this.closePosition(t.id);continue}if(t.takeProfit&&(t.side==="buy"?a>=t.takeProfit:a<=t.takeProfit)){await this.closePosition(t.id);continue}}catch{}for(const t of this.state.orders.filter(a=>a.status==="pending"))try{const a=await R.getPrice(t.symbol);(t.side==="buy"?a<=t.targetPrice:a>=t.targetPrice)&&(t.status="filled",await this.openPosition(t.symbol,t.side,t.quantity,{stopLoss:t.stopLoss,takeProfit:t.takeProfit}))}catch{}return this.state.orders=this.state.orders.filter(t=>t.status==="pending"),this.state.equity=s,this.state.equityHistory.push({time:Date.now(),value:s}),this.state.equityHistory.length>500&&(this.state.equityHistory=this.state.equityHistory.slice(-500)),this._save(),this.state}_updateStats(s){const t=this.state.stats;t.totalTrades++,t.totalPnl+=s,s>0?(t.wins++,t.bestTrade=Math.max(t.bestTrade,s)):(t.losses++,t.worstTrade=Math.min(t.worstTrade,s)),t.avgWin=t.wins>0?t.totalPnl/t.wins:0,t.avgLoss=t.losses>0?(t.totalPnl-t.avgWin*t.wins)/t.losses:0;const a=Math.max(...this.state.equityHistory.map(i=>i.value));t.maxDrawdown=(a-this.state.equity)/a*100,t.winRate=t.totalTrades>0?t.wins/t.totalTrades*100:0;const n=this.state.closedTrades.filter(i=>i.pnl>0).reduce((i,o)=>i+o.pnl,0),r=Math.abs(this.state.closedTrades.filter(i=>i.pnl<0).reduce((i,o)=>i+o.pnl,0));t.profitFactor=r>0?n/r:n>0?1/0:0}getState(){return this.state}getPerformance(){const s=this.state,t=(s.equity-s.initialBalance)/s.initialBalance*100;return{balance:s.balance,equity:s.equity,initialBalance:s.initialBalance,returnPct:t,openPositions:s.positions.length,pendingOrders:s.orders.length,...s.stats}}}const M=new kt;function St(){var T,d,f;const{selectedPair:c,currentPrice:s,setPage:t}=D(),[a,n]=g.useState(M.getState()),[r,i]=g.useState(M.getPerformance()),[o,m]=g.useState({quantity:"",stopLoss:"",takeProfit:"",side:"buy"}),[p,l]=g.useState(!1),[v,u]=g.useState(null);g.useEffect(()=>{const x=setInterval(async()=>{const w=await M.updatePositions();n({...w}),i(M.getPerformance())},1e4);return()=>clearInterval(x)},[]);const N=g.useCallback(async()=>{const x=await M.updatePositions();n({...x}),i(M.getPerformance())},[]),h=async()=>{if(!(!o.quantity||!s)){l(!0);try{const x=await M.openPosition(c,o.side,parseFloat(o.quantity),{stopLoss:o.stopLoss?parseFloat(o.stopLoss):null,takeProfit:o.takeProfit?parseFloat(o.takeProfit):null});u({type:"success",text:x.message}),m({...o,quantity:"",stopLoss:"",takeProfit:""}),await N()}catch(x){u({type:"error",text:x.message})}l(!1),setTimeout(()=>u(null),3e3)}},j=async x=>{try{const w=await M.closePosition(x);u({type:w.trade.pnl>=0?"success":"error",text:w.message}),await N()}catch(w){u({type:"error",text:w.message})}setTimeout(()=>u(null),3e3)},y=()=>{M.reset(1e4),n(M.getState()),i(M.getPerformance()),u({type:"success",text:"Simulador reiniciado con $10,000"}),setTimeout(()=>u(null),2e3)},S=r.returnPct||0;return e.jsxs("div",{className:"flex-1 overflow-y-auto p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-xl font-bold flex items-center gap-2",children:[e.jsx(Q,{size:20,className:"text-[var(--gold)]"}),"Paper Trading Simulator"]}),e.jsx("p",{className:"text-sm text-[var(--text-dim)]",children:"Practica con datos reales, sin arriesgar dinero real"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:N,className:"px-3 py-1.5 bg-[var(--dark-3)] text-[var(--text-dim)] rounded-lg text-xs hover:text-[var(--text)] transition-colors",children:"Actualizar"}),e.jsxs("button",{onClick:y,className:"flex items-center gap-1 px-3 py-1.5 bg-[var(--red)]/20 text-[var(--red)] rounded-lg text-xs font-bold hover:bg-[var(--red)]/30 transition-colors",children:[e.jsx(qe,{size:12})," Reiniciar"]})]})]}),e.jsx(H,{children:v&&e.jsx(I.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},className:`p-3 rounded-xl text-sm font-bold text-center ${v.type==="success"?"bg-[var(--green)]/20 text-[var(--green)]":"bg-[var(--red)]/20 text-[var(--red)]"}`,children:v.text})}),e.jsx("div",{className:"grid grid-cols-5 gap-3",children:[{label:"Balance",value:`$${(T=r.balance)==null?void 0:T.toFixed(2)}`,icon:je,color:"var(--gold)"},{label:"Equity",value:`$${(d=r.equity)==null?void 0:d.toFixed(2)}`,icon:Y,color:"var(--blue)"},{label:"Retorno",value:`${S>=0?"+":""}${S.toFixed(2)}%`,icon:S>=0?ae:be,color:S>=0?"var(--green)":"var(--red)"},{label:"Win Rate",value:`${(r.winRate||0).toFixed(0)}%`,icon:Ke,color:"var(--gold)"},{label:"Trades",value:r.totalTrades||0,icon:se,color:"var(--text)"}].map((x,w)=>{const L=x.icon;return e.jsxs(I.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:w*.05},className:"bg-[var(--dark-2)] border border-[var(--border)] rounded-xl p-3 text-center",children:[e.jsx(L,{size:16,style:{color:x.color},className:"mx-auto mb-1"}),e.jsx("p",{className:"text-lg font-bold font-mono",style:{color:x.color},children:x.value}),e.jsx("p",{className:"text-[10px] text-[var(--text-dim)]",children:x.label})]},x.label)})}),e.jsx("div",{className:"grid grid-cols-4 gap-3",children:[{label:"P&L Total",value:`${r.totalPnl>=0?"+":""}$${(r.totalPnl||0).toFixed(2)}`,color:(r.totalPnl||0)>=0?"var(--green)":"var(--red)"},{label:"Mejor Trade",value:`+$${(r.bestTrade||0).toFixed(2)}`,color:"var(--green)"},{label:"Peor Trade",value:`$${(r.worstTrade||0).toFixed(2)}`,color:"var(--red)"},{label:"Max Drawdown",value:`${(r.maxDrawdown||0).toFixed(1)}%`,color:"var(--red)"}].map(x=>e.jsxs("div",{className:"bg-[var(--dark-2)] border border-[var(--border)] rounded-xl p-3",children:[e.jsx("p",{className:"text-xs text-[var(--text-dim)]",children:x.label}),e.jsx("p",{className:"text-sm font-bold font-mono",style:{color:x.color},children:x.value})]},x.label))}),e.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-[var(--dark-2)] border border-[var(--border)] rounded-xl p-4 space-y-3",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Abrir Posici√≥n (Demo)"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm font-bold text-[var(--gold)]",children:c}),e.jsxs("span",{className:"text-sm font-mono",children:["$",(s==null?void 0:s.toLocaleString(void 0,{maximumFractionDigits:2}))||"---"]}),e.jsx("button",{onClick:()=>t("chart"),className:"text-xs text-[var(--gold)] hover:underline ml-auto",children:"Ver gr√°fico ‚Üí"})]}),e.jsxs("div",{className:"flex gap-1 bg-[var(--dark-3)] rounded-lg p-1",children:[e.jsx("button",{onClick:()=>m({...o,side:"buy"}),className:`flex-1 py-2 text-sm font-bold rounded-md transition-all ${o.side==="buy"?"bg-[var(--green)] text-white":"text-[var(--text-dim)]"}`,children:"COMPRAR"}),e.jsx("button",{onClick:()=>m({...o,side:"sell"}),className:`flex-1 py-2 text-sm font-bold rounded-md transition-all ${o.side==="sell"?"bg-[var(--red)] text-white":"text-[var(--text-dim)]"}`,children:"VENDER"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-[var(--text-dim)] mb-1 block",children:"Cantidad"}),e.jsx("input",{type:"number",value:o.quantity,onChange:x=>m({...o,quantity:x.target.value}),placeholder:"Ej: 0.01",className:"w-full text-sm"}),o.quantity&&s&&e.jsxs("p",{className:"text-[10px] text-[var(--text-dim)] mt-1",children:["Costo: $",(parseFloat(o.quantity)*s).toFixed(2)," de $",(f=r.balance)==null?void 0:f.toFixed(2)," disponible"]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"text-xs text-[var(--text-dim)] mb-1 flex items-center gap-1",children:[e.jsx(Z,{size:10})," Stop Loss"]}),e.jsx("input",{type:"number",value:o.stopLoss,onChange:x=>m({...o,stopLoss:x.target.value}),placeholder:"Precio",className:"w-full text-xs"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"text-xs text-[var(--text-dim)] mb-1 flex items-center gap-1",children:[e.jsx(se,{size:10})," Take Profit"]}),e.jsx("input",{type:"number",value:o.takeProfit,onChange:x=>m({...o,takeProfit:x.target.value}),placeholder:"Precio",className:"w-full text-xs"})]})]}),e.jsx("button",{onClick:h,disabled:!o.quantity||!s||p,className:`w-full py-3 font-bold rounded-xl text-sm transition-colors disabled:opacity-50 ${o.side==="buy"?"bg-[var(--green)] text-white":"bg-[var(--red)] text-white"}`,children:p?"Ejecutando...":`${o.side==="buy"?"Comprar":"Vender"} ${c.replace("USDT","")} (Demo)`})]}),e.jsxs("div",{className:"bg-[var(--dark-2)] border border-[var(--border)] rounded-xl p-4",children:[e.jsxs("h3",{className:"text-sm font-bold mb-3",children:["Posiciones Abiertas (",a.positions.length,")"]}),a.positions.length===0?e.jsx("p",{className:"text-sm text-[var(--text-dim)] text-center py-8",children:"Sin posiciones abiertas"}):e.jsx("div",{className:"space-y-2 max-h-64 overflow-y-auto",children:a.positions.map(x=>{var w,L,b,A;return e.jsxs("div",{className:"bg-[var(--dark-3)] rounded-xl p-3",children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:`text-xs font-bold px-1.5 py-0.5 rounded ${x.side==="buy"?"bg-[var(--green)]/20 text-[var(--green)]":"bg-[var(--red)]/20 text-[var(--red)]"}`,children:x.side.toUpperCase()}),e.jsx("span",{className:"text-sm font-bold",children:x.symbol})]}),e.jsx("button",{onClick:()=>j(x.id),className:"px-2 py-0.5 bg-[var(--dark-4)] text-[var(--text-dim)] rounded text-[10px] hover:bg-[var(--red)]/20 hover:text-[var(--red)] transition-colors",children:"Cerrar"})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-2 text-[10px]",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-[var(--text-dim)]",children:"Entrada"}),e.jsxs("p",{className:"font-mono",children:["$",(w=x.entryPrice)==null?void 0:w.toFixed(2)]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-[var(--text-dim)]",children:"Actual"}),e.jsxs("p",{className:"font-mono",children:["$",(L=x.currentPrice)==null?void 0:L.toFixed(2)]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-[var(--text-dim)]",children:"P&L"}),e.jsxs("p",{className:`font-mono font-bold ${x.pnl>=0?"text-[var(--green)]":"text-[var(--red)]"}`,children:[x.pnl>=0?"+":"","$",(b=x.pnl)==null?void 0:b.toFixed(2)," (",(A=x.pnlPercent)==null?void 0:A.toFixed(1),"%)"]})]})]})]},x.id)})})]})]}),a.closedTrades.length>0&&e.jsxs("div",{className:"bg-[var(--dark-2)] border border-[var(--border)] rounded-xl overflow-hidden",children:[e.jsx("div",{className:"p-3 border-b border-[var(--border)]",children:e.jsx("h3",{className:"text-sm font-bold",children:"Historial de Trades (Demo)"})}),e.jsx("div",{className:"max-h-64 overflow-y-auto",children:e.jsxs("table",{className:"w-full text-xs",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"text-[var(--text-dim)] border-b border-[var(--border)]",children:[e.jsx("th",{className:"text-left p-2",children:"Par"}),e.jsx("th",{className:"text-left p-2",children:"Lado"}),e.jsx("th",{className:"text-right p-2",children:"Entrada"}),e.jsx("th",{className:"text-right p-2",children:"Salida"}),e.jsx("th",{className:"text-right p-2",children:"P&L"})]})}),e.jsx("tbody",{children:a.closedTrades.slice().reverse().map(x=>{var w,L,b;return e.jsxs("tr",{className:"border-b border-[var(--border)]/50 hover:bg-[var(--dark-3)]",children:[e.jsx("td",{className:"p-2 font-bold",children:x.symbol}),e.jsx("td",{className:"p-2",children:e.jsx("span",{className:x.side==="buy"?"text-[var(--green)]":"text-[var(--red)]",children:x.side.toUpperCase()})}),e.jsxs("td",{className:"p-2 text-right font-mono",children:["$",(w=x.entryPrice)==null?void 0:w.toFixed(2)]}),e.jsxs("td",{className:"p-2 text-right font-mono",children:["$",(L=x.exitPrice)==null?void 0:L.toFixed(2)]}),e.jsxs("td",{className:`p-2 text-right font-mono font-bold ${x.pnl>=0?"text-[var(--green)]":"text-[var(--red)]"}`,children:[x.pnl>=0?"+":"","$",(b=x.pnl)==null?void 0:b.toFixed(2)]})]},x.id)})})]})})]}),e.jsxs("div",{className:"text-center text-xs text-[var(--text-dim)] pb-4",children:[e.jsx("p",{children:"‚ö†Ô∏è Esto es un simulador con datos reales del mercado. No se usa dinero real."}),e.jsx("p",{className:"text-[var(--gold)] mt-1",children:"Practica tus estrategias sin riesgo."})]})]})}function Pt(){var m;const{settings:c,updateSettings:s,user:t}=D(),[a,n]=g.useState(""),[r,i]=g.useState(!1),o=()=>{a.trim()&&(Ne.setApiKey(a.trim()),s({openaiKey:a.trim()}),i(!0),setTimeout(()=>i(!1),2e3))};return e.jsxs("div",{className:"flex-1 overflow-y-auto p-6 space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl font-bold",children:"Ajustes"}),e.jsx("p",{className:"text-sm text-[var(--text-dim)]",children:"Configuraci√≥n de tu plataforma"})]}),e.jsxs("div",{className:"bg-[var(--dark-2)] border border-[var(--border)] rounded-xl p-4",children:[e.jsxs("h2",{className:"text-sm font-bold mb-3 flex items-center gap-2",children:[e.jsx(Z,{size:16,className:"text-[var(--gold)]"})," Perfil"]}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("p",{children:[e.jsx("span",{className:"text-[var(--text-dim)]",children:"Email:"})," ",t==null?void 0:t.email]}),e.jsxs("p",{children:[e.jsx("span",{className:"text-[var(--text-dim)]",children:"Nombre:"})," ",t==null?void 0:t.name]}),e.jsxs("p",{children:[e.jsx("span",{className:"text-[var(--text-dim)]",children:"Plan:"})," ",e.jsx("span",{className:"text-[var(--gold)]",children:(m=t==null?void 0:t.plan)==null?void 0:m.toUpperCase()})]})]})]}),e.jsxs("div",{className:"bg-[var(--dark-2)] border border-[var(--border)] rounded-xl p-4",children:[e.jsxs("h2",{className:"text-sm font-bold mb-3 flex items-center gap-2",children:[e.jsx(Ue,{size:16,className:"text-[var(--gold)]"})," API Key de OpenAI"]}),e.jsx("p",{className:"text-xs text-[var(--text-dim)] mb-2",children:"Opcional. Sin API key, Kairos AI usa an√°lisis local integrado. Con API key, accedes a GPT-4 para an√°lisis avanzado."}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"password",value:a,onChange:p=>n(p.target.value),placeholder:"sk-...",className:"flex-1 text-sm font-mono"}),e.jsx("button",{onClick:o,className:"px-4 py-2 bg-[var(--gold)] text-white rounded-xl text-sm font-bold",children:r?"‚úì Guardado":"Guardar"})]})]}),e.jsxs("div",{className:"bg-[var(--dark-2)] border border-[var(--border)] rounded-xl p-4",children:[e.jsxs("h2",{className:"text-sm font-bold mb-3 flex items-center gap-2",children:[e.jsx(He,{size:16,className:"text-[var(--gold)]"})," Trading por Defecto"]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-[var(--text-dim)] mb-1 block",children:"Riesgo m√°x. por trade (%)"}),e.jsx("input",{type:"number",value:c.maxRiskPerTrade,onChange:p=>s({maxRiskPerTrade:parseFloat(p.target.value)}),className:"w-full text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-[var(--text-dim)] mb-1 block",children:"Apalancamiento predeterminado"}),e.jsx("input",{type:"number",value:c.defaultLeverage,onChange:p=>s({defaultLeverage:parseFloat(p.target.value)}),className:"w-full text-sm"})]})]})]}),e.jsxs("div",{className:"bg-[var(--dark-2)] border border-[var(--border)] rounded-xl p-4",children:[e.jsxs("h2",{className:"text-sm font-bold mb-3 flex items-center gap-2",children:[e.jsx(fe,{size:16,className:"text-[var(--gold)]"})," Notificaciones"]}),e.jsx("div",{className:"space-y-3",children:[{key:"notifications",label:"Notificaciones",desc:"Alertas de trades y se√±ales"},{key:"soundAlerts",label:"Sonido",desc:"Alertas sonoras al ejecutar trades"}].map(p=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm",children:p.label}),e.jsx("p",{className:"text-xs text-[var(--text-dim)]",children:p.desc})]}),e.jsx("button",{onClick:()=>s({[p.key]:!c[p.key]}),className:`w-12 h-6 rounded-full transition-colors relative
                  ${c[p.key]?"bg-[var(--gold)]":"bg-[var(--dark-4)]"}`,children:e.jsx("div",{className:`w-5 h-5 bg-white rounded-full absolute top-0.5 transition-transform
                    ${c[p.key]?"left-6":"left-0.5"}`})})]},p.key))})]}),e.jsxs("div",{className:"bg-[var(--dark-2)] border border-[var(--border)] rounded-xl p-4",children:[e.jsxs("h2",{className:"text-sm font-bold mb-3 flex items-center gap-2",children:[e.jsx(te,{size:16,className:"text-[var(--gold)]"})," Kairos Wallet"]}),e.jsx("p",{className:"text-xs text-[var(--text-dim)] mb-3",children:"Conecta tu Kairos Wallet para usar KAIROS Coin como m√©todo de pago y recibir recompensas."}),e.jsxs("a",{href:"https://kairos-wallet.netlify.app",target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-2 px-4 py-2 bg-[var(--gold)]/20 text-[var(--gold)] rounded-xl text-sm font-bold hover:bg-[var(--gold)]/30 transition-colors",children:[e.jsx(te,{size:14})," Abrir Kairos Wallet"]})]}),e.jsxs("div",{className:"text-center text-xs text-[var(--text-dim)] pb-4",children:[e.jsx("p",{children:"Kairos Trade v1.0.0 ‚Ä¢ Kairos 777 Inc"}),e.jsx("p",{className:"text-[var(--gold)] mt-1",children:"Powered by Kairos AI"})]})]})}function Ct(){const{isAuthenticated:c,currentPage:s,aiPanelOpen:t}=D();if(!c)return e.jsx(ct,{});const a=()=>{switch(s){case"dashboard":return e.jsx(me,{});case"chart":return e.jsxs("div",{className:"flex flex-1 overflow-hidden h-full",children:[e.jsx("div",{className:"flex-1 h-full overflow-hidden",children:e.jsx(pt,{})}),e.jsx(ut,{})]});case"bots":return e.jsx(gt,{});case"simulator":return e.jsx(St,{});case"brokers":return e.jsx(bt,{});case"ai":return e.jsx(ve,{});case"strategies":return e.jsx(Nt,{});case"history":return e.jsx(wt,{});case"wallet":return e.jsx("div",{className:"flex-1 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-16 h-16 rounded-2xl bg-[var(--gold)]/15 flex items-center justify-center text-[var(--gold)] text-2xl font-bold mx-auto mb-4",children:"K"}),e.jsx("h2",{className:"text-lg font-bold mb-2",children:"Kairos Wallet"}),e.jsx("p",{className:"text-sm text-[var(--text-dim)] mb-4 max-w-xs",children:"Conecta tu Kairos Wallet para integrar tus balances de KAIROS Coin con la plataforma de trading."}),e.jsx("a",{href:"https://kairos-wallet.netlify.app",target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-2 px-6 py-3 bg-[var(--gold)] text-white font-semibold rounded-xl hover:bg-[var(--gold-light)] transition-colors",children:"Abrir Kairos Wallet"})]})});case"settings":return e.jsx(Pt,{});default:return e.jsx(me,{})}};return e.jsxs("div",{className:"flex h-screen bg-[var(--dark)] overflow-hidden",children:[e.jsx(Ve,{position:"top-right",toastOptions:{style:{background:"#181A20",color:"#EAECEF",border:"1px solid #1E222D",fontSize:"13px"}}}),e.jsx(ot,{}),e.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden",children:[e.jsx(lt,{}),e.jsxs("div",{className:"flex flex-1 overflow-hidden",children:[e.jsx(H,{mode:"wait",children:e.jsx(I.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.15},className:"flex-1 flex flex-col overflow-hidden",children:a()},s)}),e.jsx(H,{children:t&&s!=="ai"&&e.jsx(I.div,{initial:{width:0,opacity:0},animate:{width:380,opacity:1},exit:{width:0,opacity:0},transition:{duration:.2},className:"border-l border-[var(--border)] overflow-hidden shrink-0",children:e.jsx(ve,{})})})]})]})]})}at.createRoot(document.getElementById("root")).render(e.jsx(Xe.StrictMode,{children:e.jsx(Ye,{children:e.jsx(Ct,{})})}));
