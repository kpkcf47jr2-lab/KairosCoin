import{j as e,m as B,U as We,C as ze,L as Ge,B as ee,P as oe,a as ae,Z as Q,S as ge,b as we,H as Qe,c as re,W as ue,d as Ye,e as Je,A as K,f as Xe,g as fe,T as X,h as ie,i as Ze,k as et,l as se,n as te,E as qe,o as Ue,p as tt,q as ye,D as ne,r as st,s as at,t as rt,u as je,v as ve,G as it,w as nt,x as lt,y as ce,z as Ne,X as ot,R as ct,F as dt,I as xt,J as mt,K as pt,M as ut,N as ht,O as gt,Q as vt,V as bt}from"./ui-BiAtrKCH.js";import{b as ft,g as yt,c as jt,a as w,R as Nt,B as wt}from"./vendor-CUCP814w.js";import{V as St,a as kt,I as Pt}from"./charts-UjLl1g-4.js";(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))a(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const n of o.addedNodes)n.tagName==="LINK"&&n.rel==="modulepreload"&&a(n)}).observe(document,{childList:!0,subtree:!0});function t(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerPolicy&&(o.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?o.credentials="include":i.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function a(i){if(i.ep)return;i.ep=!0;const o=t(i);fetch(i.href,o)}})();var me={},Fe;function Ct(){if(Fe)return me;Fe=1;var x=ft();return me.createRoot=x.createRoot,me.hydrateRoot=x.hydrateRoot,me}var Tt=Ct();const At=yt(Tt),J={binance:{id:"binance",name:"Binance",logo:"üü°",baseUrl:"https://api.binance.com",wsUrl:"wss://stream.binance.com:9443/ws",supportedMarkets:["spot","futures"],requiredFields:["apiKey","apiSecret"]},bybit:{id:"bybit",name:"Bybit",logo:"üü†",baseUrl:"https://api.bybit.com",wsUrl:"wss://stream.bybit.com/v5/public/spot",supportedMarkets:["spot","futures","options"],requiredFields:["apiKey","apiSecret"]},kraken:{id:"kraken",name:"Kraken",logo:"üü£",baseUrl:"https://api.kraken.com",wsUrl:"wss://ws.kraken.com",supportedMarkets:["spot","futures"],requiredFields:["apiKey","apiSecret"]},coinbase:{id:"coinbase",name:"Coinbase",logo:"üîµ",baseUrl:"https://api.coinbase.com",wsUrl:"wss://ws-feed.exchange.coinbase.com",supportedMarkets:["spot"],requiredFields:["apiKey","apiSecret","passphrase"]},kucoin:{id:"kucoin",name:"KuCoin",logo:"üü¢",baseUrl:"https://api.kucoin.com",wsUrl:"wss://ws-api.kucoin.com",supportedMarkets:["spot","futures"],requiredFields:["apiKey","apiSecret","passphrase"]},okx:{id:"okx",name:"OKX",logo:"‚ö´",baseUrl:"https://www.okx.com",wsUrl:"wss://ws.okx.com:8443/ws/v5/public",supportedMarkets:["spot","futures","options"],requiredFields:["apiKey","apiSecret","passphrase"]}},Se=["BTCUSDT","ETHUSDT","BNBUSDT","SOLUSDT","XRPUSDT","ADAUSDT","DOGEUSDT","AVAXUSDT","DOTUSDT","MATICUSDT","LINKUSDT","ATOMUSDT","LTCUSDT","UNIUSDT","AAVEUSDT"],ke=[{label:"1m",value:"1m",seconds:60},{label:"5m",value:"5m",seconds:300},{label:"15m",value:"15m",seconds:900},{label:"1H",value:"1h",seconds:3600},{label:"4H",value:"4h",seconds:14400},{label:"1D",value:"1d",seconds:86400},{label:"1W",value:"1w",seconds:604800}],R={AUTH:"kairos_trade_auth",BROKERS:"kairos_trade_brokers",BOTS:"kairos_trade_bots",SETTINGS:"kairos_trade_settings",STRATEGIES:"kairos_trade_strategies",POSITIONS:"kairos_trade_positions",ORDERS:"kairos_trade_orders",TRADE_HISTORY:"kairos_trade_history"},W=(x,s)=>{try{return JSON.parse(localStorage.getItem(x))||s}catch{return s}},U=(x,s)=>localStorage.setItem(x,JSON.stringify(s)),_=jt((x,s)=>({user:W(R.AUTH,null),isAuthenticated:!!W(R.AUTH,null),login:t=>{U(R.AUTH,t),x({user:t,isAuthenticated:!0})},logout:()=>{localStorage.removeItem(R.AUTH),x({user:null,isAuthenticated:!1})},currentPage:"dashboard",setPage:t=>x({currentPage:t}),brokers:W(R.BROKERS,[]),activeBroker:null,addBroker:t=>{const a={...t,id:Date.now().toString(36),apiKey:btoa(t.apiKey),apiSecret:btoa(t.apiSecret),passphrase:t.passphrase?btoa(t.passphrase):void 0,connected:!1,addedAt:new Date().toISOString()},i=[...s().brokers,a];return U(R.BROKERS,i),x({brokers:i}),a},removeBroker:t=>{var i;const a=s().brokers.filter(o=>o.id!==t);U(R.BROKERS,a),x({brokers:a,activeBroker:((i=s().activeBroker)==null?void 0:i.id)===t?null:s().activeBroker})},setActiveBroker:t=>x({activeBroker:t}),updateBrokerStatus:(t,a)=>{const i=s().brokers.map(o=>o.id===t?{...o,connected:a}:o);U(R.BROKERS,i),x({brokers:i})},bots:W(R.BOTS,[]),addBot:t=>{const a={...t,id:Date.now().toString(36),status:"stopped",trades:0,pnl:0,winRate:0,createdAt:new Date().toISOString()},i=[...s().bots,a];return U(R.BOTS,i),x({bots:i}),a},updateBot:(t,a)=>{const i=s().bots.map(o=>o.id===t?{...o,...a}:o);U(R.BOTS,i),x({bots:i})},removeBot:t=>{const a=s().bots.filter(i=>i.id!==t);U(R.BOTS,a),x({bots:a})},selectedPair:"BTCUSDT",selectedTimeframe:"1h",currentPrice:null,priceChange24h:null,orderBook:{bids:[],asks:[]},positions:W(R.POSITIONS,[]),orders:W(R.ORDERS,[]),tradeHistory:W(R.TRADE_HISTORY,[]),setSelectedPair:t=>x({selectedPair:t}),setSelectedTimeframe:t=>x({selectedTimeframe:t}),setCurrentPrice:t=>x({currentPrice:t}),setPriceChange24h:t=>x({priceChange24h:t}),setOrderBook:t=>x({orderBook:t}),addPosition:t=>{const a=[...s().positions,{...t,id:Date.now().toString(36)}];U(R.POSITIONS,a),x({positions:a})},closePosition:t=>{const a=s().positions.find(i=>i.id===t);if(a){const i=s().currentPrice||a.entryPrice,o=a.side==="buy"?(i-a.entryPrice)*a.quantity:(a.entryPrice-i)*a.quantity,n={...a,closedAt:new Date().toISOString(),exitPrice:i,pnl:o},l=s().positions.filter(p=>p.id!==t),c=[...s().tradeHistory,n];U(R.POSITIONS,l),U(R.TRADE_HISTORY,c),x({positions:l,tradeHistory:c})}},addOrder:t=>{const a=[...s().orders,{...t,id:Date.now().toString(36)}];U(R.ORDERS,a),x({orders:a})},cancelOrder:t=>{const a=s().orders.filter(i=>i.id!==t);U(R.ORDERS,a),x({orders:a})},strategies:W(R.STRATEGIES,[]),addStrategy:t=>{const a={...t,id:Date.now().toString(36),createdAt:new Date().toISOString()},i=[...s().strategies,a];return U(R.STRATEGIES,i),x({strategies:i}),a},removeStrategy:t=>{const a=s().strategies.filter(i=>i.id!==t);U(R.STRATEGIES,a),x({strategies:a})},aiMessages:[],aiLoading:!1,addAiMessage:t=>x({aiMessages:[...s().aiMessages,t]}),setAiLoading:t=>x({aiLoading:t}),clearAiMessages:()=>x({aiMessages:[]}),settings:W(R.SETTINGS,{theme:"dark",language:"es",notifications:!0,soundAlerts:!0,maxRiskPerTrade:2,defaultLeverage:1}),updateSettings:t=>{const a={...s().settings,...t};U(R.SETTINGS,a),x({settings:a})},sidebarOpen:!0,aiPanelOpen:!1,modalOpen:null,toggleSidebar:()=>x({sidebarOpen:!s().sidebarOpen}),toggleAiPanel:()=>x({aiPanelOpen:!s().aiPanelOpen}),setModal:t=>x({modalOpen:t})})),$t=[{label:"Principal",items:[{id:"dashboard",icon:Ge,label:"Dashboard",desc:"Panel de control"},{id:"chart",icon:ee,label:"Trading",desc:"Gr√°ficos en vivo"},{id:"simulator",icon:oe,label:"Simulador",desc:"Paper trading"}]},{label:"Automatizaci√≥n",items:[{id:"bots",icon:ae,label:"Bots",desc:"Trading autom√°tico"},{id:"strategies",icon:Q,label:"Estrategias",desc:"Crear y gestionar"},{id:"ai",icon:ge,label:"Kairos AI",desc:"Asistente IA",accent:!0}]},{label:"Gesti√≥n",items:[{id:"brokers",icon:we,label:"Brokers",desc:"Conexiones API"},{id:"history",icon:Qe,label:"Historial",desc:"Trades y reportes"},{id:"alerts",icon:re,label:"Alertas",desc:"Notificaciones"}]}],Ft=[{id:"wallet",icon:ue,label:"Wallet"},{id:"settings",icon:Ye,label:"Ajustes"}];function It(){const{currentPage:x,setPage:s,sidebarOpen:t,toggleSidebar:a,bots:i,brokers:o,logout:n,user:l}=_(),[c,p]=w.useState(null),m=i.filter(v=>v.status==="active").length,u=o.filter(v=>v.connected).length,r=v=>v==="bots"?m:v==="brokers"?u:0,y=({item:v,compact:g=!1})=>{const k=v.icon,P=x===v.id,A=r(v.id),I=c===v.id;return e.jsxs("div",{className:"relative",children:[e.jsxs("button",{onClick:()=>s(v.id),onMouseEnter:()=>p(v.id),onMouseLeave:()=>p(null),title:t?void 0:v.label,className:`w-full flex items-center rounded-xl transition-all duration-200 relative group
            ${t?"px-3 py-3 gap-3":"px-0 py-3 justify-center"}
            ${P?"text-white":"text-[var(--text-dim)] hover:text-[var(--text)]"}`,children:[P&&e.jsx(B.div,{layoutId:"navBg",className:"absolute inset-0 rounded-xl",style:{background:v.accent?"linear-gradient(135deg, rgba(212,175,55,0.12), rgba(232,200,74,0.06))":"linear-gradient(135deg, rgba(212,175,55,0.08), rgba(212,175,55,0.02))",border:"1px solid rgba(212,175,55,0.1)"},transition:{type:"spring",stiffness:350,damping:30}}),P&&e.jsx(B.div,{layoutId:"activeBar",className:"absolute left-0 top-1/2 -translate-y-1/2 w-[3px] h-6 rounded-r-full",style:{background:"linear-gradient(180deg, #E8C84A, #D4AF37)"},transition:{type:"spring",stiffness:350,damping:30}}),e.jsxs("div",{className:`relative z-10 flex items-center justify-center shrink-0 rounded-lg transition-all duration-200
            ${t?"w-8 h-8":"w-9 h-9"}
            ${P?v.accent?"bg-[var(--gold)]/20":"bg-white/[0.06]":"bg-transparent group-hover:bg-white/[0.04]"}`,children:[e.jsx(k,{size:t?18:20,strokeWidth:P?2:1.5,className:`transition-colors ${P&&v.accent?"text-[var(--gold-light)]":""}`}),A>0&&!t&&e.jsx("span",{className:"absolute -top-0.5 -right-0.5 w-[14px] h-[14px] bg-[var(--gold)] rounded-full text-[8px] font-bold text-white flex items-center justify-center",children:A})]}),t&&e.jsxs("div",{className:"relative z-10 flex-1 min-w-0 text-left",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:`text-[13px] truncate leading-tight ${P?"font-semibold":"font-medium"}`,children:v.label}),v.accent&&e.jsx("span",{className:"text-[8px] font-bold bg-[var(--gold)]/20 text-[var(--gold-light)] px-1.5 py-0.5 rounded-full uppercase tracking-wider",children:"Pro"}),A>0&&e.jsx("span",{className:"ml-auto text-[10px] font-semibold bg-[var(--gold)]/12 text-[var(--gold)] rounded-full px-2 py-0.5 min-w-[22px] text-center",children:A})]}),!g&&v.desc&&e.jsx("span",{className:`text-[10px] leading-tight truncate block mt-0.5 transition-colors
                  ${P?"text-[var(--text-dim)]":"text-[var(--text-dim)]/50"}`,children:v.desc})]})]}),e.jsx(K,{children:!t&&I&&e.jsx(B.div,{initial:{opacity:0,x:-4},animate:{opacity:1,x:0},exit:{opacity:0,x:-4},transition:{duration:.15},className:"absolute left-full ml-3 top-1/2 -translate-y-1/2 z-50 pointer-events-none",children:e.jsxs("div",{className:"bg-[var(--dark-3)] border border-[var(--border-light)] px-3 py-2 rounded-lg shadow-xl",children:[e.jsx("p",{className:"text-xs font-semibold text-[var(--text)] whitespace-nowrap",children:v.label}),v.desc&&e.jsx("p",{className:"text-[10px] text-[var(--text-dim)] whitespace-nowrap",children:v.desc})]})})})]})},f=({label:v})=>t?e.jsxs("div",{className:"flex items-center gap-2 px-3 mb-2 mt-1",children:[e.jsx("p",{className:"text-[10px] font-bold text-[var(--text-dim)]/40 uppercase tracking-[0.12em]",children:v}),e.jsx("div",{className:"flex-1 h-px bg-[var(--border)]/50"})]}):e.jsx("div",{className:"mx-auto w-6 h-px bg-[var(--border)]/60 my-3"});return e.jsxs(B.aside,{animate:{width:t?260:72},transition:{duration:.25,ease:[.4,0,.2,1]},className:"h-full flex flex-col relative shrink-0",style:{borderRight:"1px solid var(--border)",background:"linear-gradient(180deg, #0E1015 0%, #08090C 100%)"},children:[e.jsxs("div",{className:`flex items-center shrink-0 ${t?"px-5 gap-3 h-[60px]":"justify-center h-[60px]"}`,style:{borderBottom:"1px solid rgba(30,34,45,0.6)"},children:[e.jsxs("div",{className:"w-9 h-9 rounded-xl flex items-center justify-center shrink-0 relative",style:{background:"linear-gradient(135deg, #D4AF37, #B8960C)"},children:[e.jsx("span",{className:"text-[#08090C] font-extrabold text-sm",children:"K"}),e.jsx("div",{className:"absolute inset-0 rounded-xl",style:{boxShadow:"0 0 20px rgba(212,175,55,0.2)"}})]}),t&&e.jsx(B.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.1,duration:.2},children:e.jsxs("div",{className:"flex flex-col",children:[e.jsxs("div",{className:"flex items-baseline gap-1.5",children:[e.jsx("span",{className:"text-[15px] font-bold text-[var(--text)] tracking-wide",children:"KAIROS"}),e.jsx("span",{className:"text-[10px] font-bold text-[var(--gold)] tracking-widest",children:"TRADE"})]}),e.jsx("span",{className:"text-[9px] text-[var(--text-dim)]/60 font-medium tracking-wider",children:"BY KAIROS 777"})]})})]}),t&&e.jsx(B.div,{initial:{opacity:0},animate:{opacity:1},className:"mx-3 mt-4 mb-2 p-3 rounded-xl",style:{background:"linear-gradient(135deg, rgba(212,175,55,0.04), rgba(26,29,38,0.5))",border:"1px solid rgba(212,175,55,0.06)"},children:e.jsxs("div",{className:"flex items-center gap-2.5",children:[e.jsx("div",{className:"w-8 h-8 rounded-lg bg-[var(--dark-4)] flex items-center justify-center",children:e.jsx(We,{size:14,className:"text-[var(--text-dim)]"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-xs font-semibold text-[var(--text)] truncate",children:(l==null?void 0:l.name)||"Trader"}),e.jsxs("div",{className:"flex items-center gap-1 mt-0.5",children:[e.jsx(ze,{size:9,className:"text-[var(--gold)]"}),e.jsx("span",{className:"text-[9px] font-bold text-[var(--gold)] uppercase tracking-wider",children:"Free Plan"})]})]})]})}),e.jsx("nav",{className:`flex-1 overflow-y-auto py-2 ${t?"px-3":"px-2"}`,style:{scrollbarWidth:"none"},children:$t.map((v,g)=>e.jsxs("div",{className:g>0?"mt-5":"mt-1",children:[e.jsx(f,{label:v.label}),e.jsx("div",{className:"space-y-0.5",children:v.items.map(k=>e.jsx(y,{item:k},k.id))})]},v.label))}),e.jsxs("div",{className:`py-3 ${t?"px-3":"px-2"}`,style:{borderTop:"1px solid rgba(30,34,45,0.6)"},children:[e.jsx("div",{className:"space-y-0.5",children:Ft.map(v=>e.jsx(y,{item:v,compact:!0},v.id))}),e.jsxs("button",{onClick:n,onMouseEnter:()=>p("logout"),onMouseLeave:()=>p(null),title:t?void 0:"Salir",className:`w-full flex items-center rounded-xl text-[var(--text-dim)] hover:text-[var(--red)] transition-all duration-200 mt-1 relative
            ${t?"px-3 py-2.5 gap-3":"px-0 py-2.5 justify-center"}
            hover:bg-[var(--red)]/[0.06]`,children:[e.jsx("div",{className:`flex items-center justify-center shrink-0 rounded-lg ${t?"w-8 h-8":"w-9 h-9"}`,children:e.jsx(Je,{size:t?16:18,strokeWidth:1.5})}),t&&e.jsx("span",{className:"text-[13px] font-medium",children:"Cerrar Sesi√≥n"}),e.jsx(K,{children:!t&&c==="logout"&&e.jsx(B.div,{initial:{opacity:0,x:-4},animate:{opacity:1,x:0},exit:{opacity:0,x:-4},transition:{duration:.15},className:"absolute left-full ml-3 top-1/2 -translate-y-1/2 z-50 pointer-events-none",children:e.jsx("div",{className:"bg-[var(--dark-3)] border border-[var(--border-light)] px-3 py-2 rounded-lg shadow-xl",children:e.jsx("p",{className:"text-xs font-semibold text-[var(--red)] whitespace-nowrap",children:"Cerrar Sesi√≥n"})})})})]})]}),e.jsx("button",{onClick:a,className:"absolute -right-3 top-7 w-6 h-6 bg-[var(--dark-3)] border border-[var(--border)] rounded-full flex items-center justify-center text-[var(--text-dim)] hover:text-[var(--gold)] hover:border-[var(--gold)]/30 hover:bg-[var(--dark-4)] transition-all z-10 shadow-lg",children:t?e.jsx(Xe,{size:11}):e.jsx(fe,{size:11})})]})}function Bt(){const{selectedPair:x,currentPrice:s,priceChange24h:t,toggleAiPanel:a,aiPanelOpen:i,brokers:o}=_(),n=o.some(p=>p.connected),[l,c]=w.useState(!1);return e.jsxs("header",{className:"h-[56px] shrink-0 flex items-center justify-between px-5",style:{borderBottom:"1px solid rgba(26,29,38,0.6)",background:"linear-gradient(180deg, rgba(14,16,21,0.95) 0%, rgba(8,9,12,0.95) 100%)",backdropFilter:"blur(16px)"},children:[e.jsx("div",{className:"flex items-center gap-6",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-7 h-7 rounded-lg flex items-center justify-center text-[10px] font-bold",style:{background:"linear-gradient(135deg, rgba(212,175,55,0.12), rgba(212,175,55,0.04))",border:"1px solid rgba(212,175,55,0.1)"},children:e.jsx("span",{className:"text-[var(--gold)]",children:x==null?void 0:x.replace("USDT","").slice(0,3)})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-[14px] font-bold text-[var(--text)] tracking-wide leading-none",children:x}),e.jsx("span",{className:"text-[9px] text-[var(--text-dim)]/60 font-medium",children:"Perpetual"})]})]}),e.jsx("div",{className:"w-px h-7 bg-[var(--border)]/50"}),s&&e.jsx("div",{children:e.jsxs("span",{className:"text-[16px] font-mono font-bold text-[var(--text)] leading-none",children:["$",s.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})]})}),t!==null&&e.jsxs("div",{className:`flex items-center gap-1 text-xs font-mono font-semibold px-2.5 py-1 rounded-lg
              ${t>=0?"text-[var(--green)] bg-[var(--green)]/[0.08]":"text-[var(--red)] bg-[var(--red)]/[0.08]"}`,style:{border:`1px solid ${t>=0?"rgba(14,203,129,0.12)":"rgba(246,70,93,0.12)"}`},children:[t>=0?e.jsx(X,{size:12}):e.jsx(ie,{size:12}),t>=0?"+":"",t==null?void 0:t.toFixed(2),"%"]}),e.jsx("span",{className:"text-[10px] text-[var(--text-dim)]/40 font-medium",children:"24h"})]})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:`flex items-center gap-1.5 text-[11px] px-3 py-1.5 rounded-lg transition-all
          ${n?"text-[var(--green)] bg-[var(--green)]/[0.06] border border-[var(--green)]/10":"text-[var(--text-dim)] bg-white/[0.02] border border-[var(--border)]/50"}`,children:[n?e.jsx(Ze,{size:12}):e.jsx(et,{size:12}),e.jsx("span",{className:"font-semibold",children:n?"Live":"Demo"})]}),e.jsxs("button",{onClick:a,className:`flex items-center gap-1.5 px-3 py-1.5 rounded-lg text-[11px] font-semibold transition-all border
            ${i?"bg-[var(--gold)]/10 text-[var(--gold)] border-[var(--gold)]/15":"text-[var(--text-dim)] hover:text-[var(--text)] bg-white/[0.02] border-[var(--border)]/50 hover:border-[var(--gold)]/20"}`,title:"Kairos AI",children:[e.jsx(se,{size:13}),e.jsx("span",{children:"AI"}),i&&e.jsx("span",{className:"w-1.5 h-1.5 rounded-full bg-[var(--gold)] animate-pulse"})]}),e.jsxs("button",{className:"p-2 rounded-lg text-[var(--text-dim)] hover:text-[var(--text)] bg-white/[0.02] border border-[var(--border)]/50 hover:border-[var(--border)] transition-all relative",children:[e.jsx(re,{size:15}),e.jsx("span",{className:"absolute top-1 right-1 w-2 h-2 bg-[var(--gold)] rounded-full shadow-[0_0_6px_rgba(212,175,55,0.4)]"})]})]})]})}const Ie=[{icon:X,label:"Trading Profesional",desc:"Gr√°ficos TradingView con datos en tiempo real de Binance"},{icon:ae,label:"Bots Automatizados",desc:"Grid, DCA y bots de se√±ales ejecutan trades 24/7"},{icon:ge,label:"Kairos AI",desc:"Asistente con IA que analiza mercados y genera estrategias"},{icon:te,label:"Simulador Pro",desc:"Paper trading con $10,000 virtuales y datos reales"}],Dt=[{value:"50+",label:"Pares de Trading"},{value:"6",label:"Exchanges"},{value:"24/7",label:"Automatizaci√≥n"},{value:"<1ms",label:"Latencia"}];function Et(){const{login:x}=_(),[s,t]=w.useState(!0),[a,i]=w.useState({email:"",password:"",name:""}),[o,n]=w.useState(""),[l,c]=w.useState(!1),[p,m]=w.useState(!1),[u,r]=w.useState(0);w.useEffect(()=>{const f=setInterval(()=>{r(v=>(v+1)%Ie.length)},3e3);return()=>clearInterval(f)},[]);const y=async f=>{if(f.preventDefault(),n(""),!a.email||!a.password){n("Completa todos los campos");return}if(!s&&!a.name){n("Ingresa tu nombre");return}if(a.password.length<6){n("La contrase√±a debe tener al menos 6 caracteres");return}c(!0),setTimeout(()=>{x({id:Date.now().toString(36),email:a.email,name:a.name||a.email.split("@")[0],plan:"free",createdAt:new Date().toISOString()}),c(!1)},800)};return e.jsxs("div",{className:"min-h-screen bg-[var(--dark)] flex relative overflow-hidden",children:[e.jsxs("div",{className:"absolute inset-0 overflow-hidden pointer-events-none",children:[e.jsx("div",{className:"absolute top-[-20%] right-[-10%] w-[700px] h-[700px] rounded-full opacity-[0.03]",style:{background:"radial-gradient(circle, #D4AF37 0%, transparent 65%)"}}),e.jsx("div",{className:"absolute bottom-[-20%] left-[-10%] w-[600px] h-[600px] rounded-full opacity-[0.02]",style:{background:"radial-gradient(circle, #E8C84A 0%, transparent 65%)"}}),e.jsx("div",{className:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-[900px] h-[900px] rounded-full opacity-[0.015]",style:{background:"radial-gradient(circle, #D4AF37 0%, transparent 50%)"}}),e.jsx("div",{className:"absolute inset-0 opacity-[0.02]",style:{backgroundImage:"linear-gradient(rgba(212,175,55,0.3) 1px, transparent 1px), linear-gradient(90deg, rgba(212,175,55,0.3) 1px, transparent 1px)",backgroundSize:"60px 60px"}})]}),e.jsxs("div",{className:"hidden lg:flex flex-1 flex-col justify-between p-12 relative",children:[e.jsx(B.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},transition:{duration:.6},className:"relative z-10",children:e.jsxs("div",{className:"flex items-center gap-3.5",children:[e.jsx("div",{className:"w-11 h-11 rounded-xl flex items-center justify-center relative",style:{background:"linear-gradient(135deg, #D4AF37, #B8960C)",boxShadow:"0 0 30px rgba(212,175,55,0.25), inset 0 1px 0 rgba(255,255,255,0.15)"},children:e.jsx("span",{className:"text-[#08090C] font-extrabold text-lg",children:"K"})}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-baseline gap-2",children:[e.jsx("span",{className:"text-[17px] font-extrabold text-[var(--text)] tracking-wide",children:"KAIROS"}),e.jsx("span",{className:"text-[11px] font-bold text-gradient-gold tracking-[0.2em]",children:"TRADE"})]}),e.jsx("span",{className:"text-[9px] text-[var(--text-dim)] font-medium tracking-[0.15em] uppercase",children:"by Kairos 777 Inc"})]})]})}),e.jsxs("div",{className:"relative z-10 max-w-lg",children:[e.jsxs(B.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.7,delay:.2},children:[e.jsxs("div",{className:"flex items-center gap-2 mb-5",children:[e.jsx("div",{className:"h-px flex-1 max-w-[40px] bg-gradient-to-r from-transparent to-[var(--gold)]"}),e.jsx("span",{className:"text-[10px] font-bold text-[var(--gold)] tracking-[0.2em] uppercase",children:"Professional Trading Platform"}),e.jsx("div",{className:"h-px flex-1 max-w-[40px] bg-gradient-to-l from-transparent to-[var(--gold)]"})]}),e.jsxs("h2",{className:"text-4xl font-extrabold text-[var(--text)] leading-[1.15] mb-4 tracking-tight",children:["Automatiza tu Trading",e.jsx("br",{}),e.jsx("span",{className:"text-gradient-gold",children:"con Inteligencia."})]}),e.jsx("p",{className:"text-[15px] text-[var(--text-secondary)] leading-relaxed mb-10 max-w-md",children:"Conecta tu exchange favorito y deja que nuestros bots inteligentes operen por ti. Datos en tiempo real, ejecuci√≥n autom√°tica, resultados profesionales."})]}),e.jsx("div",{className:"space-y-3 mb-10",children:Ie.map((f,v)=>{const g=f.icon,k=v===u;return e.jsxs(B.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:.4+v*.1},className:`flex items-start gap-4 p-3.5 rounded-xl transition-all duration-500 cursor-default ${k?"glass-gold":"bg-transparent"}`,onMouseEnter:()=>r(v),children:[e.jsx("div",{className:`w-10 h-10 rounded-xl flex items-center justify-center shrink-0 transition-all duration-500
                    ${k?"bg-gradient-to-br from-[var(--gold)] to-[var(--gold-dark)] shadow-[0_0_20px_rgba(212,175,55,0.2)]":"bg-[var(--surface-2)] border border-[var(--border)]"}`,children:e.jsx(g,{size:18,className:`transition-colors duration-500 ${k?"text-[#08090C]":"text-[var(--text-dim)]"}`})}),e.jsxs("div",{children:[e.jsx("p",{className:`text-[13px] font-bold transition-colors duration-500 ${k?"text-[var(--text)]":"text-[var(--text-secondary)]"}`,children:f.label}),e.jsx("p",{className:`text-[11px] mt-0.5 transition-colors duration-500 ${k?"text-[var(--text-secondary)]":"text-[var(--text-dim)]"}`,children:f.desc})]})]},f.label)})}),e.jsx(B.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.8},className:"flex gap-6",children:Dt.map(f=>e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-lg font-extrabold text-gradient-gold",children:f.value}),e.jsx("p",{className:"text-[10px] text-[var(--text-dim)] font-medium mt-0.5",children:f.label})]},f.label))})]}),e.jsxs(B.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:1},className:"relative z-10 flex items-center justify-between",children:[e.jsx("p",{className:"text-[10px] text-[var(--text-dim)]/40",children:"¬© 2026 Kairos 777 Inc. Todos los derechos reservados."}),e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx("div",{className:"w-1.5 h-1.5 rounded-full bg-[var(--green)] animate-pulse"}),e.jsx("span",{className:"text-[10px] text-[var(--green)] font-semibold",children:"Sistemas operacionales"})]})]})]}),e.jsx("div",{className:"flex-1 flex items-center justify-center p-6 lg:max-w-[480px] relative z-10",children:e.jsxs(B.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},className:"w-full max-w-[380px]",children:[e.jsxs("div",{className:"text-center mb-8 lg:hidden",children:[e.jsx("div",{className:"w-14 h-14 rounded-2xl flex items-center justify-center text-[#08090C] font-extrabold text-xl mx-auto mb-3",style:{background:"linear-gradient(135deg, #D4AF37, #B8960C)",boxShadow:"0 0 30px rgba(212,175,55,0.25)"},children:"K"}),e.jsxs("h1",{className:"text-xl font-extrabold tracking-tight",children:[e.jsx("span",{className:"text-gradient-gold",children:"KAIROS"})," ",e.jsx("span",{className:"text-[var(--text)]",children:"TRADE"})]})]}),e.jsxs("div",{className:"mb-7",children:[e.jsx("h2",{className:"text-2xl font-extrabold text-[var(--text)] tracking-tight",children:s?"Bienvenido.":"Empieza a operar."}),e.jsx("p",{className:"text-sm text-[var(--text-dim)] mt-1.5",children:s?"Accede a tu plataforma de trading":"Crea tu cuenta en 30 segundos"})]}),e.jsxs("div",{className:"flex mb-7 rounded-xl p-1 glass",children:[e.jsx("button",{onClick:()=>{t(!0),n("")},className:`flex-1 py-2.5 text-sm rounded-lg transition-all duration-300 ${s?"text-[#08090C] font-bold shadow-lg":"text-[var(--text-dim)] font-medium hover:text-[var(--text)]"}`,style:s?{background:"linear-gradient(135deg, #D4AF37, #B8960C)",boxShadow:"0 4px 15px rgba(212,175,55,0.3)"}:{},children:"Iniciar Sesi√≥n"}),e.jsx("button",{onClick:()=>{t(!1),n("")},className:`flex-1 py-2.5 text-sm rounded-lg transition-all duration-300 ${s?"text-[var(--text-dim)] font-medium hover:text-[var(--text)]":"text-[#08090C] font-bold shadow-lg"}`,style:s?{}:{background:"linear-gradient(135deg, #D4AF37, #B8960C)",boxShadow:"0 4px 15px rgba(212,175,55,0.3)"},children:"Registrarse"})]}),e.jsxs("form",{onSubmit:y,className:"space-y-4",children:[e.jsx(K,{mode:"wait",children:!s&&e.jsxs(B.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},transition:{duration:.2},children:[e.jsx("label",{className:"text-[11px] text-[var(--text-dim)] mb-1.5 block font-semibold uppercase tracking-wider",children:"Nombre"}),e.jsx("input",{type:"text",value:a.name,onChange:f=>i({...a,name:f.target.value}),placeholder:"Tu nombre completo",className:"w-full",autoComplete:"name"})]})}),e.jsxs("div",{children:[e.jsx("label",{className:"text-[11px] text-[var(--text-dim)] mb-1.5 block font-semibold uppercase tracking-wider",children:"Email"}),e.jsx("input",{type:"email",value:a.email,onChange:f=>i({...a,email:f.target.value}),placeholder:"tu@email.com",className:"w-full",autoComplete:"email"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-[11px] text-[var(--text-dim)] mb-1.5 block font-semibold uppercase tracking-wider",children:"Contrase√±a"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:p?"text":"password",value:a.password,onChange:f=>i({...a,password:f.target.value}),placeholder:"‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢",className:"w-full pr-10",autoComplete:s?"current-password":"new-password"}),e.jsx("button",{type:"button",onClick:()=>m(!p),className:"absolute right-3 top-1/2 -translate-y-1/2 text-[var(--text-dim)] hover:text-[var(--gold)] transition-colors",children:p?e.jsx(qe,{size:15}):e.jsx(Ue,{size:15})})]})]}),e.jsx(K,{children:o&&e.jsx(B.div,{initial:{opacity:0,y:-4},animate:{opacity:1,y:0},exit:{opacity:0,y:-4},className:"text-xs text-[var(--red)] bg-[var(--red)]/[0.06] border border-[var(--red)]/10 px-3.5 py-2.5 rounded-xl",children:o})}),e.jsx("button",{type:"submit",disabled:l,className:"w-full py-3.5 rounded-xl transition-all duration-300 disabled:opacity-50 flex items-center justify-center gap-2 text-sm btn-gold",children:l?e.jsx("div",{className:"w-5 h-5 border-2 border-[#08090C]/30 border-t-[#08090C] rounded-full animate-spin"}):e.jsxs(e.Fragment,{children:[s?"Acceder a la Plataforma":"Crear Cuenta",e.jsx(tt,{size:16})]})})]}),e.jsxs("div",{className:"flex items-center gap-3 my-6",children:[e.jsx("div",{className:"flex-1 h-px bg-[var(--border)]"}),e.jsx("span",{className:"text-[10px] text-[var(--text-dim)] font-medium",children:"ECOSISTEMA"}),e.jsx("div",{className:"flex-1 h-px bg-[var(--border)]"})]}),e.jsxs("a",{href:"https://kairos-777.com",target:"_blank",rel:"noopener noreferrer",className:"flex items-center justify-center gap-2 py-2.5 rounded-xl text-xs font-semibold text-[var(--text-dim)] hover:text-[var(--gold)] transition-all border border-[var(--border)] hover:border-[var(--gold)]/20",children:[e.jsx(ze,{size:14,className:"text-[var(--gold)]"}),"Conoce el ecosistema Kairos 777"]}),e.jsxs("p",{className:"text-[10px] text-[var(--text-dim)]/30 text-center mt-5",children:["Parte del ecosistema ",e.jsx("span",{className:"text-[var(--gold)] font-semibold",children:"Kairos 777"})]})]})})]})}class Rt{constructor(){this.ws=null,this.subscribers=new Map,this.reconnectAttempts=0,this.maxReconnect=5,this.candleCache=new Map}connectStream(s,t={}){const a=s.toLowerCase(),i=`wss://stream.binance.com:9443/ws/${a}@ticker/${a}@kline_1m`;return this.ws&&this.ws.close(),this.ws=new WebSocket(i),this.ws.onopen=()=>{var o;this.reconnectAttempts=0,(o=t.onConnect)==null||o.call(t)},this.ws.onmessage=o=>{var n,l;try{const c=JSON.parse(o.data);if(c.e==="24hrTicker"&&((n=t.onTicker)==null||n.call(t,{symbol:c.s,price:parseFloat(c.c),change:parseFloat(c.p),changePercent:parseFloat(c.P),high:parseFloat(c.h),low:parseFloat(c.l),volume:parseFloat(c.v),quoteVolume:parseFloat(c.q)})),c.e==="kline"){const p=c.k;(l=t.onCandle)==null||l.call(t,{time:Math.floor(p.t/1e3),open:parseFloat(p.o),high:parseFloat(p.h),low:parseFloat(p.l),close:parseFloat(p.c),volume:parseFloat(p.v),closed:p.x})}}catch(c){console.error("WS parse error:",c)}},this.ws.onerror=o=>{var n;console.error("WS error:",o),(n=t.onError)==null||n.call(t,o)},this.ws.onclose=()=>{var o;this.reconnectAttempts<this.maxReconnect&&(this.reconnectAttempts++,setTimeout(()=>this.connectStream(s,t),2e3*this.reconnectAttempts)),(o=t.onDisconnect)==null||o.call(t)},()=>this.disconnect()}disconnect(){this.ws&&(this.ws.close(),this.ws=null)}async getCandles(s,t="1h",a=500){const i=`${s}_${t}`;try{const o=`https://api.binance.com/api/v3/klines?symbol=${s}&interval=${t}&limit=${a}`,n=await fetch(o);if(!n.ok)throw new Error(`HTTP ${n.status}`);const c=(await n.json()).map(p=>({time:Math.floor(p[0]/1e3),open:parseFloat(p[1]),high:parseFloat(p[2]),low:parseFloat(p[3]),close:parseFloat(p[4]),volume:parseFloat(p[5])}));return this.candleCache.set(i,{data:c,ts:Date.now()}),c}catch(o){const n=this.candleCache.get(i);if(n)return n.data;throw o}}async getPrice(s){const a=await(await fetch(`https://api.binance.com/api/v3/ticker/price?symbol=${s}`)).json();return parseFloat(a.price)}async get24hrTicker(s){const a=await(await fetch(`https://api.binance.com/api/v3/ticker/24hr?symbol=${s}`)).json();return{symbol:a.symbol,price:parseFloat(a.lastPrice),change:parseFloat(a.priceChange),changePercent:parseFloat(a.priceChangePercent),high:parseFloat(a.highPrice),low:parseFloat(a.lowPrice),volume:parseFloat(a.volume),quoteVolume:parseFloat(a.quoteVolume)}}async getOrderBook(s,t=20){const i=await(await fetch(`https://api.binance.com/api/v3/depth?symbol=${s}&limit=${t}`)).json();return{bids:i.bids.map(([o,n])=>({price:parseFloat(o),quantity:parseFloat(n)})),asks:i.asks.map(([o,n])=>({price:parseFloat(o),quantity:parseFloat(n)}))}}async searchSymbols(s){const a=await(await fetch("https://api.binance.com/api/v3/exchangeInfo")).json(),i=s.toUpperCase();return a.symbols.filter(o=>o.status==="TRADING"&&(o.symbol.includes(i)||o.baseAsset.includes(i))).slice(0,20).map(o=>({symbol:o.symbol,base:o.baseAsset,quote:o.quoteAsset}))}}const q=new Rt;function Be(){const{setPage:x,bots:s,brokers:t,tradeHistory:a,positions:i,user:o}=_(),[n,l]=w.useState([]),[c,p]=w.useState(!0);w.useEffect(()=>{m();const g=setInterval(m,3e4);return()=>clearInterval(g)},[]);const m=async()=>{try{const g=["BTCUSDT","ETHUSDT","BNBUSDT","SOLUSDT","XRPUSDT","ADAUSDT"],k=await Promise.all(g.map(async P=>{try{return await q.get24hrTicker(P)}catch{return null}}));l(k.filter(Boolean))}catch(g){console.error("Dashboard load error:",g)}p(!1)},u=s.filter(g=>g.status==="active"),r=a.reduce((g,k)=>g+(k.pnl||0),0),y=t.filter(g=>g.connected),f=[{label:"Bots Activos",value:u.length,icon:ae,color:"#D4AF37",gradient:"linear-gradient(135deg, rgba(212,175,55,0.1), rgba(212,175,55,0.02))",border:"rgba(212,175,55,0.1)",action:"bots"},{label:"Brokers",value:`${y.length}/${t.length}`,icon:we,color:"#A855F7",gradient:"linear-gradient(135deg, rgba(168,85,247,0.1), rgba(168,85,247,0.02))",border:"rgba(168,85,247,0.1)",action:"brokers"},{label:"Posiciones",value:i.length,icon:ye,color:"#00DC82",gradient:"linear-gradient(135deg, rgba(0,220,130,0.1), rgba(0,220,130,0.02))",border:"rgba(0,220,130,0.1)",action:"history"},{label:"P&L Total",value:`${r>=0?"+":""}$${r.toFixed(2)}`,icon:ne,color:r>=0?"#00DC82":"#FF4757",gradient:r>=0?"linear-gradient(135deg, rgba(0,220,130,0.1), rgba(0,220,130,0.02))":"linear-gradient(135deg, rgba(255,71,87,0.1), rgba(255,71,87,0.02))",border:r>=0?"rgba(0,220,130,0.1)":"rgba(255,71,87,0.1)",action:"history"}],v=[{label:"Trading",icon:ee,page:"chart",desc:"Gr√°ficos profesionales",color:"#D4AF37"},{label:"Simulador",icon:oe,page:"simulator",desc:"Paper trading sin riesgo",color:"#00DC82"},{label:"Kairos AI",icon:ge,page:"ai",desc:"Asistente inteligente",color:"#A855F7"},{label:"Crear Bot",icon:ae,page:"bots",desc:"Automatiza tu trading",color:"#E8C84A"},{label:"Estrategias",icon:Q,page:"strategies",desc:"Crea y gestiona",color:"#EC4899"},{label:"Brokers",icon:te,page:"brokers",desc:"Conecta tu cuenta",color:"#22D3EE"}];return e.jsxs("div",{className:"flex-1 overflow-y-auto p-6 space-y-6",children:[e.jsxs(B.div,{initial:{opacity:0,y:8},animate:{opacity:1,y:0},className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-[22px] font-bold tracking-tight",children:["Bienvenido, ",e.jsx("span",{className:"text-[var(--gold)]",children:(o==null?void 0:o.name)||"Trader"})]}),e.jsx("p",{className:"text-sm text-[var(--text-dim)] mt-0.5",children:"Tu centro de control de trading automatizado"})]}),e.jsxs("button",{onClick:()=>x("chart"),className:"flex items-center gap-2 px-4 py-2.5 rounded-xl text-sm font-semibold transition-all hover:opacity-90 btn-gold",children:[e.jsx(ee,{size:16}),"Abrir Trading"]})]}),e.jsx("div",{className:"grid grid-cols-4 gap-4",children:f.map((g,k)=>{const P=g.icon;return e.jsxs(B.button,{initial:{opacity:0,y:12},animate:{opacity:1,y:0},transition:{delay:k*.06},onClick:()=>x(g.action),className:"rounded-xl p-4 text-left transition-all duration-200 hover:scale-[1.02] group",style:{background:g.gradient,border:`1px solid ${g.border}`},children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("div",{className:"w-9 h-9 rounded-lg flex items-center justify-center",style:{background:`${g.color}15`},children:e.jsx(P,{size:18,style:{color:g.color}})}),e.jsx(fe,{size:14,className:"text-[var(--text-dim)]/30 group-hover:text-[var(--text-dim)] transition-colors"})]}),e.jsx("p",{className:"text-[22px] font-bold leading-none",style:{color:g.color},children:g.value}),e.jsx("p",{className:"text-[11px] text-[var(--text-dim)] mt-1.5 font-medium",children:g.label})]},g.label)})}),e.jsxs("div",{children:[e.jsxs("h2",{className:"text-sm font-bold text-[var(--text)] mb-3 flex items-center gap-2",children:[e.jsx(Q,{size:14,className:"text-[var(--gold)]"}),"Acceso R√°pido"]}),e.jsx("div",{className:"grid grid-cols-3 gap-3",children:v.map((g,k)=>{const P=g.icon;return e.jsxs(B.button,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.2+k*.05},onClick:()=>x(g.page),className:"rounded-xl p-4 text-left transition-all duration-200 group hover:scale-[1.01]",style:{background:"linear-gradient(135deg, rgba(17,19,24,0.8), rgba(24,26,32,0.6))",border:"1px solid rgba(30,34,45,0.5)"},onMouseEnter:A=>A.currentTarget.style.borderColor=`${g.color}30`,onMouseLeave:A=>A.currentTarget.style.borderColor="rgba(30,34,45,0.5)",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg flex items-center justify-center mb-3 transition-transform group-hover:scale-110",style:{background:`${g.color}12`},children:e.jsx(P,{size:20,style:{color:g.color}})}),e.jsx("p",{className:"text-[13px] font-bold text-[var(--text)]",children:g.label}),e.jsx("p",{className:"text-[11px] text-[var(--text-dim)] mt-0.5",children:g.desc})]},g.label)})})]}),e.jsxs("div",{className:"rounded-xl overflow-hidden",style:{background:"linear-gradient(135deg, rgba(17,19,24,0.8), rgba(24,26,32,0.6))",border:"1px solid rgba(30,34,45,0.5)"},children:[e.jsxs("div",{className:"flex items-center justify-between p-4",style:{borderBottom:"1px solid rgba(30,34,45,0.5)"},children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ye,{size:14,className:"text-[var(--gold)]"}),e.jsx("h2",{className:"text-sm font-bold",children:"Mercado en Tiempo Real"})]}),e.jsxs("button",{onClick:()=>x("chart"),className:"text-[11px] text-[var(--gold)] hover:text-[var(--gold-light)] font-semibold flex items-center gap-1 transition-colors",children:["Ver gr√°fico ",e.jsx(fe,{size:12})]})]}),e.jsxs("div",{className:"grid grid-cols-4 gap-4 px-4 py-2 text-[10px] font-bold text-[var(--text-dim)]/50 uppercase tracking-wider",children:[e.jsx("span",{children:"Par"}),e.jsx("span",{className:"text-right",children:"Precio"}),e.jsx("span",{className:"text-right",children:"Cambio 24h"}),e.jsx("span",{className:"text-right",children:"Acci√≥n"})]}),e.jsx("div",{className:"divide-y divide-[var(--border)]/30",children:c?e.jsx("div",{className:"p-8 text-center text-sm text-[var(--text-dim)] animate-pulse",children:"Cargando mercado..."}):n.map((g,k)=>e.jsxs(B.button,{initial:{opacity:0},animate:{opacity:1},transition:{delay:k*.05},onClick:()=>{_.getState().setSelectedPair(g.symbol),x("chart")},className:"group w-full grid grid-cols-4 gap-4 items-center px-4 py-3 hover:bg-white/[0.02] transition-colors",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 rounded-lg flex items-center justify-center text-[10px] font-bold",style:{background:g.changePercent>=0?"rgba(14,203,129,0.08)":"rgba(246,70,93,0.08)"},children:e.jsx("span",{className:g.changePercent>=0?"text-[var(--green)]":"text-[var(--red)]",children:g.symbol.replace("USDT","").slice(0,3)})}),e.jsxs("div",{className:"text-left",children:[e.jsx("p",{className:"text-[13px] font-bold leading-none",children:g.symbol.replace("USDT","")}),e.jsx("p",{className:"text-[10px] text-[var(--text-dim)]/50 mt-0.5",children:"USDT"})]})]}),e.jsxs("p",{className:"text-[13px] font-mono font-semibold text-right",children:["$",g.price.toLocaleString(void 0,{maximumFractionDigits:2})]}),e.jsx("div",{className:"flex items-center gap-1 justify-end",children:e.jsxs("span",{className:`flex items-center gap-0.5 text-xs font-mono font-semibold px-2 py-0.5 rounded-md
                  ${g.changePercent>=0?"text-[var(--green)] bg-[var(--green)]/[0.08]":"text-[var(--red)] bg-[var(--red)]/[0.08]"}`,children:[g.changePercent>=0?e.jsx(st,{size:10}):e.jsx(at,{size:10}),g.changePercent>=0?"+":"",g.changePercent.toFixed(2),"%"]})}),e.jsx("div",{className:"text-right",children:e.jsx("span",{className:"text-[10px] font-semibold text-[var(--gold)] opacity-0 group-hover:opacity-100 transition-opacity bg-[var(--gold)]/10 px-2 py-1 rounded-md",children:"Trading ‚Üí"})})]},g.symbol))})]})]})}function G(x,s){const t=2/(s+1),a=[x[0]];for(let i=1;i<x.length;i++)a.push(x[i]*t+a[i-1]*(1-t));return a}function Le(x,s){const t=[];for(let a=0;a<x.length;a++){if(a<s-1){t.push(null);continue}const i=x.slice(a-s+1,a+1);t.push(i.reduce((o,n)=>o+n,0)/s)}return t}function le(x,s=14){const t=new Array(s).fill(null);let a=0,i=0;for(let o=1;o<=s;o++){const n=x[o]-x[o-1];n>0?a+=n:i+=Math.abs(n)}a/=s,i/=s,t.push(i===0?100:100-100/(1+a/i));for(let o=s+1;o<x.length;o++){const n=x[o]-x[o-1];a=(a*(s-1)+(n>0?n:0))/s,i=(i*(s-1)+(n<0?Math.abs(n):0))/s,t.push(i===0?100:100-100/(1+a/i))}return t}function Ke(x,s=12,t=26,a=9){const i=G(x,s),o=G(x,t),n=i.map((p,m)=>p-o[m]),l=G(n,a),c=n.map((p,m)=>p-l[m]);return{macd:n,signal:l,histogram:c}}function Ot(x,s=20,t=2){const a=Le(x,s),i=[],o=[];for(let n=0;n<x.length;n++){if(n<s-1){i.push(null),o.push(null);continue}const l=x.slice(n-s+1,n+1),c=a[n],p=l.reduce((u,r)=>u+Math.pow(r-c,2),0)/s,m=Math.sqrt(p)*t;i.push(c+m),o.push(c-m)}return{upper:i,middle:a,lower:o}}function he(x,s,t){if(t<1)return null;const a=x[t-1],i=x[t],o=s[t-1],n=s[t];return a<=o&&i>n?"bullish_cross":a>=o&&i<n?"bearish_cross":null}function Mt(){const x=w.useRef(null),s=w.useRef(null),t=w.useRef(null),a=w.useRef(null),i=w.useRef([]),o=w.useRef(null),{selectedPair:n,selectedTimeframe:l,setSelectedPair:c,setSelectedTimeframe:p,setCurrentPrice:m,setPriceChange24h:u}=_(),[r,y]=w.useState(!0),[f,v]=w.useState(null),[g,k]=w.useState(!1),[P,A]=w.useState(""),[I,j]=w.useState(["ema20"]);w.useEffect(()=>{const b=x.current;if(!b)return;const S=b.getBoundingClientRect(),T=S.width||b.clientWidth||800,E=S.height||b.clientHeight||500,$=St(b,{width:T,height:E,layout:{background:{type:Pt.Solid,color:"#0B0E11"},textColor:"#848E9C",fontFamily:"Inter, sans-serif",fontSize:11},grid:{vertLines:{color:"#1E222D"},horzLines:{color:"#1E222D"}},crosshair:{mode:kt.Normal,vertLine:{color:"#3B82F6",width:1,style:2,labelBackgroundColor:"#3B82F6"},horzLine:{color:"#3B82F6",width:1,style:2,labelBackgroundColor:"#3B82F6"}},timeScale:{borderColor:"#1E222D",timeVisible:!0,secondsVisible:!1,rightOffset:5,barSpacing:8},rightPriceScale:{borderColor:"#1E222D",scaleMargins:{top:.05,bottom:.2}},handleScroll:{mouseWheel:!0,pressedMouseMove:!0},handleScale:{axisPressedMouseMove:!0,mouseWheel:!0,pinch:!0}}),z=$.addCandlestickSeries({upColor:"#0ECB81",downColor:"#F6465D",borderUpColor:"#0ECB81",borderDownColor:"#F6465D",wickUpColor:"#0ECB81",wickDownColor:"#F6465D"}),h=$.addHistogramSeries({color:"#3B82F622",priceFormat:{type:"volume"},priceScaleId:"volume"});$.priceScale("volume").applyOptions({scaleMargins:{top:.8,bottom:0}}),s.current=$,t.current=z,a.current=h;const C=new ResizeObserver(F=>{if(!F||!F[0])return;const{width:L,height:Y}=F[0].contentRect;L>0&&Y>0&&$.applyOptions({width:L,height:Y})});return C.observe(b),()=>{C.disconnect(),$.remove(),s.current=null,t.current=null,a.current=null}},[]),w.useEffect(()=>{let b=!1;return(async()=>{y(!0),v(null);try{const[T,E]=await Promise.all([q.getCandles(n,l,500),q.get24hrTicker(n)]);if(b)return;if(!T||T.length===0){v("No se recibieron datos de Binance"),y(!1);return}t.current&&t.current.setData(T),a.current&&a.current.setData(T.map($=>({time:$.time,value:$.volume||0,color:$.close>=$.open?"rgba(14,203,129,0.2)":"rgba(246,70,93,0.2)"}))),m(E.price),u(E.changePercent);try{N(T)}catch($){console.warn("Indicator error (non-fatal):",$)}s.current&&s.current.timeScale().fitContent()}catch(T){console.error("Chart data load error:",T),b||v(`Error cargando datos: ${T.message}`)}b||y(!1)})(),o.current&&o.current(),o.current=q.connectStream(n,{onTicker:T=>{m(T.price),u(T.changePercent)},onCandle:T=>{t.current&&t.current.update(T),a.current&&a.current.update({time:T.time,value:T.volume||0,color:T.close>=T.open?"rgba(14,203,129,0.2)":"rgba(246,70,93,0.2)"})}}),()=>{b=!0,o.current&&(o.current(),o.current=null)}},[n,l]);const N=b=>{if(!s.current)return;i.current.forEach(E=>{var $;try{($=s.current)==null||$.removeSeries(E)}catch{}}),i.current=[];const S=b.map(E=>E.close),T=b.map(E=>E.time);I.forEach(E=>{try{if(E==="ema20"){const z=G(S,20).map((h,C)=>h!=null&&isFinite(h)?{time:T[C],value:h}:null).filter(Boolean);if(z.length>0){const h=s.current.addLineSeries({color:"#3B82F6",lineWidth:1.5,title:"EMA 20",lastValueVisible:!1,priceLineVisible:!1});h.setData(z),i.current.push(h)}}if(E==="ema50"){const z=G(S,50).map((h,C)=>h!=null&&isFinite(h)?{time:T[C],value:h}:null).filter(Boolean);if(z.length>0){const h=s.current.addLineSeries({color:"#8B5CF6",lineWidth:1.5,title:"EMA 50",lastValueVisible:!1,priceLineVisible:!1});h.setData(z),i.current.push(h)}}if(E==="sma200"){const z=Le(S,200).map((h,C)=>h!=null&&isFinite(h)?{time:T[C],value:h}:null).filter(Boolean);if(z.length>0){const h=s.current.addLineSeries({color:"#FF6D00",lineWidth:1,title:"SMA 200",lastValueVisible:!1,priceLineVisible:!1});h.setData(z),i.current.push(h)}}if(E==="bb"){const $=Ot(S),z=$.upper.map((C,F)=>C!=null&&isFinite(C)?{time:T[F],value:C}:null).filter(Boolean),h=$.lower.map((C,F)=>C!=null&&isFinite(C)?{time:T[F],value:C}:null).filter(Boolean);if(z.length>0){const C=s.current.addLineSeries({color:"#9C27B0",lineWidth:1,lineStyle:2,title:"BB Upper",lastValueVisible:!1,priceLineVisible:!1}),F=s.current.addLineSeries({color:"#9C27B0",lineWidth:1,lineStyle:2,title:"BB Lower",lastValueVisible:!1,priceLineVisible:!1});C.setData(z),F.setData(h),i.current.push(C,F)}}}catch($){console.warn(`Indicator ${E} error:`,$)}})};w.useEffect(()=>{if(!t.current)return;(async()=>{try{const S=await q.getCandles(n,l,500);N(S)}catch{}})()},[I]);const d=b=>{j(S=>S.includes(b)?S.filter(T=>T!==b):[...S,b])};return e.jsxs("div",{className:"flex flex-col w-full h-full",style:{minHeight:0},children:[e.jsxs("div",{className:"flex items-center gap-2 px-3 py-2 shrink-0 flex-wrap",style:{borderBottom:"1px solid var(--border)"},children:[e.jsxs("div",{className:"relative",children:[e.jsxs("button",{onClick:()=>k(!g),className:"flex items-center gap-1.5 px-3 py-1.5 bg-[var(--dark-3)] rounded-lg text-sm font-bold hover:bg-[var(--dark-4)] transition-colors",children:[e.jsx(rt,{size:13,className:"text-[var(--text-dim)]"}),n]}),g&&e.jsxs("div",{className:"absolute top-full left-0 mt-1 w-64 bg-[var(--dark-3)] border border-[var(--border)] rounded-xl shadow-xl z-50 p-2",children:[e.jsx("input",{type:"text",value:P,onChange:b=>A(b.target.value.toUpperCase()),placeholder:"Buscar par...",className:"w-full text-sm mb-2",autoFocus:!0}),e.jsx("div",{className:"max-h-48 overflow-y-auto space-y-0.5",children:Se.filter(b=>b.includes(P)).map(b=>e.jsx("button",{onClick:()=>{c(b),k(!1),A("")},className:`w-full text-left px-3 py-1.5 text-sm rounded-lg transition-colors
                        ${b===n?"bg-[var(--gold)]/15 text-[var(--gold)]":"text-[var(--text-dim)] hover:bg-[var(--dark-4)] hover:text-[var(--text)]"}`,children:b},b))})]})]}),e.jsx("div",{className:"flex items-center gap-0.5 bg-[var(--dark-3)] rounded-lg p-0.5",children:ke.map(b=>e.jsx("button",{onClick:()=>p(b.value),className:`px-2.5 py-1 text-xs rounded-md transition-colors
                ${l===b.value?"bg-[var(--gold)] text-white font-bold":"text-[var(--text-dim)] hover:text-[var(--text)]"}`,children:b.label},b.value))}),e.jsxs("div",{className:"flex items-center gap-1 ml-auto",children:[e.jsx(X,{size:13,className:"text-[var(--text-dim)]"}),[{id:"ema20",label:"EMA 20",color:"#3B82F6"},{id:"ema50",label:"EMA 50",color:"#8B5CF6"},{id:"sma200",label:"SMA 200",color:"#FF6D00"},{id:"bb",label:"BB",color:"#9C27B0"}].map(b=>e.jsx("button",{onClick:()=>d(b.id),className:`px-2 py-0.5 text-[11px] rounded transition-all
                ${I.includes(b.id)?"font-semibold":"text-[var(--text-dim)] hover:text-[var(--text)]"}`,style:I.includes(b.id)?{color:b.color,background:`${b.color}15`}:{},children:b.label},b.id))]})]}),e.jsxs("div",{ref:x,className:"relative",style:{flex:"1 1 0%",minHeight:0,overflow:"hidden"},children:[r&&e.jsx("div",{className:"absolute inset-0 flex items-center justify-center z-20",style:{background:"rgba(11,14,17,0.85)"},children:e.jsxs("div",{className:"flex flex-col items-center gap-2",children:[e.jsx("div",{className:"w-8 h-8 border-2 border-[var(--gold)] border-t-transparent rounded-full animate-spin"}),e.jsxs("span",{className:"text-xs text-[var(--text-dim)]",children:["Cargando ",n,"..."]})]})}),f&&!r&&e.jsx("div",{className:"absolute inset-0 flex items-center justify-center z-20",style:{background:"rgba(11,14,17,0.9)"},children:e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-sm text-[var(--red)] mb-2",children:f}),e.jsx("button",{onClick:()=>{v(null),y(!0)},className:"px-4 py-2 text-xs bg-[var(--gold)] text-white rounded-lg font-semibold",children:"Reintentar"})]})})]})]})}const _t="https://api.binance.com/api/v3/depth";function zt({pair:x="BTCUSDT",height:s=260}){const t=w.useRef(null),[a,i]=w.useState(null),[o,n]=w.useState(null),l=w.useRef(null),c=w.useCallback(async()=>{try{const u=await fetch(`${_t}?symbol=${x}&limit=100`);if(!u.ok)return;const r=await u.json();i(r)}catch{}},[x]);w.useEffect(()=>{c();const u=setInterval(c,3e3);return()=>clearInterval(u)},[c]);const p=w.useCallback(()=>{var de,Pe;const u=t.current;if(!u||!a)return;const r=u.getContext("2d"),y=window.devicePixelRatio||1,f=u.clientWidth,v=u.clientHeight;u.width=f*y,u.height=v*y,r.scale(y,y),r.clearRect(0,0,f,v);const g=a.bids.map(([D,M])=>[parseFloat(D),parseFloat(M)]),k=a.asks.map(([D,M])=>[parseFloat(D),parseFloat(M)]);if(!g.length||!k.length)return;const P=[];let A=0;for(const[D,M]of g)A+=M,P.push([D,A]);const I=[];let j=0;for(const[D,M]of k)j+=M,I.push([D,j]);const N=(g[0][0]+k[0][0])/2,d=Math.max(((de=P[P.length-1])==null?void 0:de[1])||0,((Pe=I[I.length-1])==null?void 0:Pe[1])||0),b=[...P.map(D=>D[0]),...I.map(D=>D[0])],S=Math.min(...b),T=Math.max(...b),E=T-S||1,$={top:10,bottom:25,left:0,right:0},z=f-$.left-$.right,h=v-$.top-$.bottom,C=D=>$.left+(D-S)/E*z,F=D=>$.top+h-D/d*h;r.beginPath(),r.moveTo(C(P[0][0]),F(0));for(const[D,M]of P)r.lineTo(C(D),F(M));r.lineTo(C(P[P.length-1][0]),F(0)),r.closePath();const L=r.createLinearGradient(0,0,0,v);L.addColorStop(0,"rgba(0,220,130,0.25)"),L.addColorStop(1,"rgba(0,220,130,0.02)"),r.fillStyle=L,r.fill(),r.beginPath();for(let D=0;D<P.length;D++){const[M,Z]=P[D];D===0?r.moveTo(C(M),F(Z)):r.lineTo(C(M),F(Z))}r.strokeStyle="#00DC82",r.lineWidth=1.5,r.stroke(),r.beginPath(),r.moveTo(C(I[0][0]),F(0));for(const[D,M]of I)r.lineTo(C(D),F(M));r.lineTo(C(I[I.length-1][0]),F(0)),r.closePath();const Y=r.createLinearGradient(0,0,0,v);Y.addColorStop(0,"rgba(255,59,48,0.25)"),Y.addColorStop(1,"rgba(255,59,48,0.02)"),r.fillStyle=Y,r.fill(),r.beginPath();for(let D=0;D<I.length;D++){const[M,Z]=I[D];D===0?r.moveTo(C(M),F(Z)):r.lineTo(C(M),F(Z))}r.strokeStyle="#FF3B30",r.lineWidth=1.5,r.stroke();const O=C(N);if(r.beginPath(),r.setLineDash([4,4]),r.moveTo(O,$.top),r.lineTo(O,v-$.bottom),r.strokeStyle="#D4AF3780",r.lineWidth=1,r.stroke(),r.setLineDash([]),r.fillStyle="#D4AF37",r.font="600 10px Inter, sans-serif",r.textAlign="center",r.fillText(`$${N.toFixed(2)}`,O,v-$.bottom+14),r.fillStyle="#555",r.font="9px Inter, sans-serif",r.textAlign="left",r.fillText(`$${S.toFixed(0)}`,$.left+4,v-$.bottom+14),r.textAlign="right",r.fillText(`$${T.toFixed(0)}`,f-$.right-4,v-$.bottom+14),o&&o.x>=0&&o.x<=f){const D=S+o.x/f*E,M=D<N,Z=M?P:I;let Ce=0;for(const[$e,Ve]of Z)(M?$e>=D:$e<=D)&&(Ce=Ve);r.beginPath(),r.setLineDash([2,2]),r.moveTo(o.x,$.top),r.lineTo(o.x,v-$.bottom),r.strokeStyle="rgba(255,255,255,0.15)",r.lineWidth=1,r.stroke(),r.setLineDash([]);const Te=`$${D.toFixed(2)} ‚Äî Vol: ${Ce.toFixed(4)}`,xe=r.measureText(Te).width+16,Ae=Math.min(o.x-xe/2,f-xe-4);r.fillStyle="#1A1B1E",r.strokeStyle="rgba(212,175,55,0.3)",r.lineWidth=1,r.beginPath(),r.roundRect(Math.max(Ae,4),$.top,xe,22,4),r.fill(),r.stroke(),r.fillStyle="#fff",r.font="10px Inter, sans-serif",r.textAlign="center",r.fillText(Te,Math.max(Ae,4)+xe/2,$.top+15)}},[a,o]);w.useEffect(()=>(l.current=requestAnimationFrame(p),()=>cancelAnimationFrame(l.current)),[p]);const m=u=>{var y;const r=(y=t.current)==null?void 0:y.getBoundingClientRect();r&&n({x:u.clientX-r.left,y:u.clientY-r.top})};return e.jsxs(B.div,{initial:{opacity:0},animate:{opacity:1},className:"rounded-xl overflow-hidden relative",style:{background:"var(--surface)",border:"1px solid var(--border)"},children:[e.jsxs("div",{className:"flex items-center justify-between px-4 py-2.5",style:{borderBottom:"1px solid var(--border)"},children:[e.jsxs("h3",{className:"text-xs font-bold flex items-center gap-2 text-[var(--text-secondary)]",children:[e.jsx(ee,{size:14,className:"text-[var(--gold)]"})," Depth Chart"]}),e.jsxs("div",{className:"flex items-center gap-3 text-[10px]",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx("span",{className:"w-2 h-2 rounded-full bg-[#00DC82]"})," Bids"]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx("span",{className:"w-2 h-2 rounded-full bg-[#FF3B30]"})," Asks"]})]})]}),a?e.jsx("canvas",{ref:t,style:{width:"100%",height:s},onMouseMove:m,onMouseLeave:()=>n(null),className:"cursor-crosshair"}):e.jsx("div",{className:"flex items-center justify-center",style:{height:s},children:e.jsx("span",{className:"text-xs text-[var(--text-dim)]",children:"Cargando profundidad‚Ä¶"})})]})}function qt(){const{selectedPair:x,currentPrice:s,positions:t,orders:a,addPosition:i,addOrder:o,closePosition:n,cancelOrder:l}=_(),[c,p]=w.useState("buy"),[m,u]=w.useState("market"),[r,y]=w.useState({quantity:"",price:"",stopLoss:"",takeProfit:""}),[f,v]=w.useState({bids:[],asks:[]}),[g,k]=w.useState("order");w.useEffect(()=>{P();const j=setInterval(P,5e3);return()=>clearInterval(j)},[x]);const P=async()=>{try{const j=await q.getOrderBook(x,10);v(j)}catch{}},A=()=>{if(!r.quantity)return;const j=m==="market"?s:parseFloat(r.price);j&&(m==="market"?i({symbol:x,side:c,quantity:parseFloat(r.quantity),entryPrice:j,stopLoss:r.stopLoss?parseFloat(r.stopLoss):null,takeProfit:r.takeProfit?parseFloat(r.takeProfit):null,openedAt:new Date().toISOString()}):o({symbol:x,side:c,type:m,quantity:parseFloat(r.quantity),price:j,stopLoss:r.stopLoss?parseFloat(r.stopLoss):null,takeProfit:r.takeProfit?parseFloat(r.takeProfit):null,status:"open",createdAt:new Date().toISOString()}),y({quantity:"",price:"",stopLoss:"",takeProfit:""}))},I=parseFloat(r.quantity||0)*(m==="market"?s||0:parseFloat(r.price||0));return e.jsxs("div",{className:"flex flex-col h-full",style:{width:320,borderLeft:"1px solid rgba(30,34,45,0.6)"},children:[e.jsx("div",{className:"flex shrink-0 px-2 pt-2 gap-1",style:{borderBottom:"1px solid rgba(30,34,45,0.4)"},children:["order","positions","orders"].map(j=>e.jsx("button",{onClick:()=>k(j),className:`flex-1 py-2.5 text-[11px] font-bold rounded-t-lg transition-all
              ${g===j?"text-[var(--gold)] bg-[var(--gold)]/[0.06]":"text-[var(--text-dim)] hover:text-[var(--text)]"}`,style:g===j?{borderBottom:"2px solid var(--gold)"}:{borderBottom:"2px solid transparent"},children:j==="order"?"Orden":j==="positions"?`Pos (${t.length})`:`√ìrd (${a.length})`},j))}),g==="order"&&e.jsxs("div",{className:"flex-1 overflow-y-auto p-3 space-y-3",children:[e.jsxs("div",{className:"flex gap-1 p-1 rounded-xl",style:{background:"rgba(24,26,32,0.8)",border:"1px solid rgba(30,34,45,0.4)"},children:[e.jsx("button",{onClick:()=>p("buy"),className:`flex-1 py-2.5 text-sm font-bold rounded-lg transition-all duration-200
                ${c==="buy"?"text-white shadow-lg":"text-[var(--text-dim)]"}`,style:c==="buy"?{background:"linear-gradient(135deg, #0ECB81, #0AA06A)",boxShadow:"0 4px 12px rgba(14,203,129,0.25)"}:{},children:"Comprar"}),e.jsx("button",{onClick:()=>p("sell"),className:`flex-1 py-2.5 text-sm font-bold rounded-lg transition-all duration-200
                ${c==="sell"?"text-white shadow-lg":"text-[var(--text-dim)]"}`,style:c==="sell"?{background:"linear-gradient(135deg, #F6465D, #D32F4A)",boxShadow:"0 4px 12px rgba(246,70,93,0.25)"}:{},children:"Vender"})]}),e.jsx("div",{className:"flex gap-1 p-1 rounded-lg bg-[var(--dark-3)]",children:["market","limit","stop_loss"].map(j=>e.jsx("button",{onClick:()=>u(j),className:`flex-1 py-1.5 text-[10px] font-bold rounded-md transition-all
                  ${m===j?"bg-[var(--dark-4)] text-[var(--text)] shadow-sm":"text-[var(--text-dim)] hover:text-[var(--text)]"}`,children:j==="market"?"Market":j==="limit"?"L√≠mite":"Stop"},j))}),m!=="market"&&e.jsxs("div",{children:[e.jsx("label",{className:"text-[10px] text-[var(--text-dim)] mb-1 block font-semibold uppercase tracking-wider",children:"Precio"}),e.jsx("input",{type:"number",value:r.price,onChange:j=>y({...r,price:j.target.value}),placeholder:s==null?void 0:s.toString(),className:"w-full text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-[10px] text-[var(--text-dim)] mb-1 block font-semibold uppercase tracking-wider",children:"Cantidad"}),e.jsx("input",{type:"number",value:r.quantity,onChange:j=>y({...r,quantity:j.target.value}),placeholder:"0.001",className:"w-full text-sm"}),e.jsx("div",{className:"flex gap-1 mt-1.5",children:[25,50,75,100].map(j=>e.jsxs("button",{onClick:()=>{const N=m==="market"?s:parseFloat(r.price)||s;if(N){const b=1e4*(j/100)/N;y({...r,quantity:b.toFixed(6)})}},className:"flex-1 py-1.5 text-[10px] font-semibold rounded-md text-[var(--text-dim)] hover:text-[var(--gold)] hover:border-[var(--gold)]/30 transition-all",style:{background:"rgba(14,16,21,0.6)",border:"1px solid var(--border)"},children:[j,"%"]},j))})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"text-[10px] text-[var(--text-dim)] mb-1 flex items-center gap-1 font-semibold uppercase tracking-wider",children:[e.jsx(te,{size:9,className:"text-[var(--red)]"})," SL"]}),e.jsx("input",{type:"number",value:r.stopLoss,onChange:j=>y({...r,stopLoss:j.target.value}),placeholder:"Precio",className:"w-full text-xs"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"text-[10px] text-[var(--text-dim)] mb-1 flex items-center gap-1 font-semibold uppercase tracking-wider",children:[e.jsx(je,{size:9,className:"text-[var(--green)]"})," TP"]}),e.jsx("input",{type:"number",value:r.takeProfit,onChange:j=>y({...r,takeProfit:j.target.value}),placeholder:"Precio",className:"w-full text-xs"})]})]}),e.jsxs("div",{className:"rounded-lg p-3 flex items-center justify-between",style:{background:"rgba(24,26,32,0.6)",border:"1px solid rgba(30,34,45,0.4)"},children:[e.jsx("span",{className:"text-[10px] text-[var(--text-dim)] font-semibold uppercase tracking-wider",children:"Total"}),e.jsxs("span",{className:"text-sm font-mono font-bold",children:["$",I.toFixed(2)]})]}),e.jsxs("button",{onClick:A,disabled:!r.quantity,className:"w-full py-3.5 font-bold rounded-xl text-sm transition-all duration-200 disabled:opacity-40 text-white",style:c==="buy"?{background:"linear-gradient(135deg, #0ECB81, #0AA06A)",boxShadow:"0 4px 15px rgba(14,203,129,0.25)"}:{background:"linear-gradient(135deg, #F6465D, #D32F4A)",boxShadow:"0 4px 15px rgba(246,70,93,0.25)"},children:[c==="buy"?"Comprar":"Vender"," ",x.replace("USDT","")]}),e.jsxs("div",{className:"rounded-xl p-3",style:{background:"rgba(24,26,32,0.6)",border:"1px solid rgba(30,34,45,0.4)"},children:[e.jsx("p",{className:"text-[10px] text-[var(--text-dim)] mb-2 font-bold uppercase tracking-wider",children:"Order Book"}),e.jsxs("div",{className:"space-y-[2px] text-[10px] font-mono",children:[f.asks.slice(0,5).reverse().map((j,N)=>e.jsxs("div",{className:"flex justify-between text-[var(--red)] py-0.5 px-1 rounded hover:bg-[var(--red)]/[0.04]",children:[e.jsxs("span",{children:["$",j.price.toFixed(2)]}),e.jsx("span",{className:"text-[var(--text-dim)]",children:j.quantity.toFixed(4)})]},`a${N}`)),e.jsxs("div",{className:"text-center py-1.5 text-[15px] font-bold text-[var(--gold)] my-1",style:{background:"rgba(212,175,55,0.04)",borderRadius:"6px"},children:["$",(s==null?void 0:s.toLocaleString(void 0,{minimumFractionDigits:2}))||"---"]}),f.bids.slice(0,5).map((j,N)=>e.jsxs("div",{className:"flex justify-between text-[var(--green)] py-0.5 px-1 rounded hover:bg-[var(--green)]/[0.04]",children:[e.jsxs("span",{children:["$",j.price.toFixed(2)]}),e.jsx("span",{className:"text-[var(--text-dim)]",children:j.quantity.toFixed(4)})]},`b${N}`))]})]})]}),g==="positions"&&e.jsx("div",{className:"flex-1 overflow-y-auto p-3 space-y-2",children:t.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(ne,{size:32,className:"mx-auto text-[var(--text-dim)]/20 mb-2"}),e.jsx("p",{className:"text-sm text-[var(--text-dim)]",children:"Sin posiciones abiertas"})]}):t.map(j=>{const N=j.side==="buy"?(s-j.entryPrice)*j.quantity:(j.entryPrice-s)*j.quantity;return e.jsxs("div",{className:"rounded-xl p-3",style:{background:"linear-gradient(135deg, rgba(17,19,24,0.8), rgba(24,26,32,0.6))",border:`1px solid ${N>=0?"rgba(14,203,129,0.1)":"rgba(246,70,93,0.1)"}`},children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-xs font-bold",children:j.symbol}),e.jsx("span",{className:`text-[10px] font-bold px-2 py-0.5 rounded-md ${j.side==="buy"?"text-[var(--green)] bg-[var(--green)]/[0.08]":"text-[var(--red)] bg-[var(--red)]/[0.08]"}`,children:j.side.toUpperCase()})]}),e.jsxs("div",{className:"flex justify-between text-[10px] text-[var(--text-dim)] mb-2",children:[e.jsxs("span",{children:["Entrada: $",j.entryPrice]}),e.jsxs("span",{className:`font-bold ${N>=0?"text-[var(--green)]":"text-[var(--red)]"}`,children:["P&L: ",N>=0?"+":"","$",N.toFixed(2)]})]}),e.jsx("button",{onClick:()=>n(j.id),className:"w-full py-1.5 rounded-lg text-[10px] font-semibold text-[var(--text-dim)] hover:text-[var(--red)] transition-all",style:{background:"rgba(24,26,32,0.6)",border:"1px solid rgba(30,34,45,0.4)"},children:"Cerrar Posici√≥n"})]},j.id)})}),g==="orders"&&e.jsx("div",{className:"flex-1 overflow-y-auto p-3 space-y-2",children:a.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(ne,{size:32,className:"mx-auto text-[var(--text-dim)]/20 mb-2"}),e.jsx("p",{className:"text-sm text-[var(--text-dim)]",children:"Sin √≥rdenes pendientes"})]}):a.map(j=>e.jsxs("div",{className:"rounded-xl p-3",style:{background:"linear-gradient(135deg, rgba(17,19,24,0.8), rgba(24,26,32,0.6))",border:"1px solid rgba(30,34,45,0.5)"},children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsx("span",{className:"text-xs font-bold",children:j.symbol}),e.jsxs("span",{className:`text-[10px] font-bold ${j.side==="buy"?"text-[var(--green)]":"text-[var(--red)]"}`,children:[j.side.toUpperCase()," ",j.type]})]}),e.jsxs("div",{className:"text-[10px] text-[var(--text-dim)] mb-2",children:["Precio: $",j.price," | Cantidad: ",j.quantity]}),e.jsx("button",{onClick:()=>l(j.id),className:"w-full py-1.5 rounded-lg text-[10px] font-semibold text-[var(--text-dim)] hover:text-[var(--red)] transition-all",style:{background:"rgba(24,26,32,0.6)",border:"1px solid rgba(30,34,45,0.4)"},children:"Cancelar"})]},j.id))})]})}class Ut{constructor(){this.connections=new Map}_decrypt(s){return{...s,apiKey:atob(s.apiKey),apiSecret:atob(s.apiSecret),passphrase:s.passphrase?atob(s.passphrase):void 0}}async _hmacSign(s,t){const a=new TextEncoder,i=await crypto.subtle.importKey("raw",a.encode(s),{name:"HMAC",hash:"SHA-256"},!1,["sign"]),o=await crypto.subtle.sign("HMAC",i,a.encode(t));return Array.from(new Uint8Array(o)).map(n=>n.toString(16).padStart(2,"0")).join("")}async _binanceSignedRequest(s,t,a,i={}){const o=Date.now(),n={...i,timestamp:o,recvWindow:5e3},l=Object.entries(n).filter(([,f])=>f!=null).map(([f,v])=>`${f}=${encodeURIComponent(v)}`).join("&"),c=await this._hmacSign(s.apiSecret,l),p=`${l}&signature=${c}`,m=t==="GET"?`${J.binance.baseUrl}${a}?${p}`:`${J.binance.baseUrl}${a}`,u={method:t,headers:{"X-MBX-APIKEY":s.apiKey,"Content-Type":"application/x-www-form-urlencoded"}};(t==="POST"||t==="DELETE")&&(u.body=p);const r=await fetch(m,u),y=await r.json();if(!r.ok)throw new Error(`Binance ${a}: ${y.msg||r.statusText} (${y.code||r.status})`);return y}async _binancePublicRequest(s,t={}){const a=Object.entries(t).filter(([,n])=>n!==void 0).map(([n,l])=>`${n}=${encodeURIComponent(l)}`).join("&"),i=`${J.binance.baseUrl}${s}${a?"?"+a:""}`,o=await fetch(i);if(!o.ok)throw new Error(`Binance API error: ${o.status}`);return o.json()}async connect(s){const t=this._decrypt(s),a=J[s.brokerId];if(!a)throw new Error(`Unsupported broker: ${s.brokerId}`);try{switch(s.brokerId){case"binance":{await this._binancePublicRequest("/api/v3/ping");const i=await this._binanceSignedRequest(t,"GET","/api/v3/account");return this.connections.set(s.id,{creds:t,config:a,connected:!0,permissions:i.permissions||[],accountType:i.accountType}),{success:!0,message:`Connected to Binance (${i.accountType})`,permissions:i.permissions}}default:return await fetch(a.baseUrl),this.connections.set(s.id,{creds:t,config:a,connected:!0,permissions:[]}),{success:!0,message:`Connected to ${a.name} (simulated)`}}}catch(i){return{success:!1,message:i.message}}}async getBalances(s){const t=this.connections.get(s);if(!t)throw new Error("Broker not connected");if(t.config.id==="binance")try{return(await this._binanceSignedRequest(t.creds,"GET","/api/v3/account")).balances.filter(i=>parseFloat(i.free)>0||parseFloat(i.locked)>0).map(i=>({asset:i.asset,free:i.free,locked:i.locked,total:(parseFloat(i.free)+parseFloat(i.locked)).toString()}))}catch(a){throw console.error("Binance getBalances error:",a),a}return[]}async placeOrder(s,t){var u,r,y,f,v,g;const a=this.connections.get(s);if(!a)throw new Error("Broker not connected");const{symbol:i,side:o,type:n,quantity:l,price:c,stopLoss:p,takeProfit:m}=t;if(!i||!o||!n||!l)throw new Error("Missing required order fields");if(a.config.id==="binance")try{const k={market:"MARKET",limit:"LIMIT",stop_loss:"STOP_LOSS_LIMIT"}[n]||"MARKET",P={symbol:i,side:o.toUpperCase(),type:k,quantity:l.toString()};(k==="LIMIT"||k==="STOP_LOSS_LIMIT")&&(P.timeInForce="GTC",P.price=parseFloat(c).toFixed(2)),k==="STOP_LOSS_LIMIT"&&(P.stopPrice=parseFloat(p||c).toFixed(2));const A=await this._binanceSignedRequest(a.creds,"POST","/api/v3/order",P);return{id:(u=A.orderId)==null?void 0:u.toString(),clientOrderId:A.clientOrderId,symbol:A.symbol,side:(r=A.side)==null?void 0:r.toLowerCase(),type:(y=A.type)==null?void 0:y.toLowerCase(),quantity:parseFloat(A.origQty||l),price:parseFloat(A.price||c||0),filledPrice:parseFloat(((v=(f=A.fills)==null?void 0:f[0])==null?void 0:v.price)||A.price||0),filledQty:parseFloat(A.executedQty||0),status:(g=A.status)==null?void 0:g.toLowerCase(),timestamp:new Date(A.transactTime||Date.now()).toISOString(),broker:"Binance",raw:A}}catch(k){throw console.error("Binance placeOrder error:",k),k}return{id:Date.now().toString(36),symbol:i,side:o,type:n,quantity:parseFloat(l),price:c?parseFloat(c):null,status:n==="market"?"filled":"new",filledPrice:n==="market"?parseFloat(c||0):null,timestamp:new Date().toISOString(),broker:a.config.name,simulated:!0}}async cancelOrder(s,t,a){const i=this.connections.get(s);if(!i)throw new Error("Broker not connected");if(i.config.id==="binance")try{const o=await this._binanceSignedRequest(i.creds,"DELETE","/api/v3/order",{symbol:a,orderId:t});return{success:!0,orderId:o.orderId,status:o.status}}catch(o){return{success:!1,message:o.message}}return{success:!0,orderId:t,simulated:!0}}async getOpenOrders(s,t){const a=this.connections.get(s);if(!a)throw new Error("Broker not connected");if(a.config.id==="binance")try{const i=t?{symbol:t}:{};return(await this._binanceSignedRequest(a.creds,"GET","/api/v3/openOrders",i)).map(n=>{var l,c,p,m;return{id:(l=n.orderId)==null?void 0:l.toString(),symbol:n.symbol,side:(c=n.side)==null?void 0:c.toLowerCase(),type:(p=n.type)==null?void 0:p.toLowerCase(),quantity:parseFloat(n.origQty),price:parseFloat(n.price),filledQty:parseFloat(n.executedQty),status:(m=n.status)==null?void 0:m.toLowerCase(),time:new Date(n.time).toISOString()}})}catch{return[]}return[]}async getTradeHistory(s,t,a=50){const i=this.connections.get(s);if(!i)throw new Error("Broker not connected");if(i.config.id==="binance")try{return(await this._binanceSignedRequest(i.creds,"GET","/api/v3/myTrades",{symbol:t,limit:a})).map(n=>{var l,c;return{id:(l=n.id)==null?void 0:l.toString(),orderId:(c=n.orderId)==null?void 0:c.toString(),symbol:n.symbol,side:n.isBuyer?"buy":"sell",price:parseFloat(n.price),quantity:parseFloat(n.qty),commission:parseFloat(n.commission),commissionAsset:n.commissionAsset,time:new Date(n.time).toISOString(),isMaker:n.isMaker}})}catch{return[]}return[]}async getExchangeInfo(s){var t,a,i,o;try{const l=(t=(await this._binancePublicRequest("/api/v3/exchangeInfo",{symbol:s})).symbols)==null?void 0:t[0];if(!l)return null;const c=(a=l.filters)==null?void 0:a.find(u=>u.filterType==="LOT_SIZE"),p=(i=l.filters)==null?void 0:i.find(u=>u.filterType==="PRICE_FILTER"),m=(o=l.filters)==null?void 0:o.find(u=>u.filterType==="NOTIONAL"||u.filterType==="MIN_NOTIONAL");return{symbol:l.symbol,status:l.status,baseAsset:l.baseAsset,quoteAsset:l.quoteAsset,minQty:c?parseFloat(c.minQty):0,maxQty:c?parseFloat(c.maxQty):1/0,stepSize:c?parseFloat(c.stepSize):0,minPrice:p?parseFloat(p.minPrice):0,tickSize:p?parseFloat(p.tickSize):0,minNotional:m?parseFloat(m.minNotional||m.notional):0}}catch{return null}}isConnected(s){return this.connections.has(s)}getConnection(s){return this.connections.get(s)}disconnect(s){this.connections.delete(s)}}const pe=new Ut;class Lt{constructor(){this.activeBots=new Map,this.intervals=new Map}async startBot(s,t,a){if(this.activeBots.has(s.id))return;a==null||a(`ü§ñ Bot "${s.name}" iniciado en ${s.pair}`),this.activeBots.set(s.id,{bot:s,running:!0});const i=this._getCheckInterval(s.timeframe),o=async()=>{var l;if((l=this.activeBots.get(s.id))!=null&&l.running)try{const c=await q.getCandles(s.pair,s.timeframe,100),p=c.map(r=>r.close),m=p[p.length-1],u=this._evaluateStrategy(s.strategy,c,p);if(u){a==null||a(`üìä Se√±al detectada: ${u.type.toUpperCase()} a $${m}`);const r=this._calculatePositionSize(s,m),y={symbol:s.pair,side:u.type,type:"market",quantity:r,price:m,stopLoss:u.type==="buy"?m*(1-parseFloat(s.strategy.stopLoss)/100):m*(1+parseFloat(s.strategy.stopLoss)/100),takeProfit:u.type==="buy"?m*(1+parseFloat(s.strategy.takeProfit)/100):m*(1-parseFloat(s.strategy.takeProfit)/100)};t==null||t(y),a==null||a(`‚úÖ Orden ejecutada: ${u.type.toUpperCase()} ${r} ${s.pair} @ $${m}`)}}catch(c){a==null||a(`‚ùå Error: ${c.message}`)}};await o();const n=setInterval(o,i);this.intervals.set(s.id,n)}stopBot(s){const t=this.activeBots.get(s);t&&(t.running=!1,this.activeBots.delete(s));const a=this.intervals.get(s);a&&(clearInterval(a),this.intervals.delete(s))}_evaluateStrategy(s,t,a){var n,l,c,p,m,u,r,y,f,v,g,k;if(!((n=s==null?void 0:s.entry)!=null&&n.indicator))return null;const i=a.length,o=s.entry.indicator;switch(o){case"ema_cross":case"ema_cross_rsi":{const P=((l=s.entry.params)==null?void 0:l.fastEma)||((c=s.entry.params)==null?void 0:c.fast)||20,A=((p=s.entry.params)==null?void 0:p.slowEma)||((m=s.entry.params)==null?void 0:m.slow)||50,I=G(a,P),j=G(a,A),N=he(I,j,i-1);if(o==="ema_cross_rsi"){const d=((u=s.entry.params)==null?void 0:u.rsiPeriod)||14,S=le(a,d)[i-1],T=((r=s.entry.params)==null?void 0:r.rsiOversold)||30,E=((f=(y=s.exit)==null?void 0:y.params)==null?void 0:f.rsiOverbought)||70;if(N==="bullish_cross"&&S<T)return{type:"buy"};if(N==="bearish_cross"&&S>E)return{type:"sell"};if(S>E)return{type:"sell"};if(S<T)return{type:"buy"}}else{if(N==="bullish_cross")return{type:"buy"};if(N==="bearish_cross")return{type:"sell"}}break}case"rsi":{const P=((v=s.entry.params)==null?void 0:v.period)||14,I=le(a,P)[i-1];if(I<(((g=s.entry.params)==null?void 0:g.oversold)||30))return{type:"buy"};if(I>(((k=s.entry.params)==null?void 0:k.overbought)||70))return{type:"sell"};break}case"macd_cross":{const{macd:P,signal:A}=Ke(a),I=he(P,A,i-1);if(I==="bullish_cross")return{type:"buy"};if(I==="bearish_cross")return{type:"sell"};break}default:return null}return null}_calculatePositionSize(s,t){const a=s.balance||1e3,i=parseFloat(s.riskPercent||2)/100,o=a*i/t;return Math.round(o*1e8)/1e8}_getCheckInterval(s){return{"1m":6e4,"5m":3e5,"15m":9e5,"1h":3e5,"4h":9e5,"1d":36e5}[s]||3e5}getActiveBotCount(){return this.activeBots.size}}const De=new Lt;class Kt{constructor(){this.activeBots=new Map}start(s){if(this.activeBots.has(s.id))return;const{pair:t,upperPrice:a,lowerPrice:i,gridLines:o,investment:n,onLog:l,onTrade:c}=s,p=(a-i)/(o-1),m=[];for(let y=0;y<o;y++)m.push(+(i+p*y).toFixed(2));const u=n/(o-1),r={id:s.id,pair:t,levels:m,priceStep:p,investmentPerGrid:u,activeOrders:new Map,filledBuys:[],totalProfit:0,trades:0,running:!0,lastPrice:null};this.activeBots.set(s.id,r),l==null||l(`üìä Grid Bot started: ${o} levels from $${i} to $${a}`),l==null||l(`üí∞ Investment per grid: $${u.toFixed(2)}`),this._startMonitor(r,l,c)}async _startMonitor(s,t,a){const i=async()=>{if(s.running)try{const l=(await q.get24hrTicker(s.pair)).price,c=s.lastPrice;if(s.lastPrice=l,!c){t==null||t(`üìà Current price: $${l.toFixed(2)}`);for(const m of s.levels)m<l?s.activeOrders.set(m,{side:"buy",price:m,status:"pending"}):m>l;const p=s.activeOrders.size;t==null||t(`üü¢ ${p} buy orders placed below current price`);return}for(const p of s.levels){const m=s.activeOrders.get(p);if((m==null?void 0:m.side)==="buy"&&m.status==="pending"&&l<=p){const u=s.investmentPerGrid/p;m.status="filled",s.filledBuys.push(p),s.trades++,a==null||a({symbol:s.pair,side:"buy",type:"grid",quantity:+u.toFixed(6),price:p,gridLevel:p}),t==null||t(`‚úÖ BUY filled at $${p} (qty: ${u.toFixed(6)})`);const r=p+s.priceStep;r<=s.levels[s.levels.length-1]&&(s.activeOrders.set(r,{side:"sell",price:r,status:"pending",buyLevel:p,quantity:u}),t==null||t(`üì§ SELL order placed at $${r.toFixed(2)}`))}if((m==null?void 0:m.side)==="sell"&&m.status==="pending"&&l>=p){m.status="filled";const u=(p-m.buyLevel)*m.quantity;s.totalProfit+=u,s.trades++,a==null||a({symbol:s.pair,side:"sell",type:"grid",quantity:+m.quantity.toFixed(6),price:p,profit:+u.toFixed(2),gridLevel:p}),t==null||t(`‚úÖ SELL filled at $${p.toFixed(2)} ‚Äî Profit: +$${u.toFixed(2)}`);const r=p-s.priceStep;r>=s.levels[0]&&(s.activeOrders.set(r,{side:"buy",price:r,status:"pending"}),t==null||t(`üì• BUY order re-placed at $${r.toFixed(2)}`))}}}catch(n){t==null||t(`‚ùå Error: ${n.message}`)}};await i();const o=setInterval(i,1e4);s._interval=o}stop(s){const t=this.activeBots.get(s);t&&(t.running=!1,t._interval&&clearInterval(t._interval),this.activeBots.delete(s))}getStats(s){const t=this.activeBots.get(s);return t?{levels:t.levels.length,activeOrders:[...t.activeOrders.values()].filter(a=>a.status==="pending").length,filledBuys:t.filledBuys.length,totalProfit:t.totalProfit,trades:t.trades,lastPrice:t.lastPrice}:null}isRunning(s){return this.activeBots.has(s)}}const Ee=new Kt;class Ht{constructor(){this.activeBots=new Map}start(s){if(this.activeBots.has(s.id))return;const{pair:t,investmentPerOrder:a,intervalMinutes:i,maxOrders:o=100,useRsiFilter:n=!1,rsiPeriod:l=14,rsiThreshold:c=40,usePriceDipFilter:p=!1,dipPercent:m=3,onLog:u,onTrade:r}=s,y={id:s.id,pair:t,investmentPerOrder:a,intervalMinutes:i,maxOrders:o,useRsiFilter:n,rsiPeriod:l,rsiThreshold:c,usePriceDipFilter:p,dipPercent:m,executedOrders:0,totalInvested:0,totalQuantity:0,avgPrice:0,prices:[],running:!0,lastBuyPrice:null,startTime:Date.now()};this.activeBots.set(s.id,y),u==null||u(`üìä DCA Bot started: $${a} every ${i}min on ${t}`),n&&(u==null||u(`üìâ RSI filter enabled: buy when RSI < ${c}`)),p&&(u==null||u(`üìâ Dip filter enabled: buy when price drops ${m}%`)),this._startMonitor(y,u,r)}async _startMonitor(s,t,a){const i=async()=>{if(s.running){if(s.executedOrders>=s.maxOrders){t==null||t(`üèÅ Max orders reached (${s.maxOrders}). DCA Bot stopped.`),this.stop(s.id);return}try{const l=(await q.get24hrTicker(s.pair)).price;if(s.useRsiFilter)try{const m=(await q.getCandles(s.pair,"1h",100)).map(y=>y.close),u=le(m,s.rsiPeriod),r=u[u.length-1];if(r>s.rsiThreshold){t==null||t(`‚è∏Ô∏è RSI ${r.toFixed(1)} > ${s.rsiThreshold} ‚Äî skipping buy`);return}t==null||t(`üìâ RSI ${r.toFixed(1)} < ${s.rsiThreshold} ‚Äî proceeding with buy`)}catch(p){t==null||t(`‚ö†Ô∏è RSI check failed, proceeding anyway: ${p.message}`)}if(s.usePriceDipFilter&&s.lastBuyPrice){const p=(s.lastBuyPrice-l)/s.lastBuyPrice*100;if(p<s.dipPercent){t==null||t(`‚è∏Ô∏è Price drop ${p.toFixed(2)}% < ${s.dipPercent}% ‚Äî skipping buy`);return}t==null||t(`üìâ Price dropped ${p.toFixed(2)}% ‚Äî proceeding with buy`)}const c=s.investmentPerOrder/l;s.executedOrders++,s.totalInvested+=s.investmentPerOrder,s.totalQuantity+=c,s.avgPrice=s.totalInvested/s.totalQuantity,s.lastBuyPrice=l,s.prices.push(l),a==null||a({symbol:s.pair,side:"buy",type:"dca",quantity:+c.toFixed(8),price:l,dcaOrder:s.executedOrders,avgPrice:+s.avgPrice.toFixed(2)}),t==null||t(`‚úÖ DCA Buy #${s.executedOrders}: ${c.toFixed(6)} ${s.pair.replace("USDT","")} @ $${l.toFixed(2)}`),t==null||t(`üìä Avg price: $${s.avgPrice.toFixed(2)} | Total invested: $${s.totalInvested.toFixed(2)}`)}catch(n){t==null||t(`‚ùå Error: ${n.message}`)}}};await i();const o=setInterval(i,s.intervalMinutes*60*1e3);s._interval=o}stop(s){const t=this.activeBots.get(s);t&&(t.running=!1,t._interval&&clearInterval(t._interval),this.activeBots.delete(s))}getStats(s){const t=this.activeBots.get(s);if(!t)return null;const i=t.totalQuantity*(t.lastBuyPrice||0)-t.totalInvested;return{executedOrders:t.executedOrders,maxOrders:t.maxOrders,totalInvested:t.totalInvested,totalQuantity:t.totalQuantity,avgPrice:t.avgPrice,currentPrice:t.lastBuyPrice,unrealizedPnl:i,unrealizedPnlPercent:t.totalInvested>0?i/t.totalInvested*100:0,runningTime:Date.now()-t.startTime}}isRunning(s){return this.activeBots.has(s)}}const Re=new Ht,be=[{id:"signal",label:"Signal Bot",icon:Q,desc:"Ejecuta trades basado en indicadores t√©cnicos",color:"#D4AF37"},{id:"grid",label:"Grid Bot",icon:it,desc:"Compra y vende en niveles de precio predefinidos",color:"#00DC82"},{id:"dca",label:"DCA Bot",icon:ne,desc:"Invierte cantidades fijas a intervalos regulares",color:"#A855F7"}];function Vt(){const{bots:x,addBot:s,updateBot:t,removeBot:a,strategies:i,brokers:o}=_(),[n,l]=w.useState(!1),[c,p]=w.useState("signal"),[m,u]=w.useState([]),[r,y]=w.useState({name:"",pair:"BTCUSDT",timeframe:"1h",strategyId:"",brokerId:"",balance:"1000",riskPercent:"2",maxTrades:"10",upperPrice:"",lowerPrice:"",gridLines:"10",investmentPerOrder:"100",intervalMinutes:"60",maxOrders:"50",useRsiFilter:!1,rsiThreshold:"40",usePriceDipFilter:!1,dipPercent:"3"}),f=()=>{if(!r.name||!r.pair)return;const d={name:r.name,pair:r.pair,botType:c,brokerId:r.brokerId};if(c==="signal"){const b=i.find(S=>S.id===r.strategyId)||{name:"EMA Cross + RSI",entry:{condition:"EMA 20 cruza EMA 50 + RSI < 30",indicator:"ema_cross_rsi",params:{fastEma:20,slowEma:50,rsiPeriod:14,rsiOversold:30}},exit:{condition:"RSI > 70",indicator:"rsi",params:{rsiOverbought:70}},stopLoss:"2",takeProfit:"4"};Object.assign(d,{timeframe:r.timeframe,strategy:b,balance:parseFloat(r.balance),riskPercent:parseFloat(r.riskPercent),maxTrades:parseInt(r.maxTrades)})}else c==="grid"?Object.assign(d,{upperPrice:parseFloat(r.upperPrice),lowerPrice:parseFloat(r.lowerPrice),gridLines:parseInt(r.gridLines),balance:parseFloat(r.balance)}):c==="dca"&&Object.assign(d,{investmentPerOrder:parseFloat(r.investmentPerOrder),intervalMinutes:parseInt(r.intervalMinutes),maxOrders:parseInt(r.maxOrders),useRsiFilter:r.useRsiFilter,rsiThreshold:parseInt(r.rsiThreshold),usePriceDipFilter:r.usePriceDipFilter,dipPercent:parseFloat(r.dipPercent),balance:parseFloat(r.investmentPerOrder)*parseInt(r.maxOrders)});s(d),l(!1)},v=(d,b)=>{u(S=>[...S.slice(-100),{type:"log",bot:d.name,message:b,time:new Date().toLocaleTimeString()}])},g=(d,b)=>{u(T=>[...T.slice(-100),{type:"trade",bot:d.name,...b,time:new Date().toLocaleTimeString()}]);const S=_.getState().bots.find(T=>T.id===d.id);if(S){const T=(S.trades||0)+1,E=(S.pnl||0)+(b.profit||0);t(d.id,{trades:T,pnl:E})}},k=async d=>{t(d.id,{status:"active"});const b=d.botType||"signal";b==="signal"?De.startBot({...d,status:"active"},S=>g(d,S),S=>v(d,S)):b==="grid"?Ee.start({id:d.id,pair:d.pair,upperPrice:d.upperPrice,lowerPrice:d.lowerPrice,gridLines:d.gridLines,investment:d.balance,onLog:S=>v(d,S),onTrade:S=>g(d,S)}):b==="dca"&&Re.start({id:d.id,pair:d.pair,investmentPerOrder:d.investmentPerOrder,intervalMinutes:d.intervalMinutes,maxOrders:d.maxOrders,useRsiFilter:d.useRsiFilter,rsiThreshold:d.rsiThreshold,usePriceDipFilter:d.usePriceDipFilter,dipPercent:d.dipPercent,onLog:S=>v(d,S),onTrade:S=>g(d,S)})},P=d=>{const b=d.botType||"signal";b==="signal"?De.stopBot(d.id):b==="grid"?Ee.stop(d.id):b==="dca"&&Re.stop(d.id),t(d.id,{status:"stopped"})},A=d=>{P(d),t(d.id,{status:"paused"})},I=d=>{P(d),a(d.id)},j=d=>{switch(d){case"active":return"var(--green)";case"paused":return"var(--gold)";case"error":return"var(--red)";default:return"var(--text-dim)"}},N=d=>be.find(b=>b.id===d)||be[0];return e.jsxs("div",{className:"flex-1 overflow-y-auto p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl font-bold",children:"Trading Bots"}),e.jsxs("p",{className:"text-sm text-[var(--text-dim)]",children:[x.filter(d=>d.status==="active").length," activos de ",x.length," total"]})]}),e.jsxs("button",{onClick:()=>l(!n),className:"flex items-center gap-2 px-4 py-2 btn-gold rounded-xl text-sm",children:[e.jsx(ve,{size:16})," Crear Bot"]})]}),e.jsx(K,{children:n&&e.jsx(B.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},className:"rounded-xl overflow-hidden",style:{background:"var(--surface)",border:"1px solid var(--border)"},children:e.jsxs("div",{className:"p-5 space-y-5",children:[e.jsx("h3",{className:"text-sm font-bold text-[var(--text)]",children:"Nuevo Bot de Trading"}),e.jsx("div",{className:"grid grid-cols-3 gap-3",children:be.map(d=>{const b=d.icon;return e.jsxs("button",{onClick:()=>p(d.id),className:`p-3 rounded-xl text-left transition-all ${c===d.id?"ring-1":"hover:bg-[var(--surface-2)]"}`,style:{background:c===d.id?`${d.color}10`:"var(--surface-2)",borderColor:c===d.id?`${d.color}40`:"var(--border)",border:`1px solid ${c===d.id?d.color+"30":"var(--border)"}`},children:[e.jsx(b,{size:20,style:{color:d.color},className:"mb-1.5"}),e.jsx("p",{className:"text-xs font-bold",style:{color:c===d.id?d.color:"var(--text)"},children:d.label}),e.jsx("p",{className:"text-[10px] text-[var(--text-dim)] mt-0.5",children:d.desc})]},d.id)})}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-[10px] text-[var(--text-dim)] mb-1 block font-semibold uppercase tracking-wider",children:"Nombre"}),e.jsx("input",{value:r.name,onChange:d=>y({...r,name:d.target.value}),placeholder:"Mi Bot",className:"w-full"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-[10px] text-[var(--text-dim)] mb-1 block font-semibold uppercase tracking-wider",children:"Par"}),e.jsx("select",{value:r.pair,onChange:d=>y({...r,pair:d.target.value}),className:"w-full",children:Se.map(d=>e.jsx("option",{value:d,children:d},d))})]})]}),c==="signal"&&e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-[10px] text-[var(--text-dim)] mb-1 block font-semibold uppercase tracking-wider",children:"Timeframe"}),e.jsx("select",{value:r.timeframe,onChange:d=>y({...r,timeframe:d.target.value}),className:"w-full",children:ke.map(d=>e.jsx("option",{value:d.value,children:d.label},d.value))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-[10px] text-[var(--text-dim)] mb-1 block font-semibold uppercase tracking-wider",children:"Balance ($)"}),e.jsx("input",{type:"number",value:r.balance,onChange:d=>y({...r,balance:d.target.value}),className:"w-full"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-[10px] text-[var(--text-dim)] mb-1 block font-semibold uppercase tracking-wider",children:"Riesgo (%)"}),e.jsx("input",{type:"number",value:r.riskPercent,onChange:d=>y({...r,riskPercent:d.target.value}),className:"w-full"})]})]}),c==="grid"&&e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-[10px] text-[var(--text-dim)] mb-1 block font-semibold uppercase tracking-wider",children:"Precio Superior ($)"}),e.jsx("input",{type:"number",value:r.upperPrice,onChange:d=>y({...r,upperPrice:d.target.value}),placeholder:"100000",className:"w-full"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-[10px] text-[var(--text-dim)] mb-1 block font-semibold uppercase tracking-wider",children:"Precio Inferior ($)"}),e.jsx("input",{type:"number",value:r.lowerPrice,onChange:d=>y({...r,lowerPrice:d.target.value}),placeholder:"90000",className:"w-full"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-[10px] text-[var(--text-dim)] mb-1 block font-semibold uppercase tracking-wider",children:"Niveles de Grid"}),e.jsx("input",{type:"number",value:r.gridLines,onChange:d=>y({...r,gridLines:d.target.value}),className:"w-full"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-[10px] text-[var(--text-dim)] mb-1 block font-semibold uppercase tracking-wider",children:"Inversi√≥n Total ($)"}),e.jsx("input",{type:"number",value:r.balance,onChange:d=>y({...r,balance:d.target.value}),className:"w-full"})]})]}),c==="dca"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-[10px] text-[var(--text-dim)] mb-1 block font-semibold uppercase tracking-wider",children:"$ por Compra"}),e.jsx("input",{type:"number",value:r.investmentPerOrder,onChange:d=>y({...r,investmentPerOrder:d.target.value}),className:"w-full"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-[10px] text-[var(--text-dim)] mb-1 block font-semibold uppercase tracking-wider",children:"Intervalo (min)"}),e.jsx("input",{type:"number",value:r.intervalMinutes,onChange:d=>y({...r,intervalMinutes:d.target.value}),className:"w-full"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-[10px] text-[var(--text-dim)] mb-1 block font-semibold uppercase tracking-wider",children:"M√°x. Compras"}),e.jsx("input",{type:"number",value:r.maxOrders,onChange:d=>y({...r,maxOrders:d.target.value}),className:"w-full"})]})]}),e.jsxs("div",{className:"flex flex-wrap gap-4",children:[e.jsxs("label",{className:"flex items-center gap-2 text-xs text-[var(--text-secondary)] cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:r.useRsiFilter,onChange:d=>y({...r,useRsiFilter:d.target.checked}),className:"w-4 h-4 rounded accent-[var(--gold)]"}),"Filtro RSI (comprar solo si RSI < ",r.rsiThreshold,")"]}),e.jsxs("label",{className:"flex items-center gap-2 text-xs text-[var(--text-secondary)] cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:r.usePriceDipFilter,onChange:d=>y({...r,usePriceDipFilter:d.target.checked}),className:"w-4 h-4 rounded accent-[var(--gold)]"}),"Filtro de Ca√≠da (comprar cuando baje ",r.dipPercent,"%)"]})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:f,className:"flex-1 py-2.5 btn-gold rounded-xl text-sm",children:"Crear Bot"}),e.jsx("button",{onClick:()=>l(!1),className:"px-4 py-2.5 bg-[var(--surface-2)] text-[var(--text-dim)] rounded-xl text-sm border border-[var(--border)]",children:"Cancelar"})]})]})})}),x.length===0?e.jsxs("div",{className:"rounded-xl p-12 text-center",style:{background:"var(--surface)",border:"1px solid var(--border)"},children:[e.jsx(ae,{size:48,className:"text-[var(--text-dim)]/20 mx-auto mb-4"}),e.jsx("p",{className:"text-[var(--text-dim)]",children:"No hay bots creados"}),e.jsx("p",{className:"text-xs text-[var(--text-dim)] mt-1",children:"Crea tu primer bot para automatizar tu trading"})]}):e.jsx("div",{className:"space-y-3",children:x.map(d=>{var T;const b=N(d.botType||"signal"),S=b.icon;return e.jsxs(B.div,{layout:!0,className:"rounded-xl p-4",style:{background:"var(--surface)",border:"1px solid var(--border)"},children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-xl flex items-center justify-center",style:{background:`${b.color}12`,border:`1px solid ${b.color}20`},children:e.jsx(S,{size:20,style:{color:b.color}})}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("p",{className:"text-sm font-bold",children:d.name}),e.jsx("span",{className:"text-[9px] font-bold px-1.5 py-0.5 rounded-md uppercase tracking-wider",style:{background:`${b.color}15`,color:b.color},children:b.label})]}),e.jsxs("p",{className:"text-xs text-[var(--text-dim)]",children:[d.pair,d.timeframe?` ‚Ä¢ ${d.timeframe}`:""]})]})]}),e.jsx("span",{className:"px-2.5 py-1 rounded-lg text-[10px] font-bold",style:{color:j(d.status),background:`${j(d.status)}15`},children:d.status==="active"?"‚óè Activo":d.status==="paused"?"‚ùö‚ùö Pausado":"‚ñ† Detenido"})]}),e.jsxs("div",{className:"grid grid-cols-4 gap-2 mb-3",children:[e.jsxs("div",{className:"rounded-lg p-2 text-center",style:{background:"var(--surface-2)"},children:[e.jsx("p",{className:"text-[10px] text-[var(--text-dim)]",children:"Trades"}),e.jsx("p",{className:"text-sm font-bold",children:d.trades||0})]}),e.jsxs("div",{className:"rounded-lg p-2 text-center",style:{background:"var(--surface-2)"},children:[e.jsx("p",{className:"text-[10px] text-[var(--text-dim)]",children:"P&L"}),e.jsxs("p",{className:`text-sm font-bold ${(d.pnl||0)>=0?"text-[var(--green)]":"text-[var(--red)]"}`,children:[(d.pnl||0)>=0?"+":"","$",(d.pnl||0).toFixed(2)]})]}),e.jsxs("div",{className:"rounded-lg p-2 text-center",style:{background:"var(--surface-2)"},children:[e.jsx("p",{className:"text-[10px] text-[var(--text-dim)]",children:"Win Rate"}),e.jsxs("p",{className:"text-sm font-bold text-[var(--gold)]",children:[(d.winRate||0).toFixed(0),"%"]})]}),e.jsxs("div",{className:"rounded-lg p-2 text-center",style:{background:"var(--surface-2)"},children:[e.jsx("p",{className:"text-[10px] text-[var(--text-dim)]",children:"Balance"}),e.jsxs("p",{className:"text-sm font-bold",children:["$",((T=d.balance)==null?void 0:T.toLocaleString())||"0"]})]})]}),e.jsxs("div",{className:"flex gap-2",children:[d.status!=="active"?e.jsxs("button",{onClick:()=>k(d),className:"flex items-center gap-1 px-3 py-1.5 bg-[var(--green)]/10 text-[var(--green)] rounded-lg text-xs font-bold hover:bg-[var(--green)]/20 transition-colors border border-[var(--green)]/20",children:[e.jsx(oe,{size:12})," Iniciar"]}):e.jsxs("button",{onClick:()=>A(d),className:"flex items-center gap-1 px-3 py-1.5 bg-[var(--gold)]/10 text-[var(--gold)] rounded-lg text-xs font-bold hover:bg-[var(--gold)]/20 transition-colors border border-[var(--gold)]/20",children:[e.jsx(nt,{size:12})," Pausar"]}),e.jsxs("button",{onClick:()=>P(d),className:"flex items-center gap-1 px-3 py-1.5 text-[var(--text-dim)] rounded-lg text-xs hover:text-[var(--text)] transition-colors",style:{background:"var(--surface-2)",border:"1px solid var(--border)"},children:[e.jsx(lt,{size:12})," Detener"]}),e.jsx("button",{onClick:()=>I(d),className:"ml-auto flex items-center gap-1 px-3 py-1.5 text-[var(--text-dim)] hover:text-[var(--red)] rounded-lg text-xs transition-colors",children:e.jsx(ce,{size:12})})]})]},d.id)})}),m.length>0&&e.jsxs("div",{className:"rounded-xl overflow-hidden",style:{background:"var(--surface)",border:"1px solid var(--border)"},children:[e.jsxs("div",{className:"flex items-center justify-between p-3",style:{borderBottom:"1px solid var(--border)"},children:[e.jsxs("h3",{className:"text-sm font-bold flex items-center gap-2",children:[e.jsx("div",{className:"w-2 h-2 rounded-full bg-[var(--green)] animate-pulse"}),"Actividad en Vivo"]}),e.jsx("button",{onClick:()=>u([]),className:"text-xs text-[var(--text-dim)] hover:text-[var(--gold)] transition-colors",children:"Limpiar"})]}),e.jsx("div",{className:"max-h-48 overflow-y-auto p-3 space-y-1 font-mono text-[11px]",children:m.slice(-50).reverse().map((d,b)=>{var S;return e.jsxs("div",{className:"flex items-start gap-2 py-0.5",children:[e.jsx("span",{className:"text-[var(--text-dim)] shrink-0",children:d.time}),e.jsxs("span",{className:"text-[var(--gold)] shrink-0 font-semibold",children:["[",d.bot,"]"]}),e.jsx("span",{className:"text-[var(--text-secondary)]",children:d.message||`${(S=d.side)==null?void 0:S.toUpperCase()} ${d.quantity} @ $${d.price}`})]},b)})})]})]})}function Wt(){var z;const{brokers:x,addBroker:s,removeBroker:t,updateBrokerStatus:a,setActiveBroker:i}=_(),[o,n]=w.useState(!1),[l,c]=w.useState({brokerId:"binance",apiKey:"",apiSecret:"",passphrase:"",label:""}),[p,m]=w.useState(!1),[u,r]=w.useState(null),[y,f]=w.useState(""),[v,g]=w.useState({}),[k,P]=w.useState({}),[A,I]=w.useState(null),[j,N]=w.useState({}),d=()=>{if(f(""),!l.apiKey||!l.apiSecret){f("API Key y Secret son obligatorios");return}const h=J[l.brokerId];if(h.requiredFields.includes("passphrase")&&!l.passphrase){f("Este broker requiere Passphrase");return}s({brokerId:l.brokerId,label:l.label||h.name,apiKey:l.apiKey,apiSecret:l.apiSecret,passphrase:l.passphrase}),c({brokerId:"binance",apiKey:"",apiSecret:"",passphrase:"",label:""}),n(!1)},b=async h=>{r(h.id);const C=await pe.connect(h);a(h.id,C.success),C.success&&(i(h),S(h)),r(null)},S=w.useCallback(async h=>{P(C=>({...C,[h.id]:!0}));try{const C=await pe.getBalances(h.id);C.success&&g(F=>({...F,[h.id]:C.balances}))}catch{}P(C=>({...C,[h.id]:!1}))},[]),T=w.useCallback(async h=>{try{const C=await pe.getTradeHistory(h.id,"BTCUSDT",10);C.success&&N(F=>({...F,[h.id]:C.trades}))}catch{}},[]);w.useEffect(()=>{const h=x.filter(F=>F.connected);h.forEach(F=>S(F));const C=setInterval(()=>h.forEach(F=>S(F)),3e4);return()=>clearInterval(C)},[x,S]);const E=h=>{pe.disconnect(h),t(h),g(C=>{const F={...C};return delete F[h],F})},$=h=>(v[h]||[]).reduce((F,L)=>["USDT","USDC","BUSD","FDUSD"].includes(L.asset)?F+parseFloat(L.free)+parseFloat(L.locked||0):F,0);return e.jsxs("div",{className:"flex-1 overflow-y-auto p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl font-bold",children:"Brokers Conectados"}),e.jsxs("p",{className:"text-sm text-[var(--text-dim)]",children:[x.filter(h=>h.connected).length," conectados de ",x.length]})]}),e.jsxs("button",{onClick:()=>n(!o),className:"flex items-center gap-2 px-4 py-2 btn-gold rounded-xl text-sm",children:[e.jsx(ve,{size:16})," Agregar Broker"]})]}),e.jsx("div",{className:"rounded-xl p-4 flex items-start gap-3",style:{background:"var(--gold-dark)",opacity:.08,position:"absolute"}}),e.jsxs("div",{className:"rounded-xl p-4 flex items-start gap-3",style:{background:"rgba(212,175,55,0.05)",border:"1px solid rgba(212,175,55,0.15)"},children:[e.jsx(te,{size:20,className:"text-[var(--gold)] shrink-0 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-bold text-[var(--gold)]",children:"Tus API Keys est√°n seguras"}),e.jsxs("p",{className:"text-xs text-[var(--text-dim)] mt-1",children:["Las claves se almacenan encriptadas localmente. Kairos Trade solo necesita permisos de lectura y trading.",e.jsx("strong",{className:"text-[var(--text)]",children:" Nunca actives permisos de retiro."})]})]})]}),e.jsx(K,{children:o&&e.jsx(B.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},className:"rounded-xl overflow-hidden",style:{background:"var(--surface)",border:"1px solid var(--border)"},children:e.jsxs("div",{className:"p-5 space-y-5",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Nuevo Broker"}),e.jsx("div",{className:"grid grid-cols-3 gap-2",children:Object.values(J).map(h=>e.jsxs("button",{onClick:()=>c({...l,brokerId:h.id}),className:"p-3 rounded-xl text-center transition-all",style:{background:l.brokerId===h.id?"rgba(212,175,55,0.08)":"var(--surface-2)",border:`1px solid ${l.brokerId===h.id?"var(--gold)":"var(--border)"}`},children:[e.jsx("span",{className:"text-2xl",children:h.logo}),e.jsx("p",{className:"text-sm font-bold mt-1",children:h.name}),e.jsx("p",{className:"text-[10px] text-[var(--text-dim)]",children:h.supportedMarkets.join(", ")})]},h.id))}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-[10px] text-[var(--text-dim)] mb-1 block font-semibold uppercase tracking-wider",children:"Etiqueta (opcional)"}),e.jsx("input",{value:l.label,onChange:h=>c({...l,label:h.target.value}),placeholder:"Mi cuenta Binance",className:"w-full"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-[10px] text-[var(--text-dim)] mb-1 block font-semibold uppercase tracking-wider",children:"API Key"}),e.jsx("input",{value:l.apiKey,onChange:h=>c({...l,apiKey:h.target.value}),placeholder:"Tu API Key",className:"w-full font-mono text-xs"})]}),e.jsxs("div",{className:"relative",children:[e.jsx("label",{className:"text-[10px] text-[var(--text-dim)] mb-1 block font-semibold uppercase tracking-wider",children:"API Secret"}),e.jsx("input",{type:p?"text":"password",value:l.apiSecret,onChange:h=>c({...l,apiSecret:h.target.value}),placeholder:"Tu API Secret",className:"w-full font-mono text-xs pr-10"}),e.jsx("button",{onClick:()=>m(!p),className:"absolute right-3 top-7 text-[var(--text-dim)]",children:p?e.jsx(qe,{size:14}):e.jsx(Ue,{size:14})})]}),((z=J[l.brokerId])==null?void 0:z.requiredFields.includes("passphrase"))&&e.jsxs("div",{children:[e.jsx("label",{className:"text-[10px] text-[var(--text-dim)] mb-1 block font-semibold uppercase tracking-wider",children:"Passphrase"}),e.jsx("input",{type:"password",value:l.passphrase,onChange:h=>c({...l,passphrase:h.target.value}),placeholder:"Passphrase",className:"w-full font-mono text-xs"})]})]}),y&&e.jsx("p",{className:"text-xs text-[var(--red)]",children:y}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:d,className:"flex-1 py-2.5 btn-gold rounded-xl text-sm",children:"Guardar Broker"}),e.jsx("button",{onClick:()=>n(!1),className:"px-4 py-2.5 rounded-xl text-sm text-[var(--text-dim)]",style:{background:"var(--surface-2)",border:"1px solid var(--border)"},children:"Cancelar"})]})]})})}),x.length===0?e.jsxs("div",{className:"rounded-xl p-12 text-center",style:{background:"var(--surface)",border:"1px solid var(--border)"},children:[e.jsx(we,{size:48,className:"text-[var(--text-dim)]/20 mx-auto mb-4"}),e.jsx("p",{className:"text-[var(--text-dim)]",children:"No hay brokers conectados"}),e.jsx("p",{className:"text-xs text-[var(--text-dim)] mt-1",children:"Agrega tu primer broker para empezar a operar"})]}):e.jsx("div",{className:"space-y-3",children:x.map(h=>{const C=J[h.brokerId],F=v[h.id]||[],L=A===h.id,Y=$(h.id);return e.jsxs(B.div,{layout:!0,className:"rounded-xl overflow-hidden",style:{background:"var(--surface)",border:"1px solid var(--border)"},children:[e.jsxs("div",{className:"p-4 flex items-center justify-between cursor-pointer",onClick:()=>I(L?null:h.id),children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"text-2xl",children:(C==null?void 0:C.logo)||"üìä"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-bold",children:h.label}),e.jsxs("p",{className:"text-xs text-[var(--text-dim)]",children:[C==null?void 0:C.name," ‚Ä¢ API: ",atob(h.apiKey).slice(0,8),"..."]})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[h.connected&&F.length>0&&e.jsxs("div",{className:"text-right mr-2",children:[e.jsx("p",{className:"text-xs text-[var(--text-dim)]",children:"Balance Total"}),e.jsxs("p",{className:"text-sm font-bold text-[var(--gold)]",children:["$",Y.toFixed(2)," USD"]})]}),h.connected?e.jsxs("span",{className:"flex items-center gap-1 text-xs text-[var(--green)] px-2 py-1 rounded-lg",style:{background:"rgba(0,220,130,0.1)"},children:[e.jsx(Ne,{size:12})," Conectado"]}):e.jsxs("span",{className:"flex items-center gap-1 text-xs text-[var(--text-dim)] px-2 py-1 rounded-lg",style:{background:"var(--surface-2)"},children:[e.jsx(ot,{size:12})," Desconectado"]}),e.jsx("button",{onClick:O=>{O.stopPropagation(),b(h)},disabled:u===h.id,className:"px-3 py-1.5 rounded-lg text-xs font-bold transition-colors disabled:opacity-50",style:{background:"rgba(212,175,55,0.1)",color:"var(--gold)",border:"1px solid rgba(212,175,55,0.2)"},children:u===h.id?"...":h.connected?"Reconectar":"Conectar"}),e.jsx("button",{onClick:O=>{O.stopPropagation(),E(h.id)},className:"p-1.5 text-[var(--text-dim)] hover:text-[var(--red)] transition-colors",children:e.jsx(ce,{size:14})})]})]}),e.jsx(K,{children:L&&h.connected&&e.jsx(B.div,{initial:{height:0},animate:{height:"auto"},exit:{height:0},className:"overflow-hidden",children:e.jsxs("div",{className:"px-4 pb-4 space-y-4",style:{borderTop:"1px solid var(--border)"},children:[e.jsxs("div",{className:"pt-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("h4",{className:"text-xs font-bold uppercase tracking-wider text-[var(--text-dim)] flex items-center gap-2",children:[e.jsx(ue,{size:14,className:"text-[var(--gold)]"})," Balances en Tiempo Real"]}),e.jsxs("button",{onClick:()=>S(h),className:`text-xs text-[var(--text-dim)] hover:text-[var(--gold)] transition-colors flex items-center gap-1 ${k[h.id]?"animate-spin":""}`,children:[e.jsx(ct,{size:12})," Refrescar"]})]}),F.length>0?e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-2",children:F.slice(0,12).map(O=>e.jsxs("div",{className:"rounded-lg p-2.5",style:{background:"var(--surface-2)"},children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-xs font-bold text-[var(--gold)]",children:O.asset}),parseFloat(O.locked||0)>0&&e.jsx("span",{className:"text-[9px] text-[var(--text-dim)]",children:"üîí"})]}),e.jsx("p",{className:"text-sm font-bold mt-0.5",children:parseFloat(O.free).toFixed(O.asset==="BTC"?8:2)}),parseFloat(O.locked||0)>0&&e.jsxs("p",{className:"text-[10px] text-[var(--text-dim)]",children:["Bloq: ",parseFloat(O.locked).toFixed(4)]})]},O.asset))}):e.jsx("p",{className:"text-xs text-[var(--text-dim)]",children:k[h.id]?"Cargando...":"Sin balances disponibles"})]}),e.jsx("div",{className:"flex gap-2",children:e.jsxs("button",{onClick:()=>T(h),className:"flex items-center gap-1.5 px-3 py-1.5 rounded-lg text-xs font-bold transition-colors",style:{background:"var(--surface-2)",border:"1px solid var(--border)",color:"var(--text-secondary)"},children:[e.jsx(dt,{size:12})," Ver √öltimos Trades"]})}),j[h.id]&&j[h.id].length>0&&e.jsxs("div",{children:[e.jsx("h4",{className:"text-xs font-bold uppercase tracking-wider text-[var(--text-dim)] mb-2",children:"√öltimos Trades"}),e.jsx("div",{className:"space-y-1",children:j[h.id].slice(0,5).map((O,de)=>e.jsxs("div",{className:"flex items-center justify-between py-1.5 px-2 rounded-lg text-xs",style:{background:"var(--surface-2)"},children:[e.jsx("span",{className:`font-bold ${O.isBuyer?"text-[var(--green)]":"text-[var(--red)]"}`,children:O.isBuyer?"COMPRA":"VENTA"}),e.jsx("span",{className:"text-[var(--text-secondary)]",children:parseFloat(O.qty).toFixed(6)}),e.jsxs("span",{className:"font-mono",children:["$",parseFloat(O.price).toFixed(2)]}),e.jsx("span",{className:"text-[var(--text-dim)]",children:new Date(O.time).toLocaleTimeString()})]},de))})]})]})})})]},h.id)})})]})}const Gt=`Eres Kairos AI, el asistente de trading m√°s avanzado del mundo.
Eres parte de Kairos Trade, la plataforma de trading automatizado de Kairos 777 Inc.

Tu especialidad:
- An√°lisis t√©cnico (EMA, RSI, MACD, Bollinger Bands, VWAP, estructura de mercado)
- Generaci√≥n de estrategias de trading autom√°ticas
- An√°lisis de sentimiento del mercado
- Gesti√≥n de riesgo
- Educaci√≥n en trading

Reglas:
- Responde en espa√±ol siempre
- S√© directo, conciso y profesional
- Cuando generes estrategias, usa formato JSON estructurado
- Nunca des consejos financieros personales ‚Äî eres una herramienta de an√°lisis
- Si te piden una estrategia, incluye SIEMPRE: entry, exit, stopLoss, takeProfit, timeframe
- Usa datos t√©cnicos reales cuando los tengas disponibles

Cuando generes una estrategia, responde con un bloque JSON as√≠:
\`\`\`strategy
{
  "name": "Nombre de la estrategia",
  "pair": "BTCUSDT",
  "timeframe": "1h",
  "entry": { "condition": "EMA 20 cruza por encima de EMA 50", "indicator": "ema_cross", "params": { "fast": 20, "slow": 50 } },
  "exit": { "condition": "RSI > 70", "indicator": "rsi", "params": { "period": 14, "threshold": 70 } },
  "stopLoss": "1.5%",
  "takeProfit": "3%",
  "riskReward": "1:2"
}
\`\`\``;class Qt{constructor(){this.apiKey=null,this.model="gpt-4o-mini",this.conversationHistory=[]}setApiKey(s){this.apiKey=s}async chat(s,t=null){var i;let a=s;if(t&&(a+=`

[Datos del mercado actual]
Par: ${t.symbol}
Precio: $${t.price}
Cambio 24h: ${t.changePercent}%
Volumen: ${t.volume}
M√°ximo 24h: $${t.high}
M√≠nimo 24h: $${t.low}`),this.conversationHistory.push({role:"user",content:a}),!this.apiKey)return this._localAnalysis(s,t);try{const o=await fetch("https://api.openai.com/v1/chat/completions",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${this.apiKey}`},body:JSON.stringify({model:this.model,messages:[{role:"system",content:Gt},...this.conversationHistory.slice(-20)],temperature:.7,max_tokens:1e3})});if(!o.ok){const c=await o.json();throw new Error(((i=c.error)==null?void 0:i.message)||"API error")}const n=await o.json(),l=n.choices[0].message.content;return this.conversationHistory.push({role:"assistant",content:l}),{text:l,strategy:this._extractStrategy(l),usage:n.usage}}catch(o){return console.error("AI error:",o),this._localAnalysis(s,t)}}_localAnalysis(s,t){var o,n,l,c;const a=s.toLowerCase();if(a.includes("estrategia")||a.includes("strategy")){const p=(t==null?void 0:t.symbol)||"BTCUSDT",m={name:`Kairos Auto Strategy ‚Äî ${p}`,pair:p,timeframe:"1h",entry:{condition:"EMA 20 cruza por encima de EMA 50 + RSI < 30",indicator:"ema_cross_rsi",params:{fastEma:20,slowEma:50,rsiPeriod:14,rsiOversold:30}},exit:{condition:"RSI > 70 o EMA 20 cruza por debajo de EMA 50",indicator:"rsi_overbought",params:{rsiOverbought:70}},stopLoss:"2%",takeProfit:"4%",riskReward:"1:2"},u=`üìä **Estrategia generada para ${p}**

**Entrada:** ${m.entry.condition}
**Salida:** ${m.exit.condition}
**Stop Loss:** ${m.stopLoss}
**Take Profit:** ${m.takeProfit}
**Risk/Reward:** ${m.riskReward}

Puedes activar esta estrategia desde el panel de bots.`;return this.conversationHistory.push({role:"assistant",content:u}),{text:u,strategy:m}}if(a.includes("analiz")||a.includes("mercado")||a.includes("market")||a.includes("c√≥mo ves")){let p="";if(t){const m=t.changePercent>0?"alcista":t.changePercent<-0?"bajista":"lateral",u=Math.abs(t.changePercent),r=u>3?"fuerte":u>1?"moderado":"d√©bil";p=`üìà **An√°lisis de ${t.symbol}**

**Precio:** $${(o=t.price)==null?void 0:o.toLocaleString()}
**Tendencia 24h:** ${m} (${t.changePercent>0?"+":""}${(n=t.changePercent)==null?void 0:n.toFixed(2)}%)
**Momentum:** ${r}
**Rango 24h:** $${(l=t.low)==null?void 0:l.toLocaleString()} ‚Äî $${(c=t.high)==null?void 0:c.toLocaleString()}
**Volumen:** $${(t.quoteVolume/1e6).toFixed(1)}M

`+(t.changePercent>2?`‚ö° El mercado muestra fuerza compradora. Considerar compras en retrocesos.
`:t.changePercent<-2?`‚ö†Ô∏è Presi√≥n vendedora activa. Esperar confirmaci√≥n de soporte.
`:`üìä Mercado en consolidaci√≥n. Esperar ruptura para tomar posici√≥n.
`)+`
üí° Recomendaci√≥n: ${m==="alcista"?"Buscar entradas en pullbacks al EMA 20.":m==="bajista"?"Precauci√≥n. Esperar divergencia RSI para posible reversal.":"Operar rango ‚Äî comprar soporte, vender resistencia."}`}else p="üìä Necesito datos del mercado para analizar. Selecciona un par de trading primero.";return this.conversationHistory.push({role:"assistant",content:p}),{text:p,strategy:null}}const i=`ü§ñ Soy **Kairos AI**, tu asistente de trading.

Puedo ayudarte con:
‚Ä¢ **"Analiza BTC"** ‚Äî An√°lisis t√©cnico del mercado
‚Ä¢ **"Dame una estrategia para ETHUSDT"** ‚Äî Generar estrategia autom√°tica
‚Ä¢ **"¬øC√≥mo ves el mercado?"** ‚Äî Visi√≥n general
‚Ä¢ **"Configura un bot"** ‚Äî Ayuda con automatizaci√≥n

¬øEn qu√© te puedo ayudar?`;return this.conversationHistory.push({role:"assistant",content:i}),{text:i,strategy:null}}_extractStrategy(s){const t=s.match(/```strategy\n([\s\S]*?)```/);if(t)try{return JSON.parse(t[1])}catch{return null}return null}clearHistory(){this.conversationHistory=[]}}const He=new Qt;function Oe(){const{aiMessages:x,addAiMessage:s,aiLoading:t,setAiLoading:a,clearAiMessages:i,currentPrice:o,selectedPair:n,priceChange24h:l}=_(),[c,p]=w.useState(""),m=w.useRef(null);w.useEffect(()=>{var f;(f=m.current)==null||f.scrollIntoView({behavior:"smooth"})},[x]);const u=async()=>{if(!c.trim()||t)return;const f={role:"user",content:c.trim(),time:new Date().toLocaleTimeString()};s(f),p(""),a(!0);try{const v=o?{symbol:n,price:o,changePercent:l,high:o*1.02,low:o*.98,volume:0,quoteVolume:0}:null,g=await He.chat(c.trim(),v);s({role:"assistant",content:g.text,strategy:g.strategy,time:new Date().toLocaleTimeString()})}catch(v){s({role:"assistant",content:`‚ùå Error: ${v.message}`,time:new Date().toLocaleTimeString()})}a(!1)},r=[{label:"Analiza el mercado",icon:ee,prompt:`Analiza ${n} ahora mismo`},{label:"Dame una estrategia",icon:Q,prompt:`Dame una estrategia de trading para ${n}`},{label:"¬øC√≥mo ves BTC?",icon:ge,prompt:"¬øC√≥mo ves Bitcoin hoy?"}],y=(f,v)=>{const g=f.role==="user";return e.jsx(B.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:`flex ${g?"justify-end":"justify-start"}`,children:e.jsxs("div",{className:`max-w-[85%] rounded-2xl p-3 ${g?"bg-[var(--gold)] text-white rounded-br-md":"bg-[var(--dark-3)] text-[var(--text)] rounded-bl-md"}`,children:[!g&&e.jsxs("div",{className:"flex items-center gap-1 mb-1",children:[e.jsx(se,{size:12,className:"text-[var(--gold)]"}),e.jsx("span",{className:"text-[10px] text-[var(--gold)] font-bold",children:"Kairos AI"})]}),e.jsx("div",{className:"text-sm whitespace-pre-wrap leading-relaxed",children:f.content.split(`
`).map((k,P)=>k.startsWith("**")&&k.endsWith("**")?e.jsx("p",{className:"font-bold my-0.5",children:k.replace(/\*\*/g,"")},P):k.startsWith("‚Ä¢")||k.startsWith("-")?e.jsx("p",{className:"ml-2",children:k},P):e.jsx("p",{children:k},P))}),f.strategy&&e.jsxs("div",{className:"mt-2 p-2 bg-[var(--dark-4)] rounded-xl border border-[var(--gold)]/20",children:[e.jsxs("div",{className:"flex items-center gap-1 mb-1",children:[e.jsx(Q,{size:12,className:"text-[var(--gold)]"}),e.jsx("span",{className:"text-xs font-bold text-[var(--gold)]",children:"Estrategia Lista"})]}),e.jsx("p",{className:"text-xs",children:f.strategy.name||"Auto Strategy"}),e.jsx("button",{onClick:()=>{_.getState().addStrategy(f.strategy),s({role:"assistant",content:"‚úÖ Estrategia guardada. Puedes activarla desde el panel de Bots.",time:new Date().toLocaleTimeString()})},className:"mt-1 px-3 py-1 bg-[var(--gold)] text-white text-xs font-bold rounded-lg",children:"Activar Estrategia"})]}),e.jsx("p",{className:`text-[10px] mt-1 ${g?"text-white/60":"text-[var(--text-dim)]"}`,children:f.time})]})},v)};return e.jsxs("div",{className:"flex-1 flex flex-col h-full overflow-hidden",children:[e.jsx("div",{className:"p-4 border-b border-[var(--border)] bg-[var(--dark-2)] shrink-0",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-8 h-8 rounded-lg bg-[var(--gold)]/20 flex items-center justify-center",children:e.jsx(se,{size:18,className:"text-[var(--gold)]"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-sm font-bold",children:"Kairos AI"}),e.jsx("p",{className:"text-[10px] text-[var(--text-dim)]",children:"Asistente de trading inteligente"})]})]}),e.jsx("button",{onClick:i,className:"p-1.5 text-[var(--text-dim)] hover:text-[var(--red)] transition-colors",children:e.jsx(ce,{size:14})})]})}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-3",children:[x.length===0&&e.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-center",children:[e.jsx(se,{size:48,className:"text-[var(--gold)] mb-4"}),e.jsx("h3",{className:"text-lg font-bold mb-1",children:"Kairos AI"}),e.jsx("p",{className:"text-sm text-[var(--text-dim)] mb-6 max-w-xs",children:"Tu asistente de trading con inteligencia artificial. Preg√∫ntame cualquier cosa sobre el mercado."}),e.jsx("div",{className:"space-y-2 w-full max-w-xs",children:r.map((f,v)=>{const g=f.icon;return e.jsxs("button",{onClick:()=>{p(f.prompt)},className:"w-full flex items-center gap-2 p-3 bg-[var(--dark-3)] border border-[var(--border)] rounded-xl text-sm hover:border-[var(--gold)]/30 transition-colors text-left",children:[e.jsx(g,{size:16,className:"text-[var(--gold)] shrink-0"}),f.label]},v)})})]}),x.map(y),t&&e.jsx("div",{className:"flex justify-start",children:e.jsxs("div",{className:"bg-[var(--dark-3)] rounded-2xl rounded-bl-md p-3",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(se,{size:12,className:"text-[var(--gold)]"}),e.jsx("span",{className:"text-[10px] text-[var(--gold)] font-bold",children:"Kairos AI"})]}),e.jsxs("div",{className:"flex gap-1 mt-1",children:[e.jsx("div",{className:"w-2 h-2 rounded-full bg-[var(--gold)] animate-bounce",style:{animationDelay:"0ms"}}),e.jsx("div",{className:"w-2 h-2 rounded-full bg-[var(--gold)] animate-bounce",style:{animationDelay:"150ms"}}),e.jsx("div",{className:"w-2 h-2 rounded-full bg-[var(--gold)] animate-bounce",style:{animationDelay:"300ms"}})]})]})}),e.jsx("div",{ref:m})]}),e.jsx("div",{className:"p-3 border-t border-[var(--border)] bg-[var(--dark-2)] shrink-0",children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{value:c,onChange:f=>p(f.target.value),onKeyDown:f=>f.key==="Enter"&&u(),placeholder:"Pregunta sobre el mercado, pide estrategias...",className:"flex-1 text-sm"}),e.jsx("button",{onClick:u,disabled:!c.trim()||t,className:"px-4 py-2 bg-[var(--gold)] text-white rounded-xl hover:bg-[var(--gold-light)] transition-colors disabled:opacity-50",children:e.jsx(xt,{size:16})})]})})]})}const Yt=[{name:"EMA Cross Classic",description:"Cruces de EMA r√°pida/lenta ‚Äî Tendencia",entry:{condition:"EMA 20 cruza por encima de EMA 50",indicator:"ema_cross",params:{fast:20,slow:50}},exit:{condition:"EMA 20 cruza por debajo de EMA 50",indicator:"ema_cross",params:{fast:20,slow:50}},stopLoss:"2",takeProfit:"4"},{name:"RSI Reversal",description:"Compra en sobreventa, vende en sobrecompra",entry:{condition:"RSI < 30 (sobreventa)",indicator:"rsi",params:{period:14,oversold:30}},exit:{condition:"RSI > 70 (sobrecompra)",indicator:"rsi",params:{period:14,overbought:70}},stopLoss:"1.5",takeProfit:"3"},{name:"MACD Momentum",description:"Cruce de l√≠nea MACD y se√±al",entry:{condition:"MACD cruza por encima de se√±al",indicator:"macd_cross",params:{fast:12,slow:26,signal:9}},exit:{condition:"MACD cruza por debajo de se√±al",indicator:"macd_cross",params:{}},stopLoss:"2",takeProfit:"4"},{name:"Bollinger Bounce",description:"Compra en banda inferior, vende en superior",entry:{condition:"Precio toca Bollinger Band inferior",indicator:"bb_bounce",params:{period:20,stdDev:2}},exit:{condition:"Precio toca Bollinger Band superior",indicator:"bb_bounce",params:{}},stopLoss:"1",takeProfit:"2"},{name:"EMA + RSI Combo",description:"M√°s preciso: cruces de EMA confirmados con RSI",entry:{condition:"EMA 20 > EMA 50 + RSI < 30",indicator:"ema_cross_rsi",params:{fastEma:20,slowEma:50,rsiPeriod:14,rsiOversold:30}},exit:{condition:"RSI > 70",indicator:"rsi",params:{rsiOverbought:70}},stopLoss:"2",takeProfit:"4"}];function Jt(){const{strategies:x,addStrategy:s,removeStrategy:t,setPage:a}=_(),[i,o]=w.useState(!1),[n,l]=w.useState({name:"",pair:"BTCUSDT",timeframe:"1h",entryIndicator:"ema_cross",entryCondition:"",exitIndicator:"rsi",exitCondition:"",stopLoss:"2",takeProfit:"4"}),c=m=>{s({...m,pair:"BTCUSDT",timeframe:"1h"})},p=()=>{n.name&&(s({name:n.name,pair:n.pair,timeframe:n.timeframe,entry:{condition:n.entryCondition||`${n.entryIndicator} signal`,indicator:n.entryIndicator,params:{}},exit:{condition:n.exitCondition||`${n.exitIndicator} signal`,indicator:n.exitIndicator,params:{}},stopLoss:n.stopLoss,takeProfit:n.takeProfit}),l({name:"",pair:"BTCUSDT",timeframe:"1h",entryIndicator:"ema_cross",entryCondition:"",exitIndicator:"rsi",exitCondition:"",stopLoss:"2",takeProfit:"4"}),o(!1))};return e.jsxs("div",{className:"flex-1 overflow-y-auto p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl font-bold",children:"Estrategias de Trading"}),e.jsx("p",{className:"text-sm text-[var(--text-dim)]",children:"Crea, gestiona y aplica estrategias a tus bots"})]}),e.jsxs("button",{onClick:()=>o(!i),className:"flex items-center gap-2 px-4 py-2 bg-[var(--gold)] text-white font-bold rounded-xl hover:bg-[var(--gold-light)] transition-colors text-sm",children:[e.jsx(ve,{size:16})," Crear Estrategia"]})]}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-sm font-bold mb-3",children:"Plantillas Predefinidas"}),e.jsx("div",{className:"grid grid-cols-3 gap-3",children:Yt.map((m,u)=>e.jsxs(B.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:u*.05},className:"bg-[var(--dark-2)] border border-[var(--border)] rounded-xl p-4 hover:border-[var(--gold)]/30 transition-colors",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(Q,{size:16,className:"text-[var(--gold)]"}),e.jsx("h3",{className:"text-sm font-bold",children:m.name})]}),e.jsx("p",{className:"text-xs text-[var(--text-dim)] mb-3",children:m.description}),e.jsxs("div",{className:"space-y-1 text-xs mb-3",children:[e.jsxs("p",{children:[e.jsx("span",{className:"text-[var(--green)]",children:"‚ñ≤"})," ",m.entry.condition]}),e.jsxs("p",{children:[e.jsx("span",{className:"text-[var(--red)]",children:"‚ñº"})," ",m.exit.condition]}),e.jsxs("p",{className:"text-[var(--text-dim)]",children:["SL: ",m.stopLoss,"% | TP: ",m.takeProfit,"%"]})]}),e.jsx("button",{onClick:()=>c(m),className:"w-full py-1.5 bg-[var(--gold)]/20 text-[var(--gold)] rounded-lg text-xs font-bold hover:bg-[var(--gold)]/30 transition-colors",children:"Usar Plantilla"})]},m.name))})]}),e.jsx(K,{children:i&&e.jsx(B.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},className:"bg-[var(--dark-2)] border border-[var(--border)] rounded-xl overflow-hidden",children:e.jsxs("div",{className:"p-4 space-y-4",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Crear Estrategia Personalizada"}),e.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-[var(--text-dim)] mb-1 block",children:"Nombre"}),e.jsx("input",{value:n.name,onChange:m=>l({...n,name:m.target.value}),placeholder:"Mi estrategia",className:"w-full"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-[var(--text-dim)] mb-1 block",children:"Par"}),e.jsx("select",{value:n.pair,onChange:m=>l({...n,pair:m.target.value}),className:"w-full",children:Se.map(m=>e.jsx("option",{children:m},m))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-[var(--text-dim)] mb-1 block",children:"Timeframe"}),e.jsx("select",{value:n.timeframe,onChange:m=>l({...n,timeframe:m.target.value}),className:"w-full",children:ke.map(m=>e.jsx("option",{value:m.value,children:m.label},m.value))})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"bg-[var(--dark-3)] rounded-xl p-3",children:[e.jsx("p",{className:"text-xs font-bold text-[var(--green)] mb-2",children:"‚ñ≤ Condici√≥n de Entrada"}),e.jsxs("select",{value:n.entryIndicator,onChange:m=>l({...n,entryIndicator:m.target.value}),className:"w-full mb-2 text-sm",children:[e.jsx("option",{value:"ema_cross",children:"EMA Cross"}),e.jsx("option",{value:"rsi",children:"RSI"}),e.jsx("option",{value:"macd_cross",children:"MACD Cross"}),e.jsx("option",{value:"ema_cross_rsi",children:"EMA + RSI Combo"}),e.jsx("option",{value:"bb_bounce",children:"Bollinger Bounce"})]}),e.jsx("input",{value:n.entryCondition,onChange:m=>l({...n,entryCondition:m.target.value}),placeholder:"Describe la condici√≥n...",className:"w-full text-xs"})]}),e.jsxs("div",{className:"bg-[var(--dark-3)] rounded-xl p-3",children:[e.jsx("p",{className:"text-xs font-bold text-[var(--red)] mb-2",children:"‚ñº Condici√≥n de Salida"}),e.jsxs("select",{value:n.exitIndicator,onChange:m=>l({...n,exitIndicator:m.target.value}),className:"w-full mb-2 text-sm",children:[e.jsx("option",{value:"rsi",children:"RSI"}),e.jsx("option",{value:"ema_cross",children:"EMA Cross"}),e.jsx("option",{value:"macd_cross",children:"MACD Cross"})]}),e.jsx("input",{value:n.exitCondition,onChange:m=>l({...n,exitCondition:m.target.value}),placeholder:"Describe la condici√≥n...",className:"w-full text-xs"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-[var(--text-dim)] mb-1 block",children:"Stop Loss (%)"}),e.jsx("input",{type:"number",value:n.stopLoss,onChange:m=>l({...n,stopLoss:m.target.value}),className:"w-full"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-[var(--text-dim)] mb-1 block",children:"Take Profit (%)"}),e.jsx("input",{type:"number",value:n.takeProfit,onChange:m=>l({...n,takeProfit:m.target.value}),className:"w-full"})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:p,className:"flex-1 py-2.5 bg-[var(--gold)] text-white font-bold rounded-xl text-sm",children:"Crear Estrategia"}),e.jsx("button",{onClick:()=>o(!1),className:"px-4 py-2.5 bg-[var(--dark-3)] text-[var(--text-dim)] rounded-xl text-sm",children:"Cancelar"})]})]})})}),x.length>0&&e.jsxs("div",{children:[e.jsxs("h2",{className:"text-sm font-bold mb-3",children:["Mis Estrategias (",x.length,")"]}),e.jsx("div",{className:"space-y-2",children:x.map(m=>{var u;return e.jsxs("div",{className:"bg-[var(--dark-2)] border border-[var(--border)] rounded-xl p-4 flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-bold",children:m.name}),e.jsxs("p",{className:"text-xs text-[var(--text-dim)]",children:[(u=m.entry)==null?void 0:u.condition," | SL: ",m.stopLoss,"% | TP: ",m.takeProfit,"%"]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:()=>a("bots"),className:"px-3 py-1.5 bg-[var(--green)]/20 text-[var(--green)] rounded-lg text-xs font-bold",children:[e.jsx(oe,{size:12,className:"inline mr-1"})," Usar en Bot"]}),e.jsx("button",{onClick:()=>t(m.id),className:"p-1.5 text-[var(--text-dim)] hover:text-[var(--red)]",children:e.jsx(ce,{size:14})})]})]},m.id)})})]})]})}function Xt(){const{tradeHistory:x,positions:s}=_(),[t,a]=w.useState("open"),i=x.reduce((l,c)=>l+(c.pnl||0),0),o=x.filter(l=>(l.pnl||0)>0).length,n=x.length>0?o/x.length*100:0;return e.jsxs("div",{className:"flex-1 overflow-y-auto p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl font-bold",children:"Historial de Trading"}),e.jsxs("p",{className:"text-sm text-[var(--text-dim)]",children:[x.length," trades cerrados ‚Ä¢ ",s.length," posiciones abiertas"]})]}),e.jsxs("button",{onClick:()=>{const l=[["Par","Lado","Entrada","Salida","Cantidad","P&L","Fecha Apertura","Fecha Cierre"]];x.forEach(r=>{var y,f;l.push([r.symbol,r.side,(y=r.entryPrice)==null?void 0:y.toFixed(2),((f=r.exitPrice)==null?void 0:f.toFixed(2))||"",r.quantity,(r.pnl||0).toFixed(2),r.openedAt||"",r.closedAt||""])});const c=l.map(r=>r.join(",")).join(`
`),p=new Blob([c],{type:"text/csv"}),m=URL.createObjectURL(p),u=document.createElement("a");u.href=m,u.download=`kairos-trades-${new Date().toISOString().split("T")[0]}.csv`,u.click(),URL.revokeObjectURL(m)},className:"flex items-center gap-2 px-3 py-1.5 bg-[var(--dark-3)] text-[var(--text-dim)] rounded-lg text-xs hover:text-[var(--gold)] hover:border-[var(--gold)]/30 transition-all border border-[var(--border)]",children:[e.jsx(mt,{size:14})," Exportar CSV"]})]}),e.jsxs("div",{className:"grid grid-cols-4 gap-3",children:[e.jsxs("div",{className:"bg-[var(--dark-2)] border border-[var(--border)] rounded-xl p-3 text-center",children:[e.jsx("p",{className:"text-xs text-[var(--text-dim)]",children:"Total Trades"}),e.jsx("p",{className:"text-lg font-bold",children:x.length})]}),e.jsxs("div",{className:"bg-[var(--dark-2)] border border-[var(--border)] rounded-xl p-3 text-center",children:[e.jsx("p",{className:"text-xs text-[var(--text-dim)]",children:"P&L Total"}),e.jsxs("p",{className:`text-lg font-bold ${i>=0?"text-[var(--green)]":"text-[var(--red)]"}`,children:[i>=0?"+":"","$",i.toFixed(2)]})]}),e.jsxs("div",{className:"bg-[var(--dark-2)] border border-[var(--border)] rounded-xl p-3 text-center",children:[e.jsx("p",{className:"text-xs text-[var(--text-dim)]",children:"Win Rate"}),e.jsxs("p",{className:"text-lg font-bold text-[var(--gold)]",children:[n.toFixed(1),"%"]})]}),e.jsxs("div",{className:"bg-[var(--dark-2)] border border-[var(--border)] rounded-xl p-3 text-center",children:[e.jsx("p",{className:"text-xs text-[var(--text-dim)]",children:"Posiciones Abiertas"}),e.jsx("p",{className:"text-lg font-bold text-[var(--blue)]",children:s.length})]})]}),e.jsxs("div",{className:"flex gap-1 bg-[var(--dark-3)] rounded-lg p-1 w-fit",children:[e.jsxs("button",{onClick:()=>a("open"),className:`px-4 py-1.5 text-sm rounded-md ${t==="open"?"bg-[var(--gold)] text-[#08090C] font-bold":"text-[var(--text-dim)]"}`,children:["Abiertas (",s.length,")"]}),e.jsxs("button",{onClick:()=>a("closed"),className:`px-4 py-1.5 text-sm rounded-md ${t==="closed"?"bg-[var(--gold)] text-[#08090C] font-bold":"text-[var(--text-dim)]"}`,children:["Cerradas (",x.length,")"]})]}),e.jsx("div",{className:"bg-[var(--dark-2)] border border-[var(--border)] rounded-xl overflow-hidden",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-[var(--border)] text-[var(--text-dim)] text-xs",children:[e.jsx("th",{className:"text-left p-3",children:"Par"}),e.jsx("th",{className:"text-left p-3",children:"Lado"}),e.jsx("th",{className:"text-right p-3",children:"Entrada"}),e.jsx("th",{className:"text-right p-3",children:"Cantidad"}),e.jsx("th",{className:"text-right p-3",children:"P&L"}),e.jsx("th",{className:"text-right p-3",children:"Fecha"})]})}),e.jsx("tbody",{children:(t==="open"?s:x).length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:6,className:"p-8 text-center text-[var(--text-dim)]",children:t==="open"?"Sin posiciones abiertas":"Sin trades cerrados"})}):(t==="open"?s:x).map((l,c)=>{var p,m;return e.jsxs("tr",{className:"border-b border-[var(--border)] hover:bg-[var(--dark-3)] transition-colors",children:[e.jsx("td",{className:"p-3 font-bold",children:l.symbol}),e.jsx("td",{className:"p-3",children:e.jsx("span",{className:`px-2 py-0.5 rounded-full text-xs font-bold
                    ${l.side==="buy"?"bg-[var(--green)]/20 text-[var(--green)]":"bg-[var(--red)]/20 text-[var(--red)]"}`,children:(p=l.side)==null?void 0:p.toUpperCase()})}),e.jsxs("td",{className:"p-3 text-right font-mono",children:["$",(m=l.entryPrice)==null?void 0:m.toFixed(2)]}),e.jsx("td",{className:"p-3 text-right font-mono",children:l.quantity}),e.jsxs("td",{className:`p-3 text-right font-mono font-bold ${(l.pnl||0)>=0?"text-[var(--green)]":"text-[var(--red)]"}`,children:[(l.pnl||0)>=0?"+":"","$",(l.pnl||0).toFixed(2)]}),e.jsx("td",{className:"p-3 text-right text-xs text-[var(--text-dim)]",children:new Date(l.openedAt||l.closedAt).toLocaleDateString()})]},l.id||c)})})]})})]})}const Me="kairos_trade_simulator";class Zt{constructor(){this.state=this._load()}_load(){try{const s=JSON.parse(localStorage.getItem(Me));if(s)return s}catch{}return this._defaultState()}_defaultState(){return{balance:1e4,initialBalance:1e4,positions:[],closedTrades:[],orders:[],equity:1e4,stats:{totalTrades:0,wins:0,losses:0,totalPnl:0,bestTrade:0,worstTrade:0,avgWin:0,avgLoss:0,maxDrawdown:0,sharpeRatio:0},equityHistory:[{time:Date.now(),value:1e4}],createdAt:new Date().toISOString()}}_save(){localStorage.setItem(Me,JSON.stringify(this.state))}reset(s=1e4){return this.state=this._defaultState(),this.state.balance=s,this.state.initialBalance=s,this.state.equity=s,this.state.equityHistory=[{time:Date.now(),value:s}],this._save(),this.state}async openPosition(s,t,a,i={}){const o=await q.getPrice(s),n=o*a;if(n>this.state.balance)throw new Error(`Fondos insuficientes. Necesitas $${n.toFixed(2)}, tienes $${this.state.balance.toFixed(2)}`);const l={id:Date.now().toString(36)+Math.random().toString(36).slice(2,6),symbol:s,side:t,quantity:a,entryPrice:o,currentPrice:o,cost:n,pnl:0,pnlPercent:0,stopLoss:i.stopLoss||null,takeProfit:i.takeProfit||null,leverage:i.leverage||1,openedAt:new Date().toISOString()};return this.state.balance-=n,this.state.positions.push(l),this._save(),{success:!0,position:l,message:`${t.toUpperCase()} ${a} ${s} @ $${o.toFixed(2)}`}}async closePosition(s){const t=this.state.positions.findIndex(c=>c.id===s);if(t===-1)throw new Error("Posici√≥n no encontrada");const a=this.state.positions[t],i=await q.getPrice(a.symbol),o=a.side==="buy"?(i-a.entryPrice)*a.quantity*a.leverage:(a.entryPrice-i)*a.quantity*a.leverage,n=o/a.cost*100,l={...a,exitPrice:i,pnl:o,pnlPercent:n,closedAt:new Date().toISOString(),duration:Date.now()-new Date(a.openedAt).getTime()};return this.state.balance+=a.cost+o,this.state.positions.splice(t,1),this.state.closedTrades.push(l),this._updateStats(o),this._save(),{success:!0,trade:l,message:`Cerrada: ${o>=0?"+":""}$${o.toFixed(2)} (${n.toFixed(1)}%)`}}async placeLimitOrder(s,t,a,i,o={}){const n=await q.getPrice(s),l={id:Date.now().toString(36),symbol:s,side:t,quantity:a,targetPrice:i,currentPrice:n,type:"limit",stopLoss:o.stopLoss||null,takeProfit:o.takeProfit||null,status:"pending",createdAt:new Date().toISOString()};return this.state.orders.push(l),this._save(),{success:!0,order:l}}cancelOrder(s){return this.state.orders=this.state.orders.filter(t=>t.id!==s),this._save(),{success:!0}}async updatePositions(){let s=this.state.balance;for(const t of this.state.positions)try{const a=await q.getPrice(t.symbol);if(t.currentPrice=a,t.pnl=t.side==="buy"?(a-t.entryPrice)*t.quantity*(t.leverage||1):(t.entryPrice-a)*t.quantity*(t.leverage||1),t.pnlPercent=t.pnl/t.cost*100,s+=t.cost+t.pnl,t.stopLoss&&(t.side==="buy"?a<=t.stopLoss:a>=t.stopLoss)){await this.closePosition(t.id);continue}if(t.takeProfit&&(t.side==="buy"?a>=t.takeProfit:a<=t.takeProfit)){await this.closePosition(t.id);continue}}catch{}for(const t of this.state.orders.filter(a=>a.status==="pending"))try{const a=await q.getPrice(t.symbol);(t.side==="buy"?a<=t.targetPrice:a>=t.targetPrice)&&(t.status="filled",await this.openPosition(t.symbol,t.side,t.quantity,{stopLoss:t.stopLoss,takeProfit:t.takeProfit}))}catch{}return this.state.orders=this.state.orders.filter(t=>t.status==="pending"),this.state.equity=s,this.state.equityHistory.push({time:Date.now(),value:s}),this.state.equityHistory.length>500&&(this.state.equityHistory=this.state.equityHistory.slice(-500)),this._save(),this.state}_updateStats(s){const t=this.state.stats;t.totalTrades++,t.totalPnl+=s,s>0?(t.wins++,t.bestTrade=Math.max(t.bestTrade,s)):(t.losses++,t.worstTrade=Math.min(t.worstTrade,s)),t.avgWin=t.wins>0?t.totalPnl/t.wins:0,t.avgLoss=t.losses>0?(t.totalPnl-t.avgWin*t.wins)/t.losses:0;const a=Math.max(...this.state.equityHistory.map(n=>n.value));t.maxDrawdown=(a-this.state.equity)/a*100,t.winRate=t.totalTrades>0?t.wins/t.totalTrades*100:0;const i=this.state.closedTrades.filter(n=>n.pnl>0).reduce((n,l)=>n+l.pnl,0),o=Math.abs(this.state.closedTrades.filter(n=>n.pnl<0).reduce((n,l)=>n+l.pnl,0));t.profitFactor=o>0?i/o:i>0?1/0:0}getState(){return this.state}getPerformance(){const s=this.state,t=(s.equity-s.initialBalance)/s.initialBalance*100;return{balance:s.balance,equity:s.equity,initialBalance:s.initialBalance,returnPct:t,openPositions:s.positions.length,pendingOrders:s.orders.length,...s.stats}}}const H=new Zt;function es({data:x,height:s=140}){const t=w.useRef(null);return w.useEffect(()=>{const a=t.current;if(!a||!x||x.length<2)return;const i=a.getContext("2d"),o=window.devicePixelRatio||1,n=a.clientWidth,l=a.clientHeight;a.width=n*o,a.height=l*o,i.scale(o,o),i.clearRect(0,0,n,l);const c=x.map(S=>S.value),p=Math.min(...c)*.998,m=Math.max(...c)*1.002,u=m-p||1,r={top:8,bottom:20,left:0,right:0},y=n-r.left-r.right,f=l-r.top-r.bottom,v=S=>r.left+S/(x.length-1)*y,g=S=>r.top+f-(S-p)/u*f,k=c[0],P=c[c.length-1],A=P>=k,I=A?"#00DC82":"#FF3B30";i.beginPath(),i.moveTo(v(0),g(c[0]));for(let S=1;S<c.length;S++)i.lineTo(v(S),g(c[S]));i.lineTo(v(c.length-1),l-r.bottom),i.lineTo(v(0),l-r.bottom),i.closePath();const j=i.createLinearGradient(0,0,0,l);j.addColorStop(0,A?"rgba(0,220,130,0.2)":"rgba(255,59,48,0.2)"),j.addColorStop(1,"rgba(0,0,0,0)"),i.fillStyle=j,i.fill(),i.beginPath(),i.moveTo(v(0),g(c[0]));for(let S=1;S<c.length;S++)i.lineTo(v(S),g(c[S]));i.strokeStyle=I,i.lineWidth=2,i.lineJoin="round",i.stroke(),i.beginPath(),i.setLineDash([3,3]);const N=g(k);i.moveTo(0,N),i.lineTo(n,N),i.strokeStyle="#D4AF3740",i.lineWidth=1,i.stroke(),i.setLineDash([]),i.fillStyle="#666",i.font="9px Inter, sans-serif",i.textAlign="left",i.fillText(`$${p.toFixed(0)}`,4,l-r.bottom+12),i.textAlign="right",i.fillText(`$${m.toFixed(0)}`,n-4,l-r.bottom+12);const d=v(c.length-1),b=g(P);i.beginPath(),i.arc(d,b,3,0,Math.PI*2),i.fillStyle=I,i.fill(),i.beginPath(),i.arc(d,b,6,0,Math.PI*2),i.strokeStyle=I,i.lineWidth=1,i.globalAlpha=.4,i.stroke(),i.globalAlpha=1},[x,s]),!x||x.length<2?e.jsx("div",{className:"flex items-center justify-center text-xs text-[var(--text-dim)]",style:{height:s},children:"Ejecuta trades para ver la curva de equity"}):e.jsx("canvas",{ref:t,style:{width:"100%",height:s}})}function ts(){var P,A,I,j;const{selectedPair:x,currentPrice:s,setPage:t}=_(),[a,i]=w.useState(H.getState()),[o,n]=w.useState(H.getPerformance()),[l,c]=w.useState({quantity:"",stopLoss:"",takeProfit:"",side:"buy"}),[p,m]=w.useState(!1),[u,r]=w.useState(null);w.useEffect(()=>{const N=setInterval(async()=>{const d=await H.updatePositions();i({...d}),n(H.getPerformance())},1e4);return()=>clearInterval(N)},[]);const y=w.useCallback(async()=>{const N=await H.updatePositions();i({...N}),n(H.getPerformance())},[]),f=async()=>{if(!(!l.quantity||!s)){m(!0);try{const N=await H.openPosition(x,l.side,parseFloat(l.quantity),{stopLoss:l.stopLoss?parseFloat(l.stopLoss):null,takeProfit:l.takeProfit?parseFloat(l.takeProfit):null});r({type:"success",text:N.message}),c({...l,quantity:"",stopLoss:"",takeProfit:""}),await y()}catch(N){r({type:"error",text:N.message})}m(!1),setTimeout(()=>r(null),3e3)}},v=async N=>{try{const d=await H.closePosition(N);r({type:d.trade.pnl>=0?"success":"error",text:d.message}),await y()}catch(d){r({type:"error",text:d.message})}setTimeout(()=>r(null),3e3)},g=()=>{H.reset(1e4),i(H.getState()),n(H.getPerformance()),r({type:"success",text:"Simulador reiniciado con $10,000"}),setTimeout(()=>r(null),2e3)},k=o.returnPct||0;return e.jsxs("div",{className:"flex-1 overflow-y-auto p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-xl font-bold flex items-center gap-2",children:[e.jsx(oe,{size:20,className:"text-[var(--gold)]"}),"Paper Trading Simulator"]}),e.jsx("p",{className:"text-sm text-[var(--text-dim)]",children:"Practica con datos reales, sin arriesgar dinero real"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:y,className:"px-3 py-1.5 bg-[var(--dark-3)] text-[var(--text-dim)] rounded-lg text-xs hover:text-[var(--text)] transition-colors",children:"Actualizar"}),e.jsxs("button",{onClick:g,className:"flex items-center gap-1 px-3 py-1.5 bg-[var(--red)]/20 text-[var(--red)] rounded-lg text-xs font-bold hover:bg-[var(--red)]/30 transition-colors",children:[e.jsx(pt,{size:12})," Reiniciar"]})]})]}),e.jsx(K,{children:u&&e.jsx(B.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},className:`p-3 rounded-xl text-sm font-bold text-center ${u.type==="success"?"bg-[var(--green)]/20 text-[var(--green)]":"bg-[var(--red)]/20 text-[var(--red)]"}`,children:u.text})}),e.jsx("div",{className:"grid grid-cols-5 gap-3",children:[{label:"Balance",value:`$${(P=o.balance)==null?void 0:P.toFixed(2)}`,icon:ne,color:"var(--gold)"},{label:"Equity",value:`$${(A=o.equity)==null?void 0:A.toFixed(2)}`,icon:ee,color:"var(--blue)"},{label:"Retorno",value:`${k>=0?"+":""}${k.toFixed(2)}%`,icon:k>=0?X:ie,color:k>=0?"var(--green)":"var(--red)"},{label:"Win Rate",value:`${(o.winRate||0).toFixed(0)}%`,icon:ut,color:"var(--gold)"},{label:"Trades",value:o.totalTrades||0,icon:je,color:"var(--text)"}].map((N,d)=>{const b=N.icon;return e.jsxs(B.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:d*.05},className:"bg-[var(--dark-2)] border border-[var(--border)] rounded-xl p-3 text-center",children:[e.jsx(b,{size:16,style:{color:N.color},className:"mx-auto mb-1"}),e.jsx("p",{className:"text-lg font-bold font-mono",style:{color:N.color},children:N.value}),e.jsx("p",{className:"text-[10px] text-[var(--text-dim)]",children:N.label})]},N.label)})}),e.jsx("div",{className:"grid grid-cols-4 gap-3",children:[{label:"P&L Total",value:`${o.totalPnl>=0?"+":""}$${(o.totalPnl||0).toFixed(2)}`,color:(o.totalPnl||0)>=0?"var(--green)":"var(--red)"},{label:"Mejor Trade",value:`+$${(o.bestTrade||0).toFixed(2)}`,color:"var(--green)"},{label:"Peor Trade",value:`$${(o.worstTrade||0).toFixed(2)}`,color:"var(--red)"},{label:"Max Drawdown",value:`${(o.maxDrawdown||0).toFixed(1)}%`,color:"var(--red)"}].map(N=>e.jsxs("div",{className:"bg-[var(--dark-2)] border border-[var(--border)] rounded-xl p-3",children:[e.jsx("p",{className:"text-xs text-[var(--text-dim)]",children:N.label}),e.jsx("p",{className:"text-sm font-bold font-mono",style:{color:N.color},children:N.value})]},N.label))}),e.jsxs("div",{className:"rounded-xl overflow-hidden",style:{background:"var(--surface)",border:"1px solid var(--border)"},children:[e.jsxs("div",{className:"flex items-center justify-between px-4 py-2.5",style:{borderBottom:"1px solid var(--border)"},children:[e.jsxs("h3",{className:"text-xs font-bold flex items-center gap-2 text-[var(--text-secondary)]",children:[e.jsx(X,{size:14,className:"text-[var(--gold)]"})," Curva de Equity"]}),e.jsxs("span",{className:"text-[10px] text-[var(--text-dim)]",children:[((I=a.equityHistory)==null?void 0:I.length)||0," puntos"]})]}),e.jsx("div",{className:"p-2",children:e.jsx(es,{data:a.equityHistory,height:160})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-[var(--dark-2)] border border-[var(--border)] rounded-xl p-4 space-y-3",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Abrir Posici√≥n (Demo)"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm font-bold text-[var(--gold)]",children:x}),e.jsxs("span",{className:"text-sm font-mono",children:["$",(s==null?void 0:s.toLocaleString(void 0,{maximumFractionDigits:2}))||"---"]}),e.jsx("button",{onClick:()=>t("chart"),className:"text-xs text-[var(--gold)] hover:underline ml-auto",children:"Ver gr√°fico ‚Üí"})]}),e.jsxs("div",{className:"flex gap-1 bg-[var(--dark-3)] rounded-lg p-1",children:[e.jsx("button",{onClick:()=>c({...l,side:"buy"}),className:`flex-1 py-2 text-sm font-bold rounded-md transition-all ${l.side==="buy"?"bg-[var(--green)] text-white":"text-[var(--text-dim)]"}`,children:"COMPRAR"}),e.jsx("button",{onClick:()=>c({...l,side:"sell"}),className:`flex-1 py-2 text-sm font-bold rounded-md transition-all ${l.side==="sell"?"bg-[var(--red)] text-white":"text-[var(--text-dim)]"}`,children:"VENDER"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-[var(--text-dim)] mb-1 block",children:"Cantidad"}),e.jsx("input",{type:"number",value:l.quantity,onChange:N=>c({...l,quantity:N.target.value}),placeholder:"Ej: 0.01",className:"w-full text-sm"}),l.quantity&&s&&e.jsxs("p",{className:"text-[10px] text-[var(--text-dim)] mt-1",children:["Costo: $",(parseFloat(l.quantity)*s).toFixed(2)," de $",(j=o.balance)==null?void 0:j.toFixed(2)," disponible"]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"text-xs text-[var(--text-dim)] mb-1 flex items-center gap-1",children:[e.jsx(te,{size:10})," Stop Loss"]}),e.jsx("input",{type:"number",value:l.stopLoss,onChange:N=>c({...l,stopLoss:N.target.value}),placeholder:"Precio",className:"w-full text-xs"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"text-xs text-[var(--text-dim)] mb-1 flex items-center gap-1",children:[e.jsx(je,{size:10})," Take Profit"]}),e.jsx("input",{type:"number",value:l.takeProfit,onChange:N=>c({...l,takeProfit:N.target.value}),placeholder:"Precio",className:"w-full text-xs"})]})]}),e.jsx("button",{onClick:f,disabled:!l.quantity||!s||p,className:`w-full py-3 font-bold rounded-xl text-sm transition-colors disabled:opacity-50 ${l.side==="buy"?"bg-[var(--green)] text-white":"bg-[var(--red)] text-white"}`,children:p?"Ejecutando...":`${l.side==="buy"?"Comprar":"Vender"} ${x.replace("USDT","")} (Demo)`})]}),e.jsxs("div",{className:"bg-[var(--dark-2)] border border-[var(--border)] rounded-xl p-4",children:[e.jsxs("h3",{className:"text-sm font-bold mb-3",children:["Posiciones Abiertas (",a.positions.length,")"]}),a.positions.length===0?e.jsx("p",{className:"text-sm text-[var(--text-dim)] text-center py-8",children:"Sin posiciones abiertas"}):e.jsx("div",{className:"space-y-2 max-h-64 overflow-y-auto",children:a.positions.map(N=>{var d,b,S,T;return e.jsxs("div",{className:"bg-[var(--dark-3)] rounded-xl p-3",children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:`text-xs font-bold px-1.5 py-0.5 rounded ${N.side==="buy"?"bg-[var(--green)]/20 text-[var(--green)]":"bg-[var(--red)]/20 text-[var(--red)]"}`,children:N.side.toUpperCase()}),e.jsx("span",{className:"text-sm font-bold",children:N.symbol})]}),e.jsx("button",{onClick:()=>v(N.id),className:"px-2 py-0.5 bg-[var(--dark-4)] text-[var(--text-dim)] rounded text-[10px] hover:bg-[var(--red)]/20 hover:text-[var(--red)] transition-colors",children:"Cerrar"})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-2 text-[10px]",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-[var(--text-dim)]",children:"Entrada"}),e.jsxs("p",{className:"font-mono",children:["$",(d=N.entryPrice)==null?void 0:d.toFixed(2)]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-[var(--text-dim)]",children:"Actual"}),e.jsxs("p",{className:"font-mono",children:["$",(b=N.currentPrice)==null?void 0:b.toFixed(2)]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-[var(--text-dim)]",children:"P&L"}),e.jsxs("p",{className:`font-mono font-bold ${N.pnl>=0?"text-[var(--green)]":"text-[var(--red)]"}`,children:[N.pnl>=0?"+":"","$",(S=N.pnl)==null?void 0:S.toFixed(2)," (",(T=N.pnlPercent)==null?void 0:T.toFixed(1),"%)"]})]})]})]},N.id)})})]})]}),a.closedTrades.length>0&&e.jsxs("div",{className:"bg-[var(--dark-2)] border border-[var(--border)] rounded-xl overflow-hidden",children:[e.jsx("div",{className:"p-3 border-b border-[var(--border)]",children:e.jsx("h3",{className:"text-sm font-bold",children:"Historial de Trades (Demo)"})}),e.jsx("div",{className:"max-h-64 overflow-y-auto",children:e.jsxs("table",{className:"w-full text-xs",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"text-[var(--text-dim)] border-b border-[var(--border)]",children:[e.jsx("th",{className:"text-left p-2",children:"Par"}),e.jsx("th",{className:"text-left p-2",children:"Lado"}),e.jsx("th",{className:"text-right p-2",children:"Entrada"}),e.jsx("th",{className:"text-right p-2",children:"Salida"}),e.jsx("th",{className:"text-right p-2",children:"P&L"})]})}),e.jsx("tbody",{children:a.closedTrades.slice().reverse().map(N=>{var d,b,S;return e.jsxs("tr",{className:"border-b border-[var(--border)]/50 hover:bg-[var(--dark-3)]",children:[e.jsx("td",{className:"p-2 font-bold",children:N.symbol}),e.jsx("td",{className:"p-2",children:e.jsx("span",{className:N.side==="buy"?"text-[var(--green)]":"text-[var(--red)]",children:N.side.toUpperCase()})}),e.jsxs("td",{className:"p-2 text-right font-mono",children:["$",(d=N.entryPrice)==null?void 0:d.toFixed(2)]}),e.jsxs("td",{className:"p-2 text-right font-mono",children:["$",(b=N.exitPrice)==null?void 0:b.toFixed(2)]}),e.jsxs("td",{className:`p-2 text-right font-mono font-bold ${N.pnl>=0?"text-[var(--green)]":"text-[var(--red)]"}`,children:[N.pnl>=0?"+":"","$",(S=N.pnl)==null?void 0:S.toFixed(2)]})]},N.id)})})]})})]}),e.jsxs("div",{className:"text-center text-xs text-[var(--text-dim)] pb-4",children:[e.jsx("p",{children:"‚ö†Ô∏è Esto es un simulador con datos reales del mercado. No se usa dinero real."}),e.jsx("p",{className:"text-[var(--gold)] mt-1",children:"Practica tus estrategias sin riesgo."})]})]})}function ss(){var c;const{settings:x,updateSettings:s,user:t}=_(),[a,i]=w.useState(""),[o,n]=w.useState(!1),l=()=>{a.trim()&&(He.setApiKey(a.trim()),s({openaiKey:a.trim()}),n(!0),setTimeout(()=>n(!1),2e3))};return e.jsxs("div",{className:"flex-1 overflow-y-auto p-6 space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl font-bold",children:"Ajustes"}),e.jsx("p",{className:"text-sm text-[var(--text-dim)]",children:"Configuraci√≥n de tu plataforma"})]}),e.jsxs("div",{className:"bg-[var(--dark-2)] border border-[var(--border)] rounded-xl p-4",children:[e.jsxs("h2",{className:"text-sm font-bold mb-3 flex items-center gap-2",children:[e.jsx(te,{size:16,className:"text-[var(--gold)]"})," Perfil"]}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("p",{children:[e.jsx("span",{className:"text-[var(--text-dim)]",children:"Email:"})," ",t==null?void 0:t.email]}),e.jsxs("p",{children:[e.jsx("span",{className:"text-[var(--text-dim)]",children:"Nombre:"})," ",t==null?void 0:t.name]}),e.jsxs("p",{children:[e.jsx("span",{className:"text-[var(--text-dim)]",children:"Plan:"})," ",e.jsx("span",{className:"text-[var(--gold)]",children:(c=t==null?void 0:t.plan)==null?void 0:c.toUpperCase()})]})]})]}),e.jsxs("div",{className:"bg-[var(--dark-2)] border border-[var(--border)] rounded-xl p-4",children:[e.jsxs("h2",{className:"text-sm font-bold mb-3 flex items-center gap-2",children:[e.jsx(ht,{size:16,className:"text-[var(--gold)]"})," API Key de OpenAI"]}),e.jsx("p",{className:"text-xs text-[var(--text-dim)] mb-2",children:"Opcional. Sin API key, Kairos AI usa an√°lisis local integrado. Con API key, accedes a GPT-4 para an√°lisis avanzado."}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"password",value:a,onChange:p=>i(p.target.value),placeholder:"sk-...",className:"flex-1 text-sm font-mono"}),e.jsx("button",{onClick:l,className:"px-4 py-2 bg-[var(--gold)] text-white rounded-xl text-sm font-bold",children:o?"‚úì Guardado":"Guardar"})]})]}),e.jsxs("div",{className:"bg-[var(--dark-2)] border border-[var(--border)] rounded-xl p-4",children:[e.jsxs("h2",{className:"text-sm font-bold mb-3 flex items-center gap-2",children:[e.jsx(gt,{size:16,className:"text-[var(--gold)]"})," Trading por Defecto"]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-[var(--text-dim)] mb-1 block",children:"Riesgo m√°x. por trade (%)"}),e.jsx("input",{type:"number",value:x.maxRiskPerTrade,onChange:p=>s({maxRiskPerTrade:parseFloat(p.target.value)}),className:"w-full text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-[var(--text-dim)] mb-1 block",children:"Apalancamiento predeterminado"}),e.jsx("input",{type:"number",value:x.defaultLeverage,onChange:p=>s({defaultLeverage:parseFloat(p.target.value)}),className:"w-full text-sm"})]})]})]}),e.jsxs("div",{className:"bg-[var(--dark-2)] border border-[var(--border)] rounded-xl p-4",children:[e.jsxs("h2",{className:"text-sm font-bold mb-3 flex items-center gap-2",children:[e.jsx(re,{size:16,className:"text-[var(--gold)]"})," Notificaciones"]}),e.jsx("div",{className:"space-y-3",children:[{key:"notifications",label:"Notificaciones",desc:"Alertas de trades y se√±ales"},{key:"soundAlerts",label:"Sonido",desc:"Alertas sonoras al ejecutar trades"}].map(p=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm",children:p.label}),e.jsx("p",{className:"text-xs text-[var(--text-dim)]",children:p.desc})]}),e.jsx("button",{onClick:()=>s({[p.key]:!x[p.key]}),className:`w-12 h-6 rounded-full transition-colors relative
                  ${x[p.key]?"bg-[var(--gold)]":"bg-[var(--dark-4)]"}`,children:e.jsx("div",{className:`w-5 h-5 bg-white rounded-full absolute top-0.5 transition-transform
                    ${x[p.key]?"left-6":"left-0.5"}`})})]},p.key))})]}),e.jsxs("div",{className:"bg-[var(--dark-2)] border border-[var(--border)] rounded-xl p-4",children:[e.jsxs("h2",{className:"text-sm font-bold mb-3 flex items-center gap-2",children:[e.jsx(ue,{size:16,className:"text-[var(--gold)]"})," Kairos Wallet"]}),e.jsx("p",{className:"text-xs text-[var(--text-dim)] mb-3",children:"Conecta tu Kairos Wallet para usar KAIROS Coin como m√©todo de pago y recibir recompensas."}),e.jsxs("a",{href:"https://kairos-wallet.netlify.app",target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-2 px-4 py-2 bg-[var(--gold)]/20 text-[var(--gold)] rounded-xl text-sm font-bold hover:bg-[var(--gold)]/30 transition-colors",children:[e.jsx(ue,{size:14})," Abrir Kairos Wallet"]})]}),e.jsxs("div",{className:"text-center text-xs text-[var(--text-dim)] pb-4",children:[e.jsx("p",{children:"Kairos Trade v1.0.0 ‚Ä¢ Kairos 777 Inc"}),e.jsx("p",{className:"text-[var(--gold)] mt-1",children:"Powered by Kairos AI"})]})]})}const _e="kairos_trade_alerts";class as{constructor(){this.alerts=this._load(),this.triggered=[],this.monitoring=!1,this.interval=null,this.callbacks=new Set}_load(){try{return JSON.parse(localStorage.getItem(_e))||[]}catch{return[]}}_save(){localStorage.setItem(_e,JSON.stringify(this.alerts))}subscribe(s){return this.callbacks.add(s),()=>this.callbacks.delete(s)}_notify(s){this.callbacks.forEach(t=>t(s)),Notification.permission==="granted"&&new Notification(`Kairos Trade ‚Äî ${s.symbol}`,{body:s.message,icon:'data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><rect width="100" height="100" rx="20" fill="%23D4AF37"/><text x="50" y="70" font-size="60" text-anchor="middle" fill="%230A0A0F" font-family="serif" font-weight="bold">K</text></svg>'})}async requestPermission(){Notification.permission!=="granted"&&await Notification.requestPermission()}addPriceAlert(s,t,a,i={}){const o={id:Date.now().toString(36),type:"price",symbol:s,condition:t,targetPrice:parseFloat(a),active:!0,repeat:i.repeat||!1,message:`${s} ${t==="above"?">":"<"} $${a}`,createdAt:new Date().toISOString()};return this.alerts.push(o),this._save(),this._ensureMonitoring(),o}addSignalAlert(s,t,a={}){const i={ema_cross:`EMA ${a.fast||20}/${a.slow||50} Cross`,rsi_oversold:`RSI < ${a.threshold||30}`,rsi_overbought:`RSI > ${a.threshold||70}`,macd_cross:"MACD Signal Cross",volume_spike:`Volume Spike > ${a.multiplier||2}x avg`},o={id:Date.now().toString(36),type:"signal",symbol:s,signalType:t,params:a,active:!0,repeat:a.repeat||!1,message:`${s}: ${i[t]||t}`,createdAt:new Date().toISOString()};return this.alerts.push(o),this._save(),this._ensureMonitoring(),o}removeAlert(s){this.alerts=this.alerts.filter(t=>t.id!==s),this._save()}getAlerts(){return this.alerts}getTriggered(){return this.triggered}_ensureMonitoring(){this.monitoring||(this.monitoring=!0,this.interval=setInterval(()=>this._check(),15e3),this._check())}stop(){this.monitoring=!1,this.interval&&clearInterval(this.interval)}async _check(){const s=this.alerts.filter(a=>a.active);if(s.length===0)return;const t={};s.forEach(a=>{t[a.symbol]||(t[a.symbol]=[]),t[a.symbol].push(a)});for(const[a,i]of Object.entries(t))try{const o=await q.getPrice(a);for(const n of i){let l=!1;n.type==="price"&&(n.condition==="above"&&o>=n.targetPrice&&(l=!0),n.condition==="below"&&o<=n.targetPrice&&(l=!0)),n.type==="signal"&&(l=await this._checkSignal(a,n)),l&&(n.triggeredAt=new Date().toISOString(),n.triggeredPrice=o,this.triggered.push({...n}),this._notify({...n,currentPrice:o,message:`üîî ${n.message} ‚Äî Precio actual: $${o.toLocaleString()}`}),n.repeat||(n.active=!1))}}catch{}this._save()}async _checkSignal(s,t){try{const a=await q.getCandles(s,"1h",60),i=a.map(n=>n.close),o=i.length;switch(t.signalType){case"ema_cross":{const n=G(i,t.params.fast||20),l=G(i,t.params.slow||50);return he(n,l,o-1)!==null}case"rsi_oversold":return le(i,t.params.period||14)[o-1]<(t.params.threshold||30);case"rsi_overbought":return le(i,t.params.period||14)[o-1]>(t.params.threshold||70);case"macd_cross":{const{macd:n,signal:l}=Ke(i);return he(n,l,o-1)!==null}case"volume_spike":{const n=a.map(c=>c.volume),l=n.slice(-20).reduce((c,p)=>c+p,0)/20;return n[o-1]>l*(t.params.multiplier||2)}default:return!1}}catch{return!1}}}const V=new as,rs=[{id:"ema_cross",label:"EMA Cruce",desc:"EMA 20/50 crossover",icon:ye},{id:"rsi_oversold",label:"RSI Sobreventa",desc:"RSI < 30",icon:ie},{id:"rsi_overbought",label:"RSI Sobrecompra",desc:"RSI > 70",icon:X},{id:"macd_cross",label:"MACD Cruce",desc:"MACD/Signal crossover",icon:Q},{id:"volume_spike",label:"Spike Volumen",desc:"Volumen > 2x promedio",icon:vt}];function is(){const{selectedPair:x}=_(),[s,t]=w.useState([]),[a,i]=w.useState([]),[o,n]=w.useState("active"),[l,c]=w.useState({type:"price",condition:"above",price:"",signalType:"ema_cross",repeat:!1});w.useEffect(()=>{t(V.getAlerts()),i(V.getTriggered());const r=V.subscribe(()=>{t([...V.getAlerts()]),i([...V.getTriggered()])});return V.requestPermission(),r},[]);const p=()=>{if(l.type==="price"){if(!l.price)return;V.addPriceAlert(x,l.condition,l.price,{repeat:l.repeat})}else V.addSignalAlert(x,l.signalType,{repeat:l.repeat});t([...V.getAlerts()]),c({type:"price",condition:"above",price:"",signalType:"ema_cross",repeat:!1}),n("active")},m=r=>{V.removeAlert(r),t([...V.getAlerts()])},u=s.filter(r=>r.active);return s.filter(r=>!r.active),e.jsxs("div",{className:"flex-1 overflow-y-auto p-6 space-y-6",children:[e.jsxs(B.div,{initial:{opacity:0,y:8},animate:{opacity:1,y:0},className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-[22px] font-bold tracking-tight flex items-center gap-2",children:[e.jsx(re,{size:22,className:"text-[var(--gold)]"}),"Alertas"]}),e.jsxs("p",{className:"text-sm text-[var(--text-dim)] mt-0.5",children:[u.length," alerta",u.length!==1?"s":""," activa",u.length!==1?"s":""]})]}),e.jsxs("button",{onClick:()=>n("create"),className:"flex items-center gap-2 px-4 py-2.5 rounded-xl text-sm font-semibold text-white transition-all hover:opacity-90",style:{background:"linear-gradient(135deg, #3B82F6, #2563EB)",boxShadow:"0 4px 15px rgba(59,130,246,0.25)"},children:[e.jsx(ve,{size:16}),"Nueva Alerta"]})]}),e.jsx("div",{className:"flex gap-1 p-1 rounded-xl",style:{background:"rgba(24,26,32,0.8)",border:"1px solid rgba(30,34,45,0.5)"},children:[{id:"active",label:`Activas (${u.length})`},{id:"triggered",label:`Disparadas (${a.length})`},{id:"create",label:"Crear"}].map(r=>e.jsx("button",{onClick:()=>n(r.id),className:`flex-1 py-2 text-xs font-bold rounded-lg transition-all duration-200
              ${o===r.id?"text-white":"text-[var(--text-dim)]"}`,style:o===r.id?{background:"linear-gradient(135deg, rgba(59,130,246,0.2), rgba(59,130,246,0.08))",border:"1px solid rgba(59,130,246,0.15)"}:{},children:r.label},r.id))}),e.jsx(K,{children:o==="create"&&e.jsxs(B.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},className:"rounded-xl p-5 space-y-4",style:{background:"linear-gradient(135deg, rgba(17,19,24,0.8), rgba(24,26,32,0.6))",border:"1px solid rgba(30,34,45,0.5)"},children:[e.jsxs("h3",{className:"text-sm font-bold",children:["Crear Alerta para ",x]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>c({...l,type:"price"}),className:`flex-1 py-2 text-xs font-bold rounded-lg transition-all
                  ${l.type==="price"?"bg-[var(--gold)]/15 text-[var(--gold)] border border-[var(--gold)]/20":"bg-[var(--dark-3)] text-[var(--text-dim)] border border-transparent"}`,children:"Precio"}),e.jsx("button",{onClick:()=>c({...l,type:"signal"}),className:`flex-1 py-2 text-xs font-bold rounded-lg transition-all
                  ${l.type==="signal"?"bg-[var(--gold)]/15 text-[var(--gold)] border border-[var(--gold)]/20":"bg-[var(--dark-3)] text-[var(--text-dim)] border border-transparent"}`,children:"Se√±al T√©cnica"})]}),l.type==="price"?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"flex gap-2",children:["above","below"].map(r=>e.jsxs("button",{onClick:()=>c({...l,condition:r}),className:`flex-1 py-2 text-xs font-bold rounded-lg transition-all flex items-center justify-center gap-1.5
                        ${l.condition===r?r==="above"?"bg-[var(--green)]/10 text-[var(--green)] border border-[var(--green)]/15":"bg-[var(--red)]/10 text-[var(--red)] border border-[var(--red)]/15":"bg-[var(--dark-3)] text-[var(--text-dim)] border border-transparent"}`,children:[r==="above"?e.jsx(X,{size:12}):e.jsx(ie,{size:12}),r==="above"?"Sube a":"Baja a"]},r))}),e.jsxs("div",{children:[e.jsx("label",{className:"text-[11px] text-[var(--text-dim)] mb-1.5 block font-medium",children:"Precio objetivo (USD)"}),e.jsx("input",{type:"number",value:l.price,onChange:r=>c({...l,price:r.target.value}),placeholder:"Ej: 100000",className:"w-full",step:"any"})]})]}):e.jsx("div",{className:"space-y-2",children:rs.map(r=>{const y=r.icon;return e.jsxs("button",{onClick:()=>c({...l,signalType:r.id}),className:`w-full flex items-center gap-3 p-3 rounded-lg transition-all text-left
                        ${l.signalType===r.id?"bg-[var(--gold)]/10 border border-[var(--gold)]/15":"bg-[var(--dark-3)] border border-transparent hover:border-[var(--border)]"}`,children:[e.jsx("div",{className:`w-8 h-8 rounded-lg flex items-center justify-center ${l.signalType===r.id?"bg-[var(--gold)]/15":"bg-[var(--dark-4)]"}`,children:e.jsx(y,{size:14,className:l.signalType===r.id?"text-[var(--gold)]":"text-[var(--text-dim)]"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-bold",children:r.label}),e.jsx("p",{className:"text-[10px] text-[var(--text-dim)]",children:r.desc})]})]},r.id)})}),e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("div",{className:`w-9 h-5 rounded-full transition-colors relative ${l.repeat?"bg-[var(--gold)]":"bg-[var(--dark-4)]"}`,onClick:()=>c({...l,repeat:!l.repeat}),children:e.jsx("div",{className:`absolute top-0.5 w-4 h-4 rounded-full bg-white transition-transform ${l.repeat?"translate-x-4":"translate-x-0.5"}`})}),e.jsx("span",{className:"text-xs text-[var(--text-dim)]",children:"Repetir alerta"})]}),e.jsx("button",{onClick:p,disabled:l.type==="price"&&!l.price,className:"w-full py-3 text-white font-bold rounded-xl text-sm transition-all disabled:opacity-40",style:{background:"linear-gradient(135deg, #3B82F6, #2563EB)",boxShadow:"0 4px 15px rgba(59,130,246,0.25)"},children:"Crear Alerta"})]})}),o==="active"&&e.jsx("div",{className:"space-y-2",children:u.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(re,{size:40,className:"mx-auto text-[var(--text-dim)]/20 mb-3"}),e.jsx("p",{className:"text-sm text-[var(--text-dim)]",children:"No hay alertas activas"}),e.jsx("button",{onClick:()=>n("create"),className:"text-xs text-[var(--gold)] mt-2 font-semibold",children:"Crear primera alerta ‚Üí"})]}):u.map((r,y)=>e.jsxs(B.div,{initial:{opacity:0,y:5},animate:{opacity:1,y:0},transition:{delay:y*.04},className:"flex items-center gap-3 p-3 rounded-xl group",style:{background:"linear-gradient(135deg, rgba(17,19,24,0.8), rgba(24,26,32,0.6))",border:"1px solid rgba(30,34,45,0.5)"},children:[e.jsx("div",{className:"w-9 h-9 rounded-lg flex items-center justify-center shrink-0",style:{background:r.type==="price"?"rgba(59,130,246,0.08)":"rgba(139,92,246,0.08)"},children:r.type==="price"?r.condition==="above"?e.jsx(X,{size:16,className:"text-[var(--green)]"}):e.jsx(ie,{size:16,className:"text-[var(--red)]"}):e.jsx(Q,{size:16,className:"text-purple-400"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-[13px] font-semibold truncate",children:r.symbol}),e.jsx("p",{className:"text-[11px] text-[var(--text-dim)] truncate",children:r.message})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[r.repeat&&e.jsx("span",{className:"text-[9px] font-bold text-[var(--gold)] bg-[var(--gold)]/10 px-1.5 py-0.5 rounded",children:"‚Üª"}),e.jsx("span",{className:"w-2 h-2 rounded-full bg-[var(--green)] animate-pulse"}),e.jsx("button",{onClick:()=>m(r.id),className:"p-1.5 rounded-lg text-[var(--text-dim)] hover:text-[var(--red)] hover:bg-[var(--red)]/[0.06] transition-all opacity-0 group-hover:opacity-100",children:e.jsx(ce,{size:13})})]})]},r.id))}),o==="triggered"&&e.jsx("div",{className:"space-y-2",children:a.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(Ne,{size:40,className:"mx-auto text-[var(--text-dim)]/20 mb-3"}),e.jsx("p",{className:"text-sm text-[var(--text-dim)]",children:"No hay alertas disparadas"})]}):[...a].reverse().map((r,y)=>{var f;return e.jsxs(B.div,{initial:{opacity:0},animate:{opacity:1},className:"flex items-center gap-3 p-3 rounded-xl",style:{background:"linear-gradient(135deg, rgba(14,203,129,0.04), rgba(17,19,24,0.6))",border:"1px solid rgba(14,203,129,0.08)"},children:[e.jsx("div",{className:"w-9 h-9 rounded-lg bg-[var(--green)]/[0.08] flex items-center justify-center shrink-0",children:e.jsx(Ne,{size:16,className:"text-[var(--green)]"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-[13px] font-semibold truncate",children:r.symbol}),e.jsx("p",{className:"text-[11px] text-[var(--text-dim)] truncate",children:r.message})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("p",{className:"text-xs font-mono text-[var(--green)]",children:["$",(f=r.triggeredPrice)==null?void 0:f.toLocaleString()]}),e.jsx("p",{className:"text-[9px] text-[var(--text-dim)]",children:new Date(r.triggeredAt).toLocaleTimeString()})]})]},`${r.id}-${y}`)})})]})}function ns(){const[x,s]=w.useState("chart"),{selectedPair:t}=_();return e.jsxs("div",{className:"flex flex-1 overflow-hidden h-full",children:[e.jsxs("div",{className:"flex-1 h-full overflow-hidden flex flex-col",children:[e.jsx("div",{className:"flex gap-1 px-3 pt-2",style:{background:"var(--surface)"},children:[["chart","Chart"],["depth","Depth"]].map(([a,i])=>e.jsx("button",{onClick:()=>s(a),className:`px-3 py-1.5 text-xs font-bold rounded-t-lg transition-colors ${x===a?"text-[var(--gold)]":"text-[var(--text-dim)] hover:text-[var(--text-secondary)]"}`,style:x===a?{background:"var(--dark)",borderTop:"2px solid var(--gold)"}:{},children:i},a))}),x==="chart"?e.jsx(Mt,{}):e.jsx(zt,{pair:t||"BTCUSDT",height:500})]}),e.jsx(qt,{})]})}function ls(){const{isAuthenticated:x,currentPage:s,aiPanelOpen:t}=_();if(!x)return e.jsx(Et,{});const a=()=>{switch(s){case"dashboard":return e.jsx(Be,{});case"chart":return e.jsx(ns,{});case"bots":return e.jsx(Vt,{});case"simulator":return e.jsx(ts,{});case"brokers":return e.jsx(Wt,{});case"ai":return e.jsx(Oe,{});case"strategies":return e.jsx(Jt,{});case"history":return e.jsx(Xt,{});case"alerts":return e.jsx(is,{});case"wallet":return e.jsx("div",{className:"flex-1 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-16 h-16 rounded-2xl bg-[var(--gold)]/15 flex items-center justify-center text-[var(--gold)] text-2xl font-bold mx-auto mb-4",children:"K"}),e.jsx("h2",{className:"text-lg font-bold mb-2",children:"Kairos Wallet"}),e.jsx("p",{className:"text-sm text-[var(--text-dim)] mb-4 max-w-xs",children:"Conecta tu Kairos Wallet para integrar tus balances de KAIROS Coin con la plataforma de trading."}),e.jsx("a",{href:"https://kairos-wallet.netlify.app",target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-2 px-6 py-3 bg-[var(--gold)] text-white font-semibold rounded-xl hover:bg-[var(--gold-light)] transition-colors",children:"Abrir Kairos Wallet"})]})});case"settings":return e.jsx(ss,{});default:return e.jsx(Be,{})}};return e.jsxs("div",{className:"flex h-screen bg-[var(--dark)] overflow-hidden",children:[e.jsx(bt,{position:"top-right",toastOptions:{style:{background:"#181A20",color:"#EAECEF",border:"1px solid #1E222D",fontSize:"13px"}}}),e.jsx(It,{}),e.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden",children:[e.jsx(Bt,{}),e.jsxs("div",{className:"flex flex-1 overflow-hidden",children:[e.jsx(K,{mode:"wait",children:e.jsx(B.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.15},className:"flex-1 flex flex-col overflow-hidden",children:a()},s)}),e.jsx(K,{children:t&&s!=="ai"&&e.jsx(B.div,{initial:{width:0,opacity:0},animate:{width:380,opacity:1},exit:{width:0,opacity:0},transition:{duration:.2},className:"border-l border-[var(--border)] overflow-hidden shrink-0",children:e.jsx(Oe,{})})})]})]})]})}At.createRoot(document.getElementById("root")).render(e.jsx(Nt.StrictMode,{children:e.jsx(wt,{children:e.jsx(ls,{})})}));
