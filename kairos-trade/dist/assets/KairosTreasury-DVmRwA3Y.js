import{j as e,S as _,R as g,L as D,m as N,V as q,$ as y,B as P,a1 as K,T as O,t as U,A as w,Z as E,au as V}from"./ui-BpW-uvdI.js";import{a as c}from"./vendor-CUCP814w.js";import{u as B,i as S,f as H,A as M}from"./index-D_6OLlYW.js";const F="https://kairos-api-u6k5.onrender.com",i=(n,d=2)=>(n||0).toLocaleString(void 0,{minimumFractionDigits:d,maximumFractionDigits:d}),p=n=>n?n>=1e6?`$${(n/1e6).toFixed(2)}M`:n>=1e3?`$${(n/1e3).toFixed(1)}K`:`$${n.toFixed(2)}`:"$0";function J(){var z;const{showToast:n,user:d,setPage:T}=B(),[t,C]=c.useState(null),[l,k]=c.useState(null),[a,$]=c.useState(null),[R,A]=c.useState(!0),[v,I]=c.useState(null),m=c.useCallback(async()=>{if(S(d))try{const[s,x]=await Promise.all([fetch(`${F}/api/perps/treasury`).then(o=>o.json()),fetch(`${F}/api/perps/stats`).then(o=>o.json())]);s.success&&C(s.data),x.success&&k(x.data),$(H.getStats()),I(new Date)}catch(s){console.error("Treasury fetch error:",s)}finally{A(!1)}},[d]);if(c.useEffect(()=>{m();const s=setInterval(m,1e4);return()=>clearInterval(s)},[m]),!S(d))return e.jsx("div",{className:"flex-1 flex items-center justify-center",children:e.jsxs("div",{className:"text-center p-8",children:[e.jsx(_,{size:48,className:"text-red-500 mx-auto mb-4"}),e.jsx("h2",{className:"text-xl font-bold text-white mb-2",children:"Acceso Restringido"}),e.jsxs("p",{className:"text-zinc-400 mb-4",children:["Solo administradores de ",M.companyName," pueden acceder al Treasury."]}),e.jsx("button",{onClick:()=>T("dashboard"),className:"px-4 py-2 bg-blue-600 rounded-lg text-white text-sm hover:bg-blue-500 transition",children:"Volver al Dashboard"})]})});if(R)return e.jsx("div",{className:"flex-1 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx(g,{className:"w-8 h-8 text-[var(--gold)] animate-spin mx-auto mb-3"}),e.jsx("p",{className:"text-sm text-zinc-400",children:"Cargando Treasury..."})]})});const h=(t==null?void 0:t.breakdown)||{},u=h.open_fee||{total:0,count:0},j=h.close_fee||{total:0,count:0},f=h.liquidation_fee||{total:0,count:0},r=(t==null?void 0:t.totalRevenue)||0,L=(t==null?void 0:t.todayRevenue)||0,b=(t==null?void 0:t.feeRates)||{};return e.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",style:{scrollbarWidth:"thin",scrollbarColor:"#3f3f46 transparent"},children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-11 h-11 rounded-xl bg-gradient-to-br from-amber-500/20 to-yellow-600/10 border border-amber-500/30 flex items-center justify-center",children:e.jsx(D,{size:22,className:"text-amber-400"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl font-bold text-white",children:"Kairos 777 Treasury"}),e.jsx("p",{className:"text-xs text-zinc-500",children:"Ingresos por comisiones de trading"})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[v&&e.jsxs("span",{className:"text-[10px] text-zinc-600",children:["Actualizado ",v.toLocaleTimeString()]}),e.jsx("button",{onClick:m,className:"p-2 rounded-lg bg-zinc-800 hover:bg-zinc-700 transition-colors",children:e.jsx(g,{size:14,className:"text-zinc-400"})})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3",children:[e.jsxs(N.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"bg-gradient-to-br from-amber-500/10 to-amber-600/5 border border-amber-500/20 rounded-xl p-5",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(q,{size:16,className:"text-amber-400"}),e.jsx("span",{className:"text-xs font-medium text-amber-400/80 uppercase tracking-wider",children:"Revenue Total"})]}),e.jsxs("p",{className:"text-3xl font-bold text-white font-mono",children:[i(r)," ",e.jsx("span",{className:"text-base text-amber-400",children:"KAIROS"})]}),e.jsxs("p",{className:"text-xs text-zinc-500 mt-1",children:["≈ $",i(r)," USD (1:1 peg)"]})]}),e.jsxs(N.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.05},className:"bg-zinc-900 border border-zinc-800 rounded-xl p-5",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(y,{size:16,className:"text-green-400"}),e.jsx("span",{className:"text-xs font-medium text-zinc-500 uppercase tracking-wider",children:"Revenue Hoy"})]}),e.jsxs("p",{className:"text-3xl font-bold text-green-400 font-mono",children:[i(L)," ",e.jsx("span",{className:"text-base text-green-400/60",children:"KAIROS"})]}),e.jsx("p",{className:"text-xs text-zinc-500 mt-1",children:"Acumulado desde 00:00 UTC"})]}),e.jsxs(N.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.1},className:"bg-zinc-900 border border-zinc-800 rounded-xl p-5",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(P,{size:16,className:"text-blue-400"}),e.jsx("span",{className:"text-xs font-medium text-zinc-500 uppercase tracking-wider",children:"Actividad"})]}),e.jsx("p",{className:"text-2xl font-bold text-white font-mono",children:p((l==null?void 0:l.volume)||0)}),e.jsxs("p",{className:"text-xs text-zinc-500",children:["Volumen total • ",(l==null?void 0:l.positionsOpened)||0," trades"]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3",children:[e.jsxs("div",{className:"bg-zinc-900 border border-zinc-800 rounded-xl p-4",children:[e.jsx("div",{className:"flex items-center justify-between mb-3",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-8 h-8 rounded-lg bg-blue-500/10 flex items-center justify-center",children:e.jsx(K,{size:16,className:"text-blue-400"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-white",children:"Open Fees"}),e.jsxs("p",{className:"text-[10px] text-zinc-600",children:[b.openFee," por posición"]})]})]})}),e.jsx("p",{className:"text-xl font-bold text-blue-400 font-mono",children:i(u.total)}),e.jsxs("p",{className:"text-xs text-zinc-500 mt-1",children:[u.count," cobros"]}),e.jsx("div",{className:"mt-2 h-1 bg-zinc-800 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-blue-500 rounded-full",style:{width:`${r>0?u.total/r*100:0}%`}})})]}),e.jsxs("div",{className:"bg-zinc-900 border border-zinc-800 rounded-xl p-4",children:[e.jsx("div",{className:"flex items-center justify-between mb-3",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-8 h-8 rounded-lg bg-purple-500/10 flex items-center justify-center",children:e.jsx(O,{size:16,className:"text-purple-400"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-white",children:"Close Fees"}),e.jsxs("p",{className:"text-[10px] text-zinc-600",children:[b.closeFee," por cierre"]})]})]})}),e.jsx("p",{className:"text-xl font-bold text-purple-400 font-mono",children:i(j.total)}),e.jsxs("p",{className:"text-xs text-zinc-500 mt-1",children:[j.count," cobros"]}),e.jsx("div",{className:"mt-2 h-1 bg-zinc-800 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-purple-500 rounded-full",style:{width:`${r>0?j.total/r*100:0}%`}})})]}),e.jsxs("div",{className:"bg-zinc-900 border border-zinc-800 rounded-xl p-4",children:[e.jsx("div",{className:"flex items-center justify-between mb-3",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-8 h-8 rounded-lg bg-red-500/10 flex items-center justify-center",children:e.jsx(U,{size:16,className:"text-red-400"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-white",children:"Liquidation Fees"}),e.jsxs("p",{className:"text-[10px] text-zinc-600",children:[b.liquidationFee," penalización"]})]})]})}),e.jsx("p",{className:"text-xl font-bold text-red-400 font-mono",children:i(f.total)}),e.jsxs("p",{className:"text-xs text-zinc-500 mt-1",children:[f.count," liquidaciones"]}),e.jsx("div",{className:"mt-2 h-1 bg-zinc-800 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-red-500 rounded-full",style:{width:`${r>0?f.total/r*100:0}%`}})})]})]}),l&&e.jsxs("div",{className:"bg-zinc-900 border border-zinc-800 rounded-xl p-4",children:[e.jsxs("h3",{className:"text-sm font-semibold text-white mb-3 flex items-center gap-2",children:[e.jsx(w,{size:14,className:"text-[var(--gold)]"}),"Estadísticas del Protocolo"]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-[10px] text-zinc-600 uppercase tracking-wider",children:"Open Interest Long"}),e.jsx("p",{className:"text-sm font-bold text-green-400 font-mono",children:p(l.openInterestLong)})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-[10px] text-zinc-600 uppercase tracking-wider",children:"Open Interest Short"}),e.jsx("p",{className:"text-sm font-bold text-red-400 font-mono",children:p(l.openInterestShort)})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-[10px] text-zinc-600 uppercase tracking-wider",children:"Cuentas Activas"}),e.jsx("p",{className:"text-sm font-bold text-white font-mono",children:l.totalAccounts||0})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-[10px] text-zinc-600 uppercase tracking-wider",children:"Liquidaciones"}),e.jsx("p",{className:"text-sm font-bold text-orange-400 font-mono",children:l.liquidations||0})]})]})]}),((z=t==null?void 0:t.recentFees)==null?void 0:z.length)>0&&e.jsxs("div",{className:"bg-zinc-900 border border-zinc-800 rounded-xl p-4",children:[e.jsxs("h3",{className:"text-sm font-semibold text-white mb-3 flex items-center gap-2",children:[e.jsx(y,{size:14,className:"text-zinc-400"}),"Últimas Comisiones Cobradas"]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-xs",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"text-zinc-600 border-b border-zinc-800",children:[e.jsx("th",{className:"text-left py-2 px-2 font-medium",children:"Fecha"}),e.jsx("th",{className:"text-left py-2 px-2 font-medium",children:"Tipo"}),e.jsx("th",{className:"text-left py-2 px-2 font-medium",children:"Par"}),e.jsx("th",{className:"text-left py-2 px-2 font-medium",children:"Trader"}),e.jsx("th",{className:"text-right py-2 px-2 font-medium",children:"Monto"})]})}),e.jsx("tbody",{children:t.recentFees.map(s=>{var x,o;return e.jsxs("tr",{className:"border-b border-zinc-800/50 hover:bg-zinc-800/30 transition-colors",children:[e.jsx("td",{className:"py-2 px-2 text-zinc-400 font-mono",children:new Date(s.created_at+"Z").toLocaleString("es",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})}),e.jsx("td",{className:"py-2 px-2",children:e.jsx("span",{className:`inline-flex items-center gap-1 px-2 py-0.5 rounded-full text-[10px] font-medium ${s.fee_type==="open_fee"?"bg-blue-500/10 text-blue-400":s.fee_type==="close_fee"?"bg-purple-500/10 text-purple-400":"bg-red-500/10 text-red-400"}`,children:s.fee_type==="open_fee"?"Apertura":s.fee_type==="close_fee"?"Cierre":"Liquidación"})}),e.jsx("td",{className:"py-2 px-2 text-white font-medium",children:s.pair}),e.jsxs("td",{className:"py-2 px-2 text-zinc-500 font-mono",children:[(x=s.trader)==null?void 0:x.slice(0,6),"...",(o=s.trader)==null?void 0:o.slice(-4)]}),e.jsxs("td",{className:"py-2 px-2 text-right font-bold text-amber-400 font-mono",children:["+",i(s.amount)," K"]})]},s.id)})})]})})]}),a&&e.jsxs("div",{className:"bg-gradient-to-br from-green-500/5 to-emerald-600/5 border border-green-500/20 rounded-xl p-4",children:[e.jsxs("h3",{className:"text-sm font-semibold text-white mb-3 flex items-center gap-2",children:[e.jsx(E,{size:14,className:"text-green-400"}),"Platform Trading Fees (Bots & Trading)",e.jsxs("span",{className:"ml-auto text-[10px] text-green-400/60 font-mono",children:[a.feeRateDisplay," por operación"]})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-3",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-[10px] text-zinc-600 uppercase tracking-wider",children:"Total Recaudado"}),e.jsxs("p",{className:"text-lg font-bold text-green-400 font-mono",children:["$",i(a.totalCollected,4)]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-[10px] text-zinc-600 uppercase tracking-wider",children:"Hoy"}),e.jsxs("p",{className:"text-lg font-bold text-white font-mono",children:["$",i(a.today.fees,4)]}),e.jsxs("p",{className:"text-[10px] text-zinc-500",children:[a.today.trades," trades • Vol: ",p(a.today.volume)]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-[10px] text-zinc-600 uppercase tracking-wider",children:"Últimos 7 Días"}),e.jsxs("p",{className:"text-lg font-bold text-white font-mono",children:["$",i(a.last7days.fees,4)]}),e.jsxs("p",{className:"text-[10px] text-zinc-500",children:[a.last7days.trades," trades"]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-[10px] text-zinc-600 uppercase tracking-wider",children:"Últimos 30 Días"}),e.jsxs("p",{className:"text-lg font-bold text-white font-mono",children:["$",i(a.last30days.fees,4)]}),e.jsxs("p",{className:"text-[10px] text-zinc-500",children:[a.last30days.trades," trades"]})]})]}),e.jsxs("div",{className:"flex items-center gap-2 text-[10px] text-zinc-500",children:[e.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-0.5 rounded-full bg-green-500/10 text-green-400",children:[e.jsx(w,{size:10})," ",a.totalTrades," trades totales"]}),a.pendingSync>0&&e.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-0.5 rounded-full bg-amber-500/10 text-amber-400",children:[e.jsx(g,{size:10})," $",i(a.pendingSync,4)," pendiente de sync"]})]})]}),e.jsxs("div",{className:"bg-zinc-900/50 border border-zinc-800/50 rounded-xl p-4",children:[e.jsxs("h3",{className:"text-sm font-semibold text-white mb-3 flex items-center gap-2",children:[e.jsx(V,{size:14,className:"text-[var(--gold)]"}),"Estructura de Comisiones — Kairos 777 Inc"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-3 text-xs",children:[e.jsxs("div",{className:"bg-zinc-800/50 rounded-lg p-3",children:[e.jsx("p",{className:"text-green-400 font-bold mb-1",children:"Platform Fee: 0.05%"}),e.jsx("p",{className:"text-zinc-500",children:"Se cobra al abrir y cerrar trades en bots, simulador, grid, DCA y trading manual. Invisible para el usuario."})]}),e.jsxs("div",{className:"bg-zinc-800/50 rounded-lg p-3",children:[e.jsx("p",{className:"text-blue-400 font-bold mb-1",children:"Open Fee: 0.10%"}),e.jsx("p",{className:"text-zinc-500",children:"Se cobra al abrir una posición apalancada. Calculado sobre el tamaño total (collateral × leverage)."})]}),e.jsxs("div",{className:"bg-zinc-800/50 rounded-lg p-3",children:[e.jsx("p",{className:"text-purple-400 font-bold mb-1",children:"Close Fee: 0.10%"}),e.jsx("p",{className:"text-zinc-500",children:"Se cobra al cerrar una posición. Calculado sobre el tamaño total de la posición."})]}),e.jsxs("div",{className:"bg-zinc-800/50 rounded-lg p-3",children:[e.jsx("p",{className:"text-red-400 font-bold mb-1",children:"Liquidation Fee: 0.50%"}),e.jsx("p",{className:"text-zinc-500",children:"Penalización cuando una posición es liquidada automáticamente por el monitor de riesgo."})]})]}),e.jsx("p",{className:"text-[10px] text-zinc-600 mt-3 text-center",children:"Todas las comisiones se acumulan en el Treasury de Kairos 777 Inc • Los fondos son propiedad de la empresa"})]})]})}export{J as default};
