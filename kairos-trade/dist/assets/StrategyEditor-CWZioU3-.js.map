{"version":3,"file":"StrategyEditor-CWZioU3-.js","sources":["../../src/components/Bots/StrategyEditor.jsx"],"sourcesContent":["// Kairos Trade ‚Äî Strategy Editor v2.0\n// Clean, intuitive design ‚Äî similar style to Broker Manager\nimport { useState, useRef, useEffect, useCallback } from 'react';\nimport { motion, AnimatePresence } from 'framer-motion';\nimport {\n  Code2, Play, Save, Copy, Clipboard, X, Zap, TrendingUp,\n  AlertTriangle, CheckCircle, BarChart3, Trophy, ArrowDownRight,\n  Target, BookOpen, RotateCcw, ChevronRight, Info,\n} from 'lucide-react';\nimport { executeScript, validateScript, backtestScript, SCRIPT_TEMPLATES } from '../../services/kairosScript';\nimport { marketData } from '../../services/marketData';\n\n// ‚îÄ‚îÄ‚îÄ Smart code extraction from clipboard ‚îÄ‚îÄ‚îÄ\nfunction extractCodeFromText(raw) {\n  let text = raw;\n  const codeBlocks = [...text.matchAll(/```(?:javascript|js|jsx)?\\s*\\n([\\s\\S]*?)```/g)];\n  if (codeBlocks.length > 0) {\n    text = codeBlocks.reduce((best, m) => m[1].length > best.length ? m[1] : best, '');\n  }\n  const lines = text.split('\\n');\n  const codeLines = [];\n  let insideCode = false;\n  for (let idx = 0; idx < lines.length; idx++) {\n    const line = lines[idx];\n    const trimmed = line.trim();\n    if (!insideCode && !trimmed) continue;\n    const isCodeLine =\n      trimmed === '' || trimmed.startsWith('//') || trimmed.startsWith('/*') ||\n      trimmed.startsWith('*') || trimmed.startsWith('*/') ||\n      /^(config|const |let |var |if |else|for |while |function |return |buy|sell|log|alert|\\{|\\}|\\(|\\)|\\/\\/)/.test(trimmed) ||\n      /^[a-zA-Z_$][a-zA-Z0-9_$]*\\s*[\\(=\\.\\[]/.test(trimmed) ||\n      /^[a-zA-Z_$][a-zA-Z0-9_$]*\\s*[+\\-*/%<>&|!]/.test(trimmed) ||\n      /^\\}/.test(trimmed);\n    if (isCodeLine) { insideCode = true; codeLines.push(line); }\n    else if (insideCode) {\n      const remaining = lines.slice(idx);\n      const hasMore = remaining.some(l => /^(\\/\\/|config|const |let |var |if |else|buy|sell|log)/.test(l.trim()));\n      if (!hasMore) break;\n    }\n  }\n  return codeLines.join('\\n').trim() || text.trim();\n}\n\n// ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\n// CODE EDITOR ‚Äî visible text, working colors\n// ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\nfunction CodeEditor({ code, onChange, error }) {\n  const textareaRef = useRef(null);\n\n  const handleKeyDown = (e) => {\n    if (e.key === 'Tab') {\n      e.preventDefault();\n      const s = e.target.selectionStart;\n      const end = e.target.selectionEnd;\n      onChange(code.substring(0, s) + '  ' + code.substring(end));\n      setTimeout(() => { e.target.selectionStart = e.target.selectionEnd = s + 2; }, 0);\n    }\n  };\n\n  const handlePaste = (e) => {\n    e.preventDefault();\n    const pasted = e.clipboardData.getData('text');\n    const cleaned = extractCodeFromText(pasted);\n    const ta = e.target;\n    const s = ta.selectionStart;\n    const end = ta.selectionEnd;\n    const newCode = code.substring(0, s) + cleaned + code.substring(end);\n    onChange(newCode);\n  };\n\n  const lineCount = (code || '').split('\\n').length;\n\n  return (\n    <div className=\"rounded-xl overflow-hidden\" style={{ border: `1px solid ${error ? '#ef4444' : 'rgba(255,255,255,0.08)'}` }}>\n      {error && (\n        <div className=\"flex items-center gap-2 px-4 py-2\" style={{ background: 'rgba(239,68,68,0.08)', borderBottom: '1px solid rgba(239,68,68,0.2)' }}>\n          <AlertTriangle size={13} style={{ color: '#ef4444' }} />\n          <span className=\"text-xs\" style={{ color: '#ef4444' }}>{typeof error === 'string' ? error : String(error)}</span>\n        </div>\n      )}\n      <div className=\"flex\" style={{ background: '#0d1117' }}>\n        <div className=\"select-none text-right pr-3 pl-3 pt-4 pb-4 shrink-0 font-mono text-[11px] leading-6\"\n          style={{ color: '#484f58', background: '#0d1117', borderRight: '1px solid rgba(255,255,255,0.06)', minWidth: 44 }}>\n          {Array.from({ length: Math.max(lineCount, 12) }, (_, i) => (\n            <div key={i}>{i + 1}</div>\n          ))}\n        </div>\n        <textarea\n          ref={textareaRef}\n          value={code}\n          onChange={(e) => onChange(e.target.value)}\n          onPaste={handlePaste}\n          onKeyDown={handleKeyDown}\n          spellCheck={false}\n          className=\"flex-1 p-4 font-mono text-[12px] leading-6 resize-none outline-none\"\n          style={{ background: '#0d1117', color: '#c9d1d9', caretColor: '#3B82F6', minHeight: 260 }}\n          placeholder=\"// Pega o escribe tu c√≥digo aqu√≠...\"\n        />\n      </div>\n    </div>\n  );\n}\n\n// ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\n// BACKTEST RESULTS\n// ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\nfunction BacktestResults({ results }) {\n  if (!results) return null;\n  const { trades, finalBalance, totalTrades, wins, losses, winRate, totalPnl, maxDrawdown, profitFactor } = results;\n  const ok = totalPnl >= 0;\n  return (\n    <motion.div initial={{ opacity: 0, y: 8 }} animate={{ opacity: 1, y: 0 }} className=\"space-y-3\">\n      <div className=\"grid grid-cols-4 gap-2\">\n        {[\n          { label: 'Balance', value: `$${finalBalance.toFixed(0)}`, icon: BarChart3, color: ok ? '#00DC82' : '#ef4444' },\n          { label: 'Win Rate', value: `${winRate.toFixed(0)}%`, icon: Trophy, color: winRate >= 50 ? '#00DC82' : '#ef4444' },\n          { label: 'Drawdown', value: `${maxDrawdown.toFixed(1)}%`, icon: ArrowDownRight, color: maxDrawdown < 10 ? '#00DC82' : '#ef4444' },\n          { label: 'Profit F.', value: profitFactor === Infinity ? '‚àû' : profitFactor.toFixed(2), icon: Target, color: profitFactor >= 1.5 ? '#00DC82' : '#ef4444' },\n        ].map((s, i) => (\n          <div key={i} className=\"rounded-xl p-3 text-center\" style={{ background: 'var(--surface-2)', border: '1px solid var(--border)' }}>\n            <s.icon size={16} className=\"mx-auto mb-1\" style={{ color: s.color }} />\n            <p className=\"text-[10px]\" style={{ color: '#8b949e' }}>{s.label}</p>\n            <p className=\"text-base font-bold\" style={{ color: s.color }}>{s.value}</p>\n          </div>\n        ))}\n      </div>\n      <div className=\"flex items-center gap-4 text-xs px-4 py-2.5 rounded-xl\" style={{ background: 'var(--surface-2)' }}>\n        <span style={{ color: '#8b949e' }}>Trades: <b style={{ color: '#c9d1d9' }}>{totalTrades}</b></span>\n        <span style={{ color: '#00DC82' }}>‚úì {wins}</span>\n        <span style={{ color: '#ef4444' }}>‚úó {losses}</span>\n        <span className=\"ml-auto font-bold text-sm\" style={{ color: ok ? '#00DC82' : '#ef4444' }}>\n          {ok ? '+' : ''}${totalPnl.toFixed(2)}\n        </span>\n      </div>\n      {trades.length > 0 && (\n        <div className=\"max-h-32 overflow-y-auto rounded-xl\" style={{ background: 'var(--surface-2)', border: '1px solid var(--border)' }}>\n          <table className=\"w-full text-[11px]\">\n            <thead><tr style={{ color: '#8b949e', borderBottom: '1px solid var(--border)' }}>\n              <th className=\"text-left p-2.5 text-[10px]\">Tipo</th>\n              <th className=\"text-right p-2.5 text-[10px]\">Entrada</th>\n              <th className=\"text-right p-2.5 text-[10px]\">Salida</th>\n              <th className=\"text-right p-2.5 text-[10px]\">P&L</th>\n            </tr></thead>\n            <tbody>\n              {trades.slice(-8).reverse().map((t, i) => (\n                <tr key={i} style={{ borderBottom: '1px solid var(--border)' }}>\n                  <td className=\"p-2.5 font-bold\" style={{ color: t.side === 'buy' ? '#00DC82' : '#ef4444' }}>\n                    {t.side === 'buy' ? 'LONG' : 'SHORT'}\n                  </td>\n                  <td className=\"p-2.5 text-right\" style={{ color: '#c9d1d9' }}>${t.entryPrice?.toFixed(2)}</td>\n                  <td className=\"p-2.5 text-right\" style={{ color: '#c9d1d9' }}>${t.exitPrice?.toFixed(2)}</td>\n                  <td className=\"p-2.5 text-right font-bold\" style={{ color: t.pnl >= 0 ? '#00DC82' : '#ef4444' }}>\n                    {t.pnl >= 0 ? '+' : ''}${t.pnl?.toFixed(2)}\n                  </td>\n                </tr>\n              ))}\n            </tbody>\n          </table>\n        </div>\n      )}\n    </motion.div>\n  );\n}\n\n// ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\n// MAIN STRATEGY EDITOR ‚Äî clean & intuitive\n// ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\nexport default function StrategyEditor({ onSave, onClose, initialCode, initialName, editMode = false }) {\n  const [name, setName] = useState(initialName || '');\n  const [code, setCode] = useState(initialCode || '');\n  const [error, setError] = useState(null);\n  const [view, setView] = useState('editor');\n  const [backtestResults, setBacktestResults] = useState(null);\n  const [testing, setTesting] = useState(false);\n  const [testPair, setTestPair] = useState('BTCUSDT');\n  const [testTimeframe, setTestTimeframe] = useState('1h');\n  const [saved, setSaved] = useState(false);\n\n  useEffect(() => {\n    const t = setTimeout(() => {\n      if (code?.trim()) {\n        const r = validateScript(code);\n        setError(r.valid ? null : r.error);\n      } else { setError(null); }\n    }, 600);\n    return () => clearTimeout(t);\n  }, [code]);\n\n  const handleBacktest = async () => {\n    setTesting(true); setBacktestResults(null);\n    try {\n      const candles = await marketData.getCandles(testPair, testTimeframe, 500);\n      if (!candles || candles.length < 50) { setError('No hay suficientes datos'); setTesting(false); return; }\n      setBacktestResults(backtestScript(code, candles, { initialBalance: 1000, riskPercent: 2 }));\n    } catch (err) { setError(`Error: ${err.message}`); }\n    setTesting(false);\n  };\n\n  const handleSave = () => {\n    if (!name.trim()) { setError('Escribe un nombre para tu estrategia'); return; }\n    const v = validateScript(code);\n    if (!v.valid) { setError(v.error); return; }\n    onSave?.({ name: name.trim(), code, type: 'custom_script' });\n    setSaved(true);\n    setTimeout(() => setSaved(false), 2500);\n  };\n\n  const handlePasteBtn = async () => {\n    try {\n      const text = await navigator.clipboard?.readText();\n      if (text) { setCode(extractCodeFromText(text)); setBacktestResults(null); }\n    } catch { /* denied */ }\n  };\n\n  return (\n    <motion.div initial={{ opacity: 0, scale: 0.97 }} animate={{ opacity: 1, scale: 1 }} exit={{ opacity: 0, scale: 0.97 }}\n      className=\"rounded-2xl overflow-hidden\" style={{ background: 'var(--surface)', border: '1px solid var(--border)' }}>\n\n      {/* ‚ïê‚ïê‚ïê HEADER ‚ïê‚ïê‚ïê */}\n      <div className=\"flex items-center justify-between px-5 py-4\" style={{ borderBottom: '1px solid var(--border)', background: 'rgba(59,130,246,0.03)' }}>\n        <div className=\"flex items-center gap-3\">\n          <div className=\"w-10 h-10 rounded-xl flex items-center justify-center\" style={{ background: 'rgba(59,130,246,0.12)', border: '1px solid rgba(59,130,246,0.25)' }}>\n            <Code2 size={20} style={{ color: '#3B82F6' }} />\n          </div>\n          <div>\n            <h3 className=\"text-base font-bold\" style={{ color: '#c9d1d9' }}>{editMode ? 'Editar Estrategia' : 'Crear Estrategia'}</h3>\n            <p className=\"text-xs\" style={{ color: '#8b949e' }}>Escribe c√≥digo, elige un template o pega desde ChatGPT</p>\n          </div>\n        </div>\n        {onClose && (\n          <button onClick={onClose} className=\"w-9 h-9 rounded-xl flex items-center justify-center transition-colors\"\n            style={{ background: 'var(--surface-2)', border: '1px solid var(--border)' }}>\n            <X size={16} style={{ color: '#8b949e' }} />\n          </button>\n        )}\n      </div>\n\n      {/* ‚ïê‚ïê‚ïê TAB BAR ‚ïê‚ïê‚ïê */}\n      <div className=\"flex px-5 pt-3 gap-1\">\n        {[\n          { id: 'editor', label: 'Editor', icon: Code2 },\n          { id: 'templates', label: 'Templates', icon: BookOpen },\n          { id: 'help', label: 'Referencia', icon: Info },\n        ].map(tab => {\n          const active = view === tab.id;\n          return (\n            <button key={tab.id} onClick={() => setView(tab.id)}\n              className=\"flex items-center gap-1.5 px-4 py-2 rounded-t-xl text-xs font-semibold transition-all\"\n              style={{\n                background: active ? 'var(--surface-2)' : 'transparent',\n                color: active ? '#3B82F6' : '#8b949e',\n                borderBottom: active ? '2px solid #3B82F6' : '2px solid transparent',\n              }}>\n              <tab.icon size={13} />\n              {tab.label}\n            </button>\n          );\n        })}\n      </div>\n\n      <div className=\"p-5 space-y-4\">\n\n        {/* ‚ïê‚ïê‚ïê EDITOR VIEW ‚ïê‚ïê‚ïê */}\n        {view === 'editor' && (\n          <>\n            {/* Name input */}\n            <div>\n              <label className=\"text-[11px] font-semibold mb-1.5 block\" style={{ color: '#8b949e' }}>NOMBRE DE LA ESTRATEGIA</label>\n              <input value={name} onChange={(e) => setName(e.target.value)} placeholder=\"Ej: Mi Bot Scalper\"\n                className=\"w-full px-4 py-2.5 rounded-xl text-sm outline-none transition-all focus:ring-1 focus:ring-[#D4AF37]\"\n                style={{ background: 'var(--surface-2)', border: '1px solid var(--border)', color: '#c9d1d9' }} />\n            </div>\n\n            {/* Quick actions */}\n            <div className=\"grid grid-cols-3 gap-2\">\n              <button onClick={handlePasteBtn}\n                className=\"flex items-center justify-center gap-2 py-2.5 rounded-xl text-xs font-semibold transition-all hover:brightness-110\"\n                style={{ background: 'rgba(0,220,130,0.08)', border: '1px solid rgba(0,220,130,0.2)', color: '#00DC82' }}>\n                <Clipboard size={14} /> Pegar C√≥digo\n              </button>\n              <button onClick={() => navigator.clipboard?.writeText(code)}\n                className=\"flex items-center justify-center gap-2 py-2.5 rounded-xl text-xs font-semibold transition-all hover:brightness-110\"\n                style={{ background: 'var(--surface-2)', border: '1px solid var(--border)', color: '#c9d1d9' }}>\n                <Copy size={14} /> Copiar\n              </button>\n              <button onClick={() => { setCode(''); setBacktestResults(null); }}\n                className=\"flex items-center justify-center gap-2 py-2.5 rounded-xl text-xs font-semibold transition-all hover:brightness-110\"\n                style={{ background: 'var(--surface-2)', border: '1px solid var(--border)', color: '#8b949e' }}>\n                <X size={14} /> Limpiar\n              </button>\n            </div>\n\n            {/* Code editor */}\n            <CodeEditor code={code} onChange={(c) => { setCode(c); setBacktestResults(null); }} error={error} />\n\n            {/* ‚ïê‚ïê‚ïê BACKTEST section ‚Äî separated from Save ‚ïê‚ïê‚ïê */}\n            <div className=\"rounded-xl p-3 space-y-3\" style={{ background: 'rgba(0,220,130,0.03)', border: '1px solid rgba(0,220,130,0.1)' }}>\n              <div className=\"flex items-center gap-2 flex-wrap\">\n                <Play size={13} style={{ color: '#00DC82' }} />\n                <span className=\"text-[11px] font-bold\" style={{ color: '#00DC82' }}>Backtest</span>\n                <span className=\"text-[10px]\" style={{ color: '#6b7280' }}>‚Äî Prueba tu c√≥digo con datos reales antes de activar el bot</span>\n              </div>\n              <div className=\"flex items-center gap-2 flex-wrap\">\n                <select value={testPair} onChange={(e) => setTestPair(e.target.value)}\n                  className=\"px-3 py-1.5 rounded-lg text-[11px] font-semibold outline-none\"\n                  style={{ background: 'var(--surface-2)', border: '1px solid var(--border)', color: '#c9d1d9' }}>\n                  {['BTCUSDT', 'ETHUSDT', 'BNBUSDT', 'SOLUSDT', 'XRPUSDT'].map(p => <option key={p} value={p}>{p}</option>)}\n                </select>\n                <select value={testTimeframe} onChange={(e) => setTestTimeframe(e.target.value)}\n                  className=\"px-3 py-1.5 rounded-lg text-[11px] font-semibold outline-none\"\n                  style={{ background: 'var(--surface-2)', border: '1px solid var(--border)', color: '#c9d1d9' }}>\n                  {['1m', '5m', '15m', '1h', '4h', '1d'].map(tf => <option key={tf} value={tf}>{tf}</option>)}\n                </select>\n                <button onClick={handleBacktest} disabled={testing || !!error || !code?.trim()}\n                  className=\"flex items-center gap-2 px-4 py-1.5 rounded-lg text-[11px] font-bold transition-all hover:brightness-110 disabled:opacity-40\"\n                  style={{ background: 'rgba(0,220,130,0.12)', border: '1px solid rgba(0,220,130,0.25)', color: '#00DC82' }}>\n                  {testing ? <RotateCcw size={12} className=\"animate-spin\" /> : <Play size={12} />}\n                  {testing ? 'Probando...' : 'Ejecutar Test'}\n                </button>\n              </div>\n            </div>\n\n            <AnimatePresence>\n              {backtestResults && <BacktestResults results={backtestResults} />}\n            </AnimatePresence>\n\n            {/* ‚ïê‚ïê‚ïê SAVE button ‚Äî full width, clearly separated ‚ïê‚ïê‚ïê */}\n            <button onClick={handleSave} disabled={!!error || !code?.trim() || !name?.trim()}\n              className=\"w-full flex items-center justify-center gap-2 px-4 py-3 rounded-xl text-sm font-bold transition-all hover:brightness-110 disabled:opacity-40\"\n              style={{ background: saved ? 'rgba(0,220,130,0.15)' : 'linear-gradient(135deg, #3B82F6 0%, #2563EB 100%)', color: saved ? '#00DC82' : '#fff', border: 'none' }}>\n              {saved ? <><CheckCircle size={15} /> Estrategia Guardada</> : <><Save size={15} /> Guardar Estrategia</>}\n            </button>\n          </>\n        )}\n\n        {/* ‚ïê‚ïê‚ïê TEMPLATES VIEW ‚ïê‚ïê‚ïê */}\n        {view === 'templates' && (\n          <div className=\"space-y-3\">\n            <p className=\"text-xs\" style={{ color: '#8b949e' }}>\n              Haz clic en un template para cargarlo en el editor. Puedes modificarlo despu√©s.\n            </p>\n            <div className=\"grid grid-cols-1 gap-2\">\n              {SCRIPT_TEMPLATES.map(t => (\n                <button key={t.id} onClick={() => { setCode(t.code); if (!name) setName(t.name); setView('editor'); setBacktestResults(null); }}\n                  className=\"flex items-center gap-4 p-4 rounded-xl text-left transition-all hover:brightness-110\"\n                  style={{ background: 'var(--surface-2)', border: '1px solid var(--border)' }}>\n                  <div className=\"w-10 h-10 rounded-xl flex items-center justify-center shrink-0\"\n                    style={{ background: 'rgba(59,130,246,0.1)', border: '1px solid rgba(59,130,246,0.2)' }}>\n                    <Zap size={18} style={{ color: '#3B82F6' }} />\n                  </div>\n                  <div className=\"flex-1 min-w-0\">\n                    <h4 className=\"text-sm font-bold\" style={{ color: '#c9d1d9' }}>{t.name}</h4>\n                    <p className=\"text-[11px] mt-0.5\" style={{ color: '#8b949e' }}>{t.description}</p>\n                  </div>\n                  <span className=\"text-[10px] px-2 py-1 rounded-lg font-bold shrink-0\"\n                    style={{\n                      color: t.difficulty === 'Principiante' ? '#00DC82' : t.difficulty === 'Intermedio' ? '#3B82F6' : '#A855F7',\n                      background: t.difficulty === 'Principiante' ? 'rgba(0,220,130,0.1)' : t.difficulty === 'Intermedio' ? 'rgba(59,130,246,0.1)' : 'rgba(168,85,247,0.1)',\n                    }}>\n                    {t.difficulty}\n                  </span>\n                  <ChevronRight size={16} style={{ color: '#484f58' }} />\n                </button>\n              ))}\n            </div>\n          </div>\n        )}\n\n        {/* ‚ïê‚ïê‚ïê HELP VIEW ‚ïê‚ïê‚ïê */}\n        {view === 'help' && (\n          <div className=\"space-y-4\">\n            <p className=\"text-xs\" style={{ color: '#8b949e' }}>Funciones disponibles en Kairos Script.</p>\n\n            <div className=\"rounded-xl overflow-hidden\" style={{ border: '1px solid var(--border)' }}>\n              <div className=\"px-4 py-2.5\" style={{ background: 'rgba(97,175,239,0.06)', borderBottom: '1px solid var(--border)' }}>\n                <span className=\"text-xs font-bold\" style={{ color: '#61AFEF' }}>üìä Indicadores</span>\n              </div>\n              {[\n                ['ema(periodo)', 'Media M√≥vil Exponencial'],\n                ['sma(periodo)', 'Media M√≥vil Simple'],\n                ['rsi(periodo)', 'Fuerza Relativa (0-100)'],\n                ['macd(f, s, sig)', '.line .signal .histogram'],\n                ['bb(periodo, std)', '.upper .middle .lower'],\n                ['vwap()', 'Precio Promedio por Volumen'],\n              ].map(([fn, desc]) => (\n                <div key={fn} className=\"flex items-center justify-between px-4 py-2\" style={{ borderBottom: '1px solid var(--border)' }}>\n                  <code className=\"text-xs font-bold\" style={{ color: '#61AFEF' }}>{fn}</code>\n                  <span className=\"text-[10px]\" style={{ color: '#8b949e' }}>{desc}</span>\n                </div>\n              ))}\n            </div>\n\n            <div className=\"rounded-xl overflow-hidden\" style={{ border: '1px solid var(--border)' }}>\n              <div className=\"px-4 py-2.5\" style={{ background: 'rgba(224,108,117,0.06)', borderBottom: '1px solid var(--border)' }}>\n                <span className=\"text-xs font-bold\" style={{ color: '#E06C75' }}>‚ö° Acciones</span>\n              </div>\n              {[\n                ['buy()', 'Se√±al de COMPRA'],\n                ['sell()', 'Se√±al de VENTA'],\n                ['config({ stopLoss, takeProfit })', 'SL/TP en %'],\n                ['log(\"msg\")', 'Log del bot'],\n              ].map(([fn, desc]) => (\n                <div key={fn} className=\"flex items-center justify-between px-4 py-2\" style={{ borderBottom: '1px solid var(--border)' }}>\n                  <code className=\"text-xs font-bold\" style={{ color: '#E06C75' }}>{fn}</code>\n                  <span className=\"text-[10px]\" style={{ color: '#8b949e' }}>{desc}</span>\n                </div>\n              ))}\n            </div>\n\n            <div className=\"rounded-xl overflow-hidden\" style={{ border: '1px solid var(--border)' }}>\n              <div className=\"px-4 py-2.5\" style={{ background: 'rgba(0,220,130,0.06)', borderBottom: '1px solid var(--border)' }}>\n                <span className=\"text-xs font-bold\" style={{ color: '#00DC82' }}>üîç Detecci√≥n</span>\n              </div>\n              {[\n                ['crossover(a, b)', 'A cruza arriba de B'],\n                ['crossunder(a, b)', 'A cruza abajo de B'],\n                ['highest(ind, n)', 'M√°ximo en N barras'],\n                ['lowest(ind, n)', 'M√≠nimo en N barras'],\n                ['avg(ind, n)', 'Promedio en N barras'],\n                ['percentChange(ind, n)', 'Cambio % en N barras'],\n              ].map(([fn, desc]) => (\n                <div key={fn} className=\"flex items-center justify-between px-4 py-2\" style={{ borderBottom: '1px solid var(--border)' }}>\n                  <code className=\"text-xs font-bold\" style={{ color: '#00DC82' }}>{fn}</code>\n                  <span className=\"text-[10px]\" style={{ color: '#8b949e' }}>{desc}</span>\n                </div>\n              ))}\n            </div>\n\n            <div className=\"rounded-xl p-4\" style={{ background: 'var(--surface-2)', border: '1px solid var(--border)' }}>\n              <span className=\"text-xs font-bold\" style={{ color: '#56B6C2' }}>üìà Variables</span>\n              <div className=\"flex flex-wrap gap-2 mt-2\">\n                {['close', 'open', 'high', 'low', 'volume', 'price', 'barIndex'].map(v => (\n                  <code key={v} className=\"text-[11px] px-2.5 py-1 rounded-lg font-bold\"\n                    style={{ background: 'rgba(86,182,194,0.1)', color: '#56B6C2', border: '1px solid rgba(86,182,194,0.2)' }}>\n                    {v}\n                  </code>\n                ))}\n              </div>\n            </div>\n\n            <button onClick={() => setView('editor')}\n              className=\"w-full py-2.5 rounded-xl text-xs font-bold flex items-center justify-center gap-2 transition-all hover:brightness-110\"\n              style={{ background: 'rgba(59,130,246,0.1)', border: '1px solid rgba(59,130,246,0.2)', color: '#3B82F6' }}>\n              <Code2 size={14} /> Volver al Editor\n            </button>\n          </div>\n        )}\n      </div>\n    </motion.div>\n  );\n}"],"names":["extractCodeFromText","raw","text","codeBlocks","best","m","lines","codeLines","insideCode","idx","line","trimmed","l","CodeEditor","code","onChange","error","textareaRef","useRef","handleKeyDown","e","s","end","handlePaste","pasted","cleaned","ta","newCode","lineCount","jsxs","jsx","AlertTriangle","_","i","BacktestResults","results","trades","finalBalance","totalTrades","wins","losses","winRate","totalPnl","maxDrawdown","profitFactor","ok","motion","BarChart3","Trophy","ArrowDownRight","Target","t","_a","_b","_c","StrategyEditor","onSave","onClose","initialCode","initialName","editMode","name","setName","useState","setCode","setError","view","setView","backtestResults","setBacktestResults","testing","setTesting","testPair","setTestPair","testTimeframe","setTestTimeframe","saved","setSaved","useEffect","r","validateScript","handleBacktest","candles","marketData","backtestScript","err","handleSave","v","handlePasteBtn","Code2","X","BookOpen","Info","tab","active","Fragment","Clipboard","Copy","c","Play","p","tf","RotateCcw","AnimatePresence","CheckCircle","Save","SCRIPT_TEMPLATES","Zap","ChevronRight","fn","desc"],"mappings":"oSAaA,SAASA,EAAoBC,EAAK,CAChC,IAAIC,EAAOD,EACX,MAAME,EAAa,CAAC,GAAGD,EAAK,SAAS,8CAA8C,CAAC,EAChFC,EAAW,OAAS,IACtBD,EAAOC,EAAW,OAAO,CAACC,EAAMC,IAAMA,EAAE,CAAC,EAAE,OAASD,EAAK,OAASC,EAAE,CAAC,EAAID,EAAM,EAAE,GAEnF,MAAME,EAAQJ,EAAK,MAAM;AAAA,CAAI,EACvBK,EAAY,CAAA,EAClB,IAAIC,EAAa,GACjB,QAASC,EAAM,EAAGA,EAAMH,EAAM,OAAQG,IAAO,CAC3C,MAAMC,EAAOJ,EAAMG,CAAG,EAChBE,EAAUD,EAAK,KAAA,EACrB,GAAI,CAACF,GAAc,CAACG,EAAS,SAQ7B,GANEA,IAAY,IAAMA,EAAQ,WAAW,IAAI,GAAKA,EAAQ,WAAW,IAAI,GACrEA,EAAQ,WAAW,GAAG,GAAKA,EAAQ,WAAW,IAAI,GAClD,wGAAwG,KAAKA,CAAO,GACpH,wCAAwC,KAAKA,CAAO,GACpD,4CAA4C,KAAKA,CAAO,GACxD,MAAM,KAAKA,CAAO,EACFH,EAAa,GAAMD,EAAU,KAAKG,CAAI,UAC/CF,GAGH,CAFcF,EAAM,MAAMG,CAAG,EACP,KAAKG,GAAK,wDAAwD,KAAKA,EAAE,KAAA,CAAM,CAAC,EAC5F,KAElB,CACA,OAAOL,EAAU,KAAK;AAAA,CAAI,EAAE,KAAA,GAAUL,EAAK,KAAA,CAC7C,CAKA,SAASW,GAAW,CAAE,KAAAC,EAAM,SAAAC,EAAU,MAAAC,GAAS,CAC7C,MAAMC,EAAcC,EAAAA,OAAO,IAAI,EAEzBC,EAAiBC,GAAM,CAC3B,GAAIA,EAAE,MAAQ,MAAO,CACnBA,EAAE,eAAA,EACF,MAAMC,EAAID,EAAE,OAAO,eACbE,EAAMF,EAAE,OAAO,aACrBL,EAASD,EAAK,UAAU,EAAGO,CAAC,EAAI,KAAOP,EAAK,UAAUQ,CAAG,CAAC,EAC1D,WAAW,IAAM,CAAEF,EAAE,OAAO,eAAiBA,EAAE,OAAO,aAAeC,EAAI,CAAG,EAAG,CAAC,CAClF,CACF,EAEME,EAAeH,GAAM,CACzBA,EAAE,eAAA,EACF,MAAMI,EAASJ,EAAE,cAAc,QAAQ,MAAM,EACvCK,EAAUzB,EAAoBwB,CAAM,EACpCE,EAAKN,EAAE,OACPC,EAAIK,EAAG,eACPJ,EAAMI,EAAG,aACTC,EAAUb,EAAK,UAAU,EAAGO,CAAC,EAAII,EAAUX,EAAK,UAAUQ,CAAG,EACnEP,EAASY,CAAO,CAClB,EAEMC,GAAad,GAAQ,IAAI,MAAM;AAAA,CAAI,EAAE,OAE3C,OACEe,EAAAA,KAAC,MAAA,CAAI,UAAU,6BAA6B,MAAO,CAAE,OAAQ,aAAab,EAAQ,UAAY,wBAAwB,EAAA,EACnH,SAAA,CAAAA,GACCa,EAAAA,KAAC,MAAA,CAAI,UAAU,oCAAoC,MAAO,CAAE,WAAY,uBAAwB,aAAc,+BAAA,EAC5G,SAAA,CAAAC,MAACC,GAAc,KAAM,GAAI,MAAO,CAAE,MAAO,WAAa,EACtDD,EAAAA,IAAC,OAAA,CAAK,UAAU,UAAU,MAAO,CAAE,MAAO,SAAA,EAAc,gBAAOd,GAAU,SAAWA,EAAQ,OAAOA,CAAK,CAAA,CAAE,CAAA,EAC5G,EAEFa,OAAC,OAAI,UAAU,OAAO,MAAO,CAAE,WAAY,WACzC,SAAA,CAAAC,EAAAA,IAAC,MAAA,CAAI,UAAU,sFACb,MAAO,CAAE,MAAO,UAAW,WAAY,UAAW,YAAa,mCAAoC,SAAU,EAAA,EAC5G,eAAM,KAAK,CAAE,OAAQ,KAAK,IAAIF,EAAW,EAAE,CAAA,EAAK,CAACI,EAAGC,IACnDH,EAAAA,IAAC,OAAa,SAAAG,EAAI,CAAA,EAARA,CAAU,CACrB,CAAA,CAAA,EAEHH,EAAAA,IAAC,WAAA,CACC,IAAKb,EACL,MAAOH,EACP,SAAWM,GAAML,EAASK,EAAE,OAAO,KAAK,EACxC,QAASG,EACT,UAAWJ,EACX,WAAY,GACZ,UAAU,sEACV,MAAO,CAAE,WAAY,UAAW,MAAO,UAAW,WAAY,UAAW,UAAW,GAAA,EACpF,YAAY,qCAAA,CAAA,CACd,CAAA,CACF,CAAA,EACF,CAEJ,CAKA,SAASe,GAAgB,CAAE,QAAAC,GAAW,CACpC,GAAI,CAACA,EAAS,OAAO,KACrB,KAAM,CAAE,OAAAC,EAAQ,aAAAC,EAAc,YAAAC,EAAa,KAAAC,EAAM,OAAAC,EAAQ,QAAAC,EAAS,SAAAC,EAAU,YAAAC,EAAa,aAAAC,CAAA,EAAiBT,EACpGU,EAAKH,GAAY,EACvB,cACGI,EAAO,IAAP,CAAW,QAAS,CAAE,QAAS,EAAG,EAAG,GAAK,QAAS,CAAE,QAAS,EAAG,EAAG,GAAK,UAAU,YAClF,SAAA,CAAAhB,EAAAA,IAAC,MAAA,CAAI,UAAU,yBACZ,SAAA,CACC,CAAE,MAAO,UAAW,MAAO,IAAIO,EAAa,QAAQ,CAAC,CAAC,GAAI,KAAMU,EAAW,MAAOF,EAAK,UAAY,SAAA,EACnG,CAAE,MAAO,WAAY,MAAO,GAAGJ,EAAQ,QAAQ,CAAC,CAAC,IAAK,KAAMO,EAAQ,MAAOP,GAAW,GAAK,UAAY,SAAA,EACvG,CAAE,MAAO,WAAY,MAAO,GAAGE,EAAY,QAAQ,CAAC,CAAC,IAAK,KAAMM,EAAgB,MAAON,EAAc,GAAK,UAAY,SAAA,EACtH,CAAE,MAAO,YAAa,MAAOC,IAAiB,IAAW,IAAMA,EAAa,QAAQ,CAAC,EAAG,KAAMM,EAAQ,MAAON,GAAgB,IAAM,UAAY,SAAA,CAAU,EACzJ,IAAI,CAACvB,EAAGY,IACRJ,EAAAA,KAAC,MAAA,CAAY,UAAU,6BAA6B,MAAO,CAAE,WAAY,mBAAoB,OAAQ,2BACnG,SAAA,CAAAC,EAAAA,IAACT,EAAE,KAAF,CAAO,KAAM,GAAI,UAAU,eAAe,MAAO,CAAE,MAAOA,EAAE,KAAA,CAAM,CAAG,EACtES,EAAAA,IAAC,IAAA,CAAE,UAAU,cAAc,MAAO,CAAE,MAAO,SAAA,EAAc,SAAAT,EAAE,KAAA,CAAM,EACjES,EAAAA,IAAC,IAAA,CAAE,UAAU,sBAAsB,MAAO,CAAE,MAAOT,EAAE,KAAA,EAAU,SAAAA,EAAE,KAAA,CAAM,CAAA,GAH/DY,CAIV,CACD,EACH,EACAJ,OAAC,OAAI,UAAU,yDAAyD,MAAO,CAAE,WAAY,oBAC3F,SAAA,CAAAA,EAAAA,KAAC,OAAA,CAAK,MAAO,CAAE,MAAO,WAAa,SAAA,CAAA,iBAAS,IAAA,CAAE,MAAO,CAAE,MAAO,SAAA,EAAc,SAAAS,CAAA,CAAY,CAAA,EAAI,SAC3F,OAAA,CAAK,MAAO,CAAE,MAAO,WAAa,SAAA,CAAA,KAAGC,CAAA,EAAK,SAC1C,OAAA,CAAK,MAAO,CAAE,MAAO,WAAa,SAAA,CAAA,KAAGC,CAAA,EAAO,EAC7CX,EAAAA,KAAC,OAAA,CAAK,UAAU,4BAA4B,MAAO,CAAE,MAAOgB,EAAK,UAAY,SAAA,EAC1E,SAAA,CAAAA,EAAK,IAAM,GAAG,IAAEH,EAAS,QAAQ,CAAC,CAAA,CAAA,CACrC,CAAA,EACF,EACCN,EAAO,OAAS,GACfN,EAAAA,IAAC,MAAA,CAAI,UAAU,sCAAsC,MAAO,CAAE,WAAY,mBAAoB,OAAQ,yBAAA,EACpG,SAAAD,EAAAA,KAAC,QAAA,CAAM,UAAU,qBACf,SAAA,CAAAC,EAAAA,IAAC,QAAA,CAAM,gBAAC,KAAA,CAAG,MAAO,CAAE,MAAO,UAAW,aAAc,yBAAA,EAClD,SAAA,CAAAA,EAAAA,IAAC,KAAA,CAAG,UAAU,8BAA8B,SAAA,OAAI,EAChDA,EAAAA,IAAC,KAAA,CAAG,UAAU,+BAA+B,SAAA,UAAO,EACpDA,EAAAA,IAAC,KAAA,CAAG,UAAU,+BAA+B,SAAA,SAAM,EACnDA,EAAAA,IAAC,KAAA,CAAG,UAAU,+BAA+B,SAAA,KAAA,CAAG,CAAA,CAAA,CAClD,CAAA,CAAK,QACJ,QAAA,CACE,SAAAM,EAAO,MAAM,EAAE,EAAE,UAAU,IAAI,CAACe,EAAGlB,eAClCJ,OAAAA,EAAAA,KAAC,KAAA,CAAW,MAAO,CAAE,aAAc,2BACjC,SAAA,CAAAC,MAAC,MAAG,UAAU,kBAAkB,MAAO,CAAE,MAAOqB,EAAE,OAAS,MAAQ,UAAY,WAC5E,SAAAA,EAAE,OAAS,MAAQ,OAAS,QAC/B,EACAtB,OAAC,MAAG,UAAU,mBAAmB,MAAO,CAAE,MAAO,WAAa,SAAA,CAAA,KAAEuB,EAAAD,EAAE,aAAF,YAAAC,EAAc,QAAQ,EAAC,EAAE,EACzFvB,OAAC,MAAG,UAAU,mBAAmB,MAAO,CAAE,MAAO,WAAa,SAAA,CAAA,KAAEwB,EAAAF,EAAE,YAAF,YAAAE,EAAa,QAAQ,EAAC,EAAE,EACxFxB,EAAAA,KAAC,KAAA,CAAG,UAAU,6BAA6B,MAAO,CAAE,MAAOsB,EAAE,KAAO,EAAI,UAAY,SAAA,EACjF,SAAA,CAAAA,EAAE,KAAO,EAAI,IAAM,GAAG,KAAEG,EAAAH,EAAE,MAAF,YAAAG,EAAO,QAAQ,EAAC,CAAA,CAC3C,CAAA,CAAA,EAROrB,CAST,EACD,CAAA,CACH,CAAA,CAAA,CACF,CAAA,CACF,CAAA,EAEJ,CAEJ,CAKA,SAAwBsB,GAAe,CAAE,OAAAC,EAAQ,QAAAC,EAAS,YAAAC,EAAa,YAAAC,EAAa,SAAAC,EAAW,IAAS,CACtG,KAAM,CAACC,EAAMC,CAAO,EAAIC,EAAAA,SAASJ,GAAe,EAAE,EAC5C,CAAC7C,EAAMkD,CAAO,EAAID,EAAAA,SAASL,GAAe,EAAE,EAC5C,CAAC1C,EAAOiD,CAAQ,EAAIF,EAAAA,SAAS,IAAI,EACjC,CAACG,EAAMC,CAAO,EAAIJ,EAAAA,SAAS,QAAQ,EACnC,CAACK,EAAiBC,CAAkB,EAAIN,EAAAA,SAAS,IAAI,EACrD,CAACO,EAASC,CAAU,EAAIR,EAAAA,SAAS,EAAK,EACtC,CAACS,EAAUC,CAAW,EAAIV,EAAAA,SAAS,SAAS,EAC5C,CAACW,EAAeC,CAAgB,EAAIZ,EAAAA,SAAS,IAAI,EACjD,CAACa,EAAOC,CAAQ,EAAId,EAAAA,SAAS,EAAK,EAExCe,EAAAA,UAAU,IAAM,CACd,MAAM3B,EAAI,WAAW,IAAM,CACzB,GAAIrC,GAAA,MAAAA,EAAM,OAAQ,CAChB,MAAMiE,EAAIC,EAAelE,CAAI,EAC7BmD,EAASc,EAAE,MAAQ,KAAOA,EAAE,KAAK,CACnC,MAASd,EAAS,IAAI,CACxB,EAAG,GAAG,EACN,MAAO,IAAM,aAAad,CAAC,CAC7B,EAAG,CAACrC,CAAI,CAAC,EAET,MAAMmE,EAAiB,SAAY,CACjCV,EAAW,EAAI,EAAGF,EAAmB,IAAI,EACzC,GAAI,CACF,MAAMa,EAAU,MAAMC,EAAW,WAAWX,EAAUE,EAAe,GAAG,EACxE,GAAI,CAACQ,GAAWA,EAAQ,OAAS,GAAI,CAAEjB,EAAS,0BAA0B,EAAGM,EAAW,EAAK,EAAG,MAAQ,CACxGF,EAAmBe,EAAetE,EAAMoE,EAAS,CAAE,eAAgB,IAAM,YAAa,CAAA,CAAG,CAAC,CAC5F,OAASG,EAAK,CAAEpB,EAAS,UAAUoB,EAAI,OAAO,EAAE,CAAG,CACnDd,EAAW,EAAK,CAClB,EAEMe,EAAa,IAAM,CACvB,GAAI,CAACzB,EAAK,OAAQ,CAAEI,EAAS,sCAAsC,EAAG,MAAQ,CAC9E,MAAMsB,EAAIP,EAAelE,CAAI,EAC7B,GAAI,CAACyE,EAAE,MAAO,CAAEtB,EAASsB,EAAE,KAAK,EAAG,MAAQ,CAC3C/B,GAAA,MAAAA,EAAS,CAAE,KAAMK,EAAK,KAAA,EAAQ,KAAA/C,EAAM,KAAM,kBAC1C+D,EAAS,EAAI,EACb,WAAW,IAAMA,EAAS,EAAK,EAAG,IAAI,CACxC,EAEMW,EAAiB,SAAY,OACjC,GAAI,CACF,MAAMtF,EAAO,OAAMkD,EAAA,UAAU,YAAV,YAAAA,EAAqB,YACpClD,IAAQ8D,EAAQhE,EAAoBE,CAAI,CAAC,EAAGmE,EAAmB,IAAI,EACzE,MAAQ,CAAe,CACzB,EAEA,OACExC,EAAAA,KAACiB,EAAO,IAAP,CAAW,QAAS,CAAE,QAAS,EAAG,MAAO,GAAA,EAAQ,QAAS,CAAE,QAAS,EAAG,MAAO,CAAA,EAAK,KAAM,CAAE,QAAS,EAAG,MAAO,GAAA,EAC9G,UAAU,8BAA8B,MAAO,CAAE,WAAY,iBAAkB,OAAQ,yBAAA,EAGvF,SAAA,CAAAjB,EAAAA,KAAC,MAAA,CAAI,UAAU,8CAA8C,MAAO,CAAE,aAAc,0BAA2B,WAAY,uBAAA,EACzH,SAAA,CAAAA,EAAAA,KAAC,MAAA,CAAI,UAAU,0BACb,SAAA,CAAAC,MAAC,OAAI,UAAU,wDAAwD,MAAO,CAAE,WAAY,wBAAyB,OAAQ,iCAAA,EAC3H,SAAAA,MAAC2D,EAAA,CAAM,KAAM,GAAI,MAAO,CAAE,MAAO,WAAa,EAChD,SACC,MAAA,CACC,SAAA,CAAA3D,EAAAA,IAAC,KAAA,CAAG,UAAU,sBAAsB,MAAO,CAAE,MAAO,SAAA,EAAc,SAAA8B,EAAW,oBAAsB,kBAAA,CAAmB,EACtH9B,EAAAA,IAAC,KAAE,UAAU,UAAU,MAAO,CAAE,MAAO,SAAA,EAAa,SAAA,wDAAA,CAAsD,CAAA,CAAA,CAC5G,CAAA,EACF,EACC2B,GACC3B,EAAAA,IAAC,SAAA,CAAO,QAAS2B,EAAS,UAAU,wEAClC,MAAO,CAAE,WAAY,mBAAoB,OAAQ,yBAAA,EACjD,SAAA3B,EAAAA,IAAC4D,GAAE,KAAM,GAAI,MAAO,CAAE,MAAO,UAAU,CAAG,CAAA,CAAA,CAC5C,EAEJ,EAGA5D,EAAAA,IAAC,MAAA,CAAI,UAAU,uBACZ,SAAA,CACC,CAAE,GAAI,SAAU,MAAO,SAAU,KAAM2D,CAAA,EACvC,CAAE,GAAI,YAAa,MAAO,YAAa,KAAME,CAAA,EAC7C,CAAE,GAAI,OAAQ,MAAO,aAAc,KAAMC,CAAA,CAAK,EAC9C,IAAIC,GAAO,CACX,MAAMC,EAAS5B,IAAS2B,EAAI,GAC5B,OACEhE,EAAAA,KAAC,SAAA,CAAoB,QAAS,IAAMsC,EAAQ0B,EAAI,EAAE,EAChD,UAAU,wFACV,MAAO,CACL,WAAYC,EAAS,mBAAqB,cAC1C,MAAOA,EAAS,UAAY,UAC5B,aAAcA,EAAS,oBAAsB,uBAAA,EAE/C,SAAA,CAAAhE,EAAAA,IAAC+D,EAAI,KAAJ,CAAS,KAAM,EAAA,CAAI,EACnBA,EAAI,KAAA,CAAA,EARMA,EAAI,EAAA,CAWrB,CAAC,CAAA,CACH,EAEAhE,EAAAA,KAAC,MAAA,CAAI,UAAU,gBAGZ,SAAA,CAAAqC,IAAS,UACRrC,EAAAA,KAAAkE,EAAAA,SAAA,CAEE,SAAA,CAAAlE,OAAC,MAAA,CACC,SAAA,CAAAC,EAAAA,IAAC,QAAA,CAAM,UAAU,yCAAyC,MAAO,CAAE,MAAO,SAAA,EAAa,SAAA,yBAAA,CAAuB,EAC9GA,EAAAA,IAAC,QAAA,CAAM,MAAO+B,EAAM,SAAWzC,GAAM0C,EAAQ1C,EAAE,OAAO,KAAK,EAAG,YAAY,qBACxE,UAAU,sGACV,MAAO,CAAE,WAAY,mBAAoB,OAAQ,0BAA2B,MAAO,SAAA,CAAU,CAAA,CAAG,EACpG,EAGAS,EAAAA,KAAC,MAAA,CAAI,UAAU,yBACb,SAAA,CAAAA,EAAAA,KAAC,SAAA,CAAO,QAAS2D,EACf,UAAU,qHACV,MAAO,CAAE,WAAY,uBAAwB,OAAQ,gCAAiC,MAAO,SAAA,EAC7F,SAAA,CAAA1D,EAAAA,IAACkE,EAAA,CAAU,KAAM,EAAA,CAAI,EAAE,eAAA,CAAA,CAAA,EAEzBnE,EAAAA,KAAC,SAAA,CAAO,QAAS,IAAA,OAAM,OAAAuB,EAAA,UAAU,YAAV,YAAAA,EAAqB,UAAUtC,IACpD,UAAU,qHACV,MAAO,CAAE,WAAY,mBAAoB,OAAQ,0BAA2B,MAAO,SAAA,EACnF,SAAA,CAAAgB,EAAAA,IAACmE,EAAA,CAAK,KAAM,EAAA,CAAI,EAAE,SAAA,CAAA,CAAA,EAEpBpE,EAAAA,KAAC,SAAA,CAAO,QAAS,IAAM,CAAEmC,EAAQ,EAAE,EAAGK,EAAmB,IAAI,CAAG,EAC9D,UAAU,qHACV,MAAO,CAAE,WAAY,mBAAoB,OAAQ,0BAA2B,MAAO,SAAA,EACnF,SAAA,CAAAvC,EAAAA,IAAC4D,EAAA,CAAE,KAAM,EAAA,CAAI,EAAE,UAAA,CAAA,CAAA,CACjB,EACF,EAGA5D,EAAAA,IAACjB,GAAA,CAAW,KAAAC,EAAY,SAAWoF,GAAM,CAAElC,EAAQkC,CAAC,EAAG7B,EAAmB,IAAI,CAAG,EAAG,MAAArD,CAAA,CAAc,EAGlGa,EAAAA,KAAC,MAAA,CAAI,UAAU,2BAA2B,MAAO,CAAE,WAAY,uBAAwB,OAAQ,+BAAA,EAC7F,SAAA,CAAAA,EAAAA,KAAC,MAAA,CAAI,UAAU,oCACb,SAAA,CAAAC,MAACqE,GAAK,KAAM,GAAI,MAAO,CAAE,MAAO,WAAa,EAC7CrE,EAAAA,IAAC,QAAK,UAAU,wBAAwB,MAAO,CAAE,MAAO,SAAA,EAAa,SAAA,UAAA,CAAQ,EAC7EA,EAAAA,IAAC,QAAK,UAAU,cAAc,MAAO,CAAE,MAAO,SAAA,EAAa,SAAA,6DAAA,CAA2D,CAAA,EACxH,EACAD,EAAAA,KAAC,MAAA,CAAI,UAAU,oCACb,SAAA,CAAAC,EAAAA,IAAC,SAAA,CAAO,MAAO0C,EAAU,SAAWpD,GAAMqD,EAAYrD,EAAE,OAAO,KAAK,EAClE,UAAU,gEACV,MAAO,CAAE,WAAY,mBAAoB,OAAQ,0BAA2B,MAAO,SAAA,EAClF,SAAA,CAAC,UAAW,UAAW,UAAW,UAAW,SAAS,EAAE,IAAIgF,SAAM,SAAA,CAAe,MAAOA,EAAI,SAAAA,CAAA,EAAdA,CAAgB,CAAS,CAAA,CAAA,EAE1GtE,EAAAA,IAAC,SAAA,CAAO,MAAO4C,EAAe,SAAWtD,GAAMuD,EAAiBvD,EAAE,OAAO,KAAK,EAC5E,UAAU,gEACV,MAAO,CAAE,WAAY,mBAAoB,OAAQ,0BAA2B,MAAO,SAAA,EAClF,UAAC,KAAM,KAAM,MAAO,KAAM,KAAM,IAAI,EAAE,IAAIiF,SAAO,SAAA,CAAgB,MAAOA,EAAK,SAAAA,CAAA,EAAhBA,CAAmB,CAAS,CAAA,CAAA,EAE5FxE,EAAAA,KAAC,SAAA,CAAO,QAASoD,EAAgB,SAAUX,GAAW,CAAC,CAACtD,GAAS,EAACF,GAAA,MAAAA,EAAM,QACtE,UAAU,+HACV,MAAO,CAAE,WAAY,uBAAwB,OAAQ,iCAAkC,MAAO,SAAA,EAC7F,SAAA,CAAAwD,EAAUxC,EAAAA,IAACwE,EAAA,CAAU,KAAM,GAAI,UAAU,eAAe,EAAKxE,EAAAA,IAACqE,EAAA,CAAK,KAAM,EAAA,CAAI,EAC7E7B,EAAU,cAAgB,eAAA,CAAA,CAAA,CAC7B,CAAA,CACF,CAAA,EACF,QAECiC,EAAA,CACE,SAAAnC,SAAoBlC,GAAA,CAAgB,QAASkC,EAAiB,EACjE,EAGAtC,EAAAA,IAAC,SAAA,CAAO,QAASwD,EAAY,SAAU,CAAC,CAACtE,GAAS,EAACF,GAAA,MAAAA,EAAM,SAAU,EAAC+C,GAAA,MAAAA,EAAM,QACxE,UAAU,+IACV,MAAO,CAAE,WAAYe,EAAQ,uBAAyB,oDAAqD,MAAOA,EAAQ,UAAY,OAAQ,OAAQ,MAAA,EACrJ,WAAQ/C,EAAAA,KAAAkE,EAAAA,SAAA,CAAE,SAAA,CAAAjE,EAAAA,IAAC0E,EAAA,CAAY,KAAM,EAAA,CAAI,EAAE,sBAAA,CAAA,CAAoB,EAAM3E,EAAAA,KAAAkE,EAAAA,SAAA,CAAE,SAAA,CAAAjE,EAAAA,IAAC2E,EAAA,CAAK,KAAM,EAAA,CAAI,EAAE,qBAAA,CAAA,CAAmB,CAAA,CAAA,CACvG,EACF,EAIDvC,IAAS,aACRrC,OAAC,MAAA,CAAI,UAAU,YACb,SAAA,CAAAC,EAAAA,IAAC,IAAA,CAAE,UAAU,UAAU,MAAO,CAAE,MAAO,SAAA,EAAa,SAAA,iFAAA,CAEpD,QACC,MAAA,CAAI,UAAU,yBACZ,SAAA4E,EAAiB,IAAIvD,GACpBtB,EAAAA,KAAC,SAAA,CAAkB,QAAS,IAAM,CAAEmC,EAAQb,EAAE,IAAI,EAAQU,GAAMC,EAAQX,EAAE,IAAI,EAAGgB,EAAQ,QAAQ,EAAGE,EAAmB,IAAI,CAAG,EAC5H,UAAU,uFACV,MAAO,CAAE,WAAY,mBAAoB,OAAQ,yBAAA,EACjD,SAAA,CAAAvC,EAAAA,IAAC,MAAA,CAAI,UAAU,iEACb,MAAO,CAAE,WAAY,uBAAwB,OAAQ,gCAAA,EACrD,SAAAA,EAAAA,IAAC6E,GAAI,KAAM,GAAI,MAAO,CAAE,MAAO,UAAU,CAAG,CAAA,CAAA,EAE9C9E,EAAAA,KAAC,MAAA,CAAI,UAAU,iBACb,SAAA,CAAAC,EAAAA,IAAC,KAAA,CAAG,UAAU,oBAAoB,MAAO,CAAE,MAAO,SAAA,EAAc,SAAAqB,EAAE,IAAA,CAAK,EACvErB,EAAAA,IAAC,IAAA,CAAE,UAAU,qBAAqB,MAAO,CAAE,MAAO,SAAA,EAAc,SAAAqB,EAAE,WAAA,CAAY,CAAA,EAChF,EACArB,EAAAA,IAAC,OAAA,CAAK,UAAU,sDACd,MAAO,CACL,MAAOqB,EAAE,aAAe,eAAiB,UAAYA,EAAE,aAAe,aAAe,UAAY,UACjG,WAAYA,EAAE,aAAe,eAAiB,sBAAwBA,EAAE,aAAe,aAAe,uBAAyB,sBAAA,EAEhI,SAAAA,EAAE,UAAA,CAAA,EAELrB,MAAC8E,GAAa,KAAM,GAAI,MAAO,CAAE,MAAO,UAAU,CAAG,CAAA,CAAA,EAlB1CzD,EAAE,EAAA,CAoBhB,CAAA,CACH,CAAA,EACF,EAIDe,IAAS,QACRrC,OAAC,MAAA,CAAI,UAAU,YACb,SAAA,CAAAC,EAAAA,IAAC,IAAA,CAAE,UAAU,UAAU,MAAO,CAAE,MAAO,SAAA,EAAa,SAAA,yCAAA,CAAuC,EAE3FD,OAAC,OAAI,UAAU,6BAA6B,MAAO,CAAE,OAAQ,2BAC3D,SAAA,CAAAC,EAAAA,IAAC,MAAA,CAAI,UAAU,cAAc,MAAO,CAAE,WAAY,wBAAyB,aAAc,yBAAA,EACvF,eAAC,OAAA,CAAK,UAAU,oBAAoB,MAAO,CAAE,MAAO,WAAa,0BAAc,CAAA,CACjF,EACC,CACC,CAAC,eAAgB,yBAAyB,EAC1C,CAAC,eAAgB,oBAAoB,EACrC,CAAC,eAAgB,yBAAyB,EAC1C,CAAC,kBAAmB,0BAA0B,EAC9C,CAAC,mBAAoB,uBAAuB,EAC5C,CAAC,SAAU,6BAA6B,CAAA,EACxC,IAAI,CAAC,CAAC+E,EAAIC,CAAI,IACdjF,EAAAA,KAAC,MAAA,CAAa,UAAU,8CAA8C,MAAO,CAAE,aAAc,2BAC3F,SAAA,CAAAC,EAAAA,IAAC,OAAA,CAAK,UAAU,oBAAoB,MAAO,CAAE,MAAO,SAAA,EAAc,SAAA+E,CAAA,CAAG,EACrE/E,EAAAA,IAAC,QAAK,UAAU,cAAc,MAAO,CAAE,MAAO,SAAA,EAAc,SAAAgF,CAAA,CAAK,CAAA,CAAA,EAFzDD,CAGV,CACD,CAAA,EACH,EAEAhF,OAAC,OAAI,UAAU,6BAA6B,MAAO,CAAE,OAAQ,2BAC3D,SAAA,CAAAC,EAAAA,IAAC,MAAA,CAAI,UAAU,cAAc,MAAO,CAAE,WAAY,yBAA0B,aAAc,yBAAA,EACxF,eAAC,OAAA,CAAK,UAAU,oBAAoB,MAAO,CAAE,MAAO,WAAa,sBAAU,CAAA,CAC7E,EACC,CACC,CAAC,QAAS,iBAAiB,EAC3B,CAAC,SAAU,gBAAgB,EAC3B,CAAC,mCAAoC,YAAY,EACjD,CAAC,aAAc,aAAa,CAAA,EAC5B,IAAI,CAAC,CAAC+E,EAAIC,CAAI,IACdjF,EAAAA,KAAC,MAAA,CAAa,UAAU,8CAA8C,MAAO,CAAE,aAAc,2BAC3F,SAAA,CAAAC,EAAAA,IAAC,OAAA,CAAK,UAAU,oBAAoB,MAAO,CAAE,MAAO,SAAA,EAAc,SAAA+E,CAAA,CAAG,EACrE/E,EAAAA,IAAC,QAAK,UAAU,cAAc,MAAO,CAAE,MAAO,SAAA,EAAc,SAAAgF,CAAA,CAAK,CAAA,CAAA,EAFzDD,CAGV,CACD,CAAA,EACH,EAEAhF,OAAC,OAAI,UAAU,6BAA6B,MAAO,CAAE,OAAQ,2BAC3D,SAAA,CAAAC,EAAAA,IAAC,MAAA,CAAI,UAAU,cAAc,MAAO,CAAE,WAAY,uBAAwB,aAAc,yBAAA,EACtF,eAAC,OAAA,CAAK,UAAU,oBAAoB,MAAO,CAAE,MAAO,WAAa,wBAAY,CAAA,CAC/E,EACC,CACC,CAAC,kBAAmB,qBAAqB,EACzC,CAAC,mBAAoB,oBAAoB,EACzC,CAAC,kBAAmB,oBAAoB,EACxC,CAAC,iBAAkB,oBAAoB,EACvC,CAAC,cAAe,sBAAsB,EACtC,CAAC,wBAAyB,sBAAsB,CAAA,EAChD,IAAI,CAAC,CAAC+E,EAAIC,CAAI,IACdjF,EAAAA,KAAC,MAAA,CAAa,UAAU,8CAA8C,MAAO,CAAE,aAAc,2BAC3F,SAAA,CAAAC,EAAAA,IAAC,OAAA,CAAK,UAAU,oBAAoB,MAAO,CAAE,MAAO,SAAA,EAAc,SAAA+E,CAAA,CAAG,EACrE/E,EAAAA,IAAC,QAAK,UAAU,cAAc,MAAO,CAAE,MAAO,SAAA,EAAc,SAAAgF,CAAA,CAAK,CAAA,CAAA,EAFzDD,CAGV,CACD,CAAA,EACH,EAEAhF,EAAAA,KAAC,MAAA,CAAI,UAAU,iBAAiB,MAAO,CAAE,WAAY,mBAAoB,OAAQ,yBAAA,EAC/E,SAAA,CAAAC,EAAAA,IAAC,OAAA,CAAK,UAAU,oBAAoB,MAAO,CAAE,MAAO,SAAA,EAAa,SAAA,cAAA,CAAY,EAC7EA,EAAAA,IAAC,MAAA,CAAI,UAAU,4BACZ,UAAC,QAAS,OAAQ,OAAQ,MAAO,SAAU,QAAS,UAAU,EAAE,IAAIyD,GACnEzD,EAAAA,IAAC,OAAA,CAAa,UAAU,+CACtB,MAAO,CAAE,WAAY,uBAAwB,MAAO,UAAW,OAAQ,gCAAA,EACtE,SAAAyD,CAAA,EAFQA,CAAA,CAIZ,CAAA,CACH,CAAA,EACF,EAEA1D,EAAAA,KAAC,SAAA,CAAO,QAAS,IAAMsC,EAAQ,QAAQ,EACrC,UAAU,wHACV,MAAO,CAAE,WAAY,uBAAwB,OAAQ,iCAAkC,MAAO,SAAA,EAC9F,SAAA,CAAArC,EAAAA,IAAC2D,EAAA,CAAM,KAAM,EAAA,CAAI,EAAE,mBAAA,CAAA,CAAA,CACrB,CAAA,CACF,CAAA,CAAA,CAEJ,CAAA,CAAA,CAAA,CAGN"}