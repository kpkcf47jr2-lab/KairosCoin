import{a as l,j as e,Z as A,a0 as _,T as U,aL as W,a2 as q,af as M,az as H,F as Z,o as B,m as G,W as g,a3 as J,aH as Y,y as C,I as Q,aI as X,H as ee,a6 as se,a5 as te,aE as ae}from"./ui-C9JhL7YV.js";import{u as P}from"./index-Cu2XX3EC.js";import"./vendor-09nSF2_j.js";const re="https://kairos-api-u6k5.onrender.com/api/vault";async function u(c,i={}){const a=await fetch(`${re}${c}`,{headers:{"Content-Type":"application/json"},...i}),d=await a.json();if(!a.ok)throw new Error(d.error||"API Error");return d}function ce(){var F;const{user:c,showToast:i}=P(),a=(c==null?void 0:c.walletAddress)||"",d=!!a,[t,$]=l.useState(null),[r,K]=l.useState(null),[y,O]=l.useState([]),[S,D]=l.useState([]),[m,z]=l.useState(""),[h,N]=l.useState(""),[b,j]=l.useState(!1),[k,T]=l.useState("deposit"),[w,E]=l.useState(!1),x=l.useCallback(async()=>{try{const s=await u("/info");$(s)}catch(s){console.error("Vault info error:",s)}},[]),o=l.useCallback(async()=>{if(a)try{const s=await u(`/account?wallet=${a}`);K(s)}catch(s){console.error("User vault error:",s)}},[a]),I=l.useCallback(async()=>{try{const s=await u("/leaderboard?limit=10");O(s)}catch(s){console.error("Leaderboard error:",s)}},[]),R=l.useCallback(async()=>{try{const s=await u("/epochs?limit=20");D(s)}catch(s){console.error("Epochs error:",s)}},[]);l.useEffect(()=>{x(),I(),R(),a&&o();const s=setInterval(()=>{x(),a&&o()},1e4);return()=>clearInterval(s)},[x,o,I,R,a]);const V=l.useCallback(async()=>{const s=parseFloat(m);if(!s||s<=0){i("Ingresa una cantidad vÃ¡lida","error");return}j(!0);try{const n=await u("/deposit",{method:"POST",body:JSON.stringify({wallet:a,amount:s})});i(`Depositado: ${s} KAIROS â†’ ${n.sharesReceived.toFixed(4)} kKAIROS`,"success"),z(""),x(),o()}catch(n){i(n.message,"error")}j(!1)},[m,a,i,x,o]),L=l.useCallback(async()=>{const s=parseFloat(h);if(!s||s<=0){i("Ingresa la cantidad de shares","error");return}j(!0);try{const n=await u("/withdraw",{method:"POST",body:JSON.stringify({wallet:a,shares:s})});i(`Retirado: ${n.kairosReturned.toFixed(4)} KAIROS (Ganancia: +${n.earned.toFixed(4)})`,"success"),N(""),x(),o()}catch(n){i(n.message,"error")}j(!1)},[h,a,i,x,o]),p=s=>!s||s===0?"0":s>=1e6?(s/1e6).toFixed(2)+"M":s>=1e3?(s/1e3).toFixed(1)+"K":s.toFixed(2);return e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"bg-gradient-to-r from-emerald-900/40 to-blue-900/30 border border-emerald-500/20 rounded-xl p-5",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg flex items-center justify-center overflow-hidden",children:e.jsx("img",{src:"/kairos-logo.png",alt:"Kairos",className:"w-10 h-10 object-contain"})}),e.jsxs("div",{children:[e.jsxs("h1",{className:"text-xl font-bold text-white flex items-center gap-2",children:["Kairos Vault",e.jsxs("span",{className:"text-xs bg-emerald-600 text-white px-2 py-0.5 rounded-full flex items-center gap-1",children:[e.jsx(A,{size:10})," EARN"]})]}),e.jsx("p",{className:"text-sm text-emerald-300",children:"Provee liquidez y gana yield de trading fees"})]})]}),d&&e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs("div",{className:"bg-emerald-900/30 border border-emerald-500/30 rounded-lg px-3 py-1.5 flex items-center gap-2",children:[e.jsx("div",{className:"w-2 h-2 rounded-full bg-emerald-400 animate-pulse"}),e.jsxs("span",{className:"text-xs text-emerald-400 font-mono",children:[a.slice(0,6),"...",a.slice(-4)]})]})})]})}),t&&e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3",children:[e.jsx(f,{icon:_,label:"TVL (Total Value Locked)",value:`$${p(t.tvl)}`,color:"emerald"}),e.jsx(f,{icon:U,label:"APY Estimado",value:`${t.apy.toFixed(2)}%`,color:"blue"}),e.jsx(f,{icon:W,label:"Liquidity Providers",value:t.totalProviders.toString(),color:"purple"}),e.jsx(f,{icon:q,label:"Precio kKAIROS",value:`$${t.pricePerShare.toFixed(6)}`,color:"amber"})]}),e.jsxs("button",{onClick:()=>E(!w),className:"w-full flex items-center justify-between px-4 py-3 rounded-xl bg-zinc-900 border border-zinc-800 text-sm text-white/60 hover:text-white/80 transition-colors",children:[e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx(M,{size:14})," Â¿CÃ³mo funciona el Vault?"]}),w?e.jsx(H,{size:14}):e.jsx(Z,{size:14})]}),e.jsx(B,{children:w&&e.jsxs(G.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},className:"bg-zinc-900/50 border border-zinc-800 rounded-xl p-5 space-y-3",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4",children:[e.jsx(v,{step:"1",title:"Deposita KAIROS",desc:"Deposita KAIROS en el Vault y recibe tokens kKAIROS que representan tu participaciÃ³n."}),e.jsx(v,{step:"2",title:"Traders pagan fees",desc:"Cada trade con apalancamiento genera fees. 70% fluye al vault, aumentando el valor de tu kKAIROS."}),e.jsx(v,{step:"3",title:"Retira con yield",desc:"Cuando retiras, tu kKAIROS vale mÃ¡s que cuando depositaste. La diferencia es tu ganancia."})]}),t&&e.jsxs("div",{className:"flex gap-6 justify-center mt-3 pt-3 border-t border-zinc-800",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-xs text-white/30",children:"LP Reward"}),e.jsxs("p",{className:"text-sm font-bold text-emerald-400",children:[t.feeSplit.vault,"%"]})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-xs text-white/30",children:"Treasury"}),e.jsxs("p",{className:"text-sm font-bold text-blue-400",children:[t.feeSplit.treasury,"%"]})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-xs text-white/30",children:"Insurance"}),e.jsxs("p",{className:"text-sm font-bold text-amber-400",children:[t.feeSplit.insurance,"%"]})]})]})]})}),d?e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-zinc-900 border border-zinc-800 rounded-xl p-4",children:[e.jsxs("h3",{className:"text-sm font-bold text-white/70 mb-3 flex items-center gap-2",children:[e.jsx(g,{size:14})," Tu PosiciÃ³n"]}),r?e.jsxs("div",{className:"space-y-2.5",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-xs text-white/40",children:"kKAIROS Balance"}),e.jsx("span",{className:"text-sm font-bold text-white",children:r.shares.toFixed(4)})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-xs text-white/40",children:"Valor Actual"}),e.jsxs("span",{className:"text-sm font-bold text-emerald-400",children:["$",r.currentValue.toFixed(2)]})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-xs text-white/40",children:"Total Depositado"}),e.jsxs("span",{className:"text-sm text-white/60",children:["$",r.totalDeposited.toFixed(2)]})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-xs text-white/40",children:"Ganancia No Realizada"}),e.jsxs("span",{className:`text-sm font-bold ${r.unrealizedProfit>0?"text-emerald-400":"text-white/40"}`,children:["+$",r.unrealizedProfit.toFixed(4)]})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-xs text-white/40",children:"Total Ganado"}),e.jsxs("span",{className:"text-sm font-bold text-emerald-400",children:["$",r.totalEarned.toFixed(4)]})]}),r.cooldownRemaining>0&&e.jsxs("div",{className:"flex items-center gap-2 mt-2 px-2 py-1.5 rounded-lg bg-amber-900/20 border border-amber-500/20",children:[e.jsx(J,{size:12,className:"text-amber-400"}),e.jsxs("span",{className:"text-xs text-amber-400",children:["Cooldown: ",Math.ceil(r.cooldownRemaining/60),"min restantes"]})]})]}):e.jsx("p",{className:"text-xs text-white/30",children:"No tienes posiciÃ³n en el vault aÃºn"})]}),t&&e.jsxs("div",{className:"bg-zinc-900 border border-zinc-800 rounded-xl p-4",children:[e.jsxs("h3",{className:"text-sm font-bold text-white/70 mb-3 flex items-center gap-2",children:[e.jsx(Y,{size:14})," Vault Stats"]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-xs text-white/40",children:"Total Fees Distribuidos"}),e.jsxs("span",{className:"text-xs text-emerald-400",children:["$",p(t.totalFeesDistributed)]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-xs text-white/40",children:"Fees al Treasury"}),e.jsxs("span",{className:"text-xs text-blue-400",children:["$",p(t.totalTreasuryFees)]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-xs text-white/40",children:"Fees al Insurance Fund"}),e.jsxs("span",{className:"text-xs text-amber-400",children:["$",p(t.totalInsuranceFees)]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-xs text-white/40",children:"Ã‰pocas"}),e.jsx("span",{className:"text-xs text-white/60",children:t.currentEpoch})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-xs text-white/40",children:"Capacidad MÃ¡x"}),e.jsx("span",{className:"text-xs text-white/60",children:p(t.maxCapacity)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-xs text-white/40",children:"DepÃ³sito MÃ­n"}),e.jsxs("span",{className:"text-xs text-white/60",children:[t.minDeposit," KAIROS"]})]})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-zinc-900 border border-zinc-800 rounded-xl p-4",children:[e.jsx("div",{className:"flex gap-1 mb-4 p-1 rounded-lg bg-zinc-800",children:["deposit","withdraw"].map(s=>e.jsx("button",{onClick:()=>T(s),className:`flex-1 py-2 text-xs font-bold rounded-md transition-all ${k===s?s==="deposit"?"bg-emerald-600 text-white":"bg-blue-600 text-white":"text-white/40 hover:text-white/60"}`,children:s==="deposit"?"ðŸ“¥ Depositar":"ðŸ“¤ Retirar"},s))}),k==="deposit"?e.jsxs("div",{className:"space-y-3",children:[e.jsx("label",{className:"text-xs text-white/40 block",children:"Cantidad de KAIROS a depositar"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"number",value:m,onChange:s=>z(s.target.value),placeholder:"100",min:"1",step:"0.01",className:"w-full bg-zinc-800 border border-zinc-700 rounded-lg px-3 py-2.5 text-white text-sm focus:border-emerald-500 outline-none"}),e.jsx("span",{className:"absolute right-3 top-1/2 -translate-y-1/2 text-xs text-white/30",children:"KAIROS"})]}),t&&m&&e.jsxs("div",{className:"bg-zinc-800/50 rounded-lg p-3 space-y-1",children:[e.jsxs("div",{className:"flex justify-between text-xs",children:[e.jsx("span",{className:"text-white/40",children:"RecibirÃ¡s aprox."}),e.jsxs("span",{className:"text-emerald-400 font-mono",children:[(parseFloat(m)/(t.pricePerShare||1)).toFixed(4)," kKAIROS"]})]}),e.jsxs("div",{className:"flex justify-between text-xs",children:[e.jsx("span",{className:"text-white/40",children:"Precio por share"}),e.jsxs("span",{className:"text-white/60 font-mono",children:["$",t.pricePerShare.toFixed(6)]})]})]}),e.jsx("button",{onClick:V,disabled:b||!m,className:"w-full py-3 rounded-xl bg-emerald-600 hover:bg-emerald-500 text-white font-bold text-sm disabled:opacity-40 transition-colors flex items-center justify-center gap-2",children:b?e.jsx(C,{size:14,className:"animate-spin"}):e.jsxs(e.Fragment,{children:[e.jsx(Q,{size:14})," Depositar en Vault"]})})]}):e.jsxs("div",{className:"space-y-3",children:[e.jsx("label",{className:"text-xs text-white/40 block",children:"Cantidad de kKAIROS shares a retirar"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"number",value:h,onChange:s=>N(s.target.value),placeholder:r?r.shares.toFixed(4):"0",min:"0.0001",step:"0.0001",className:"w-full bg-zinc-800 border border-zinc-700 rounded-lg px-3 py-2.5 text-white text-sm focus:border-blue-500 outline-none"}),e.jsx("span",{className:"absolute right-3 top-1/2 -translate-y-1/2 text-xs text-white/30",children:"kKAIROS"})]}),r&&e.jsxs("button",{onClick:()=>N(r.shares.toFixed(6)),className:"text-xs text-blue-400 hover:text-blue-300 transition-colors",children:["Max: ",r.shares.toFixed(4)," kKAIROS"]}),t&&h&&e.jsx("div",{className:"bg-zinc-800/50 rounded-lg p-3 space-y-1",children:e.jsxs("div",{className:"flex justify-between text-xs",children:[e.jsx("span",{className:"text-white/40",children:"RecibirÃ¡s aprox."}),e.jsxs("span",{className:"text-blue-400 font-mono",children:[(parseFloat(h)*(t.pricePerShare||1)).toFixed(4)," KAIROS"]})]})}),e.jsx("button",{onClick:L,disabled:b||!h,className:"w-full py-3 rounded-xl bg-blue-600 hover:bg-blue-500 text-white font-bold text-sm disabled:opacity-40 transition-colors flex items-center justify-center gap-2",children:b?e.jsx(C,{size:14,className:"animate-spin"}):e.jsxs(e.Fragment,{children:[e.jsx(X,{size:14})," Retirar del Vault"]})})]})]}),((F=r==null?void 0:r.transactions)==null?void 0:F.length)>0&&e.jsxs("div",{className:"bg-zinc-900 border border-zinc-800 rounded-xl p-4",children:[e.jsxs("h3",{className:"text-sm font-bold text-white/70 mb-3 flex items-center gap-2",children:[e.jsx(ee,{size:14})," Historial"]}),e.jsx("div",{className:"space-y-2 max-h-[200px] overflow-y-auto",children:r.transactions.slice(0,10).map(s=>e.jsxs("div",{className:"flex items-center justify-between py-1.5 border-b border-zinc-800/50 last:border-0",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[s.type==="DEPOSIT"?e.jsx(se,{size:12,className:"text-emerald-400"}):e.jsx(te,{size:12,className:"text-blue-400"}),e.jsx("span",{className:"text-xs text-white/60",children:s.type})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("p",{className:"text-xs font-mono text-white",children:[s.kairos_amount.toFixed(2)," KAIROS"]}),e.jsx("p",{className:"text-[10px] text-white/30",children:new Date(s.created_at+"Z").toLocaleDateString()})]})]},s.id))})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-zinc-900 border border-zinc-800 rounded-xl p-4",children:[e.jsxs("h3",{className:"text-sm font-bold text-white/70 mb-3 flex items-center gap-2",children:[e.jsx(ae,{size:14})," Top Liquidity Providers"]}),y.length>0?e.jsx("div",{className:"space-y-2",children:y.slice(0,8).map((s,n)=>e.jsxs("div",{className:"flex items-center justify-between py-1.5",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:`w-5 h-5 rounded-full flex items-center justify-center text-[10px] font-bold
                          ${n===0?"bg-amber-500 text-black":n===1?"bg-zinc-400 text-black":n===2?"bg-amber-700 text-white":"bg-zinc-800 text-white/40"}`,children:n+1}),e.jsxs("span",{className:"text-xs text-white/50 font-mono",children:[s.wallet_address.slice(0,6),"...",s.wallet_address.slice(-4)]})]}),e.jsxs("span",{className:"text-xs font-bold text-emerald-400",children:["$",p(s.currentValue)]})]},s.wallet_address))}):e.jsx("p",{className:"text-xs text-white/30 text-center py-4",children:"SÃ© el primer LP"})]}),S.length>0&&e.jsxs("div",{className:"bg-zinc-900 border border-zinc-800 rounded-xl p-4",children:[e.jsxs("h3",{className:"text-sm font-bold text-white/70 mb-3 flex items-center gap-2",children:[e.jsx(A,{size:14})," Distribuciones Recientes"]}),e.jsx("div",{className:"space-y-2 max-h-[180px] overflow-y-auto",children:S.slice(0,10).map(s=>e.jsxs("div",{className:"flex items-center justify-between py-1.5 border-b border-zinc-800/50 last:border-0",children:[e.jsxs("div",{children:[e.jsxs("span",{className:"text-xs text-white/50",children:["Ã‰poca #",s.epoch]}),e.jsx("p",{className:"text-[10px] text-white/25",children:new Date(s.created_at+"Z").toLocaleDateString()})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("p",{className:"text-xs font-bold text-emerald-400",children:["+",s.vault_share.toFixed(4)]}),e.jsxs("p",{className:"text-[10px] text-white/30",children:["PPS: $",s.price_per_share.toFixed(6)]})]})]},s.epoch))})]})]})]}):e.jsxs("div",{className:"bg-zinc-900 border border-zinc-800 rounded-xl p-12 text-center",children:[e.jsx("div",{className:"w-16 h-16 rounded-2xl bg-emerald-500/10 flex items-center justify-center mx-auto mb-4",children:e.jsx(g,{className:"w-8 h-8 text-emerald-400"})}),e.jsx("h2",{className:"text-lg font-bold text-white mb-2",children:"Wallet Requerida"}),e.jsx("p",{className:"text-zinc-400 text-sm max-w-md mx-auto mb-5",children:"Necesitas tu Kairos Wallet activa para depositar en el Vault y ganar yield de trading fees."}),e.jsx("button",{onClick:()=>P.getState().setPage("wallet"),className:"px-6 py-3 rounded-xl text-sm font-bold text-black transition-all hover:brightness-110",style:{background:"linear-gradient(135deg, #D4AF37, #B8972E)"},children:e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx(g,{size:16})," Ir a Mi Wallet"]})})]})]})}function f({icon:c,label:i,value:a,color:d}){const t={emerald:"from-emerald-900/30 to-emerald-800/10 border-emerald-500/20 text-emerald-400",blue:"from-blue-900/30 to-blue-800/10 border-blue-500/20 text-blue-400",purple:"from-purple-900/30 to-purple-800/10 border-purple-500/20 text-purple-400",amber:"from-amber-900/30 to-amber-800/10 border-amber-500/20 text-amber-400"};return e.jsxs("div",{className:`bg-gradient-to-br ${t[d]} border rounded-xl p-4`,children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(c,{size:14,className:t[d].split(" ").pop()}),e.jsx("span",{className:"text-[10px] text-white/40 uppercase tracking-wider",children:i})]}),e.jsx("p",{className:"text-xl font-black",children:a})]})}function v({step:c,title:i,desc:a}){return e.jsxs("div",{className:"text-center p-3",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-emerald-600 text-white font-bold text-sm flex items-center justify-center mx-auto mb-2",children:c}),e.jsx("h4",{className:"text-sm font-bold text-white mb-1",children:i}),e.jsx("p",{className:"text-xs text-white/40",children:a})]})}export{ce as default};
//# sourceMappingURL=KairosVault-SnGVzG5h.js.map
