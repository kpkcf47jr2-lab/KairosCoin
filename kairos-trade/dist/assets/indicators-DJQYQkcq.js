function f(l,t){const e=2/(t+1),n=[l[0]];for(let u=1;u<l.length;u++)n.push(l[u]*e+n[u-1]*(1-e));return n}function m(l,t){const e=[];for(let n=0;n<l.length;n++){if(n<t-1){e.push(null);continue}const u=l.slice(n-t+1,n+1);e.push(u.reduce((c,s)=>c+s,0)/t)}return e}function v(l,t=14){const e=new Array(t).fill(null);let n=0,u=0;for(let c=1;c<=t;c++){const s=l[c]-l[c-1];s>0?n+=s:u+=Math.abs(s)}n/=t,u/=t,e.push(u===0?100:100-100/(1+n/u));for(let c=t+1;c<l.length;c++){const s=l[c]-l[c-1];n=(n*(t-1)+(s>0?s:0))/t,u=(u*(t-1)+(s<0?Math.abs(s):0))/t,e.push(u===0?100:100-100/(1+n/u))}return e}function M(l,t=12,e=26,n=9){const u=f(l,t),c=f(l,e),s=u.map((i,h)=>i-c[h]),a=f(s,n),r=s.map((i,h)=>i-a[h]);return{macd:s,signal:a,histogram:r}}function p(l,t=20,e=2){const n=m(l,t),u=[],c=[];for(let s=0;s<l.length;s++){if(s<t-1){u.push(null),c.push(null);continue}const a=l.slice(s-t+1,s+1),r=n[s],i=a.reduce((o,g)=>o+Math.pow(g-r,2),0)/t,h=Math.sqrt(i)*e;u.push(r+h),c.push(r-h)}return{upper:u,middle:n,lower:c}}function w(l){let t=0,e=0;return l.map(n=>{const u=(n.high+n.low+n.close)/3;return e+=u*n.volume,t+=n.volume,t>0?e/t:u})}function A(l,t,e){if(e<1)return null;const n=l[e-1],u=l[e],c=t[e-1],s=t[e];return n<=c&&u>s?"bullish_cross":n>=c&&u<s?"bearish_cross":null}function H(l,t,e=14){if(l.length<e*2)return null;const n=l.length,u=Math.max(...l.slice(n-e)),c=Math.max(...l.slice(n-e*2,n-e)),s=Math.max(...t.slice(n-e).filter(r=>r!==null)),a=Math.max(...t.slice(n-e*2,n-e).filter(r=>r!==null));return u>c&&s<a?"bearish_divergence":u<c&&s>a?"bullish_divergence":null}export{m as a,p as b,f as c,v as d,M as e,w as f,A as g,H as h};
