{"version":3,"file":"TradeHistory-CsKn9he1.js","sources":["../../src/components/Trading/TradeHistory.jsx"],"sourcesContent":["// Kairos Trade — Trade History\nimport { useState } from 'react';\nimport { motion } from 'framer-motion';\nimport { History, TrendingUp, TrendingDown, Download, Filter } from 'lucide-react';\nimport useStore from '../../store/useStore';\n\nexport default function TradeHistory() {\n  const { tradeHistory, positions } = useStore();\n  const [tab, setTab] = useState('open'); // open | closed\n\n  const totalPnl = tradeHistory.reduce((sum, t) => sum + (t.pnl || 0), 0);\n  const wins = tradeHistory.filter(t => (t.pnl || 0) > 0).length;\n  const winRate = tradeHistory.length > 0 ? (wins / tradeHistory.length * 100) : 0;\n\n  return (\n    <div className=\"flex-1 overflow-y-auto px-5 py-5 space-y-5\">\n      <div className=\"flex items-center justify-between gap-3\">\n        <div className=\"min-w-0\">\n          <h1 className=\"text-lg font-bold\">Historial de Trading</h1>\n          <p className=\"text-xs text-[var(--text-dim)]\">\n            {tradeHistory.length} trades cerrados • {positions.length} posiciones abiertas\n          </p>\n        </div>\n        <button\n          onClick={() => {\n            const rows = [['Par', 'Lado', 'Entrada', 'Salida', 'Cantidad', 'P&L', 'Fecha Apertura', 'Fecha Cierre']];\n            tradeHistory.forEach(t => {\n              rows.push([\n                t.symbol, t.side, t.entryPrice?.toFixed(2), t.exitPrice?.toFixed(2) || '',\n                t.quantity, (t.pnl || 0).toFixed(2),\n                t.openedAt || '', t.closedAt || '',\n              ]);\n            });\n            const csv = rows.map(r => r.join(',')).join('\\n');\n            const blob = new Blob([csv], { type: 'text/csv' });\n            const url = URL.createObjectURL(blob);\n            const a = document.createElement('a');\n            a.href = url;\n            a.download = `kairos-trades-${new Date().toISOString().split('T')[0]}.csv`;\n            a.click();\n            URL.revokeObjectURL(url);\n          }}\n          className=\"flex items-center gap-2 px-3 py-1.5 bg-[var(--dark-3)] text-[var(--text-dim)] rounded-lg text-xs hover:text-[var(--gold)] hover:border-[var(--gold)]/30 transition-all border border-[var(--border)]\"\n        >\n          <Download size={14} /> Exportar CSV\n        </button>\n      </div>\n\n      {/* Stats */}\n      <div className=\"grid grid-cols-2 sm:grid-cols-4 gap-2\">\n        <div className=\"bg-[var(--dark-2)] border border-[var(--border)] rounded-xl p-3 text-center\">\n          <p className=\"text-xs text-[var(--text-dim)]\">Total Trades</p>\n          <p className=\"text-lg font-bold\">{tradeHistory.length}</p>\n        </div>\n        <div className=\"bg-[var(--dark-2)] border border-[var(--border)] rounded-xl p-3 text-center\">\n          <p className=\"text-xs text-[var(--text-dim)]\">P&L Total</p>\n          <p className={`text-lg font-bold ${totalPnl >= 0 ? 'text-[var(--green)]' : 'text-[var(--red)]'}`}>\n            {totalPnl >= 0 ? '+' : ''}${totalPnl.toFixed(2)}\n          </p>\n        </div>\n        <div className=\"bg-[var(--dark-2)] border border-[var(--border)] rounded-xl p-3 text-center\">\n          <p className=\"text-xs text-[var(--text-dim)]\">Win Rate</p>\n          <p className=\"text-lg font-bold text-[var(--gold)]\">{winRate.toFixed(1)}%</p>\n        </div>\n        <div className=\"bg-[var(--dark-2)] border border-[var(--border)] rounded-xl p-3 text-center\">\n          <p className=\"text-xs text-[var(--text-dim)]\">Posiciones Abiertas</p>\n          <p className=\"text-lg font-bold text-[var(--blue)]\">{positions.length}</p>\n        </div>\n      </div>\n\n      {/* Tabs */}\n      <div className=\"flex gap-1 bg-[var(--dark-3)] rounded-lg p-1 w-fit\">\n        <button\n          onClick={() => setTab('open')}\n          className={`px-4 py-1.5 text-sm rounded-md ${tab === 'open' ? 'bg-[var(--gold)] text-white font-bold' : 'text-[var(--text-dim)]'}`}\n        >\n          Abiertas ({positions.length})\n        </button>\n        <button\n          onClick={() => setTab('closed')}\n          className={`px-4 py-1.5 text-sm rounded-md ${tab === 'closed' ? 'bg-[var(--gold)] text-white font-bold' : 'text-[var(--text-dim)]'}`}\n        >\n          Cerradas ({tradeHistory.length})\n        </button>\n      </div>\n\n      {/* Trade list */}\n      <div className=\"bg-[var(--dark-2)] border border-[var(--border)] rounded-xl overflow-x-auto\">\n        <table className=\"w-full text-sm min-w-[600px]\">\n          <thead>\n            <tr className=\"border-b border-[var(--border)] text-[var(--text-dim)] text-xs\">\n              <th className=\"text-left p-3\">Par</th>\n              <th className=\"text-left p-3\">Lado</th>\n              <th className=\"text-right p-3\">Entrada</th>\n              <th className=\"text-right p-3\">Cantidad</th>\n              <th className=\"text-right p-3\">P&L</th>\n              <th className=\"text-right p-3\">Fecha</th>\n            </tr>\n          </thead>\n          <tbody>\n            {(tab === 'open' ? positions : tradeHistory).length === 0 ? (\n              <tr>\n                <td colSpan={6} className=\"p-8 text-center text-[var(--text-dim)]\">\n                  {tab === 'open' ? 'Sin posiciones abiertas' : 'Sin trades cerrados'}\n                </td>\n              </tr>\n            ) : (tab === 'open' ? positions : tradeHistory).map((trade, i) => (\n              <tr key={trade.id || i} className=\"border-b border-[var(--border)] hover:bg-[var(--dark-3)] transition-colors\">\n                <td className=\"p-3 font-bold\">{trade.symbol}</td>\n                <td className=\"p-3\">\n                  <span className={`px-2 py-0.5 rounded-full text-xs font-bold\n                    ${trade.side === 'buy' ? 'bg-[var(--green)]/20 text-[var(--green)]' : 'bg-[var(--red)]/20 text-[var(--red)]'}`}>\n                    {trade.side?.toUpperCase()}\n                  </span>\n                </td>\n                <td className=\"p-3 text-right font-mono\">${trade.entryPrice?.toFixed(2)}</td>\n                <td className=\"p-3 text-right font-mono\">{trade.quantity}</td>\n                <td className={`p-3 text-right font-mono font-bold ${(trade.pnl || 0) >= 0 ? 'text-[var(--green)]' : 'text-[var(--red)]'}`}>\n                  {(trade.pnl || 0) >= 0 ? '+' : ''}${(trade.pnl || 0).toFixed(2)}\n                </td>\n                <td className=\"p-3 text-right text-xs text-[var(--text-dim)]\">\n                  {new Date(trade.openedAt || trade.closedAt).toLocaleDateString()}\n                </td>\n              </tr>\n            ))}\n          </tbody>\n        </table>\n      </div>\n    </div>\n  );\n}\n"],"names":["TradeHistory","tradeHistory","positions","useStore","tab","setTab","useState","totalPnl","sum","t","wins","winRate","jsxs","jsx","rows","_a","_b","csv","r","blob","url","a","Download","trade","i"],"mappings":"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"}