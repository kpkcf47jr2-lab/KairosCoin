<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><defs><linearGradient id='g' x1='0%25' y1='0%25' x2='100%25' y2='100%25'><stop offset='0%25' stop-color='%2360A5FA'/><stop offset='100%25' stop-color='%232563EB'/></linearGradient></defs><rect width='100' height='100' rx='22' fill='%2308090C'/><rect x='3' y='3' width='94' height='94' rx='19' fill='none' stroke='url(%23g)' stroke-width='2'/><text x='50' y='68' font-size='52' text-anchor='middle' fill='url(%23g)' font-family='Inter,sans-serif' font-weight='800'>K</text></svg>" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover" />
    <meta name="description" content="Kairos Trade — Plataforma de trading automatizado con inteligencia artificial" />
    <meta name="theme-color" content="#0B0E11" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
    <meta name="apple-mobile-web-app-title" content="Kairos Trade" />
    <link rel="apple-touch-icon" href="/icons/icon-192.png" />
    <link rel="manifest" href="/manifest.json" />
    <title>Kairos Trade — Trading Automatizado con AI</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Playfair+Display:wght@700&display=swap" rel="stylesheet">
  </head>
  <body>
    <div id="root"></div>
    <script>
      // Global JS error catcher — only shows critical errors before React mounts
      (function() {
        var reactMounted = false;
        var el = null;
        // React will set this flag once mounted
        window.__kairosReady = function() { reactMounted = true; if (el) el.remove(); el = null; };
        window.onerror = function(msg, src, line, col, err) {
          // Once React is mounted, let React error boundaries handle it
          if (reactMounted) return;
          // Ignore chart/WS disposal errors (non-critical)
          if (typeof msg === 'string' && (msg.includes('Value is null') || msg.includes('disposed') || msg.includes('WebSocket'))) return;
          if (typeof src === 'string' && (src.includes('charts-') || src.includes('lightweight-charts'))) return;
          if (!el) {
            el = document.createElement('div');
            el.id = 'js-error-overlay';
            el.style.cssText = 'position:fixed;top:0;left:0;right:0;z-index:99999;background:#1A1D26;color:#FF6B7A;padding:12px 16px;font:12px/1.4 monospace;border-bottom:2px solid #FF4757;max-height:40vh;overflow:auto;';
            document.body.prepend(el);
          }
          el.innerHTML += '<b>ERROR:</b> ' + msg + '<br><small>' + (src||'') + ':' + line + '</small><br>';
        };
        window.addEventListener('unhandledrejection', function(e) {
          if (reactMounted) return;
          var msg = e.reason?.message || String(e.reason || 'unknown');
          if (msg.includes('Value is null') || msg.includes('disposed') || msg.includes('chart')) return;
          window.onerror('Promise: ' + msg, '', 0, 0, e.reason);
        });
        // Auto-clear after 8s (React should be mounted by then)
        setTimeout(function() { reactMounted = true; if (el) el.remove(); }, 8000);
      })();
    </script>
    <script type="module" src="/src/main.jsx"></script>
    <script>
      if ('serviceWorker' in navigator) {
        window.addEventListener('load', () => {
          navigator.serviceWorker.register('/sw.js').catch(() => {});
        });
      }
    </script>
    <script src="/kairos-agent.js"></script>
  </body>
</html>
